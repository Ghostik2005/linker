!function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/codebase/",n(n.s=30)}([function(t,e,n){"use strict";n.r(e),n.d(e,"user_inn_w",function(){return i}),n.d(e,"user_inn_u",function(){return r}),n.d(e,"checkKey",function(){return a}),n.d(e,"checkVal",function(){return s}),n.d(e,"str_join",function(){return c}),n.d(e,"getDtParams",function(){return l}),n.d(e,"clear_obj",function(){return u}),n.d(e,"gen_params",function(){return p}),n.d(e,"get_data_test",function(){return h}),n.d(e,"init_first",function(){return f}),n.d(e,"after_call",function(){return d}),n.d(e,"after_call_s",function(){return g}),n.d(e,"request",function(){return b}),n.d(e,"getCookie",function(){return _}),n.d(e,"setCookie",function(){return w}),n.d(e,"deleteCookie",function(){return m}),n.d(e,"dt_format",function(){return v}),n.d(e,"unique_arr",function(){return y}),n.d(e,"insert_inns",function(){return $}),n.d(e,"onExit",function(){return x});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=new webix.DataCollection({}),r=new webix.DataCollection({});function a(t){var e=!1;return(8===t||13===t||32===t||46===t||t>47&&t<91||t>95&&t<112||t>185&&t<193||t>219&&t<223)&&(e=!0),e}function s(t,e){var n;return"s"===e?n=JSON.parse(t):"a"===e&&(n=t.json()),n.result?n=n.ret_val:(n=void 0,"error"),n}function c(t){var e="";for(var n in t){var i=t[n];"object"===(void 0===i?"undefined":o(i))?i=c(i):e+=i.toString()}return e}function l(t){return t.config.name,[void 0,t.config.posPpage,t.config.fi,t.config.di]}function u(t){for(var e in t){var n=t[e];"object"===(void 0===n?"undefined":o(n))?n=u(n):void 0==n&&delete t[e]}return t}function p(t){var e=t.view,n=e.$scope.app,o=t.searchBar,i=t.field?t.field:void 0,r=t.direction?t.direction:void 0,a=o?e.$scope.$$(o).getValue():void 0,s=t.filter?t.filter:void 0,c={user:n.config.user,search:a,start:t.start,count:t.count,field:i,direction:r,c_filter:s,cbars:t.cbars};return c=u(c)}function h(t){var e=t.view,n=e.$scope.app;e&&e.clearAll();var o=t.navBar,i=n.config.r_url+"?"+t.method,r=p(t),a=r.search;-1!=a.indexOf("+")&&(a=a.replace("+","+++++")),""===a&&(a="%%");var l=void 0!==a?a.replace(/\ /g,"").length:2;(void 0!==a?a.length:2)>1&&l>1&&(e.showProgress({type:"top"}),b(i,r).then(function(n){if(n=s(n,"a")){if(n.params){var i=c(p(t));if(c(n.params)!==i)return e.enable(),void e.hideProgress()}e.parse(n.datas),e.config.startPos=n.start,e.config.totalPos=n.total;var r=Math.ceil(e.config.totalPos/e.config.posPpage),l=0!==r?Math.ceil(e.config.startPos/e.config.posPpage):1,u=o.getChildViews()[3],h=o.getChildViews()[7];h.define("label","<span style='font-size: smaller'>Всего записей: "+e.config.totalPos+"</span>"),h.refresh();var f=o.$scope.$$("__page").getValue();try{f=+f}catch(t){}f!==l&&(o.$scope.$$("__page").config.manual=!1);var d=u.getChildViews();d[2].define("label","<span style='font-size: smaller'>"+r+"</span>"),d[2].refresh(),o.$scope.$$("__page").setValue(l),o.$scope.$$("__page").refresh();var g=webix.storage.session.get(e.config.name);if(g)"%%"!==a&&g.push(a);else g=["%%"!==a?a:""];webix.storage.session.put(e.config.name,g)}e.enable(),e.hideProgress()}))}function f(t){webix.i18n.setLocale("ru-RU"),webix.protoUI({name:"cWindow",defaults:{resize:!0,modal:!1,move:!0,position:"center"},$init:function(t){webix.extend(t,{head:{view:"toolbar",cols:[{view:"label",label:"Название окна"},{view:"button",tooltip:"Закрыть",css:"custom_button",type:"imageButton",image:"./library/img/close-cross.svg",height:26,width:40,click:function(){this.getTopParentView().hide()}}]}})}},webix.ui.window)}function d(t,e,n){403==n.status&&(m("merge3-app"),location.href="localhost"===location.hostname?"http://localhost:8080":"/merge3/")}function g(t,e,n){}function b(t,e,n){return!0===n?webix.ajax().sync().headers({"Content-type":"application/json"}).post(t,e,{success:g,error:d}):webix.ajax().timeout(9e4).headers({"Content-type":"application/json"}).post(t,e,{success:g,error:d})}function _(t){var e=document.cookie.match(new RegExp("(?:^|; )"+t.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return e?decodeURIComponent(e[1]):NaN}function w(t,e,n){var o=(n=n||{}).expires;if("number"==typeof o&&o){var i=new Date;i.setTime(i.getTime()+1e3*o),o=n.expires=i}o&&o.toUTCString&&(n.expires=o.toUTCString());var r=t+"="+(e=encodeURIComponent(e));for(var a in n){r+="; "+a;var s=n[a];!0!==s&&(r+="="+s)}document.cookie=r}function m(t){w(t,"",{expires:-1,path:"/"})}function v(t){return webix.Date.dateToStr("%d-%m-%Y")(t)}function y(t){for(var e={},n=0;n<t.length;n++){e[t[n]]=!0}return Object.keys(e)}function $(t,e){var n=[];0===e.length?e="":1===e.length?e=e[0]:(e.length>4&&(n=e.slice(4,e.length),(e=e.slice(0,4)).push("<span style='color: red'>  а также...</span>")),e=e.join(", "),n=n.join(", ")),t.define({label:e,tooltip:n}),t.refresh()}var x=function(t){var e=_("merge3-app");if(e){var n=e.split("::");e=n[0],n[1];var o=t.config.r_url+"?setExit",i={user:e};t.debug&&b(o,i)}}},function(t,e,n){"use strict";var o=function(){function t(){this.webixJet=!0,this._id=webix.uid(),this._events=[],this._subs={},this._data={}}return t.prototype.getRoot=function(){return this._root},t.prototype.destructor=function(){for(var t=this._events,e=t.length-1;e>=0;e--)t[e].obj.detachEvent(t[e].id);for(var n in this._subs){var o=this._subs[n].view;o&&o.destructor()}this._events=this._container=this.app=this._parent=null},t.prototype.setParam=function(t,e,n){var o;this._data[t]!==e&&(this._data[t]=e,this.app.callEvent("app:paramchange",[this,t,e,n])&&n&&this.show(((o={})[t]=e,o)))},t.prototype.getParam=function(t,e){var n=this._data[t];if(void 0!==n||!e)return n;var o=this.getParentView();return o?o.getParam(t,e):void 0},t.prototype.getUrl=function(){return this._url},t.prototype.render=function(t,e,n){var o=this;this._parent=n,e&&(this._index=e[0].index),this._init_url_data(e);var i="string"==typeof(t=t||document.body)?webix.toNode(t):t;return this._container!==i?(this._container=i,this._render(e).then(function(){return o.getRoot()})):this._urlChange(e).then(function(){return o.getRoot()})},t.prototype.getIndex=function(){return this._index},t.prototype.getId=function(){return this._id},t.prototype.getParentView=function(){return this._parent},t.prototype.$$=function(t){if("string"==typeof t){var e=this.getRoot();return e.queryView(function(n){return(n.config.id===t||n.config.localId===t)&&n.$scope===e.$scope},"self")}return t},t.prototype.on=function(t,e,n){var o=t.attachEvent(e,n);return this._events.push({obj:t,id:o}),o},t.prototype.contains=function(t){for(var e in this._subs){var n=this._subs[e].view;if(n===t||n.contains(t))return!0}return!1},t.prototype.getSubView=function(t){var e=this.getSubViewInfo(t);if(e)return e.subview.view},t.prototype.getSubViewInfo=function(t){var e=this._subs[t||"default"];return e?{subview:e,parent:this}:this._parent?this._parent.getSubViewInfo(t):null},t.prototype.getName=function(){return this._name},t.prototype._init_url_data=function(t){t&&t[0]&&(this._data={},webix.extend(this._data,t[0].params,!0)),this._url=t},t}();function i(t){"/"===t[0]&&(t=t.substr(1));for(var e=t.split("/"),n=[],o=0;o<e.length;o++){var i=e[o],r={},a=i.indexOf(":");if(-1===a&&(a=i.indexOf("?")),-1!==a)for(var s=0,c=i.substr(a+1).split(/[\:\?\&]/g);s<c.length;s++){var l=c[s].split("=");r[l[0]]=decodeURIComponent(l[1])}n[o]={page:a>-1?i.substr(0,a):i,params:r,index:o+1}}return n}function r(t){for(var e=[],n=0,o=t;n<o.length;n++){var i=o[n];e.push("/"+i.page);var r=a(i.params);r&&e.push("?"+r)}return e.join("")}function a(t){var e=[];for(var n in t)e.length&&e.push("&"),e.push(n+"="+encodeURIComponent(t[n]));return e.join("")}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),l=function(t){function e(e,n){var o=t.call(this)||this;return o.app=e,o._name=n,o._children=[],o}return c(e,t),e.prototype.ui=function(t,e){var n=(e=e||{}).container||t.container,i=this.app.createView(t);return this._children.push(i),i.render(n,null,this),"object"!==(void 0===t?"undefined":s(t))||t instanceof o?i:i.getRoot()},e.prototype.show=function(t,e){var n=this;if(e=e||{},"string"==typeof t){if("/"===t.substr(0,1))return this.app.show(t);if(0===t.indexOf("../")){var o=this.getParentView();return void(o?o.show("./"+t.substr(3),e):this.app.show("/"+t.substr(3)))}0===t.indexOf("./")&&(t=t.substr(2));var a=this.getSubViewInfo(e.target);if(!a)return this.app.show("/"+t);if(a.parent!==this)return a.parent.show(t,e)}var c=i(this.app.getRouter().get());if("object"===(void 0===t?"undefined":s(t)))if(webix.isArray(t)){var l=this._index+t[0];c[l]||(c[l]={}),c[l].page=t[1],t=""}else{var u=[];for(var p in t)u.push(encodeURIComponent(p)+"="+encodeURIComponent(t[p]));t="?"+u.join("&")}if("string"==typeof t){if("?"===t.substr(0,1)){var h=t.indexOf("/"),f=t;h>-1&&(f=t.substr(0,h));var d=i(f);webix.extend(c[this._index-1].params,d[0].params,!0),t=h>-1?t.substr(h+1):""}var g=""===t?c.slice(this._index):i(t),b=null;if(this._index){b=c.slice(0,this._index).concat(g);for(var _=0;_<b.length;_++)b[_].index=_+1;var w=r(b);return this.app.canNavigate(w,this).then(function(t){return null!==t?w!==t?n.app.show(t):n._finishShow(b,t):null})}return this._finishShow(g,"")}},e.prototype.init=function(t,e){},e.prototype.ready=function(t,e){},e.prototype.config=function(){this.app.webix.message("View:Config is not implemented")},e.prototype.urlChange=function(t,e){},e.prototype.destroy=function(){},e.prototype.destructor=function(){this.destroy(),this._destroyKids(),this.app=this._parentFrame=null,this._root.destructor(),t.prototype.destructor.call(this)},e.prototype.use=function(t,e){t(this.app,this,e)},e.prototype.refresh=function(){var t=this;this._destroyKids();var e=[];this._index>1&&(e=i(this.app.getRouter().get()).slice(this._index-1)),this._render(e).then(function(){t._parentFrame.id=t.getRoot().config.id})},e.prototype._render=function(t){var e=this,n=this.config();return n.then?n.then(function(n){return e._render_final(n,t)}):this._render_final(n,t)},e.prototype._render_final=function(t,e){var n,o=this,i=this._container;if(i&&i.$destructed)return Promise.reject("Container destroyed");var r={ui:{}};this.app.copyConfig(t,r.ui,this._subs),this.app.callEvent("app:render",[this,e,r]),r.ui.$scope=this;try{if(i&&i.getParentView){var a=i.getParentView();a&&"multiview"===a.name&&!r.ui.id&&(r.ui.id=i.config.id)}this._root=this.app.webix.ui(r.ui,this._container),this._root.getParentView()&&(this._container=this._root),this._init(this._root,e),n=this._urlChange(e).then(function(){return o.ready(o._root,e)})}catch(t){n=Promise.reject(t)}return n.catch(function(t){return o._initError(o,t)})},e.prototype._init=function(t,e){return this.init(t,e)},e.prototype._urlChange=function(t){var e=this;this.app.callEvent("app:urlchange",[this,t,this._index]);var n=[];for(var o in this._subs){var i=this._renderFrame(o,this._subs[o],t);i&&n.push(i)}return Promise.all(n).then(function(){e.urlChange(e._root,t)})},e.prototype._renderFrame=function(t,e,n){if(e.url){if("string"==typeof e.url){var o=i(e.url);return o.map(function(t){t.index=0}),this._createSubView(e,o)}var r=e.view;return"function"!=typeof e.url||r instanceof e.url||(r=new e.url(this.app,"")),r||(r=e.url),this._renderSubView(e,r,n)}if("default"===t&&n&&n.length>1){var a=n.slice(1);return this._createSubView(e,a)}},e.prototype._initError=function(t,e){return this.app.error("app:error:initview",[e,t]),!0},e.prototype._createSubView=function(t,e){var n=this;return this.app.createFromURL(e,t.view).then(function(o){return n._renderSubView(t,o,e)})},e.prototype._renderSubView=function(t,n,o){var i=this.app.webix.$$(t.id);return n.render(i,o,this).then(function(o){return t.view&&t.view!==n&&t.view.destructor(),t.view=n,t.id=o.config.id,n instanceof e&&(n._parentFrame=t),o})},e.prototype._finishShow=function(t,e){var n;return this._index?(n=this._renderPartial(t.slice(this._index-1)),this.app.getRouter().set(e,{silent:!0}),this.app.callEvent("app:route",[t])):(t.map(function(t){return t.index=0}),n=this._renderPartial([null].concat(t))),n},e.prototype._renderPartial=function(t){return this._init_url_data(t),this._urlChange(t)},e.prototype._destroyKids=function(){for(var t=this._children,e=t.length-1;e>=0;e--)t[e]&&t[e].destructor&&t[e].destructor();this._children=[]},e}(o),u=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),p=function(t){function e(e,n,o){var i=t.call(this,e,n)||this;return i._ui=o,i._windows=[],i}return u(e,t),e.prototype.getRoot=function(){if(this.app.config.jet1xMode){var t=this.getParentView();if(t)return t.getRoot()}return this._root},e.prototype.config=function(){return this._ui.$ui||this._ui},e.prototype.destructor=function(){var e=this._ui.$ondestroy;e&&e();for(var n=0,o=this._windows;n<o.length;n++){o[n].destructor()}t.prototype.destructor.call(this)},e.prototype.show=function(e,n){if(0===e.indexOf("/")||0===e.indexOf("./"))return t.prototype.show.call(this,e,n);t.prototype.show.call(this,"../"+e,n)},e.prototype.init=function(){this.app.config.legacyEarlyInit&&this._realInitHandler()},e.prototype.ready=function(){this.app.config.legacyEarlyInit||this._realInitHandler()},e.prototype._realInitHandler=function(){var t=this._ui.$oninit;if(t){var n=this.getRoot();t(n,n.$scope)}var o=this._ui.$onevent;if(o)for(var i in o)this.on(this.app,i,o[i]);var r=this._ui.$windows;if(r)for(var a=0,s=r;a<s.length;a++){var c=s[a];if(c.$ui){var l=new e(this.app,this.getName(),c);l.render(document.body),this._windows.push(l)}else this.ui(c)}},e.prototype._urlChange=function(e){var n=this;return t.prototype._urlChange.call(this,e).then(function(){var t=n._ui.$onurlchange;if(t){var o=n.getRoot();t(e[0].params,e.slice(1),o.$scope)}})},e}(l),h=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),f=function(t){function e(e,n,o){var i=t.call(this,e,n)||this;return i._ui=o,i}return h(e,t),e.prototype.config=function(){return this._ui},e}(l),d=n(24),g=n.n(d),b=function(){function t(t,e){var n=this;this.config=e||{},this._prefix=this.config.routerPrefix,void 0===this._prefix&&(this._prefix="!");var o=function(t){};g()(this._prefix+"*",function(){return n._lastUrl="",o(n.get())}),o=t}return t.prototype.set=function(t,e){if(this.config.routes){var n=t.split("?",2);for(var o in this.config.routes)if(this.config.routes[o]===n[0]){t=o+(n.length>1?"?"+n[1]:"");break}}this._lastUrl=t,g.a.navigate(this._prefix+t,e)},t.prototype.get=function(){var t=this._lastUrl||(window.location.hash||"").replace("#"+this._prefix,"");if(this.config.routes){var e=t.split("?",2),n=this.config.routes[e[0]];n&&(t=n+(e.length>1?"?"+e[1]:""))}return t},t}(),_=(n(32),"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}),w=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),m=function(t){function e(e){var n=t.call(this)||this;return n.webix=e.webix||webix,n.config=n.webix.extend({name:"App",version:"1.0",start:"/home"},e,!0),n._name=n.config.name,n._services={},webix.extend(n,webix.EventSystem),n}return w(e,t),e.prototype.getService=function(t){var e=this._services[t];return"function"==typeof e&&(e=this._services[t]=e(this)),e},e.prototype.setService=function(t,e){this._services[t]=e},e.prototype.copyConfig=function(t,e,n){if(t.$ui?t={$subview:new p(this,"",t)}:(t instanceof o||"function"==typeof t&&t.prototype instanceof o)&&(t={$subview:t}),t.$subview)return this.addSubView(t,e,n);for(var i in e=e||(t instanceof Array?[]:{}),t){var r=t[i];"function"==typeof r&&r.prototype instanceof o&&(r={$subview:r}),!r||"object"!==(void 0===r?"undefined":_(r))||r instanceof webix.DataCollection||r instanceof RegExp?e[i]=r:r instanceof Date?e[i]=new Date(r):e[i]=this.copyConfig(r,r instanceof Array?[]:{},n)}return e},e.prototype.getRouter=function(){return this.$router},e.prototype.clickHandler=function(t){if(t){var e=t.target||t.srcElement;if(e&&e.getAttribute){var n=e.getAttribute("trigger");n&&this.trigger(n);var o=e.getAttribute("route");o&&this.show(o)}}},e.prototype.refresh=function(){var t=this._container;this._view._name=webix.uid()+"",this._container=null,t.tagName&&this._view&&(this._view.destructor(),this._view=null),this.render(t,i(this.getRouter().get()),this._parent)},e.prototype.loadView=function(t){var e=this,o=this.config.views,i=null;if(""===t)return Promise.resolve(this._loadError("",new Error("Webix Jet: Empty url segment")));try{o&&"string"==typeof(i="function"==typeof o?o(t):o[t])&&(t=i,i=null),i||(t=t.replace(/\./g,"/"),i=n(33)("./"+t))}catch(e){i=this._loadError(t,e)}return i.then||(i=Promise.resolve(i)),i=i.then(function(t){return t.__esModule?t.default:t}).catch(function(n){return e._loadError(t,n)})},e.prototype.createFromURL=function(t,e){var n=this,o=t[0],i=o.page;return e&&e.getName()===i?Promise.resolve(e):this.loadView(o.page).then(function(t){return n.createView(t,i)})},e.prototype.createView=function(t,e){if("function"==typeof t){if(t.prototype instanceof o)return new t(this,e);t=t()}return t instanceof o?t:t.$ui?new p(this,e,t):new f(this,e,t)},e.prototype.show=function(t){return this.$router.get()!==t?this._render(t):Promise.resolve(!0)},e.prototype.canNavigate=function(t,e){var n={url:i(t),redirect:t,confirm:Promise.resolve(!0)};return this.callEvent("app:guard",[t,e||this._view,n])?n.confirm.catch(function(){return n.redirect=null}).then(function(){return n.redirect}):Promise.reject("")},e.prototype.destructor=function(){this._view.destructor()},e.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this.apply(t,e)},e.prototype.apply=function(t,e){this.callEvent(t,e)},e.prototype.action=function(t){return this.webix.bind(function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this.apply(t,e)},this)},e.prototype.on=function(t,e){this.attachEvent(t,e)},e.prototype.use=function(t,e){t(this,null,e)},e.prototype.error=function(t,e){if(this.callEvent(t,e),this.callEvent("app:error",e),this.config.debug)for(var n=0;n<e.length;n++)if(console.error(e[n]),e[n]instanceof Error){var o=e[n].message;0===o.indexOf("Module build failed")?(o=o.replace(/\x1b\[[0-9;]*m/g,""),document.body.innerHTML="<pre style='font-size:16px; background-color: #ec6873; color: #000; padding:10px;'>"+o+"</pre>"):(o+="<br><br>Check console for more details",webix.message({type:"error",text:o,expire:-1}))}},e.prototype._render=function(t){var e=this;!this.$router&&(webix.attachEvent("onClick",function(t){return e.clickHandler(t)}),t=this._first_start(t));var n="string"==typeof t?t:r(t);return this.canNavigate(n).then(function(t){return null!==t?(e.$router.set(t,{silent:!0}),e._render_stage(t)):null})},e.prototype._render_stage=function(t){var e=this,n="string"==typeof t?i(t):t;return webix.ui.freeze(function(){return e.createFromURL(n,e._view).then(function(t){var o=e._view;return e._view=t,t.render(e._container,n,e._parent).then(function(i){return o&&o!==e._view&&o.destructor(),e._view.getRoot().getParentView()&&(e._container=i),e._root=i,e.callEvent("app:route",[n]),t})}).catch(function(t){e.error("app:error:render",[t])})})},e.prototype._urlChange=function(t){return alert("Not implemented"),Promise.resolve(!0)},e.prototype._first_start=function(t){var e=this;if(this.$router=new(this.config.router||b)(function(t){return setTimeout(function(){e._render(t)},1)},this.config),this._container===document.body&&!1!==this.config.animation){var n=this._container;webix.html.addCss(n,"webixappstart"),setTimeout(function(){webix.html.removeCss(n,"webixappstart"),webix.html.addCss(n,"webixapp")},10)}return t&&1!==t.length||(t=this.$router.get()||this.config.start,this.$router.set(t,{silent:!0})),t},e.prototype._loadError=function(t,e){return this.error("app:error:resolve",[e,t]),{template:" "}},e.prototype.addSubView=function(t,e,n){var i=!0!==t.$subview?t.$subview:null,r=t.name||(i?this.webix.uid():"default");e.id=t.id||"s"+this.webix.uid();var a=n[r]={id:e.id,url:i};return a.url instanceof o&&(a.view=a.url),e},e}(o),v=(function(){function t(t,e){this.name=e.storeName||e.id+":route",this.cb=t}t.prototype.set=function(t,e){var n=this;webix.storage.session.put(this.name,t),e&&e.silent||setTimeout(function(){return n.cb(t)},1)},t.prototype.get=function(){return webix.storage.session.get(this.name)}}(),function(){function t(t,e){var n=this;this.cb=t,window.onpopstate=function(){return n.cb(n.get())},this.prefix=e.routerPrefix||""}t.prototype.set=function(t,e){var n=this;this.get()!==t&&window.history.pushState(null,null,this.prefix+t),e&&e.silent||setTimeout(function(){return n.cb(t)},1)},t.prototype.get=function(){var t=window.location.pathname.replace(this.prefix,"");return"/"!==t?t:""}}(),function(){function t(t,e){this.path="",this.cb=t}return t.prototype.set=function(t,e){var n=this;this.path=t,e&&e.silent||setTimeout(function(){return n.cb(t)},1)},t.prototype.get=function(){return this.path},t}());n(29);n.d(e,"b",function(){return m}),n.d(e,"c",function(){return l}),n.d(e,"a",function(){return v});window.Promise||(window.Promise=webix.promise)},function(t,e,n){"use strict";n.r(e);var o=n(1),i=n(0);var r=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.config=function(){var t=this,e=(this.app,this),n={view:"form",localId:"prop_form",padding:0,elements:[{rows:[{css:{"border-bottom":"solid 1px #ccd7e6 !important",background:"#f4f5f9"},cols:[{view:"text",label:"<span style='padding: 5px'>Фильтр:</span>",fillspace:1,labelWidth:75,css:{"border-bottom":"solid 1px #ccd7e6 !important"},_keytimed:void 0,localId:"_local_search",on:{onKeyPress:function(t,n){clearTimeout(this.config._keytimed),Object(i.checkKey)(t)&&(this.config._keytimed=setTimeout(function(){!function(){var t=e.$$("_local_search").getValue();e.$$("_tTable").filter(function(e){var n=t.toString().toLowerCase();return n=n.replace(/ /g,".*"),-1!=e.uname.toString().toLowerCase().search(n)})}()},this.$scope.app.config.searchDelay))}}},{width:1}]},{view:"treetable",name:"_lTable",css:{"border-top":"1px solid #dadee0 !important"},localId:"_tTable",select:"row",borderless:!0,fixedRowHeight:!1,headermenu:!1,resizeColumn:!0,columns:[{id:"uid",hidden:!0,headermenu:!1},{id:"uname",width:200,sort:"text",header:[{text:"Имя пользователя"}],headermenu:!0,hidden:!1,template:function(t,e){return t.$group?e.icon(t,e)+t.uname:""}},{id:"c_inn",fillspace:1,sort:"text",header:[{text:"Организация"}],headermenu:!1},{id:"inn",width:150,sort:"text",header:[{text:"ИНН"}],headermenu:!1}],on:{"data->onParse":function(t,e){this.clearAll()},onAfterSelect:function(t){},onBeforeSelect:function(t){if(!this.getItem(t).$group)return!1},onAfterUnSelect:function(){},onItemDblClick:function(t){this.$scope.$$("_save").callEvent("onItemClick")},onKeyPress:function(t,e){13===t&&this.getSelectedItem()&&this.callEvent("onItemDblClick")},onAfterLoad:function(){}}},{padding:5,localId:"_bottom",cols:[{width:10},{view:"button",type:"htmlbutton",localId:"_export",hidden:!0,tooltip:"Экспорт организаций  для пользователя из старой базы или из настроек другого пользователя",label:"<span style='line-height: 18px; font-size: smaller'>Экспорт</span>",width:120,height:36,on:{onItemClick:function(e){console.log("export"),t.popexport.isVisible()?t.popexport.hide():t.popexport.show($$(e))}}},{},{view:"button",type:"htmlbutton",localId:"_save",tooltip:"Сохранить",label:"<span style='line-height: 18px; font-size: smaller'>OK</span>",width:80,height:36,on:{onItemClick:function(){var e=t.$$("_tTable").getSelectedItem();if(e){var n=t.users_view.$$("_users").getValue(),o=[],r=t.$$("_tTable").data.getBranch(e.id);r.forEach(function(t){o.push(t.inn)});var a=[];(r=t.users_view.$$("_lTable").serialize()).forEach(function(t){a.push(t.inn)});var s=t.app.config.r_url+"?unsetUserInn",c={user:t.app.config.user,set_user:n,inn:a,sklad:t.app.config.sklad};Object(i.request)(s,c,!0),s=t.app.config.r_url+"?setUserInn",c={user:t.app.config.user,set_user:n,inn:o,sklad:t.app.config.sklad},Object(i.request)(s,c,!0),t.users_view.$$("_users").callEvent("onChange",[n,void 0])}t.hide_w()}}},{width:10}]}]}]};return{view:"cWindow",localId:"_window",width:.4*document.documentElement.clientWidth,height:.8*document.documentElement.clientHeight,modal:!0,body:n,on:{onHide:function(){t.$$("_tTable").clearAll(),t.$$("_local_search").setValue()}}}},e.prototype.ready=function(){},e.prototype.show_w=function(t,e){var n=this;this.export_from=t,this.users_view=e;var o=this.app;this.getRoot().getHead().getChildViews()[0].setValue("Экспорт организаций пользователя"),this.getRoot().show();var r=o.config.r_url;"new"===this.export_from?r+="?getUsersFromNew":"old"===this.export_from?r+="?getUsersFromOld":this.getRoot().hide();var a={user:o.config.user,edit_user:e.$$("_users").getValue()};Object(i.request)(r,a).then(function(t){(t=Object(i.checkVal)(t,"a"))?(n.$$("_tTable").parse(t),n.$$("_tTable").blockEvent(),n.$$("_tTable").group({by:"uname",map:{uname:["uname"]}}),n.$$("_tTable").unblockEvent()):webix.message("error")})},e.prototype.hide_w=function(){this.getRoot().hide()},e.prototype.init=function(){},e}(o.c);e.default=r},function(t,e,n){"use strict";n.r(e);var o=n(1),i=n(0);var r=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.config=function(){var t=this,e=(this.app,this),n={view:"form",localId:"prop_form",padding:0,elements:[{rows:[{css:{"border-bottom":"solid 1px #ccd7e6 !important",background:"#f4f5f9"},cols:[{view:"text",label:"<span style='padding: 5px'>Фильтр:</span>",labelWidth:75,css:{"border-bottom":"solid 1px #ccd7e6 !important"},_keytimed:void 0,localId:"_local_search",on:{onKeyPress:function(t,n){clearTimeout(this.config._keytimed),Object(i.checkKey)(t)&&(this.config._keytimed=setTimeout(function(){!function(){var t=e.$$("_local_search").getValue();e.$$("_rTable").filter(function(e){var n=t.toString().toLowerCase();return n=n.replace(/ /g,".*"),-1!=e.c_v.toString().toLowerCase().search(n)}),e.$$("_lTable").filter(function(e){var n=t.toString().toLowerCase();return n=n.replace(/ /g,".*"),-1!=e.c_v.toString().toLowerCase().search(n)})}()},this.$scope.app.config.searchDelay))}}}]},{cols:[{rows:[{cols:[{},{view:"button",width:38,hidden:!0,tooltip:"Перенести выделенные",localId:"_to_right",type:"imageButton",image:"./library/img/right-arrow.svg",on:{onItemClick:function(){var e=t.$$("_lTable").getSelectedItem();e.length||(e=[e]),e.forEach(function(e){t.$$("_rTable").add(e,0),t.$$("_lTable").remove(e.id)})}}},{view:"button",width:38,hidden:!1,tooltip:"Перенести все",type:"imageButton",image:"./library/img/double-right-arrows.svg",click:function(){var e=t.$$("_lTable").serialize();t.$$("_lTable").clearAll(),e.forEach(function(e){t.$$("_rTable").add(e)})}}]},{view:"label",label:"Обрабатываемые организации",align:"center",css:{background:"#f4f5f9"}},{view:"datatable",name:"_lTable",css:{"border-top":"1px solid #dadee0 !important"},localId:"_lTable",select:!0,multiselect:!0,borderless:!0,fixedRowHeight:!1,headermenu:!1,resizeColumn:!0,columns:[{id:"w",hidden:!0,headermenu:!1},{id:"inn",width:150,sort:"text",header:[{text:"ИНН"}],headermenu:!0,hidden:!1},{id:"c_v",fillspace:1,sort:"text",header:[{text:"Название"}],headermenu:!1}],on:{"data->onParse":function(t,e){this.clearAll()},onAfterSelect:function(t){this.$scope.$$("_to_right").show()},onAfterUnSelect:function(){var t=this,e=!1;this.data.order.forEach(function(n){t.isSelected(n)&&(e=!0)}),e||this.$scope.$$("_to_right").hide()},onItemDblClick:function(t){var e=this.getItem(t),n=e.id;this.remove(n),this.$scope.$$("_rTable").add(e),this.$scope.show_b()},onKeyPress:function(t,e){13===t&&this.getSelectedItem()&&this.callEvent("onItemDblClick")},onAfterLoad:function(){}}}]},{width:4},{rows:[{cols:[{view:"button",width:38,hidden:!1,tooltip:"Перенести все",type:"imageButton",image:"./library/img/double-left-arrows.svg",click:function(){var e=t.$$("_rTable").serialize();t.$$("_rTable").clearAll(),e.forEach(function(e){t.$$("_lTable").add(e),t.show_b()})}},{view:"button",width:38,hidden:!0,localId:"_to_left",tooltip:"Перенести выделенные",type:"imageButton",image:"./library/img/left-arrow.svg",click:function(){var e=t.$$("_rTable").getSelectedItem();e.length||(e=[e]),e.forEach(function(e){t.$$("_lTable").add(e,0),t.$$("_rTable").remove(e.id),t.show_b()})}},{}]},{view:"label",label:"Не обрабатываемые организации",align:"center",css:{background:"#f4f5f9"}},{view:"datatable",name:"_rTable",localId:"_rTable",css:{"border-top":"1px solid #dadee0 !important"},select:!0,multiselect:!0,borderless:!0,fixedRowHeight:!1,headermenu:!1,resizeColumn:!0,columns:[{id:"w",hidden:!0,headermenu:!1},{id:"inn",width:150,sort:"text",header:[{text:"ИНН"}],headermenu:!0,hidden:!1},{id:"c_v",fillspace:1,sort:"text",header:[{text:"Название"}],headermenu:!1}],on:{"data->onParse":function(t,e){this.clearAll()},onAfterSelect:function(t){this.$scope.$$("_to_left").show()},onAfterUnSelect:function(){var t=this,e=!1;this.data.order.forEach(function(n){t.isSelected(n)&&(e=!0)}),e||this.$scope.$$("_to_left").hide()},onItemDblClick:function(t){var e=this.getItem(t),n=e.id;this.remove(n),this.$scope.$$("_lTable").add(e),this.$scope.show_b()},onKeyPress:function(t,e){13===t&&this.getSelectedItem()&&this.callEvent("onItemDblClick")},onAfterLoad:function(){}}}]}]},{padding:5,localId:"_bottom",cols:[{width:10},{view:"button",type:"htmlbutton",localId:"_cancel",tooltip:"Отменить",label:"<span style='line-height: 18px; font-size: smaller'>Отменить</span>",width:120,height:36,click:function(){t.hide_w()}},{},{view:"button",type:"htmlbutton",localId:"_save",tooltip:"Сохранить",label:"<span style='line-height: 18px; font-size: smaller'>OK</span>",width:80,height:36,click:function(){t.parent.$scope.w=[];var e=[],n=t.$$("_lTable").data.pull;for(var o in n){var r=n[o];delete r.id,t.parent.$scope.w.push(r),e.push(r.c_v)}var a=t.$$("_rTable").data.pull;for(var o in t.parent.$scope.u=[],a){var s=a[o];delete s.id,t.parent.$scope.u.push(s)}Object(i.insert_inns)(t.parent,e),t.hide_w(),t.table&&t.table.callEvent("onAfterSelect")}},{width:10}]}]}]};return{view:"cWindow",localId:"_window",width:.4*document.documentElement.clientWidth,height:.8*document.documentElement.clientHeight,modal:!0,body:n}},e.prototype.show_b=function(){this.$$("_save").show()},e.prototype.hide_b=function(){this.$$("_cancel").hide()},e.prototype.ready=function(){},e.prototype.show_w=function(t,e){this.app;this.hide_b(),this.getRoot().getHead().getChildViews()[0].setValue("Выбор организаций"),this.parent=t,this.table=e,this.$$("_rTable").parse(this.parent.$scope.u),this.$$("_lTable").parse(this.parent.$scope.w),this.getRoot().show()},e.prototype.hide_w=function(){this.getRoot().hide()},e.prototype.init=function(){},e}(o.c);e.default=r},function(t,e,n){"use strict";n.r(e);var o=n(1),i=n(0);var r=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.config=function(){var t=this.app.config.r_url+"?getVersion",e={user:this.app.config.user,sklad:this.app.config.sklad},n=Object(i.request)(t,e,!0).response;n=Object(i.checkVal)(n,"s"),this.app.config.adm=n.adm;var o=n.prod?"Production":"test";return{view:"toolbar",css:"realy-header",cols:[{view:"label",label:"Вы находитесь на сервере:  "+location.hostname+" | fv. "+this.app.config.version+" | bv. "+n.version+" | "+o,css:{color:"#404040 !important","font-size":"11px !important"},height:12},{},{view:"button",type:"htmlbutton",width:32,hidden:!0,label:"<span class='webix_icon fa-info', style='color: #666666;'></span>"}]}},e}(o.c);e.default=r},function(t,e,n){"use strict";n.r(e);var o=n(1),i=n(6),r=n(3),a=n(11),s=n(0);var c=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.config=function(){var t=this,e=this.app;return{view:"toolbar",localId:"sideMenu",css:"side-tool-bar",borderless:!0,width:44,rows:[{view:"button",hidden:!e.config.debug,tooltip:"Настройки",localId:"_test",height:40,type:"imageButton",image:"./library/img/options_main.svg",width:40,on:{onItemClick:function(n,o){var i=e.config.r_url+"?login",r={user:e.config.user,sklad:t.app.config.sklad};console.log("config",t.app.config),Object(s.request)(i,r).then(function(t){(t=Object(s.checkVal)(t,"a")).ft&&webix.alert({type:"alert-warning",width:450,title:"ВНИМАНИЕ!",text:"<span style='line-height: 24px'>Похоже, вы здесь впервые.</span><br><span> Свяжитесь с администратором для настройки организаций.</span>"}),console.log("data",t)}),console.log("test")}}},{view:"button",tooltip:"Настройки",localId:"_options",height:40,type:"imageButton",image:"./library/img/options_main.svg",width:40,on:{onItemClick:function(e,n){t.popprop.isVisible()?t.popprop.hide():t.popprop.show($$(e),t.$$("__table"))}}},{view:"button",tooltip:"Отчет по связкам",localId:"_report",height:40,type:"imageButton",image:"./library/img/report_narrow.svg",width:40,on:{onItemClick:function(t,e){var n=this.$scope.getRoot().getParentView().getChildViews()[1].getChildViews()[0].$scope.w;n=n.slice(),this.$scope.popreport.show(this,n)}}}]}},e.prototype.ready=function(){this.$$("_options").define({disabled:!this.app.config.adm}),this.$$("_options").refresh()},e.prototype.init=function(){this.popprop=this.ui(i.default),this.popinn=this.ui(r.default),this.popreport=this.ui(a.default)},e}(o.c);e.default=c},function(t,e,n){"use strict";n.r(e);var o=n(1),i=n(7),r=n(9);var a=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.config=function(){var t=this;this.app;return{view:"popup",head:"sub-menu",loclalId:"_pop",width:140,padding:8,css:"pop-up-menu",relative:!0,body:{rows:[{view:"button",type:"htmlbutton",css:"group-button",tooltip:"Редактирование организаций",label:"<span class='side-icon', style='line-height: 18px'>Редактор организаций</span>",localId:"_companies",hidden:!0,height:48,on:{onItemClick:function(){t.hide(),t.popcom.show_w()}}},{height:8},{view:"button",type:"htmlbutton",css:"group-button",tooltip:"Редактирование пользователей",label:"<span class='side-icon', style='line-height: 18px'>Редактор пользователей</span>",localId:"_users",hidden:!0,height:48,on:{onItemClick:function(){this.$scope.hide(),this.$scope.popusers.show_w()}}}]}}},e.prototype.isVisible=function(){return this.getRoot().isVisible()},e.prototype.show=function(t){return this.target=t,this.getRoot().show(this.target.$view)},e.prototype.hide=function(){return this.getRoot().hide()},e.prototype.init=function(){this.popcom=this.ui(i.default),this.popusers=this.ui(r.default)},e.prototype.ready=function(){this.app.config.adm&&(this.$$("_users").show(),this.$$("_companies").show())},e}(o.c);e.default=a},function(t,e,n){"use strict";n.r(e);var o=n(1),i=n(0),r=n(8);var a=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.config=function(){var t=this,e=this.app,n=e.config.user,o={view:"form",localId:"prop_form",padding:0,elements:[{rows:[{rows:[{cols:[{view:"text",label:"<span style='padding: 5px'>Фильтр:</span>",fillspace:1,labelWidth:75,css:{"border-bottom":"solid 1px #ccd7e6 !important"},_keytimed:void 0,localId:"_local_search",on:{onKeyPress:function(t,e){var n=this;clearTimeout(this.config._keytimed),Object(i.checkKey)(t)&&(this.config._keytimed=setTimeout(function(){var t=n.getValue();n.$scope.$$("__table").filter(function(e){return t=(t=t.toString().toLowerCase()).replace(/ /g,".*"),-1!=e.c_inn.toString().toLowerCase().search(t)})},this.$scope.app.config.searchDelay))}}},{view:"button",width:38,hidden:!0,type:"imageButton",image:"./library/img/delete_2.svg",localId:"_delete",tooltip:"Удалить",click:function(){t.deleted=t.$$("__table").getSelectedItem(),t.deleted.length||(t.deleted=[t.deleted]),console.log("deleted",t.deleted);var e=[];t.deleted.forEach(function(t){e.push(t.id)}),console.log("removed",e),t.$$("__table").remove(e)}},{view:"button",width:38,hidden:!1,type:"imageButton",image:"./library/img/add.svg",tooltip:"Добавить",click:function(){t.popedit.show_w(t.$$("__table"),"Редатирование организации")}}]},{view:"datatable",name:"_companies",css:{"border-top":"1px solid #dadee0 !important"},localId:"__table",select:!0,multiselect:!0,borderless:!0,fixedRowHeight:!1,headermenu:!1,resizeColumn:!0,columns:[{id:"change",hidden:!0,headermenu:!1},{id:"inn",width:150,sort:"text",header:[{text:"ИНН"}],headermenu:!0,hidden:!1},{id:"c_inn",fillspace:1,sort:"text",header:[{text:"Название"}],headermenu:!1}],on:{"data->onParse":function(t,e){this.clearAll()},onAfterSelect:function(t){this.$scope.$$("_delete").show()},onAfterUnSelect:function(){var t=this,e=!1;this.data.order.forEach(function(n){t.isSelected(n)&&(e=!0)}),e||this.$scope.$$("_delete").hide()},onItemDblClick:function(t){this.$scope.popedit.show_w(this,"Редатирование организации",this.getItem(t))},onKeyPress:function(t,e){13===t&&this.getSelectedItem()&&this.callEvent("onItemDblClick")},onAfterLoad:function(){}}}]},{padding:5,localId:"_bottom",cols:[{width:10},{view:"button",type:"htmlbutton",localId:"_cancel",hidden:!0,tooltip:"Отменить",label:"<span style='line-height: 18px; font-size: smaller'>Отменить</span>",width:120,height:36,click:function(){t.hide_w()}},{},{view:"button",type:"htmlbutton",localId:"_save",tooltip:"Сохранить",label:"<span style='line-height: 18px; font-size: smaller'>OK</span>",width:80,height:36,click:function(){var o=[],r=[];t.$$("__table").data.each(function(t){1===t.change&&o.push(t),2===t.change&&r.push(t)});var a=e.config.r_url+"?setCompanies",s={user:n,changed:o,deleted:t.deleted,added:r};Object(i.request)(a,s).then(function(e){(e=Object(i.checkVal)(e,"a"))?t.hide_w():webix.message("error")})}},{width:10}]}]}]};return{view:"cWindow",localId:"_window",width:.5*document.documentElement.clientWidth,height:.8*document.documentElement.clientHeight,modal:!0,body:o,on:{onHide:function(){t.$$("_local_search").setValue("")}}}},e.prototype.ready=function(){},e.prototype.show_w=function(){var t=this;this.deleted=[];var e=this.app,n=e.config.r_url+"?getCompanies",o={user:e.config.user};Object(i.request)(n,o).then(function(e){(e=Object(i.checkVal)(e,"a"))?t.$$("__table").parse(e):webix.message("error")}),this.getRoot().getHead().getChildViews()[0].setValue("Редактирование организаций"),this.getRoot().show()},e.prototype.hide_w=function(){this.getRoot().hide()},e.prototype.init=function(){this.popedit=this.ui(r.default)},e}(o.c);e.default=a},function(t,e,n){"use strict";n.r(e);var o=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.config=function(){var t=this,e=(this.app,this);return{view:"cWindow",localId:"_window",modal:!0,body:{view:"form",localId:"prop_form",padding:0,rules:{inn:function(t){if(e.item)return!0;var n=t,o=!1;return 10==(t=(t=""+t).split("")).length?t[9]==(2*t[0]+4*t[1]+10*t[2]+3*t[3]+5*t[4]+9*t[5]+4*t[6]+6*t[7]+8*t[8])%11%10&&(o=!0):12==t.length&&t[10]==(7*t[0]+2*t[1]+4*t[2]+10*t[3]+3*t[4]+5*t[5]+9*t[6]+4*t[7]+6*t[8]+8*t[9])%11%10&&t[11]==(3*t[0]+7*t[1]+2*t[2]+4*t[3]+10*t[4]+3*t[5]+5*t[6]+9*t[7]+4*t[8]+6*t[9]+8*t[10])%11%10&&(o=!0),!0===o?(e.parent.data.each(function(t){+t.inn==+n&&(o=!1)}),!1===o&&(e.$$("_inn").define({invalidMessage:"Такой ИНН есть в базе"}),e.$$("_inn").refresh()),o):(e.$$("_inn").define({invalidMessage:"Не корректный ИНН"}),e.$$("_inn").refresh(),!1)},c_inn:webix.rules.isNotEmpty},elements:[{rows:[{height:2},{cols:[{width:10},{view:"text",label:"ИНН",name:"inn",labelPosition:"top",localId:"_inn",width:190,invalidMessage:"Некоректный ИНН"},{view:"text",label:"Название",name:"c_inn",labelPosition:"top",invalidMessage:"Название не должно быть пустым",localId:"_name",width:390},{width:10}]},{padding:5,localId:"_bottom",cols:[{width:10},{view:"button",type:"htmlbutton",localId:"_cancel",hidden:!0,tooltip:"Отменить",label:"<span style='line-height: 18px; font-size: smaller'>Отменить</span>",width:120,height:36,click:function(){t.hide_w()}},{},{view:"button",type:"htmlbutton",localId:"_save",tooltip:"Сохранить",label:"<span style='line-height: 18px; font-size: smaller'>ОК</span>",width:80,height:36,click:function(){if(t.$$("prop_form").validate({hidden:!1,disabled:!1})){if(t.item){var e=t.parent.getItem(t.item.id);e.change=1,e.c_inn=t.$$("_name").getValue(),t.parent.refresh()}else{var n={change:2,c_inn:t.$$("_name").getValue(),inn:t.$$("_inn").getValue()};t.parent.add(n,0)}t.hide_w()}}},{width:10}]}]}]},on:{onHide:function(){t.$$("prop_form").clearValidation(),t.$$("_inn").setValue(""),t.$$("_inn").enable(),t.$$("_name").setValue("")}}}},e.prototype.ready=function(){},e.prototype.show_w=function(t,e,n){this.app;this.getRoot().getHead().getChildViews()[0].setValue(e),this.parent=t,this.getRoot().show(),this.$$("_name").focus(),n?(this.item=n,e=e+": "+n.c_inn,this.$$("_inn").setValue(n.inn),this.$$("_inn").disable(),this.$$("_name").setValue(n.c_inn)):(this.item=void 0,this.$$("_inn").enable())},e.prototype.hide_w=function(){this.getRoot().hide()},e.prototype.init=function(){},e}(n(1).c);e.default=o},function(t,e,n){"use strict";n.r(e);var o=n(1),i=n(0),r=n(10),a=n(2);var s=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.config=function(){var t=this,e=this.app,n=this,o=function(){var t=n.$$("_local_search").getValue();n.$$("_rTable").filter(function(e){var n=t.toString().toLowerCase();return n=n.replace(/ /g,".*"),-1!=e.c_inn.toString().toLowerCase().search(n)}),n.$$("_lTable").filter(function(e){var n=t.toString().toLowerCase();return n=n.replace(/ /g,".*"),-1!=e.c_inn.toString().toLowerCase().search(n)})},r={view:"form",localId:"prop_form",padding:0,elements:[{rows:[{css:{"border-bottom":"solid 1px #ccd7e6 !important",background:"#f4f5f9"},cols:[{view:"text",label:"<span style='padding: 5px'>Фильтр:</span>",labelWidth:75,css:{"border-bottom":"solid 1px #ccd7e6 !important"},_keytimed:void 0,localId:"_local_search",on:{onKeyPress:function(t,e){clearTimeout(this.config._keytimed),Object(i.checkKey)(t)&&(this.config._keytimed=setTimeout(function(){o()},this.$scope.app.config.searchDelay))}}},{view:"combo",label:"<span style='margin-left: 8px'>Пользователь</span>",localId:"_users",labelWidth:120,options:{body:{autoheight:!1,height:200,yCount:0},data:[]},on:{onChange:function(n,r){n?(t.$$("_export").show(),e.config.sklad&&t.$$("_admChBox").show()):(t.$$("_export").hide(),t.$$("_admChBox").hide());var a=e.config.r_url+"?getUserInn",s={user:e.config.user,user_id:n,sklad:e.config.sklad};Object(i.request)(a,s).then(function(e){if(e=Object(i.checkVal)(e,"a")){t.$$("_admChBox").blockEvent(),t.$$("_admChBox").setValue(e.admin),t.$$("_admChBox").unblockEvent(),t.$$("_lTable").parse(e.user),t.$$("_rTable").parse(e.all);var n=[];t.$$("_rTable").data.each(function(e){t.$$("_lTable").data.each(function(t){+t.inn==+e.inn&&n.push(e.id)})}),t.$$("_rTable").remove(n),o()}else webix.message("error")})}}}]},{cols:[{rows:[{cols:[{},{view:"button",width:38,hidden:!0,tooltip:"Перенести выделенные",localId:"_to_right",type:"imageButton",image:"./library/img/right-arrow.svg",on:{onItemClick:function(){var e=t.$$("_lTable").getSelectedItem(),n=[];e.length||(e=[e]),e.forEach(function(e){n.push(e.inn),t.$$("_rTable").add(e,0),t.$$("_lTable").remove(e.id)}),t.unsetInn(n)}}},{view:"button",width:38,hidden:!1,tooltip:"Перенести все",type:"imageButton",image:"./library/img/double-right-arrows.svg",click:function(){var e=t.$$("_lTable").serialize();t.$$("_lTable").clearAll();var n=[];e.forEach(function(e){n.push(e.inn),t.$$("_rTable").add(e)}),t.unsetInn(n)}}]},{view:"label",label:"Организации для пользователя",align:"center",css:{"border-bottom":"solid 1px #ccd7e6 !important",background:"#f4f5f9"}},{view:"datatable",name:"_lTable",css:{"border-top":"1px solid #dadee0 !important"},localId:"_lTable",select:!0,multiselect:!0,borderless:!0,fixedRowHeight:!1,headermenu:!1,resizeColumn:!0,columns:[{id:"w",hidden:!0,headermenu:!1},{id:"inn",width:150,sort:"text",header:[{text:"ИНН"}],headermenu:!0,hidden:!1},{id:"c_inn",fillspace:1,sort:"text",header:[{text:"Название"}],headermenu:!1}],on:{"data->onParse":function(t,e){this.clearAll()},onAfterSelect:function(t){this.$scope.$$("_to_right").show()},onAfterUnSelect:function(){var t=this,e=!1;this.data.order.forEach(function(n){t.isSelected(n)&&(e=!0)}),e||this.$scope.$$("_to_right").hide()},onItemDblClick:function(t){var e=this.getItem(t),n=e.id;this.remove(n),this.$scope.$$("_rTable").add(e),this.$scope.unsetInn(e.inn)},onKeyPress:function(t,e){13===t&&this.getSelectedItem()&&this.callEvent("onItemDblClick")},onAfterLoad:function(){}}}]},{width:4},{rows:[{cols:[{view:"button",width:38,hidden:!1,tooltip:"Перенести все",type:"imageButton",image:"./library/img/double-left-arrows.svg",click:function(){var e=t.$$("_rTable").serialize(),n=[];t.$$("_rTable").clearAll(),e.forEach(function(e){n.push(e.inn),t.$$("_lTable").add(e)}),t.setInn(n)}},{view:"button",width:38,hidden:!0,localId:"_to_left",tooltip:"Перенести выделенные",type:"imageButton",image:"./library/img/left-arrow.svg",click:function(){var e=t.$$("_rTable").getSelectedItem(),n=[];e.length||(e=[e]),e.forEach(function(e){n.push(e.inn),t.$$("_lTable").add(e,0),t.$$("_rTable").remove(e.id)}),t.setInn(n)}},{},{view:"checkbox",label:"Администратор",localId:"_admChBox",value:0,width:150,labelWidth:120,hidden:!0,on:{onChange:function(){var t=e.config.r_url+"?setAdm",n={user:e.config.user,admin:this.getValue(),sklad:e.config.sklad};Object(i.request)(t,n).then(function(t){})}}}]},{view:"label",label:"Доступные ИНН",align:"center",css:{"border-bottom":"solid 1px #ccd7e6 !important",background:"#f4f5f9"}},{view:"datatable",name:"_rTable",localId:"_rTable",css:{"border-top":"1px solid #dadee0 !important"},select:!0,multiselect:!0,borderless:!0,fixedRowHeight:!1,headermenu:!1,resizeColumn:!0,columns:[{id:"w",hidden:!0,headermenu:!1},{id:"inn",width:150,sort:"text",header:[{text:"ИНН"}],headermenu:!0,hidden:!1},{id:"c_inn",fillspace:1,sort:"text",header:[{text:"Название"}],headermenu:!1}],on:{"data->onParse":function(t,e){this.clearAll()},onAfterSelect:function(t){this.$scope.$$("_to_left").show()},onAfterUnSelect:function(){var t=this,e=!1;this.data.order.forEach(function(n){t.isSelected(n)&&(e=!0)}),e||this.$scope.$$("_to_left").hide()},onItemDblClick:function(t){var e=this.getItem(t),n=e.id;this.remove(n),this.$scope.$$("_lTable").add(e),this.$scope.setInn(e.inn)},onKeyPress:function(t,e){13===t&&this.getSelectedItem()&&this.callEvent("onItemDblClick")},onAfterLoad:function(){}}}]}]},{padding:5,localId:"_bottom",cols:[{width:10},{view:"button",type:"htmlbutton",localId:"_export",hidden:!0,tooltip:"Экспорт организаций  для пользователя из старой базы или из настроек другого пользователя",label:"<span style='line-height: 18px; font-size: smaller'>Экспорт</span>",width:120,height:36,on:{onItemClick:function(e){t.app.config.sklad?t.popexport.isVisible()?t.popexport.hide():t.popexport.show($$(e),t):t.popexport.show_w("old",t)}}},{},{view:"button",type:"htmlbutton",localId:"_save",tooltip:"Сохранить",label:"<span style='line-height: 18px; font-size: smaller'>OK</span>",width:80,height:36,click:function(){t.hide_w()}},{width:10}]}]}]};return{view:"cWindow",localId:"_window",width:.4*document.documentElement.clientWidth,height:.8*document.documentElement.clientHeight,modal:!0,body:r,on:{onHide:function(){t.$$("_users").setValue(""),t.$$("_users").getList().clearAll(),t.$$("_lTable").clearAll(),t.$$("_local_search").setValue(),$$("_main_layout").$scope.ready()}}}},e.prototype.setInn=function(t){var e=this.$$("_users").getValue(),n=this.app.config.r_url+"?setUserInn",o={user:this.app.config.user,set_user:e,inn:t,sklad:this.app.config.sklad};Object(i.request)(n,o).then(function(t){})},e.prototype.unsetInn=function(t){var e=this.$$("_users").getValue(),n=this.app.config.r_url+"?unsetUserInn",o={user:this.app.config.user,set_user:e,inn:t,sklad:this.app.config.sklad};Object(i.request)(n,o).then(function(t){})},e.prototype.ready=function(){},e.prototype.show_w=function(){var t=this,e=this.app;this.getRoot().getHead().getChildViews()[0].setValue("Настройка пользователя"),this.getRoot().show();var n=e.config.r_url+"?getUsers",o={user:e.config.user,sklad:e.config.sklad};Object(i.request)(n,o).then(function(e){(e=Object(i.checkVal)(e,"a"))?t.$$("_users").getList().parse(e):webix.message("error")})},e.prototype.hide_w=function(){this.getRoot().hide()},e.prototype.init=function(){this.app.config.sklad?this.popexport=this.ui(r.default):this.popexport=this.ui(a.default)},e}(o.c);e.default=s},function(t,e,n){"use strict";n.r(e);var o=n(1),i=n(2);var r=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.config=function(){this.app;return{view:"popup",head:"sub-menu",loclalId:"_pop",width:160,padding:10,border:!1,css:{background:"transparent !important","box-shadow":"None"},relative:!0,body:{rows:[{view:"button",type:"htmlbutton",tooltip:"Экспорт настроек старых пользователей",label:"<span class='export-icon', style='line-height: 18px; font-size: smaller'>Из старых </span>",height:36,on:{onItemClick:function(){this.$scope.hide(),this.$scope.export.show_w("old",this.$scope.users_view)}}},{height:8},{view:"button",type:"htmlbutton",tooltip:"Экспорт настроек новых пользователей",label:"<span class='export-icon', style='line-height: 18px; font-size: smaller'>Из новых</span>",height:36,on:{onItemClick:function(){this.$scope.hide(),this.$scope.export.show_w("new",this.$scope.users_view)}}}]}}},e.prototype.isVisible=function(){return this.getRoot().isVisible()},e.prototype.show=function(t,e){return this.users_view=e,this.target=t,this.getRoot().show(this.target.$view)},e.prototype.hide=function(){return this.getRoot().hide()},e.prototype.init=function(){this.export=this.ui(i.default)},e.prototype.ready=function(){},e}(o.c);e.default=r},function(t,e,n){"use strict";n.r(e);var o=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.config=function(){var t=this,e=this.app;return{view:"cWindow",modal:!0,on:{onHide:function(){t.$$("_tb").clear(),t.$$("_tb").reconstruct()}},body:{view:"toolbar",localId:"_tb",searchBar:void 0,rows:[{height:.6*document.documentElement.clientHeight,localId:"_layout",view:"form",cols:[]},{width:.7*document.documentElement.clientWidth,cols:[{},{view:"button",type:"htmlbutton",localId:"_save",tooltip:"Сохранить",label:"<span style='line-height: 18px; font-size: smaller'>ОК</span>",width:80,height:36,on:{onItemClick:function(){var n=void 0;if(t.$$("_layout").getChildViews().forEach(function(t){n=n||t.getValue()}),n){var o=e.config.r_url+"?makeReport",i={user:e.config.user,inn:n};webix.html.addCss(t.parent.$view,"anibut"),t.parent.blockEvent(),webix.ajax().timeout(6e5).headers({"Content-type":"application/json"}).response("blob").post(o,i,function(e,n,o){var i=o.getResponseHeader("content-disposition").split("filename=")[1].replace(/^\s+|\s+$/g,"");webix.html.download(n,i),t.parent.unblockEvent(),webix.html.removeCss(t.parent.$view,"anibut")}),t.hide()}}}},{width:10}]}]}}},e.prototype.show=function(t,e){this.getRoot().getHead().getChildViews()[0].setValue("Отчет по связкам. Выберите организации для отчета"),this.getRoot().show();for(var n=Math.floor(this.$$("_layout").config.height/35),o=Math.ceil(e.length/n),i=0;i<o;i++){for(var r=[],a=1;a<=n;a++){var s;if(!(s=e.shift()))break;var c={id:s.inn,value:s.c_v};r.push(c)}var l={view:"radio",labelAlign:"right",vertical:!0,align:"left",width:this.$$("_layout").config.width/o,borderless:1,options:r,on:{onItemClick:function(){var t=this.config.id;this.getParentView().getChildViews().forEach(function(e){e.config.id!=t&&e.setValue()})}}};this.$$("_layout").addView(l)}this.parent=t,this.inns=e},e.prototype.hide=function(){this.getRoot().hide()},e.prototype.init=function(){},e}(n(1).c);e.default=o},function(t,e,n){"use strict";n.r(e);var o=n(1),i=n(0),r=n(13),a=n(17),s=n(19),c=n(3);var l=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.config=function(){return{view:"layout",id:"_main_layout",rows:[{css:{border:"1px solid #dadee0"},cols:[{view:"label",label:"<span style='padding-left: 10px'>Работаем с организациями:</span>",width:220,on:{onItemClick:function(){this.$scope.popinn.show_w(this.$scope.$$("_iList"),this.$scope.spr_table)}}},{view:"label",localId:"_iList",label:"",on:{onItemClick:function(){this.$scope.popinn.show_w(this,this.$scope.spr_table)}}}]},{cols:[{$subview:r.default},{view:"resizer",width:4},{$subview:a.default},{view:"resizer",width:4},{$subview:s.default}]}]}},e.prototype.ready=function(){var t=this;this.w=[],this.u=[];var e=this.app.config.r_url+"?getInn",n={user:this.app.config.user,sklad:this.app.config.sklad};this.spr_table=this.getRoot().getChildViews()[1].getChildViews()[0].getChildViews()[0].$scope.$$("__table"),this.inactive_table=this.getRoot().getChildViews()[1].getChildViews()[2].getChildViews()[0].$scope.$$("__table"),this.active_table=this.getRoot().getChildViews()[1].getChildViews()[4].getChildViews()[0].$scope.$$("__table"),Object(i.request)(e,n).then(function(e){if(e=Object(i.checkVal)(e,"a")){var n=[];e.forEach(function(e){1==+e.w?(t.w.push(e),n.push(e.c_v)):t.u.push(e)}),Object(i.insert_inns)(t.$$("_iList"),n)}})},e.prototype.init=function(){this.popinn=this.ui(c.default)},e}(o.c);e.default=l},function(t,e,n){"use strict";n.r(e);var o=n(1),i=n(14),r=n(0),a=n(15),s=n(16);var c=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.config=function(){var t=this,e=this.app;return{view:"layout",gravity:3,css:"spr_header",rows:[{view:"label",label:"Эталоны",align:"center",css:{"border-left":"1px solid #dadee0 !important","border-right":"1px solid #dadee0 !important"}},{view:"toolbar",height:40,cols:[{view:"text",label:"",labelWidth:1,placeholder:"Поиск по названию",_keytimed:void 0,localId:"_spr_search",on:{onKeyPress:function(t,e){var n=this;clearTimeout(this.config._keytimed),Object(r.checkKey)(t)&&(this.config._keytimed=setTimeout(function(){var t=n.$scope.getRoot().getChildViews(),e=t[2];if(e){var o=Object(r.getDtParams)(e);Object(r.get_data_test)({view:e,navBar:t[3],start:1,searchBar:e.config.searchBar,method:e.config.searchMethod,field:o[2],direction:o[3],filter:o[0],count:o[1]})}},this.$scope.app.config.searchDelay))}}},{view:"button",width:38,tooltip:"Сбросить фильтры",type:"imageButton",image:"./library/img/unfilter.svg",localId:"_unfilt",label:"",click:function(){t.$$("_spr_search").setValue(""),t.$$("_spr_search").callEvent("onKeyPress",[13])}},{view:"button",width:38,hidden:!1,tooltip:"история поиска",type:"imageButton",image:"./library/img/history.svg",click:function(){var e=t.$$("__table").config.name,n=webix.storage.session.get(e);t.pophistory.show(n,t.$$("_spr_search"))}}]},{view:"datatable",name:"_spr",localId:"__table",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,resizeRow:!0,rowLineHeight:30,rowHeight:60,editable:!1,multiselect:!1,headermenu:{autowidth:!0},startPos:1,posPpage:e.config.posPpage,totalPos:0,fi:"c_tovar",di:"asc",old_stri:"",searchBar:"_spr_search",searchMethod:"getSprSearch",css:"spr_table",type:{itemIcon:function(){return"<div class='webix_el_button posi'><button class='webix_img_btn_abs spr_button', style='background:transparent'><div class='webix_image', style='width:30px;height:30px;background-image:url(./library/img/log.svg);'</div></button> </div>"}},onClick:{spr_button:function(t,e,n){var o=this.getItem(e);this.$scope.popsprh.show_w(o)}},columns:[{id:"id_spr",width:80,sort:"server",header:[{text:"IDSPR"}],headermenu:!0,hidden:!0},{id:"c_tovar",fillspace:1,sort:"server",header:[{text:"Название"}],template:function(t,e,n){return"<div class = 'spr_hover'>"+e.itemIcon()+("<div class='right_col'>"+("<span class='first_row'>"+n+"</span>")+"<br>"+("<span style='color: darkgrey !important'>"+t.c_zavod+","+t.c_strana+"</span>")+"</div>")+"</div>"},headermenu:!1}],on:{onresize:webix.once(function(){this.adjustRowHeight()}),"data->onParse":function(t,e){this.clearAll()},onBeforeSort:function(e,n){t.$$("__table").config.fi=e,t.$$("__table").config.di=n,t.getRoot().getChildViews()[3].$scope.$$("__page").setValue(0),t.getRoot().getChildViews()[3].$scope.$$("__page").refresh()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onItemDblClick:function(t){},onAfterLoad:function(){this.hideProgress()},onAfterUnSelect:function(){var t=this,e=!1;this.data.order.forEach(function(n){t.isSelected(n)&&(e=!0)}),e||this.$scope.parent.inactive_table.unselectAll()},onAfterSelect:function(){var t=this.getSelectedItem();if(t){var n=e.config.r_url+"?getVnd",o=this.$scope.getRoot().getParentView().getParentView().getChildViews()[0].$scope.$$("_iList").config.label;o+=this.$scope.getRoot().getParentView().getParentView().getChildViews()[0].$scope.$$("_iList").config.tooltip;var i=this.$scope.parent.active_table;o=o.split(", ");var a=[];this.$scope.parent.w.forEach(function(t){a.push(t.inn)}),i.showProgress({type:"top"}),i.clearAll();var s={user:e.config.user,id_spr:t.id_spr,customers:a};Object(r.request)(n,s).then(function(t){(t=Object(r.checkVal)(t,"a"))&&(i.parse(t.active),i.hideProgress())})}},onKeyPress:function(t,e){13===t&&this.getSelectedItem()&&this.callEvent("onItemDblClick")}}},{$subview:i.default}]}},e.prototype.ready=function(t){this.parent=t.getParentView().$scope,this.$$("__table").markSorting(this.$$("__table").config.fi,this.$$("__table").config.di),this.$$("_spr_search").callEvent("onKeyPress",[13])},e.prototype.init=function(){this.pophistory=this.ui(a.default),this.popsprh=this.ui(s.default)},e}(o.c);e.default=c},function(t,e,n){"use strict";n.r(e);var o=n(1),i=n(0);var r=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.config=function(){var t=this;return{view:"toolbar",cols:[{view:"button",height:36,width:36,type:"imageButton",image:"./library/img/double-left-arrows.svg",click:function(){t.$$("__page").setValue("1"),t.$$("__page").refresh()}},{view:"button",width:36,type:"imageButton",image:"./library/img/left-arrow.svg",click:function(){var e=+t.$$("__page").getValue()-1;e>0&&(t.$$("__page").setValue(e),t.$$("__page").refresh())}},{width:7},{width:200,type:"wide",css:"pager-text",cols:[{view:"text",label:"<span style='font-size: smaller'>Страница</span>",css:"custom-input",localId:"__page",labelWidth:65,width:120,value:"1",manual:!0,on:{onChange:function(e,n){if(t.$$("__page").config.manual){var o=void 0;o=1==+n&&0==+e?1:t.$$("__page").getValue();var r=t.parent.config.posPpage,a=Math.ceil(t.parent.config.totalPos/r);try{o=+o}catch(t){}if("number"==typeof o&&o>=0&&(a=o<=(0===a)?1:a)){var s=(o-1)*r+1,c=t.parent;if(c){var l=Object(i.getDtParams)(c);Object(i.get_data_test)({view:t.parent,navBar:t.getRoot(),start:s,count:l[1],searchBar:t.parent.config.searchBar,method:t.parent.config.searchMethod,field:l[2],direction:l[3],filter:l[0]})}}}else t.$$("__page").config.manual=!0}}},{view:"label",label:"<span style='font-size: smaller'>из</span>",width:30,css:{"margin-left":"0px !important"}},{view:"label",label:"1",width:45,align:"center",css:{"margin-left":"0px !important","margin-top":"-2px !important","line-height":"38px !important"}}]},{view:"button",width:36,type:"imageButton",image:"./library/img/right-arrow.svg",click:function(){var e=+t.$$("__page").getValue()+1;e<=Math.ceil(t.parent.config.totalPos/t.parent.config.posPpage)&&(t.$$("__page").setValue(e),t.$$("__page").refresh())}},{view:"button",width:36,type:"imageButton",image:"./library/img/double-right-arrows.svg",click:function(){var e=Math.ceil(t.parent.config.totalPos/t.parent.config.posPpage);t.$$("__page").setValue(e),t.$$("__page").refresh()}},{},{view:"label",label:"<span style='font-size: smaller'>Всего записей: 0</span>",width:170,css:{"margin-left":"0px !important","margin-right":"3px !important"},align:"right"}]}},e.prototype.ready=function(t){},e.prototype.init=function(t){this.parent=t.getParentView().$scope.$$("__table")},e}(o.c);e.default=r},function(t,e,n){"use strict";n.r(e);var o=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.config=function(){var t=this;return{view:"cWindow",modal:!0,height:.8*document.documentElement.clientHeight,on:{onHide:function(){t.$$("_tb").clear(),t.$$("_hist").clearAll(),t.$$("_tb").reconstruct()}},body:{view:"toolbar",localId:"_tb",searchBar:void 0,cols:[{view:"list",localId:"_hist",width:.5*document.documentElement.clientWidth,select:!0,resizeColumn:!0,navigation:"row",editable:!1,on:{onItemDblClick:function(e){var n=t.$$("_tb").config.searchBar;e=t.$$("_hist").getItem(e).value,n.setValue(e),n.refresh(),t.getRoot().hide(),n.callEvent("onKeyPress",[13])}}},{}]}}},e.prototype.show=function(t,e){this.getRoot().getHead().getChildViews()[0].setValue("История поиска"),this.getRoot().show(),this.$$("_tb").config.searchBar=e,t&&this.$$("_hist").parse(t)},e.prototype.init=function(){},e}(n(1).c);e.default=o},function(t,e,n){"use strict";n.r(e);var o=n(1),i=n(0);var r=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.config=function(){var t=this,e=(this.app,{view:"datatable",name:"_sprhistory",localId:"__table",select:!1,resizeColumn:!0,fixedRowHeight:!1,resizeRow:!0,rowLineHeight:30,rowHeight:60,editable:!1,multiselect:!1,tooltip:!0,headermenu:{autowidth:!0},columns:[{id:"user",width:130,sort:"text",header:[{text:"Пользователь"}],tooltip:!1,headermenu:!0,hidden:!1},{id:"c_vnd",width:200,sort:"text",header:[{text:"Постащик"}],tooltip:!1,headermenu:!0,hidden:!1},{id:"c_inns",sort:"text",fillspace:1,header:[{text:"Организации"}],tooltip:!1,headermenu:!0,hidden:!1},{id:"dt",width:200,sort:"text",header:[{text:"Время изменения"}],tooltip:!1,headermenu:!1},{id:"action",width:120,header:[{text:"Действие"}],headermenu:!1,tooltip:function(t,e,n){return 1===t.remove?"Удаление":"Изменение"},template:function(t,e,n){return 1===t.remove?"<span class='custom_image', style='background-image:url(./library/img/remove.svg);'</span>":"<span class='custom_image', style='background-image:url(./library/img/change.svg);'</span>"}},{id:"expire",width:200,header:[{text:"Дата окончания"}],headermenu:!0,tooltip:!1,template:function(t,e,n){return 1===t.remove?"<span>--</span>":""!==t.expires?t.expires:"<span>Не установленно</span>"}},{id:"hard",width:120,header:[{text:"Связка"}],headermenu:!0,tooltip:function(t,e,n){return 1===t.remove?"":""!==t.hard?"Жесткая":"Обычная"},template:function(t,e,n){return 1===t.remove?"<span>--</span>":""!==t.hard?"<span class='custom_image', style='background-image:url(./library/img/hard-link.svg);'</span>":"<span class='custom_image', style='background-image:url(./library/img/soft-link.svg);'</span>"}}],on:{onresize:webix.once(function(){this.adjustRowHeight()}),"data->onParse":function(t,e){this.clearAll()}}});return{view:"cWindow",modal:!0,height:.8*document.documentElement.clientHeight,width:.8*document.documentElement.clientWidth,on:{onHide:function(){t.clearWindow()}},body:{rows:[{view:"label",value:"",height:30,localId:"_name",css:{"padding-left":"10px"}},e]}}},e.prototype.show_w=function(t){var e=this,n=this.app;this.item=t,this.getRoot().getHead().getChildViews()[0].setValue("Действия по товару"),this.$$("_name").setValue(t.id_spr+", "+t.c_tovar),this.getRoot().show();var o=n.config.r_url+"?getHistory",r={user:n.config.user,id_spr:t.id_spr};Object(i.request)(o,r).then(function(t){t=Object(i.checkVal)(t,"a"),e.$$("__table").parse(t)})},e.prototype.clearWindow=function(){this.$$("__table").clearAll(),this.$$("_name").setValue("")},e.prototype.ready=function(){},e.prototype.init=function(){},e}(o.c);e.default=r},function(t,e,n){"use strict";n.r(e);var o=n(1),i=n(0),r=n(18);var a=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.config=function(){var t=this,e=this.app,n=this,o=function(t){t.length||(t=[t]);var o,r=[];n.parent.w.forEach(function(e){var i=e.inn;t.forEach(function(t){(o={}).vnd=t.c_vnd,o.dt="",o.hard=0,o.id_spr=n.parent.spr_table.getSelectedItem().id_spr,o.inn=i,r.push(o)})});var a=e.config.r_url+"?setVnd",s={user:e.config.user,datas:r,remove:!1};n.parent.active_table.showProgress({type:"top"}),Object(i.request)(a,s).then(function(t){return(t=Object(i.checkVal)(t,"a"))&&n.parent.spr_table.callEvent("onAfterSelect"),n.parent.active_table.hideProgress(),!!t})};return{view:"layout",gravity:3,css:"permited_header",rows:[{cols:[{view:"label",width:40,align:"center",css:{"border-left":"1px solid #dadee0 !important","border-right":"1px solid #dadee0 !important"},label:"<span class='custom_image', style='background-image:url(./library/img/options_supplies_white.svg); width: 30px; height: 30px;'></span>",on:{onItemClick:function(){t.popvnd.show_w(t.getParentView())}}},{view:"label",label:"<div style='text-align: center; color: white'>Неактивные</div>",css:{"border-left":"1px solid #dadee0 !important","border-right":"1px solid #dadee0 !important"},on:{onItemClick:function(){t.popvnd.show_w(t.getParentView())}}}]},{view:"toolbar",height:40,cols:[{view:"text",label:"",labelWidth:1,placeholder:"Поиск по поставщику",_keytimed:void 0,localId:"_local_spr_search",on:{onKeyPress:function(t,e){var n=this;clearTimeout(this.config._keytimed),Object(i.checkKey)(t)&&(this.config._keytimed=setTimeout(function(){var t=n.getValue();n.$scope.$$("__table").filter(function(e){return t=(t=t.toString().toLowerCase()).replace(/ /g,".*"),-1!=e.c_vnd.toString().toLowerCase().search(t)})},this.$scope.app.config.searchDelay))}}},{view:"button",width:38,tooltip:"Сбросить фильтры",type:"imageButton",image:"./library/img/unfilter.svg",localId:"_unfilt",label:"",click:function(){t.$$("_local_spr_search").setValue(""),t.$$("_local_spr_search").callEvent("onKeyPress",[13])}},{view:"button",width:38,hidden:!0,localId:"_to_r",tooltip:"Перенести выделенные",type:"imageButton",image:"./library/img/right-arrow.svg",on:{onItemClick:function(){var e=t.$$("__table").getSelectedItem();o(e)}}},{view:"button",width:38,hidden:!1,tooltip:"Перенести все",type:"imageButton",image:"./library/img/double-right-arrows.svg",click:function(){if(!t.parent.spr_table.getSelectedItem())return webix.message({type:"error",text:"Выберите товар",expire:2e3}),!1;var e=t.$$("__table").serialize();o(e)}}]},{view:"datatable",name:"_spr",localId:"__table",navigation:"row",select:!0,multiselect:!0,resizeColumn:!0,fixedRowHeight:!1,editable:!1,headermenu:{autowidth:!0},fi:"c_vnd",di:"asc",drag:!0,columns:[{id:"id_vnd",width:80,sort:"text",header:[{text:"IDSPR"}],headermenu:!0,hidden:!0},{id:"c_vnd",fillspace:1,sort:"text",header:[{text:"Поставщик"}],headermenu:!1}],on:{"data->onParse":function(t,e){this.clearAll()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onItemDblClick:function(t){this.$scope.$$("_to_r").callEvent("onItemClick")},onBeforeDrop:function(t,e){return!1},onBeforeDrag:function(t,e){if(!n.parent.spr_table.getSelectedItem())return!1;t.html="<div style='padding:8px;'>";for(var o=0;o<t.source.length;o++)t.html+=t.from.getItem(t.source[o]).c_vnd+"<br>";return t.html+="</div>",!0},onBeforeDropOut:function(t,e){var n=[];t.source.forEach(function(e){n.push(t.from.getItem(e))});o(n);return!1},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(){if(!t.parent.spr_table.getSelectedItem())return webix.message({type:"error",text:"Выберите товар",expire:2e3}),!1},onAfterSelect:function(){this.$scope.$$("_to_r").show()},onAfterUnSelect:function(){var t=this,e=!1;this.data.order.forEach(function(n){t.isSelected(n)&&(e=!0)}),e||this.$scope.$$("_to_r").hide()},onKeyPress:function(t,e){13===t&&this.getSelectedItem()&&this.callEvent("onItemDblClick")}}}]}},e.prototype.parse=function(t){this.clear(),this.$$("__table").parse(t)},e.prototype.clear=function(){this.$$("__table").clearAll()},e.prototype.ready=function(t){var e=this;this.parent=this.getRoot().getParentView().$scope,this.$$("__table").markSorting(this.$$("__table").config.fi,this.$$("__table").config.di);var n=this.app.config.r_url+"?getVnd",o={user:this.app.config.user,all:!0};Object(i.request)(n,o,0).then(function(t){(t=Object(i.checkVal)(t,"a"))&&e.parse(t.all)})},e.prototype.init=function(t){this.popvnd=this.ui(r.default)},e}(o.c);e.default=a},function(t,e,n){"use strict";n.r(e);var o=n(1),i=n(0);var r=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.config=function(){var t=this,e=this.app,n={view:"form",localId:"prop_form",padding:0,elements:[{rows:[{height:2},{css:{"border-bottom":"solid 1px #ccd7e6 !important",background:"#f4f5f9"},cols:[{view:"text",label:"<span style='padding: 5px'>Фильтр:</span>",labelWidth:75,css:{"border-bottom":"solid 1px #ccd7e6 !important"},_keytimed:void 0,localId:"_local_search",on:{onKeyPress:function(t,e){var n=this;clearTimeout(this.config._keytimed),Object(i.checkKey)(t)&&(this.config._keytimed=setTimeout(function(){var t=n.$scope.$$("_local_search").getValue();n.$scope.$$("_rTable").filter(function(e){var n=t.toString().toLowerCase();return n=n.replace(/ /g,".*"),-1!=e.c_vnd.toString().toLowerCase().search(n)}),n.$scope.$$("_lTable").filter(function(e){var n=t.toString().toLowerCase();return n=n.replace(/ /g,".*"),-1!=e.c_vnd.toString().toLowerCase().search(n)})},this.$scope.app.config.searchDelay))}}}]},{cols:[{rows:[{cols:[{},{view:"button",width:38,hidden:!0,tooltip:"Перенести выделенные",localId:"_to_right",type:"imageButton",image:"./library/img/right-arrow.svg",click:function(){var e=t.$$("_lTable").getSelectedId();e.length||(e=[e]),e.forEach(function(e){var n=t.$$("_lTable").getItem(e);t.$$("_rTable").add(n,0),t.$$("_lTable").remove(e),t.show_b()})}},{view:"button",width:38,hidden:!1,tooltip:"Перенести все",type:"imageButton",image:"./library/img/double-right-arrows.svg",click:function(){t.$$("_lTable").data.order.forEach(function(e){var n=t.$$("_lTable").getItem(e);t.$$("_lTable").remove(e),t.$$("_rTable").add(n),t.show_b()})}}]},{view:"datatable",name:"_lTable",localId:"_lTable",select:!0,multiselect:!0,borderless:!0,fixedRowHeight:!1,headermenu:!1,resizeColumn:!0,columns:[{id:"c_vnd",fillspace:1,sort:"text",header:[{text:"Обрабатываемые поставщики"}],headermenu:!1}],on:{"data->onParse":function(t,e){this.clearAll()},onAfterSelect:function(t){this.$scope.$$("_to_right").show()},onAfterUnSelect:function(){var t=this,e=!1;this.data.order.forEach(function(n){t.isSelected(n)&&(e=!0)}),e||this.$scope.$$("_to_right").hide()},onItemDblClick:function(t){var e=this.getItem(t),n=e.id;this.remove(n),this.$scope.$$("_rTable").add(e),this.$scope.show_b()},onKeyPress:function(t,e){13===t&&this.getSelectedItem()&&this.callEvent("onItemDblClick")}}}]},{width:4},{rows:[{cols:[{view:"button",width:38,hidden:!1,tooltip:"Перенести все",type:"imageButton",image:"./library/img/double-left-arrows.svg",click:function(){t.$$("_rTable").data.order.forEach(function(e){var n=t.$$("_rTable").getItem(e);t.$$("_rTable").remove(e),t.$$("_lTable").add(n),t.show_b()})}},{view:"button",width:38,hidden:!0,localId:"_to_left",tooltip:"Перенести выделенные",type:"imageButton",image:"./library/img/left-arrow.svg",click:function(){var e=t.$$("_rTable").getSelectedId();e.length||(e=[e]),e.forEach(function(e){var n=t.$$("_rTable").getItem(e);t.$$("_lTable").add(n,0),t.$$("_rTable").remove(e),t.show_b()})}},{}]},{view:"datatable",name:"_rTable",localId:"_rTable",select:!0,multiselect:!0,borderless:!0,fixedRowHeight:!1,headermenu:!1,resizeColumn:!0,columns:[{id:"c_vnd",fillspace:1,sort:"text",header:[{text:"Не обрабатываемые поставщики"}],headermenu:!1}],on:{"data->onParse":function(t,e){this.clearAll()},onAfterSelect:function(t){this.$scope.$$("_to_left").show()},onAfterUnSelect:function(){var t=this,e=!1;this.data.order.forEach(function(n){t.isSelected(n)&&(e=!0)}),e||this.$scope.$$("_to_left").hide()},onItemDblClick:function(t){var e=this.getItem(t),n=e.id;this.remove(n),this.$scope.$$("_lTable").add(e),this.$scope.show_b()},onKeyPress:function(t,e){13===t&&this.getSelectedItem()&&this.callEvent("onItemDblClick")}}}]}]},{padding:5,localId:"_bottom",cols:[{width:10},{view:"button",type:"htmlbutton",localId:"_cancel",tooltip:"Отменить",label:"<span style='line-height: 18px; font-size: smaller'>Отменить</span>",width:120,height:36,click:function(){t.hide_w()}},{},{view:"button",type:"htmlbutton",localId:"_save",tooltip:"Сохранить",label:"<span style='line-height: 18px; font-size: smaller'>ОК</span>",width:80,height:36,click:function(){var n={m:t.$$("_rTable").serialize(),m3:t.$$("_lTable").serialize(),user:e.config.user},o=e.config.r_url+"?setMerge3";Object(i.request)(o,n).then(function(e){(e=Object(i.checkVal)(e,"a"))?(t.parent.inactive_table.$scope.ready(),t.hide_w()):webix.message("error")})}},{width:10}]}]}]};return{view:"cWindow",localId:"_window",width:.5*document.documentElement.clientWidth,height:.8*document.documentElement.clientHeight,modal:!0,body:n,on:{onHide:function(){t.$$("_local_search").setValue("")}}}},e.prototype.show_b=function(){this.$$("_save").show()},e.prototype.hide_b=function(){this.$$("_cancel").hide()},e.prototype.ready=function(){},e.prototype.show_w=function(t,e){var n=this;this.parent=t;var o=this.app;this.hide_b(),this.getRoot().getHead().getChildViews()[0].setValue("Выбор поставщиков");var r=o.config.r_url+"?getMerge3",a={user:o.config.user};Object(i.request)(r,a).then(function(t){(t=Object(i.checkVal)(t,"a"))?(n.$$("_lTable").parse(t.m3),n.$$("_rTable").parse(t.m)):webix.message("error")}),this.getRoot().show(),this.$$("_local_search").focus()},e.prototype.hide_w=function(){this.getRoot().hide()},e.prototype.init=function(){},e}(o.c);e.default=r},function(t,e,n){"use strict";n.r(e);var o=n(1),i=n(20),r=n(0);var a=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.config=function(){var t,e=this,n=this.app,o=this,i=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=[],s=t.data;e.length||(e=[e]),e.forEach(function(t){t.$group?s.each(function(e){e.$parent===t.id&&a.push(e.id)}):a.push(t.id)});var c=[];(a=Object(r.unique_arr)(a)).forEach(function(e){var n=t.getItem(e);c.push({vnd:n.c_vnd,dt:n.dt,hard:n.hard,id_spr:o.parent.spr_table.getSelectedItem().id_spr,inn:n.inn})});var l=n.config.r_url+"?setVnd",u={user:n.config.user,datas:c,remove:!0};o.parent.active_table.showProgress({type:"top"}),Object(r.request)(l,u).then(function(e){(e=Object(r.checkVal)(e,"a"))&&console.log("res_data",e),o.parent.active_table.hideProgress(),e&&(i?t.clearAll():(a.length>0&&t.remove(a),(s=t.data).each(function(e){e.$group&&0===e.$count&&t.remove(e.id)})))})},a=function(t,e){var n=t.data;if(e){var o=!0,i=e.dt;i=i.getDate?i.getFullYear()+"-"+(i.getMonth()+1)+"-"+i.getDate():i.split(" ")[0],n.each(function(t){if(t.$parent===e.$parent){var n=t.dt;n=n.getDate?n.getFullYear()+"-"+(n.getMonth()+1)+"-"+n.getDate():n.split(" ")[0],i!=n&&(o=!1)}}),t.getItem(e.$parent).dt=o?i:void 0}else{var r=[];n.each(function(t){t.$group&&r.push(t)});var a=new Set;r.forEach(function(e){a.clear();var o=void 0;n.each(function(t){t.$group||t.$parent!==e.id||(o=t.dt)&&(o=o.getDate?o.getFullYear()+"-"+(o.getMonth()+1)+"-"+o.getDate():o.split(" ")[0],a.add(o))}),1===a.size?t.getItem(e.id).dt=a.values().next().value:t.getItem(e.id).dt=void 0,t.refresh()})}};return{view:"layout",gravity:4,css:"restricted_header",rows:[{view:"label",label:"<span style='color: white'>Активные</span>",align:"center"},{view:"toolbar",height:40,cols:[{view:"button",width:38,hidden:!1,tooltip:"Перенести все",type:"imageButton",image:"./library/img/double-left-arrows.svg",click:function(){var t=e.$$("__table");if(t.count()<1)return!1;i(t,t.serialize(),!0)}},{view:"button",width:38,hidden:!0,localId:"_remove_sel",tooltip:"Перенести выделенные",type:"imageButton",image:"./library/img/left-arrow.svg",click:function(){i(e.$$("__table"),e.$$("__table").getSelectedItem())}},{},{view:"button",width:38,hidden:!1,groupBy:"c_vnd",localId:"_gr",tooltip:"Группировать...",type:"imageButton",image:"./library/img/list.svg",click:function(t){var n=e.getParentView();e.popgr.isVisible()?e.popgr.hide():e.popgr.show($$(t),e.$$("__table"),n)}}]},((t={view:"treetable",name:"_active",localId:"__table",navigation:"row",select:!0,multiselect:!0,resizeColumn:!0,fixedRowHeight:!1,editable:!1,headermenu:{autowidth:!0},drag:!0}).editable=!0,t.fi="c_vnd",t.di="asc",t.old_stri="",t.threeState=!0,t.columns=[{id:"inn",sort:"text",fillspace:1,template:function(t,e){return t.$group?e.icon(t,e)+t.inn:e.space(t)+e.space(t)+t.c_inn},header:[{text:"Организация"}],headermenu:!1},{id:"c_vnd",width:160,sort:"text",header:[{text:"Поставщик"}],headermenu:!1},{id:"hard",width:80,template:"{common.treecheckbox()}",header:"Жестко"},{id:"dt",editor:"date",suggest:{type:"calendar",body:{multiselect:!1,timepicker:!1,weekNumber:!1,icons:!0}},width:160,sort:"text",format:r.dt_format,header:[{text:"Дата окончания"}],headermenu:!1}],t.on={"data->onParse":function(t,e){this.ungroup()},onBeforeDrop:function(t,e){return!1},onBeforeDrag:function(t,e){if(!o.parent.spr_table.getSelectedItem())return!1;t.html="<div style='padding:8px;'>";for(var n=0;n<t.source.length;n++)t.html+=t.from.getItem(t.source[n]).inn+"<br>";return t.html+="</div>",!0},onBeforeDropOut:function(t,e){var n=[];return t.source.forEach(function(e){n.push(t.from.getItem(e))}),i(this,n),!1},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onItemDblClick:function(t){},onAfterLoad:function(){var t=this;this.hideProgress(),setTimeout(function(){t.blockEvent(),t.group({by:t.$scope.$$("_gr").config.groupBy,map:{inn:[t.$scope.$$("_gr").config.groupBy]}}),t.data.each(function(e){1===e.hard&&1!=e.$level&&t.checkItem(e.id)}),a(t),t.unblockEvent()},0)},onAfterEditStop:function(t,e){var o=this;if("dt"===e.column){var i=e.row,s=this.getItem(i),c=t.value;c=c.getDate?c.getFullYear()+"-"+(c.getMonth()+1)+"-"+c.getDate():c.split(" ")[0],s.$group||a(this,s);var l=[],u=this.$scope.parent.spr_table.getSelectedItem().id_spr;s.$group?this.data.each(function(t){t.$parent===i&&(t.dt=s.dt,l.push({inn:t.inn,vnd:t.c_vnd,id_spr:u,hard:t.hard,dt:c}))}):l.push({inn:s.inn,vnd:s.c_vnd,id_spr:u,hard:s.hard,dt:c});var p=n.config.r_url+"?setVnd",h={user:n.config.user,datas:l,remove:!1};this.showProgress({type:"top"}),Object(r.request)(p,h).then(function(t){(t=Object(r.checkVal)(t,"a"))&&console.log("res_data",t),o.hideProgress()})}},onItemCheck:function(t,e){var o=this,i=this.getItem(t),a=[],s=this.$scope.parent.spr_table.getSelectedItem().id_spr;i.$group?this.data.each(function(n){n.$parent===t&&a.push({inn:n.inn,vnd:n.c_vnd,id_spr:s,hard:e,dt:n.dt})}):a.push({inn:i.inn,vnd:i.c_vnd,id_spr:s,hard:e});var c=n.config.r_url+"?setVnd",l={user:n.config.user,datas:a,remove:!1};this.showProgress({type:"top"}),Object(r.request)(c,l).then(function(t){(t=Object(r.checkVal)(t,"a"))&&console.log("res_data",t),o.hideProgress()})},onAfterUnSelect:function(){var t=this,e=!1;this.data.order.forEach(function(n){t.isSelected(n)&&(e=!0)}),e||this.$scope.$$("_remove_sel").hide()},onAfterSelect:function(t){this.getItem(t.id);this.$scope.$$("_remove_sel").show()},onKeyPress:function(t,e){13===t&&this.getSelectedItem()&&this.callEvent("onItemDblClick")}},t)]}},e.prototype.parse=function(t){this.clear(),this.$$("__table").parse(t)},e.prototype.clear=function(){this.$$("__table").clearAll()},e.prototype.ready=function(t){this.parent=t.getParentView().$scope,this.$$("__table").markSorting(this.$$("__table").config.fi,this.$$("__table").config.di)},e.prototype.init=function(){this.popgr=this.ui(i.default)},e}(o.c);e.default=a},function(t,e,n){"use strict";n.r(e);var o=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.config=function(){return{view:"popup",head:"sub-menu",loclalId:"_pop",width:160,padding:10,css:"pop-up-menu",body:{rows:[{view:"button",value:"по постащикам",css:"group-button",on:{onItemClick:function(){this.$scope.hide(),this.$scope.target.config.groupBy="c_vnd",this.$scope.main_tab.spr_table.callEvent("onAfterSelect")}}},{height:8},{view:"button",value:"по организациям",css:"group-button",on:{onItemClick:function(){this.$scope.hide(),this.$scope.target.config.groupBy="c_inn",this.$scope.main_tab.spr_table.callEvent("onAfterSelect")}}}]}}},e.prototype.isVisible=function(){return this.getRoot().isVisible()},e.prototype.show=function(t,e,n){return this.table=e,this.target=t,this.main_tab=n,this.getRoot().show(this.target.$view)},e.prototype.hide=function(){return this.getRoot().hide()},e}(n(1).c);e.default=o},function(t,e,n){"use strict";n.r(e);var o=n(1),i=n(0);var r=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.config=function(){var t=this.app,e=this;return{view:"toolbar",css:"realy-header",cols:[{view:"label",label:"<a href='http://ms71.org'><span class='ms-logo', style='margin-left: -5px !important; background-image: url(library/img/logo.png);'></span></a>",width:44,align:"center",height:36},{view:"label",label:"МАНУСКРИПТ-СОЛЮШН: Связки поставщиков | "+this.app.config.user,css:"ms-logo-text",height:36,width:550},{},{view:"button",type:"htmlbutton",tooltip:"Выход",label:"<span class='side-icon webix_icon fas fa-sign-out-alt'></span><span class='side-icon', style='line-height: 18px; padding-left: 5px; font-size: smaller'>Выйти</span>",width:106,on:{onItemClick:function(){Object(i.deleteCookie)("merge3-app"),e.app.config.user="",e.app.config.x_api="x_login",t.config.testmode?location.href="localhost"===location.hostname?"http://localhost:8080":"/merge3/":location.href="https://sklad71.org/logout"}}}]}},e.prototype.ready=function(){},e}(o.c);e.default=r},function(t,e,n){var o;"function"==typeof Symbol&&Symbol.iterator;!function(i){"use strict";function r(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}function a(t,e,n,o,i,a){return r(function(t,e){return t<<e|t>>>32-e}(r(r(e,t),r(o,a)),i),n)}function s(t,e,n,o,i,r,s){return a(e&n|~e&o,t,e,i,r,s)}function c(t,e,n,o,i,r,s){return a(e&o|n&~o,t,e,i,r,s)}function l(t,e,n,o,i,r,s){return a(e^n^o,t,e,i,r,s)}function u(t,e,n,o,i,r,s){return a(n^(e|~o),t,e,i,r,s)}function p(t,e){var n,o,i,a,p;t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;var h=1732584193,f=-271733879,d=-1732584194,g=271733878;for(n=0;n<t.length;n+=16)o=h,i=f,a=d,p=g,f=u(f=u(f=u(f=u(f=l(f=l(f=l(f=l(f=c(f=c(f=c(f=c(f=s(f=s(f=s(f=s(f,d=s(d,g=s(g,h=s(h,f,d,g,t[n],7,-680876936),f,d,t[n+1],12,-389564586),h,f,t[n+2],17,606105819),g,h,t[n+3],22,-1044525330),d=s(d,g=s(g,h=s(h,f,d,g,t[n+4],7,-176418897),f,d,t[n+5],12,1200080426),h,f,t[n+6],17,-1473231341),g,h,t[n+7],22,-45705983),d=s(d,g=s(g,h=s(h,f,d,g,t[n+8],7,1770035416),f,d,t[n+9],12,-1958414417),h,f,t[n+10],17,-42063),g,h,t[n+11],22,-1990404162),d=s(d,g=s(g,h=s(h,f,d,g,t[n+12],7,1804603682),f,d,t[n+13],12,-40341101),h,f,t[n+14],17,-1502002290),g,h,t[n+15],22,1236535329),d=c(d,g=c(g,h=c(h,f,d,g,t[n+1],5,-165796510),f,d,t[n+6],9,-1069501632),h,f,t[n+11],14,643717713),g,h,t[n],20,-373897302),d=c(d,g=c(g,h=c(h,f,d,g,t[n+5],5,-701558691),f,d,t[n+10],9,38016083),h,f,t[n+15],14,-660478335),g,h,t[n+4],20,-405537848),d=c(d,g=c(g,h=c(h,f,d,g,t[n+9],5,568446438),f,d,t[n+14],9,-1019803690),h,f,t[n+3],14,-187363961),g,h,t[n+8],20,1163531501),d=c(d,g=c(g,h=c(h,f,d,g,t[n+13],5,-1444681467),f,d,t[n+2],9,-51403784),h,f,t[n+7],14,1735328473),g,h,t[n+12],20,-1926607734),d=l(d,g=l(g,h=l(h,f,d,g,t[n+5],4,-378558),f,d,t[n+8],11,-2022574463),h,f,t[n+11],16,1839030562),g,h,t[n+14],23,-35309556),d=l(d,g=l(g,h=l(h,f,d,g,t[n+1],4,-1530992060),f,d,t[n+4],11,1272893353),h,f,t[n+7],16,-155497632),g,h,t[n+10],23,-1094730640),d=l(d,g=l(g,h=l(h,f,d,g,t[n+13],4,681279174),f,d,t[n],11,-358537222),h,f,t[n+3],16,-722521979),g,h,t[n+6],23,76029189),d=l(d,g=l(g,h=l(h,f,d,g,t[n+9],4,-640364487),f,d,t[n+12],11,-421815835),h,f,t[n+15],16,530742520),g,h,t[n+2],23,-995338651),d=u(d,g=u(g,h=u(h,f,d,g,t[n],6,-198630844),f,d,t[n+7],10,1126891415),h,f,t[n+14],15,-1416354905),g,h,t[n+5],21,-57434055),d=u(d,g=u(g,h=u(h,f,d,g,t[n+12],6,1700485571),f,d,t[n+3],10,-1894986606),h,f,t[n+10],15,-1051523),g,h,t[n+1],21,-2054922799),d=u(d,g=u(g,h=u(h,f,d,g,t[n+8],6,1873313359),f,d,t[n+15],10,-30611744),h,f,t[n+6],15,-1560198380),g,h,t[n+13],21,1309151649),d=u(d,g=u(g,h=u(h,f,d,g,t[n+4],6,-145523070),f,d,t[n+11],10,-1120210379),h,f,t[n+2],15,718787259),g,h,t[n+9],21,-343485551),h=r(h,o),f=r(f,i),d=r(d,a),g=r(g,p);return[h,f,d,g]}function h(t){var e,n="",o=32*t.length;for(e=0;e<o;e+=8)n+=String.fromCharCode(t[e>>5]>>>e%32&255);return n}function f(t){var e,n=[];for(n[(t.length>>2)-1]=void 0,e=0;e<n.length;e+=1)n[e]=0;var o=8*t.length;for(e=0;e<o;e+=8)n[e>>5]|=(255&t.charCodeAt(e/8))<<e%32;return n}function d(t){var e,n,o="";for(n=0;n<t.length;n+=1)e=t.charCodeAt(n),o+="0123456789abcdef".charAt(e>>>4&15)+"0123456789abcdef".charAt(15&e);return o}function g(t){return unescape(encodeURIComponent(t))}function b(t){return function(t){return h(p(f(t),8*t.length))}(g(t))}function _(t,e){return function(t,e){var n,o,i=f(t),r=[],a=[];for(r[15]=a[15]=void 0,i.length>16&&(i=p(i,8*t.length)),n=0;n<16;n+=1)r[n]=909522486^i[n],a[n]=1549556828^i[n];return o=p(r.concat(f(e)),512+8*e.length),h(p(a.concat(o),640))}(g(t),g(e))}function w(t,e,n){return e?n?_(e,t):function(t,e){return d(_(t,e))}(e,t):n?b(t):function(t){return d(b(t))}(t)}void 0===(o=function(){return w}.call(e,n,e,t))||(t.exports=o)}()},function(t,e){webix.i18n.locales["ru-RU"]={groupDelimiter:" ",groupSize:3,decimalDelimiter:",",decimalSize:2,dateFormat:"%d.%m.%Y",timeFormat:"%H:%i",longDateFormat:"%d %F %Y",fullDateFormat:"%d.%m.%Y %H:%i",price:"{obj} руб.",priceSettings:null,calendar:{monthFull:["Январь","Февраль","Март","Апрель","Maй","Июнь","Июль","Август","Сентябрь","Oктябрь","Ноябрь","Декабрь"],monthShort:["Янв","Фев","Maр","Aпр","Maй","Июн","Июл","Aвг","Сен","Окт","Ноя","Дек"],dayFull:["Воскресенье","Понедельник","Вторник","Среда","Четверг","Пятница","Суббота"],dayShort:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],hours:"Часы",minutes:"Минуты",done:"Гoтовo",clear:"Очистить",today:"Сегодня"},controls:{select:"Выбрать",invalidMessage:"Неправильное значение"},dataExport:{page:"Страница",of:"из"},PDFviewer:{of:"из",automaticZoom:"Автоматический зум",actualSize:"Настоящий размер",pageFit:"Размер страницы",pageWidth:"Ширина страницы",pageHeight:"Высота страницы"},aria:{calendar:"Календарь",increaseValue:"Увеличить значение",decreaseValue:"Уменьшить значение",navMonth:["Предыдущий месяц","Следующий месяц"],navYear:["Предыдущий год","Следующий год"],navDecade:["Предыдущие десять лет","Следующие десять лет"],dateFormat:"%d %F %Y",monthFormat:"%F %Y",yearFormat:"%Y",hourFormat:"Часы: %H",minuteFormat:"Минуты: %i",removeItem:"Удалить элемент",pages:["Первая страница","Предыдущая страница","Следующая страница","Последняя страница"],page:"Страница",headermenu:"Меню шапки таблицы",openGroup:"Развернуть группу столбцов",closeGroup:"Свернуть группу столбцов",closeTab:"Закрыть вкладку",showTabs:"Показать больше вкладок",resetTreeMap:"Вернуться к первоначальному представлению",navTreeMap:"Перейти на уровень выше",nextTab:"Следующая вкладка",prevTab:"Предыдущая вкладка",multitextSection:"Добавить элемент",multitextextraSection:"Удалить элемент",showChart:"Показать чарт",hideChart:"Спрятать чарт",resizeChart:"Изменить размер чарта"},richtext:{underline:"Подчеркивание",bold:"Жирный",italic:"Курсив"}}},function(t,e,n){var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};
/*!
 * webix-routie - router for Webix-Jet
 * v0.4.0
 * MIT License
 *
 * based on routie - a tiny hash router
 * http://projects.jga.me/routie
 * copyright Greg Allen 2016
 * MIT License
*/t.exports=function(t,e){var n,i=[],r={},a=t.routie,s=function(t,e){this.name=e,this.path=t,this.keys=[],this.fns=[],this.params={},this.regex=c(this.path,this.keys,!1,!1)};s.prototype.addHandler=function(t){this.fns.push(t)},s.prototype.removeHandler=function(t){for(var e=0,n=this.fns.length;e<n;e++)if(t==this.fns[e])return void this.fns.splice(e,1)},s.prototype.run=function(t){for(var e=0,n=this.fns.length;e<n;e++)if(!1===this.fns[e].apply(this,t))return!1;return!0},s.prototype.match=function(t,e){var n=this.regex.exec(t);if(!n)return!1;for(var o=1,i=n.length;o<i;++o){var r=this.keys[o-1],a="string"==typeof n[o]?decodeURIComponent(n[o]):n[o];r&&(this.params[r.name]=a),e.push(a)}return!0},s.prototype.toURL=function(t){var e=this.path;for(var n in t)e=e.replace("/:"+n,"/"+t[n]);if(-1!=(e=e.replace(/\/:.*\?/g,"/").replace(/\?/g,"")).indexOf(":"))throw new Error("missing parameters for url: "+e);return e};var c=function(t,e,n,o){return t instanceof RegExp?t:(t instanceof Array&&(t="("+t.join("|")+")"),t=t.concat(o?"":"/?").replace(/\/\(/g,"(?:/").replace(/\+/g,"__plus__").replace(/(\/)?(\.)?:(\w+)(?:(\(.*?\)))?(\?)?/g,function(t,n,o,i,r,a){return e.push({name:i,optional:!!a}),n=n||"",(a?"":n)+"(?:"+(a?n:"")+(o||"")+(r||o&&"([^/.]+?)"||"([^/]+?)")+")"+(a||"")}).replace(/([/.])/g,"\\$1").replace(/__plus__/g,"(.+)").replace(/\*/g,"(.*)"),new RegExp("^"+t+"$",n?"":"i"))},l=function(t,e){var n=t.split(" "),o=2==n.length?n[0]:null;t=2==n.length?n[1]:n[0],r[t]||(r[t]=new s(t,o),i.push(r[t])),r[t].addHandler(e)},u=function t(e,n){if("function"==typeof n)l(e,n),t.reload();else if("object"==(void 0===e?"undefined":o(e))){for(var i in e)l(i,e[i]);t.reload()}else void 0===n&&t.navigate(e)};u.lookup=function(t,e){for(var n=0,o=i.length;n<o;n++){var r=i[n];if(r.name==t)return r.toURL(e)}},u.remove=function(t,e){var n=r[t];n&&n.removeHandler(e)},u.removeAll=function(){r={},i=[],n=""},u.navigate=function(t,e){var n=(e=e||{}).silent||!1;n&&g(),setTimeout(function(){window.location.hash=t,n&&setTimeout(function(){d()},1)},1)},u.noConflict=function(){return t.routie=a,u};var p=function(){return window.location.hash.substring(1)},h=function(t,e){var n=[];return e.match(t,n)?!1!==e.run(n)?1:0:-1},f=u.reload=function(){for(var t=p(),e=0,o=i.length;e<o;e++){var r=i[e],a=h(t,r);if(1===a){n=t;break}if(0===a){u.navigate(n,{silent:!0});break}}},d=function(){t.addEventListener?t.addEventListener("hashchange",f,!1):t.attachEvent("onhashchange",f)},g=function(){t.removeEventListener?t.removeEventListener("hashchange",f):t.detachEvent("onhashchange",f)};if(d(),n=p(),e)return u;t.routie=u}(window,!0),t.exports.default=t.exports},function(t,e,n){"use strict";n.r(e);var o=n(1),i=n(4),r=n(5),a=n(12);var s=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.config=function(){return{view:"layout",cols:[{$subview:r.default},{borderless:!0,rows:[{$subview:a.default},{$subview:i.default}]}]}},e}(o.c);e.default=s},function(t,e,n){"use strict";n.r(e);var o=n(1),i=n(0),r=n(22),a=n.n(r);var s=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.config=function(){var t=this,e=t.app,n={view:"form",localId:"auth_box",label:"Аутентификация",elements:[{view:"text",label:"Пользователь",name:"user",labelWidth:120,width:400,localId:"_user"},{view:"text",type:"password",label:"Пароль",name:"pass",labelWidth:120,width:400},{cols:[{},{},{view:"button",label:"OK",hotkey:"enter",tooltip:"Войти",click:function(){t.validate_user(t.$$("auth_box").getValues())?this.$scope.show("/start/body"):(webix.message({text:"не авторизованно",type:"error"}),Object(i.deleteCookie)("merge3-app"))}}]}]};return{view:"layout",rows:[{height:document.documentElement.clientHeight/4},{cols:[{},e.config.testmode?n:{view:"form",label:"Аутентификация",elements:[{height:20},{view:"label",label:"Перейдите в merge3 из склада",width:400,align:"center"},{height:20}]},{}]},{}]}},e.prototype.ready=function(){this.testmode&&this.$$("_user").focus()},e.prototype.init=function(){var t=this.app;window.addEventListener("beforeunload",function(){Object(i.onExit)(t)}),this.testmode=t.config.testmode,this.sklad_c=t.config.skladcookie;var e=Object(i.getCookie)(t.config.sklad_cook);if(this.testmode){window.addEventListener("beforeunload",function(){Object(i.onExit)(t)},!1);var n=void 0,o=void 0;try{var r=Object(i.getCookie)("merge3-app").split("::");n=r[0],o=r[1]}catch(t){}n&&o?(t.config.user=n,t.config.x_api=o,this.show("/start/body")):Object(i.deleteCookie)("merge3-app")}else if(e&&e.length>1){Object(i.deleteCookie)("merge3-app"),window.addEventListener("beforeunload",function(){Object(i.onExit)(t)},!1);var a=e.substring(0,e.length-32);a=decodeURI(a),console.log("name",a),this.validate_user({user:a,pass:"",sklad:!0})&&this.show("/start/body")}},e.prototype.validate_user=function(t){var e=this.app;t.pass=a()(t.pass),t.sklad=e.config.sklad;var n=!1,o=e.config.r_url+"?login",r=Object(i.request)(o,t,!0).response;if(r=Object(i.checkVal)(r,"s")){r.ft&&webix.alert({type:"alert-warning",width:450,title:"ВНИМАНИЕ!",text:"<span style='line-height: 24px'>Похоже, Вы впервые перешли из склада.</span><br><span> Свяжитесь с администратором для настройки организаций.</span>"}),n=!0,e.config.user=r.user;e.config.testmode&&(e.config.x_api=r.key,Object(i.setCookie)("merge3-app",[e.config.user,e.config.x_api].join("::"),{path:"/",expires:0}))}return n},e}(o.c);e.default=s},function(t,e,n){"use strict";n.r(e);var o=n(1),i=n(21),r=n(0);var a=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.config=function(){return{type:"line",rows:[{$subview:i.default},{$subview:!0,borderless:!0}]}},e.prototype.init=function(){var t=this.app;Object(r.init_first)(t)},e}(o.c);e.default=a},function(t,e){},function(t,e,n){"use strict";var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function i(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function r(t,e,n){for(var o in t)i(t,o)&&e.call(n||t,t[o],o,t)}function a(t){t="Warning: "+t,"undefined"!=typeof console&&console.error(t);try{throw new Error(t)}catch(t){}}var s=String.prototype.replace,c=String.prototype.split,l="||||",u=function(t){var e=t%10;return 11!==t&&1===e?0:2<=e&&e<=4&&!(t>=12&&t<=14)?1:2},p={arabic:function(t){if(t<3)return t;var e=t%100;return e>=3&&e<=10?3:e>=11?4:5},bosnian_serbian:u,chinese:function(){return 0},croatian:u,french:function(t){return t>1?1:0},german:function(t){return 1!==t?1:0},russian:u,lithuanian:function(t){return t%10==1&&t%100!=11?0:t%10>=2&&t%10<=9&&(t%100<11||t%100>19)?1:2},czech:function(t){return 1===t?0:t>=2&&t<=4?1:2},polish:function(t){if(1===t)return 0;var e=t%10;return 2<=e&&e<=4&&(t%100<10||t%100>=20)?1:2},icelandic:function(t){return t%10!=1||t%100==11?1:0},slovenian:function(t){var e=t%100;return 1===e?0:2===e?1:3===e||4===e?2:3}},h={arabic:["ar"],bosnian_serbian:["bs-Latn-BA","bs-Cyrl-BA","srl-RS","sr-RS"],chinese:["id","id-ID","ja","ko","ko-KR","lo","ms","th","th-TH","zh"],croatian:["hr","hr-HR"],german:["fa","da","de","en","es","fi","el","he","hi-IN","hu","hu-HU","it","nl","no","pt","sv","tr"],french:["fr","tl","pt-br"],russian:["ru","ru-RU"],lithuanian:["lt"],czech:["cs","cs-CZ","sk"],polish:["pl"],icelandic:["is"],slovenian:["sl-SL"]};function f(t){var e=function(t){var e={};return r(t,function(t,n){r(t,function(t){e[t]=n})}),e}(h);return e[t]||e[c.call(t,/-/,1)[0]]||e.en}function d(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var g=/\$/g,b="$$",_=/%\{(.*?)\}/g;function w(t,e,n,o){if("string"!=typeof t)throw new TypeError("Polyglot.transformPhrase expects argument #1 to be string");if(null==e)return t;var r=t,a=o||_,u="number"==typeof e?{smart_count:e}:e;if(null!=u.smart_count&&r){var h=c.call(r,l);r=function(t){return t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}(h[function(t,e){return p[f(t)](e)}(n||"en",u.smart_count)]||h[0])}return r=s.call(r,a,function(t,e){return i(u,e)&&null!=u[e]?s.call(u[e],g,b):t})}function m(t){var e=t||{};this.phrases={},this.extend(e.phrases||{}),this.currentLocale=e.locale||"en";var n=e.allowMissing?w:null;this.onMissingKey="function"==typeof e.onMissingKey?e.onMissingKey:n,this.warn=e.warn||a,this.tokenRegex=function(t){var e=t&&t.prefix||"%{",n=t&&t.suffix||"}";if(e===l||n===l)throw new RangeError('"'+l+'" token is reserved for pluralization');return new RegExp(d(e)+"(.*?)"+d(n),"g")}(e.interpolation)}m.prototype.locale=function(t){return t&&(this.currentLocale=t),this.currentLocale},m.prototype.extend=function(t,e){r(t,function(t,n){var i=e?e+"."+n:n;"object"===(void 0===t?"undefined":o(t))?this.extend(t,i):this.phrases[i]=t},this)},m.prototype.unset=function(t,e){"string"==typeof t?delete this.phrases[t]:r(t,function(t,n){var i=e?e+"."+n:n;"object"===(void 0===t?"undefined":o(t))?this.unset(t,i):delete this.phrases[i]},this)},m.prototype.clear=function(){this.phrases={}},m.prototype.replace=function(t){this.clear(),this.extend(t)},m.prototype.t=function(t,e){var n,o,i=null==e?{}:e;if("string"==typeof this.phrases[t])n=this.phrases[t];else if("string"==typeof i._)n=i._;else if(this.onMissingKey){o=(0,this.onMissingKey)(t,i,this.currentLocale,this.tokenRegex)}else this.warn('Missing translation for key: "'+t+'"'),o=t;return"string"==typeof n&&(o=w(n,i,this.currentLocale,this.tokenRegex)),o},m.prototype.has=function(t){return i(this.phrases,t)},m.transformPhrase=function(t,e,n){return w(t,e,n)},t.exports=m},function(t,e,n){"use strict";n.r(e);n(31);var o=n(1),i=(n(23),n(0)),r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t};var a=function(t){function e(n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a={id:"Merge3",version:"2019.073.1640",router:o.a,debug:!1,user:"",r_url:"localhost"===location.hostname?"http://saas.local/merge3_logic":"merge3_logic",x_api:"x_login",searchDelay:1e3,posPpage:20,start:"/login",adm:!1,sklad:!0,sklad_cook:"manuscriptsid"},s=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r({},a,n)));s.attachEvent("app:error:resolve",function(t,e){window.console.error(e)});var c=s;if(1==location.search.search("enabletestmode"))c.config.testmode=!0;else{var l=Object(i.getCookie)(c.config.sklad_cook);c.config.testmode=!l}return c.config.sklad=!c.config.testmode,webix.attachEvent("onBeforeAjax",function(t,e,n,o,i,r,a){i["x-api-key"]=c.config.x_api}),s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(o.b);e.default=a,webix.ready(function(){return(new a).render()})},function(t,e,n){},function(t,e){var n=webix,o=webix.version.split(".");10*o[0]+1*o[1]<53&&(n.ui.freeze=function(t){var e=t();return e&&e.then?e.then(function(t){return n.ui.$freeze=!1,n.ui.resize(),t}):(n.ui.$freeze=!1,n.ui.resize()),e});var i=n.ui.baselayout.prototype.addView,r=n.ui.baselayout.prototype.removeView,a={addView:function(t,e){if(this.$scope&&this.$scope.webixJet){var n=this.$scope,o={};t=n.app.copyConfig(t,{},o),i.apply(this,[t,e]);var r=function(t){n._renderFrame(t,o[t],n.getUrl()).then(function(){n._subs[t]=o[t]})};for(var a in o)r(a);return t.id}return i.apply(this,arguments)},removeView:function(){if(r.apply(this,arguments),this.$scope&&this.$scope.webixJet){var t=this.$scope._subs;for(var e in t)webix.$$(t[e].id)||delete t[e]}}};n.extend(n.ui.layout.prototype,a,!0),n.extend(n.ui.baselayout.prototype,a,!0),webix.protoUI({name:"jetapp",$init:function(t){this.$app=new this.app(t);var e=webix.uid().toString();t.body={id:e},this.$ready.push(function(){this.$app.render(webix.$$(e))})}},webix.ui.proxy)},function(t,e,n){var o={"./body":25,"./body.js":25,"./companies_window":7,"./companies_window.js":7,"./export_options":10,"./export_options.js":10,"./export_window":2,"./export_window.js":2,"./footer":4,"./footer.js":4,"./globals":0,"./globals.js":0,"./group_pop":20,"./group_pop.js":20,"./header":21,"./header.js":21,"./history":15,"./history.js":15,"./inn_edit":8,"./inn_edit.js":8,"./inn_window":3,"./inn_window.js":3,"./login":26,"./login.js":26,"./main_tab":12,"./main_tab.js":12,"./md5":22,"./md5.js":22,"./merge3_window":18,"./merge3_window.js":18,"./pager":14,"./pager.js":14,"./permited":17,"./permited.js":17,"./prop_window":6,"./prop_window.js":6,"./report_create":11,"./report_create.js":11,"./restricted":19,"./restricted.js":19,"./sidebuttons-bar":5,"./sidebuttons-bar.js":5,"./spr":13,"./spr.js":13,"./spr_history":16,"./spr_history.js":16,"./start":27,"./start.js":27,"./users_edit":9,"./users_edit.js":9};function i(t){var e=r(t);return n(e)}function r(t){var e=o[t];if(!(e+1)){var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}return e}i.keys=function(){return Object.keys(o)},i.resolve=r,t.exports=i,i.id=33},function(t,e,n){var o={"./en":28,"./en.js":28,"./ru":23,"./ru.js":23};function i(t){var e=r(t);return n(e)}function r(t){var e=o[t];if(!(e+1)){var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}return e}i.keys=function(){return Object.keys(o)},i.resolve=r,t.exports=i,i.id=34}]);