!function(e){var t={};function i(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=t,i.d=function(e,t,o){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(o,n,function(t){return e[t]}.bind(null,n));return o},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/codebase/",i(i.s=75)}([function(e,t,i){"use strict";i.r(t),i.d(t,"u_roles",function(){return n}),i.d(t,"barcodes",function(){return r}),i.d(t,"tg",function(){return s}),i.d(t,"prcs",function(){return a}),i.d(t,"allTg",function(){return l}),i.d(t,"allIs",function(){return c}),i.d(t,"strana",function(){return u}),i.d(t,"vendor",function(){return d}),i.d(t,"dv",function(){return p}),i.d(t,"nds",function(){return h}),i.d(t,"sezon",function(){return f}),i.d(t,"hran",function(){return _}),i.d(t,"group",function(){return g}),i.d(t,"compareTrue",function(){return b}),i.d(t,"cEvent",function(){return w}),i.d(t,"unFilter",function(){return v}),i.d(t,"checkKey",function(){return $}),i.d(t,"checkVal",function(){return m}),i.d(t,"addHran",function(){return y}),i.d(t,"delHran",function(){return x}),i.d(t,"updHran",function(){return C}),i.d(t,"addIssue",function(){return V}),i.d(t,"delIssue",function(){return k}),i.d(t,"updIssue",function(){return I}),i.d(t,"addStrana",function(){return O}),i.d(t,"delStrana",function(){return j}),i.d(t,"updStrana",function(){return P}),i.d(t,"addDv",function(){return E}),i.d(t,"delDv",function(){return S}),i.d(t,"updDv",function(){return R}),i.d(t,"addNds",function(){return T}),i.d(t,"delNds",function(){return L}),i.d(t,"updNds",function(){return z}),i.d(t,"addSez",function(){return W}),i.d(t,"delSez",function(){return B}),i.d(t,"updSez",function(){return A}),i.d(t,"addGr",function(){return F}),i.d(t,"delGr",function(){return D}),i.d(t,"updGr",function(){return H}),i.d(t,"addVendor",function(){return M}),i.d(t,"delVendor",function(){return N}),i.d(t,"updVendor",function(){return q}),i.d(t,"parseToLink",function(){return K}),i.d(t,"get_bars",function(){return U}),i.d(t,"get_tg",function(){return G}),i.d(t,"clear_obj",function(){return Y}),i.d(t,"gen_params",function(){return J}),i.d(t,"str_join",function(){return Z}),i.d(t,"get_data_test",function(){return X}),i.d(t,"parse_unlinked_item",function(){return Q}),i.d(t,"get_spr",function(){return ee}),i.d(t,"getDtParams",function(){return te}),i.d(t,"dt_formating_sec",function(){return ie}),i.d(t,"dt_formating",function(){return oe}),i.d(t,"mcf_filter",function(){return ne}),i.d(t,"init_first",function(){return re}),i.d(t,"clear_names_bar",function(){return se}),i.d(t,"get_prcs",function(){return ae}),i.d(t,"get_prcs_source",function(){return le}),i.d(t,"get_prcs_date",function(){return ce}),i.d(t,"get_refs",function(){return ue}),i.d(t,"get_suppl",function(){return de}),i.d(t,"delPrc",function(){return pe}),i.d(t,"after_call",function(){return he}),i.d(t,"request",function(){return fe}),i.d(t,"getCookie",function(){return _e}),i.d(t,"setCookie",function(){return ge}),i.d(t,"deleteCookie",function(){return be}),i.d(t,"checkSSE",function(){return we}),i.d(t,"spinIconEnable",function(){return ve}),i.d(t,"spinIconDisable",function(){return $e}),i.d(t,"setButtons",function(){return me});i(1);var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=new webix.DataCollection({id:"roles_dc"}),r=new webix.DataCollection({id:"bars_dc"}),s=new webix.DataCollection({id:"tg_dc"}),a=new webix.DataCollection({id:"prcs_dc",on:{onAfterLoad:function(){var e=this.data.order[0];this.setCursor(e);var t=$$("main_ui");$$("_suppl").config.state?$$("_suppl").config.state=!1:Q(t)}}}),l=new webix.DataCollection({id:"allTg_dc"}),c=new webix.DataCollection({id:"allIs_dc"}),u=new webix.DataCollection({id:"strana_dc"}),d=new webix.DataCollection({id:"vendor_dc"}),p=new webix.DataCollection({id:"dv_dc"}),h=new webix.DataCollection({id:"nds_dc"}),f=new webix.DataCollection({id:"sezon_dc"}),_=new webix.DataCollection({id:"hran_dc"}),g=new webix.DataCollection({id:"group_dc"});function b(){return!0}var w=function(e,t,i,o){(o=o||{}).inner=!0,webix.event(e,t,i,o)},v=function(e){e.config.columns.forEach(function(t){if(e.isColumnVisible(t.id)&&t.header[1]&&t.header[1].content){var i=e.getFilter(t.id);"function"==typeof i.setValue?e.getFilter(t.id).setValue(""):i.readOnly||(i.value="")}})};function $(e){var t=!1;return(8===e||13===e||32===e||46===e||e>47&&e<91||e>95&&e<112||e>185&&e<193||e>219&&e<223)&&(t=!0),t}function m(e,t){var i;return"s"===t?i=JSON.parse(e):"a"===t&&(i=e.json()),i.result?i=i.ret_val:(i=void 0,"error"),i}function y(e){_.add(e)}function x(e){_.remove(e)}function C(e,t){var i=e.id,o=t.getItem(i);o.usloviya=e.value,t.updateItem(i,o),t.refresh()}function V(e){c.add(e)}function k(e){c.remove(e)}function I(e,t){var i=e.id,o=t.getItem(i);o.c_issue=e.value,t.updateItem(i,o),t.refresh()}function O(e){u.add(e)}function j(e){u.remove(e)}function P(e,t){var i=e.id,o=t.getItem(i);o.c_strana=e.value,t.updateItem(i,o),t.refresh()}function E(e){p.add(e)}function S(e){p.remove(e)}function R(e,t){var i=e.id,o=t.getItem(i);o.act_ingr=e.value,o.oa=e.oa,t.updateItem(i,o),t.refresh()}function T(e){h.add(e)}function L(e){h.remove(e)}function z(e,t){var i=e.id,o=t.getItem(i);o.nds=e.value,t.updateItem(i,o),t.refresh()}function W(e){f.add(e)}function B(e){f.remove(e)}function A(e,t){var i=e.id,o=t.getItem(i);o.sezon=e.value,t.updateItem(i,o),t.refresh()}function F(e){g.add(e)}function D(e){g.remove(e)}function H(e,t){var i=e.id,o=t.getItem(i);o.group=e.value,t.updateItem(i,o),t.refresh()}function M(e){d.add(e)}function N(e){d.remove(e)}function q(e,t){var i=e.id,o=t.getItem(i);o.c_zavod=e.value,t.updateItem(i,o),t.refresh()}function K(e){var t=$$("_suppl").getList(),i=t.data.order,o=void 0,n=$$("main_ui").$scope.app;m(fe(n.config.r_url+"?setWork",{user:n.config.user,sh_prc:e.sh_prc},!0).response,"s");if(i.forEach(function(i,n,r){t.getItem(i).c_vnd===e.c_vnd&&(o=t.getItem(i).id)}),o)t.getItem(o).count+=1,$$("_suppl").setValue(o),setTimeout(function(){if(a.getItem(e.id))a.setCursor(e.id),Q(this,e);else{a.add(e,0);var t=a.data.order[0];a.setCursor(t),Q(this,e)}},400);else{var r=Math.round(1e12-.5+Math.random()*(1e12+1)),s={id:r,count:1,c_vnd:e.c_vnd,id_vnd:e.id_vnd};$$("_suppl").config.manual=!0,t.add(s),$$("_suppl").setValue(r),setTimeout(function(){a.clearAll(),a.add(e,0);var t=a.data.order[0];a.setCursor(t),Q(this,e)},400)}}function U(e,t){var i=e.app.config.user,o=fe(e.app.config.r_url+"?getBar",{user:i,id_spr:t},!0).response;(o=m(o,"s"))&&($$("bars_dc").clearAll(),$$("bars_dc").parse(o))}function G(e,t){var i=e.app.config.user,o=fe(e.app.config.r_url+"?getTg",{user:i,id_spr:t},!0).response;(o=m(o,"s"))&&($$("tg_dc").clearAll(),$$("tg_dc").parse(o))}function Y(e){for(var t in e){var i=e[t];"object"===(void 0===i?"undefined":o(i))?i=Y(i):void 0==i&&delete e[t]}return e}function J(e){var t=e.view.$scope.app,i=e.searchBar,o=e.field?e.field:void 0,n=e.direction?e.direction:void 0,r=i?$$(i).getValue():void 0,s=e.filter?e.filter:void 0,a=t.config.user,l=(t.config.r_url,e.method,{user:a,search:r,start:e.start,count:e.count,field:o,direction:n,c_filter:s,cbars:e.cbars});return l=Y(l)}function Z(e){var t="";for(var i in e){var n=e[i];"object"===(void 0===n?"undefined":o(n))?n=Z(n):t+=n.toString()}return t}function X(e){var t=e.view,i=t.$scope.app;t&&t.clearAll();var o=e.navBar,n=i.config.r_url+"?"+e.method,r=J(e),s=r.search;""===s&&(s="%%");var a=void 0!==s?s.replace(/\ /g,"").length:2;(void 0!==s?s.length:2)>1&&a>1&&(t.showProgress({type:"icon",icon:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>'}),fe(n,r).then(function(i){if(i=m(i,"a")){if(i.params){var n=Z(J(e));if(Z(i.params)!==n)return void t.hideProgress()}t.parse(i.datas),t.config.startPos=i.start,t.config.totalPos=i.total;var r=Math.ceil(t.config.totalPos/t.config.posPpage),a=0!==r?Math.ceil(t.config.startPos/t.config.posPpage):1,l=o.getChildViews()[2],c=o.getChildViews()[6];c.define("label","Всего записей: "+t.config.totalPos),c.refresh();var u=o.$scope.$$("__page").getValue();try{u=+u}catch(e){}u!==a&&(o.$scope.$$("__page").config.manual=!1);var d=l.getChildViews();d[2].define("label",r),d[2].refresh(),o.$scope.$$("__page").setValue(a),o.$scope.$$("__page").refresh();var p=webix.storage.session.get(t.config.name);if(p)"%%"!==s&&p.push(s);else p=["%%"!==s?s:""];webix.storage.session.put(t.config.name,p)}t.hideProgress()}))}function Q(e,t){var i={},o="<a target='_blank' rel='noreferrer noopener' href='"+("https://www.google.ru/search?newwindow=1&q="+(t=t||$$("prcs_dc").getItem($$("prcs_dc").getCursor())).c_tovar)+"'><span>"+t.c_tovar+"</span></a>",n="<span style='color: #666666; text-decoration: underline;'>Осталось свести в текущей сессии:</span><span style='color: red; font-weight: bold;'>  "+$$("prcs_dc").count()+"</span>";i._name=o,i._count=n,i._vendor=t.c_zavod,i.p_name=t.c_tovar;var r=$$("main_ui").$scope.app.config;r.roles[r.role].spradd&&$$("_add").show(),$$("_left").show(),$$("_skip").show(),$$("_right").show(),$$("_names_bar").parse(i);var s=t.c_tovar.split(" "),a=0;s[a].length<4&&(a+=1);for(var l=s[a],c=a;c<s.length;c++)for(var u=s[c],d=0;d<u.length;d++){parseInt(u[d],10);!isNaN(u[d])&&(l+=" "+u[d])}l=(l=(l=(l=(l=(l=(l=(l=(l=l.replace('"'," ")).replace("!"," ")).replace("-"," ")).replace("."," ")).replace(","," ")).replace("*"," ")).replace("+"," ")).replace("/"," ")).replace("\\"," "),$$("_spr_search").setValue(l);var p=$$("app-nav").getChildViews()[3].getChildViews(),h=te(p[0]);X({view:p[0],navBar:p[1],start:1,searchBar:p[0].config.searchBar,method:p[0].config.searchMethod,field:h[2],direction:h[3],filter:h[0],count:h[1]}),$$("_spr_search").focus()}function ee(e,t){var i=e.app.config.user,o=fe(e.app.config.r_url+"?getSpr",{user:i,id_spr:t},!0).response;return(o=m(o,"s"))?o[0]:(webix.message("error"),"error")}function te(e){var t=void 0;return"__ttl"===e.config.name?t={id:$$(e).isColumnVisible("id")?$$(e).getFilter("id").value:void 0,c_vnd:$$(e).isColumnVisible("c_vnd")?$$(e).getFilter("c_vnd").getValue():void 0,c_zavod:$$(e).isColumnVisible("c_zavod")?$$(e).getFilter("c_zavod").value:void 0,id_tovar:$$(e).isColumnVisible("id_tovar")?$$(e).getFilter("id_tovar").value:void 0,id_spr:$$(e).isColumnVisible("id_spr")?$$(e).getFilter("id_spr").value:void 0,dt:$$(e).isColumnVisible("dt")?$$(e).getFilter("dt").getValue():void 0,spr:$$(e).isColumnVisible("spr")?$$(e).getFilter("spr").value:void 0,owner:$$(e).isColumnVisible("owner")?$$(e).getFilter("owner").value:void 0,source:$$(e).isColumnVisible("source")?$$(e).getFilter("source").getValue():void 0}:"__tt"===e.config.name?t={c_vnd:$$(e).isColumnVisible("c_vnd")?$$(e).getFilter("c_vnd").getValue():void 0,c_zavod:$$(e).isColumnVisible("c_zavod")?$$(e).getFilter("c_zavod").value:void 0,id_tovar:$$(e).isColumnVisible("id_tovar")?$$(e).getFilter("id_tovar").value:void 0,owner:$$(e).isColumnVisible("owner")?$$(e).getFilter("owner").value:void 0}:"__dt_a"===e.config.name?t={c_vnd:$$(e).isColumnVisible("c_vnd")?$$(e).getFilter("c_vnd").getValue():void 0,c_zavod:$$(e).isColumnVisible("c_zavod")?$$(e).getFilter("c_zavod").value:void 0,id_org:$$(e).isColumnVisible("id_org")?$$(e).getFilter("id_org").value:void 0,c_tovar:$$(e).isColumnVisible("c_tovar")?$$(e).getFilter("c_tovar").value:void 0,sh_prc:$$(e).isColumnVisible("sh_prc")?$$(e).getFilter("sh_prc").value:void 0,c_user:$$(e).isColumnVisible("c_user")?$$(e).getFilter("c_user").getText():void 0,source:$$(e).isColumnVisible("source")?$$(e).getFilter("source").getValue():void 0,dt:$$(e).isColumnVisible("dt")?$$(e).getFilter("dt").getValue():void 0}:"__dt_s"===e.config.name?t={c_tovar:$$(e).isColumnVisible("c_tovar")?$$(e).getFilter("c_tovar").value:void 0,sh_prc:$$(e).isColumnVisible("sh_prc")?$$(e).getFilter("sh_prc").value:void 0,c_vnd:$$(e).isColumnVisible("c_vnd")?$$(e).getFilter("c_vnd").getValue():void 0,c_zavod:$$(e).isColumnVisible("c_zavod")?$$(e).getFilter("c_zavod").value:void 0,id_org:$$(e).isColumnVisible("id_org")?$$(e).getFilter("id_org").value:void 0,dt:$$(e).isColumnVisible("dt")?$$(e).getFilter("dt").getValue():void 0,source:$$(e).isColumnVisible("source")?$$(e).getFilter("source").getValue():void 0}:"__dt_as"===e.config.name?t={dt:$$(e).isColumnVisible("dt")?$$(e).getFilter("dt").getValue():void 0,id_spr:$$(e).isColumnVisible("id_spr")?$$(e).getFilter("id_spr").value:void 0,id_zavod:$$(e).isColumnVisible("id_zavod")?$$(e).getFilter("id_zavod").getValue():void 0,id_strana:$$(e).isColumnVisible("id_strana")?$$(e).getFilter("id_strana").getValue():void 0,c_dv:$$(e).isColumnVisible("c_dv")?$$(e).getFilter("c_dv").getValue():void 0,c_group:$$(e).isColumnVisible("c_group")?$$(e).getFilter("c_group").getValue():void 0,c_nds:$$(e).isColumnVisible("c_nds")?$$(e).getFilter("c_nds").getValue():void 0,c_hran:$$(e).isColumnVisible("c_hran")?$$(e).getFilter("c_hran").getValue():void 0,c_sezon:$$(e).isColumnVisible("c_sezon")?$$(e).getFilter("c_sezon").getValue():void 0,mandat:$$(e).isColumnVisible("mandat")?$$(e).getFilter("mandat").getValue():void 0,prescr:$$(e).isColumnVisible("prescr")?$$(e).getFilter("prescr").getValue():void 0}:"__dt"===e.config.name?t={id_spr:$$(e).isColumnVisible("id_spr")?$$(e).getFilter("id_spr").value:void 0,c_dv:$$(e).isColumnVisible("c_dv")?$$(e).getFilter("c_dv").getValue():void 0}:"__brak"===e.config.name?t={dt:$$(e).isColumnVisible("dt")?$$(e).getFilter("dt").getValue():void 0}:"relink"===e.config.name&&(t={dt:$$(e).isColumnVisible("dt")?$$(e).getFilter("dt").getValue():void 0,id_spr:$$(e).isColumnVisible("id_spr")?$$(e).getFilter("id_spr").value:void 0,id_zavod:$$(e).isColumnVisible("id_zavod")?$$(e).getFilter("id_zavod").getValue():void 0,id_strana:$$(e).isColumnVisible("id_strana")?$$(e).getFilter("id_strana").getValue():void 0,c_dv:$$(e).isColumnVisible("c_dv")?$$(e).getFilter("c_dv").getValue():void 0,c_group:$$(e).isColumnVisible("c_group")?$$(e).getFilter("c_group").getValue():void 0,c_nds:$$(e).isColumnVisible("c_nds")?$$(e).getFilter("c_nds").getValue():void 0,c_hran:$$(e).isColumnVisible("c_hran")?$$(e).getFilter("c_hran").getValue():void 0,c_sezon:$$(e).isColumnVisible("c_sezon")?$$(e).getFilter("c_sezon").getValue():void 0,mandat:$$(e).isColumnVisible("mandat")?$$(e).getFilter("mandat").getValue():void 0,prescr:$$(e).isColumnVisible("prescr")?$$(e).getFilter("prescr").getValue():void 0}),[t,e.config.posPpage,e.config.fi,e.config.di]}function ie(e){return webix.Date.dateToStr("%d-%m-%Y  %G:%i:%s")(e)}function oe(e){return webix.Date.dateToStr("%d-%m-%Y")(e)}function ne(e,t){return t=t.toString().toLowerCase(),t=new RegExp(".*"+t.replace(/ /g,".*")+".*"),-1!=e.value.toString().toLowerCase().search(t)}function re(e){webix.i18n.setLocale("ru-RU"),webix.protoUI({name:"activeList"},webix.ui.list,webix.ActiveContent),webix.protoUI({name:"cWindow",defaults:{resize:!0,modal:!1,move:!0,position:"center"},$init:function(e){webix.extend(e,{head:{view:"toolbar",cols:[{view:"label",label:"Название окна"},{view:"button",type:"icon",icon:"times",css:"times",height:26,width:26,click:function(){this.getTopParentView().hide()}}]}})}},webix.ui.window),webix.protoUI({name:"customcombo",$cssName:"text",defaults:{keepText:!1,separator:",",icon:!1,iconWidth:0,tagMode:!0,tagTemplate:function(e){return e.length?e.length+" item(s)":""},template:function(e,t){return t._render_value_block(e,t)}},$init:function(){this.$view.className+=" webix_multicombo",this.attachEvent("onBeforeRender",function(){return this._inputHeight||(this._inputHeight=webix.skin.$active.inputHeight),!0}),this.attachEvent("onAfterRender",function(){this._last_size=null}),this._renderCount=0},on_click:{webix_multicombo_delete:function(e,t,i){var o;return!this._settings.readonly&&i&&(o=i.parentNode.getAttribute("optvalue"))&&this._removeValue(o),!1}},_onBlur:function(){var e=this.getInputNode().value;e&&this._settings.newValues&&new Date-(this.getPopup()._click_stamp||0)>100&&this._addNewValue(e),this._settings.keepText||(this._inputValue=""),this.refresh()},_removeValue:function(e){var t=this._settings.value,i=webix.$$(this.config.suggest);"string"==typeof t&&(t=t.split(this._settings.separator)),(t=webix.toArray(webix.copy(t))).remove(e),this.setValue(t.join(this._settings.separator)),i&&i._settings.selectAll&&i.getBody()._cells[0].setValue(0)},_addValue:function(e){var t=webix.$$(this.config.suggest);if(t.getList().getItem(e)){var i=t.getValue();i&&"string"==typeof i&&(i=i.split(t.config.separator)),(i=webix.toArray(i||[])).find(e)<0&&(i.push(e),t.setValue(i),this.setValue(t.getValue()))}},_addNewValue:function(e){var t,i=webix.$$(this.config.suggest),o=i.getList();if(e=e.replace(/^\s+|\s+$/g,""))for(var n in o.data.pull)i.getItemText(n)==e&&(t=n);!t&&e&&(t=o.add({id:e,value:e})),this._addValue(t)},_suggest_config:function(e){var t=!webix.isArray(e)&&"object"==(void 0===e?"undefined":o(e))&&!e.name,i={view:"checksuggest",separator:this.config.separator,buttonText:this.config.buttonText,button:this.config.button},n=this;this._settings.optionWidth&&(i.width=this._settings.optionWidth),t&&webix.extend(i,e,!0);var r=webix.ui(i);this._settings.optionWidth||(r.$customWidth=function(e){this.config.width=n._get_input_width(n._settings)}),r.attachEvent("onBeforeShow",function(e,t,i){if(this._settings.master&&(this.setValue(webix.$$(this._settings.master).config.value),webix.$$(this._settings.master).getInputNode().value||this.isVisible()?(this.getList().refresh(),this._dont_unfilter=!0):this.getList().filter(),e.tagName&&"input"==e.tagName.toLowerCase()))return webix.ui.popup.prototype.show.apply(this,[e.parentNode,t,i]),!1});var s=r.getList();return"string"==typeof e?s.load(e):t||s.parse(e),r._suggest_after_filter=function(){},r},_render_value_block:function(e,t){var i,o,n,r,s,a,l,c,u,d,p,h,f="",_="top"==this._settings.labelPosition;return i="x"+webix.uid(),h=t._get_input_width(e),o=e.inputAlign||"left",s=this._inputHeight-2*webix.skin.$active.inputPadding-2,r=this._inputValue||"",c="<ul class='webix_multicombo_listbox' style='line-height:"+s+"px'></ul>",n="width: "+Math.min(h,t._inputWidth||7)+"px;height:"+s+"px;max-width:"+(h-20)+"px",p=e.readonly?" readonly ":"",a="<div class='webix_inp_static' onclick='' style='line-height:"+s+"px;width: "+h+"px;  text-align: "+o+";height:auto' >"+c+("<input id='"+i+"' role='combobox' aria-multiline='true' aria-label='"+webix.template.escape(e.label)+"' tabindex='0' type='text' class='webix_multicombo_input' "+p+" style='"+n+"' value='"+r+"'/>")+"</div>",l=t.$renderLabel(e,i),d=this._settings.awidth-h-2*webix.skin.$active.inputPadding,(u=(e.invalid?e.invalidMessage:"")||e.bottomLabel)&&(f="<div class='webix_inp_bottom_label' style='width:"+h+"px;margin-left:"+Math.max(d,webix.skin.$active.inputPadding)+"px;'>"+u+"</div>"),_?l+"<div class='webix_el_box' style='width:"+this._settings.awidth+"px; '>"+a+f+"</div>":"<div class='webix_el_box' style='width:"+this._settings.awidth+"px; min-height:"+this._settings.aheight+"px;'>"+l+a+f+"</div>"},_getValueListBox:function(){return this._getBox().getElementsByTagName("UL")[0]},_set_inner_size:function(){var e=this.getPopup();if(e){var t=e?e.setValue(this._settings.value):null;e._toMultiValue&&(this._settings.value=e._toMultiValue(this._settings.value));var i="",o=this._getValueListBox(),n=t&&t.length;if(n){var r=this._inputHeight-2*webix.skin.$active.inputPadding-8,s=this._settings.value;if("string"==typeof s&&(s=s.split(this._settings.separator)),this._settings.tagMode)for(var a=0;a<t.length;a++){var l="<span>"+t[a]+"</span><span class='webix_multicombo_delete' role='button' aria-label='"+webix.i18n.aria.removeItem+"'>x</span>";i+="<li class='webix_multicombo_value' style='line-height:"+r+"px;' optvalue='"+s[a]+"'>"+l+"</li>"}else i+="<li class='webix_multicombo_tag' style='line-height:"+r+"px;'>"+this._settings.tagTemplate(s)+"</li>"}o.innerHTML=i;var c=this.getInputNode();this._settings.placeholder&&(n?(c.placeholder="",!c.value&&c.offsetWidth>20&&(c.style.width="20px")):c.value||(c.placeholder=this._settings.placeholder,c.style.width=this._get_input_width(this._settings)+"px")),!this._settings.tagMode&&o.firstChild&&(c.style.width=this._getMultiComboInputWidth()+"px")}this._resizeToContent()},_focusAtEnd:function(e){if(e=e||this.getInputNode())if(e.value.length){if(e.createTextRange){var t=e.createTextRange();t.moveStart("character",e.value.length),t.collapse(),t.select()}else if(e.selectionStart||"0"==e.selectionStart){var i=e.value.length;e.selectionStart=i,e.selectionEnd=i,e.focus()}}else e.focus()},_resizeToContent:function(){var e="top"==this._settings.labelPosition,t=this._getInputDiv(),i=Math.max(t.offsetHeight+2*webix.skin.$active.inputPadding,this._inputHeight);if(e&&(i+=this._labelTopHeight),(i+=this._settings.bottomPadding||0)!=this.$getSize(0,0)[2]){var o=t.offsetHeight+(e?this._labelTopHeight:0);if(o==this._calcHeight?this._renderCount++:this._renderCount=0,this._renderCount>10)return!1;this._calcHeight=o;var n=this.getTopParentView();clearTimeout(n._template_resize_timer),n._template_resize_timer=webix.delay(function(){this.config.height=this._calcHeight+2*webix.skin.$active.inputPadding,console.log("th",this),this.resize(),this._typing&&(this._focusAtEnd(this.getInputNode()),this._typing=!1),this._enter&&(this._settings.keepText?this.getInputNode().select():this.getInputNode().value="",this._enter=!1),(this.getPopup().isVisible()||this._typing)&&this.getPopup().show(this._getInputDiv())},this)}this._enter&&this.getInputNode().select()},_getInputDiv:function(){for(var e=this._getBox(),t=e.childNodes,i=0;i<t.length;i++)if(t[i].className&&-1!=t[i].className.indexOf("webix_inp_static"))return t[i];return e},getInputNode:function(){return this._getBox().getElementsByTagName("INPUT")[0]},$setValue:function(){this._rendered_input&&this._set_inner_size()},getValue:function(e){if("object"==(void 0===e?"undefined":o(e))&&e.options)return this._getSelectedOptions();var t=this._settings.value;return t?"string"!=typeof t?t.join(this._settings.separator):t:""},getText:function(){var e=this._settings.value;if(!e)return"";"string"==typeof e&&(e=e.split(this._settings.separator));for(var t=[],i=0;i<e.length;i++)t.push(this.getPopup().getItemText(e[i]));return t.join(this._settings.separator)},_getSelectedOptions:function(){var e,t,i,o=[],n=this._settings.value;if(!n)return[];for("string"==typeof n&&(n=n.split(this._settings.separator)),i=this.getPopup(),e=0;e<n.length;e++)(t=i.getList().getItem(n[e])||(i._valueHistory?i._valueHistory[n[e]]:null))&&o.push(t);return o},$setSize:function(e,t){var i=this._settings;if(webix.ui.view.prototype.$setSize.call(this,e,t)){if(!e||!t)return;"top"==i.labelPosition&&(i.labelWidth=0),this.render()}},_calcInputWidth:function(e){var t=document.createElement("span");t.className="webix_multicombo_input",t.style.visibility="visible",t.style.height="0px",t.innerHTML=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),document.body.appendChild(t);var i=t.offsetWidth+10;return document.body.removeChild(t),i},_getMultiComboInputWidth:function(){var e=this._getValueListBox();return e.offsetWidth-e.firstChild.offsetWidth-17},_init_onchange:function(){webix._event(this._getBox(),"click",function(){this.getInputNode().focus()},{bind:this}),webix._event(this.getInputNode(),"focus",function(){-1==this._getBox().className.indexOf("webix_focused")&&(this._getBox().className+=" webix_focused")},{bind:this}),webix._event(this.getInputNode(),"blur",function(){this._getBox().className=this._getBox().className.replace(" webix_focused","")},{bind:this}),webix._event(this.getInputNode(),"input",function(){!this.getInputNode().value&&this._inputValue&&(this.getInputNode().style.width="20px",this._inputWidth=20,this._inputValue="",this._typing=!0,this.getPopup().show(this._getInputDiv()),this._resizeToContent())},{bind:this}),webix._event(this.getInputNode(),"keyup",function(e){var t,i,o=this.getInputNode();if(e=e||event,!this._settings.placeholder||this._settings.value||o.value?(i=t=this._calcInputWidth(o.value)+10,!this._settings.tagMode&&this._getValueListBox().firstChild&&(i=this._getMultiComboInputWidth())):i=this._get_input_width(this._settings),o.style.width=i+"px",t!=this._inputWidth?(this._settings.keepText||13!=e.keyCode?this._inputValue=o.value:this._inputValue=!1,this._typing=!0,this._inputWidth&&this.getPopup().show(this._getInputDiv()),this._inputWidth=t||i,this._resizeToContent()):this._windowHeight!=this.getPopup().$height&&this.getPopup().show(this._getInputDiv()),o.value.indexOf(this._settings.separator)>-1&&this._settings.tagMode){var n=o.value.replace(this._settings.separator,"");if(n)if(this._settings.newValues)this._addNewValue(n);else{var r=this.getPopup().getItemId(n);r&&this._addValue(r)}this._settings.keepText?(this._inputValue=n,o.value=n,this._enter=!0,this._typing=!0,this._resizeToContent()):o.value=""}},{bind:this}),webix._event(this.getInputNode(),"keydown",function(e){if(this._enter=!1,this.isVisible()){e=e||event;var t=this._getValueListBox().lastChild;if(this._windowHeight=this.getPopup().$height,8==e.keyCode&&t&&(!this.getInputNode().value&&(new Date).valueOf()-(this._backspaceTime||0)>100?(this._typing=!0,this._removeValue(t.getAttribute("optvalue"))):this._backspaceTime=(new Date).valueOf()),13==e.keyCode||9==e.keyCode){var i=this.getInputNode(),o="",n=webix.$$(this._settings.suggest);n.getList().getSelectedId()||(i.value&&(o=n.getSuggestion(i.value)),this._settings.newValues?(13==e.keyCode&&(this._enter=!0),this._addNewValue(i.value),this._settings.keepText?this._inputValue=i.value:i.value=""):o&&(9==e.keyCode?(this._typing=!1,this._inputValue="",this._inputWidth=10,i.value="",this._addValue(o)):(this._enter=!0,this._addValue(o),this._settings.keepText?this._inputValue=i.value:i.value=""))),13==e.keyCode&&(this._enter=!0,this._typing=!0,this._settings.keepText?this._inputValue=i.value:i.value="")}}},{bind:this}),webix.$$(this._settings.suggest).linkInput(this)}},webix.ui.richselect),webix.ui.datafilter.richFilt=Object.create(webix.ui.datafilter.richSelectFilter),webix.ui.datafilter.richFilt.refresh=function(e,t,i){if(!e.$destructed){var o=webix.$$(i.richselect);t._comp_id=e.config.id,t.$webix=i.richselect,t.style.marginLeft="-10px",i.compare=i.compare||this.compare,i.prepare=i.prepare||this.prepare,e.registerFilter(t,i,this);var n=i.inputConfig.options,r=i.options,s=o.getPopup().getList();webix.$$(r);if(t.firstChild.appendChild(o.$view.parentNode),s.parse&&(s.clearAll(),s.parse(n),!this.$noEmptyOption&&!1!==i.emptyOption||i.emptyOption)){var a={id:"-1",value:i.emptyOption||"",$empty:!0};s.add(a,0)}i.value&&this.setValue(t,i.value),o.render(),webix.delay(o.resize,o)}},webix.ui.datafilter.richFilt.render=function(t,i){if(!i.richselect){var o={container:webix.html.create("div",{class:"webix_richfilter"}),view:(i.inputConfig?i.inputConfig.inputtype:void 0)||this.inputtype,options:[]},n=webix.extend(this.inputConfig||{},i.inputConfig||{},!0);webix.extend(o,n,!0),i.separator&&(o.separator=i.separator),i.suggest&&(o.suggest=i.suggest);var r=webix.ui(o),s=i.inputConfig.pager||2;r.attachEvent("onChange",function(){t.config.columns.forEach(function(e){e.id===r.config.column_name&&(e.header[1].height=t.getHeaderNode(e.id,1).children[0].offsetHeight+5,t.refreshColumns())});var i=t.getParentView().getChildViews()[s].$scope.$$("__page");this._filter_timer&&window.clearTimeout(this._filter_timer),this._filter_timer=window.setTimeout(function(){var e=i.getValue();i.setValue(0==+e?"1":"0"),i.refresh()},e.config.searchDelay)}),i.richselect=r.config.id}return i.css="webix_div_filter"," "},webix.ui.datafilter.cFilt=Object.create(webix.ui.datafilter.textFilter),webix.ui.datafilter.cFilt.on_key_down=function(t,i,o){var n=this._comp_id,r=webix.$$(n);if(9!=(t.which||t.keyCode)&&$(t.keyCode)){this._filter_timer&&window.clearTimeout(this._filter_timer);var s=this._pager||1;this._filter_timer=window.setTimeout(function(){var e=r.getParentView().getChildViews()[s].$scope.$$("__page"),t=e.getValue();e.setValue(0==+t?"1":"0"),e.refresh()},e.config.searchDelay)}},webix.ui.datafilter.cFilt.refresh=function(e,t,i){t.component=e.config.id,e.registerFilter(t,i,this),t._comp_id=e.config.id,i.inputConfig&&(t._pager=i.inputConfig.pager),i.value&&this.getValue(t)!=i.value&&this.setValue(t,i.value),t.onclick=webix.html.preventEvent,w(t,"keydown",this.on_key_down)},webix.ui.datafilter.cFilt.render=function(e,t){return this.init&&this.init(t),t.css="my_filter","<input "+(t.placeholder?'placeholder="'+t.placeholder+'" ':"")+"type='text'>"};var t=e.config.searchDelay;setTimeout(ue,0*t,{app:e,type:"sync",method:"getRoles",store:"roles_dc"}),fe(e.config.r_url+"?getRefs",{user:e.config.user}).then(function(e){(e=m(e,"a"))&&($$("strana_dc").clearAll(),$$("strana_dc").parse(e.strana),$$("vendor_dc").clearAll(),$$("vendor_dc").parse(e.vendor),$$("dv_dc").clearAll(),$$("dv_dc").parse(e.dv),$$("nds_dc").clearAll(),$$("nds_dc").parse(e.nds),$$("hran_dc").clearAll(),$$("hran_dc").parse(e.hran),$$("sezon_dc").clearAll(),$$("sezon_dc").parse(e.sezon),$$("group_dc").clearAll(),$$("group_dc").parse(e.group),$$("allTg_dc").clearAll(),$$("allTg_dc").parse(e.tg),$$("allIs_dc").clearAll(),$$("allIs_dc").parse(e.issue))})}function se(e,t){var i=e.getRoot().getChildViews()[1].getChildViews()[2].getChildViews()[0].getChildViews()[3].getChildViews();i[0].clearAll();var o={_name:"",_count:"",_vendor:t||"",p_name:""};e.$$("_local_add")&&e.$$("_local_add").hide(),e.$$("_local_left").hide(),e.$$("_local_skip").hide(),e.$$("_local_right").hide(),e.$$("_local_link").hide(),e.$$("_local_names_bar").parse(o),e.$$("_local_spr_search").setValue("");var n=i[1];n.getChildViews()[6].define("label","Всего записей: 0"),n.getChildViews()[6].refresh(),n.$scope.$$("__page").config.manual=!1,n.$scope.$$("__page").setValue("1"),n.$scope.$$("__page").refresh(),n.getChildViews()[2].getChildViews()[2].define("label","1"),n.getChildViews()[2].getChildViews()[2].refresh()}function ae(e,t){var i=e.app.config.user;fe(e.app.config.r_url+"?getPrcs",{user:i,id_vnd:+t}).then(function(t){(t=m(t,"a"))?($$("prcs_dc").clearAll(),t.length>0?$$("prcs_dc").parse(t):se(e,"Товары у кого-то на сведении")):webix.message("error")})}function le(e,t){var i=e.app.config.user;fe(e.app.config.r_url+"?getPrcsSou",{user:i,source:+t}).then(function(t){(t=m(t,"a"))?($$("prcs_dc").clearAll(),t.length>0?$$("prcs_dc").parse(t):se(e,"Товары у кого-то на сведении")):webix.message("error")})}function ce(e,t){var i=e.app.config.user;fe(e.app.config.r_url+"?getPrcsDate",{user:i,date:t}).then(function(t){(t=m(t,"a"))?($$("prcs_dc").clearAll(),t.length>0?$$("prcs_dc").parse(t):se(e,"Товары у кого-то на сведении")):webix.message("error")})}function ue(e){var t=e.app,i=e.method,o=e.store,n=t.config.user,r=t.config.r_url+"?"+i,s={user:n};if("sync"!==e.type)fe(r,s).then(function(e){(e=m(e,"a"))?($$(o).clearAll(),$$(o).parse(e)):webix.message("error")});else{var a=fe(r,s,!0).response;(a=m(a,"s"))&&($$(o).clearAll(),$$(o).parse(a))}}function de(e,t,i){var o=t.app.config.user;fe(t.app.config.r_url+i,{user:o}).then(function(t){if(t=m(t,"a")){$$(e).getList().clearAll(),$$(e).getList().parse(t);var i=$$(e).getList().getFirstId();$$(e).setValue(i),$$(e).refresh()}})}function pe(e,t){console.log("params",e);var i=a.getCursor(),o=void 0;$$("prcs_dc").data.order.forEach(function(e,t,n){e===i&&(o=t)}),o===$$("prcs_dc").count()-1?o=0:o+=1;var n=$$("prcs_dc").data.order[+o];if(a.remove(i),a.count()<1)2==+$$("_link_by").getValue()?de("_suppl",t,"?getDatesUnlnk"):3==+$$("_link_by").getValue()?de("_suppl",t,"?getSourceUnlnk"):de("_suppl",t,"?getSupplUnlnk");else{a.setCursor(n),Q();var r=$$("_suppl").getList(),s=$$("_suppl").getValue(),l=r.getItem(s);l.count=l.count-1,r.updateItem(s,l),$$("_suppl").refresh()}}function he(e,t,i){403==i.status&&(be("linker-app"),be("linker_user"),be("linker_auth_key"),be("linker_role"),location.href="localhost"===location.hostname?"http://localhost:8080":"/linker/")}function fe(e,t,i){return!0===i?webix.ajax().sync().headers({"Content-type":"application/json"}).post(e,t,{error:he}):webix.ajax().timeout(9e4).headers({"Content-type":"application/json"}).post(e,t,{error:he})}function _e(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):NaN}function ge(e,t,i){var o=(i=i||{}).expires;if("number"==typeof o&&o){var n=new Date;n.setTime(n.getTime()+1e3*o),o=i.expires=n}o&&o.toUTCString&&(i.expires=o.toUTCString());var r=e+"="+(t=encodeURIComponent(t));for(var s in i){r+="; "+s;var a=i[s];!0!==a&&(r+="="+a)}document.cookie=r}function be(e){ge(e,"",{expires:-1,path:"/"})}function we(e){var t=e.$scope.app.config.eventS;if(t&&1===t.readyState)return!0;try{t.close()}catch(e){}return!1}function ve(e){if(-1===e.config.label.indexOf("fa-spin")){var t=e.config.label.replace("webix_icon","webix_icon fa-spin");e.define({label:t}),e.refresh()}}function $e(e){var t=e.config.label.replace(" fa-spin","");e.define({label:t}),e.refresh(),clearTimeout(e.config.qw)}function me(e,t){t.forEach(function(t,i,o){t.define({width:e.config.expert?t.config.eWidth:t.config.sWidth,label:e.config.expert?t.config.oldLabel:t.config.oldLabel+t.config.extLabel}),t.refresh(),t.resize()})}},function(e,t,i){"use strict";var o=function(){function e(){this.webixJet=!0,this._id=webix.uid(),this._events=[],this._subs={},this._data={}}return e.prototype.getRoot=function(){return this._root},e.prototype.destructor=function(){for(var e=this._events,t=e.length-1;t>=0;t--)e[t].obj.detachEvent(e[t].id);for(var i in this._subs){var o=this._subs[i].view;o&&o.destructor()}this._events=this._container=this.app=this._parent=null},e.prototype.setParam=function(e,t,i){var o;this._data[e]!==t&&(this._data[e]=t,this.app.callEvent("app:paramchange",[this,e,t,i])&&i&&this.show(((o={})[e]=t,o)))},e.prototype.getParam=function(e,t){var i=this._data[e];if(void 0!==i||!t)return i;var o=this.getParentView();return o?o.getParam(e,t):void 0},e.prototype.getUrl=function(){return this._url},e.prototype.render=function(e,t,i){var o=this;this._parent=i,t&&(this._index=t[0].index),this._init_url_data(t);var n="string"==typeof(e=e||document.body)?webix.toNode(e):e;return this._container!==n?(this._container=n,this._render(t).then(function(){return o.getRoot()})):this._urlChange(t).then(function(){return o.getRoot()})},e.prototype.getIndex=function(){return this._index},e.prototype.getId=function(){return this._id},e.prototype.getParentView=function(){return this._parent},e.prototype.$$=function(e){if("string"==typeof e){var t=this.getRoot();return t.queryView(function(i){return(i.config.id===e||i.config.localId===e)&&i.$scope===t.$scope},"self")}return e},e.prototype.on=function(e,t,i){var o=e.attachEvent(t,i);return this._events.push({obj:e,id:o}),o},e.prototype.contains=function(e){for(var t in this._subs){var i=this._subs[t].view;if(i===e||i.contains(e))return!0}return!1},e.prototype.getSubView=function(e){var t=this.getSubViewInfo(e);if(t)return t.subview.view},e.prototype.getSubViewInfo=function(e){var t=this._subs[e||"default"];return t?{subview:t,parent:this}:this._parent?this._parent.getSubViewInfo(e):null},e.prototype.getName=function(){return this._name},e.prototype._init_url_data=function(e){e&&e[0]&&(this._data={},webix.extend(this._data,e[0].params,!0)),this._url=e},e}();function n(e){"/"===e[0]&&(e=e.substr(1));for(var t=e.split("/"),i=[],o=0;o<t.length;o++){var n=t[o],r={},s=n.indexOf(":");if(-1===s&&(s=n.indexOf("?")),-1!==s)for(var a=0,l=n.substr(s+1).split(/[\:\?\&]/g);a<l.length;a++){var c=l[a].split("=");r[c[0]]=decodeURIComponent(c[1])}i[o]={page:s>-1?n.substr(0,s):n,params:r,index:o+1}}return i}function r(e){for(var t=[],i=0,o=e;i<o.length;i++){var n=o[i];t.push("/"+n.page);var r=s(n.params);r&&t.push("?"+r)}return t.join("")}function s(e){var t=[];for(var i in e)t.length&&t.push("&"),t.push(i+"="+encodeURIComponent(e[i]));return t.join("")}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),c=function(e){function t(t,i){var o=e.call(this)||this;return o.app=t,o._name=i,o._children=[],o}return l(t,e),t.prototype.ui=function(e,t){var i=(t=t||{}).container||e.container,n=this.app.createView(e);return this._children.push(n),n.render(i,null,this),"object"!==(void 0===e?"undefined":a(e))||e instanceof o?n:n.getRoot()},t.prototype.show=function(e,t){var i=this;if(t=t||{},"string"==typeof e){if("/"===e.substr(0,1))return this.app.show(e);if(0===e.indexOf("../")){var o=this.getParentView();return void(o?o.show("./"+e.substr(3),t):this.app.show("/"+e.substr(3)))}0===e.indexOf("./")&&(e=e.substr(2));var s=this.getSubViewInfo(t.target);if(!s)return this.app.show("/"+e);if(s.parent!==this)return s.parent.show(e,t)}var l=n(this.app.getRouter().get());if("object"===(void 0===e?"undefined":a(e)))if(webix.isArray(e)){var c=this._index+e[0];l[c]||(l[c]={}),l[c].page=e[1],e=""}else{var u=[];for(var d in e)u.push(encodeURIComponent(d)+"="+encodeURIComponent(e[d]));e="?"+u.join("&")}if("string"==typeof e){if("?"===e.substr(0,1)){var p=e.indexOf("/"),h=e;p>-1&&(h=e.substr(0,p));var f=n(h);webix.extend(l[this._index-1].params,f[0].params,!0),e=p>-1?e.substr(p+1):""}var _=""===e?l.slice(this._index):n(e),g=null;if(this._index){g=l.slice(0,this._index).concat(_);for(var b=0;b<g.length;b++)g[b].index=b+1;var w=r(g);return this.app.canNavigate(w,this).then(function(e){return null!==e?w!==e?i.app.show(e):i._finishShow(g,e):null})}return this._finishShow(_,"")}},t.prototype.init=function(e,t){},t.prototype.ready=function(e,t){},t.prototype.config=function(){this.app.webix.message("View:Config is not implemented")},t.prototype.urlChange=function(e,t){},t.prototype.destroy=function(){},t.prototype.destructor=function(){this.destroy(),this._destroyKids(),this.app=this._parentFrame=null,this._root.destructor(),e.prototype.destructor.call(this)},t.prototype.use=function(e,t){e(this.app,this,t)},t.prototype.refresh=function(){var e=this;this._destroyKids();var t=[];this._index>1&&(t=n(this.app.getRouter().get()).slice(this._index-1)),this._render(t).then(function(){e._parentFrame.id=e.getRoot().config.id})},t.prototype._render=function(e){var t=this,i=this.config();return i.then?i.then(function(i){return t._render_final(i,e)}):this._render_final(i,e)},t.prototype._render_final=function(e,t){var i,o=this,n=this._container;if(n&&n.$destructed)return Promise.reject("Container destroyed");var r={ui:{}};this.app.copyConfig(e,r.ui,this._subs),this.app.callEvent("app:render",[this,t,r]),r.ui.$scope=this;try{if(n&&n.getParentView){var s=n.getParentView();s&&"multiview"===s.name&&!r.ui.id&&(r.ui.id=n.config.id)}this._root=this.app.webix.ui(r.ui,this._container),this._root.getParentView()&&(this._container=this._root),this._init(this._root,t),i=this._urlChange(t).then(function(){return o.ready(o._root,t)})}catch(e){i=Promise.reject(e)}return i.catch(function(e){return o._initError(o,e)})},t.prototype._init=function(e,t){return this.init(e,t)},t.prototype._urlChange=function(e){var t=this;this.app.callEvent("app:urlchange",[this,e,this._index]);var i=[];for(var o in this._subs){var n=this._renderFrame(o,this._subs[o],e);n&&i.push(n)}return Promise.all(i).then(function(){t.urlChange(t._root,e)})},t.prototype._renderFrame=function(e,t,i){if(t.url){if("string"==typeof t.url){var o=n(t.url);return o.map(function(e){e.index=0}),this._createSubView(t,o)}var r=t.view;return"function"!=typeof t.url||r instanceof t.url||(r=new t.url(this.app,"")),r||(r=t.url),this._renderSubView(t,r,i)}if("default"===e&&i&&i.length>1){var s=i.slice(1);return this._createSubView(t,s)}},t.prototype._initError=function(e,t){return this.app.error("app:error:initview",[t,e]),!0},t.prototype._createSubView=function(e,t){var i=this;return this.app.createFromURL(t,e.view).then(function(o){return i._renderSubView(e,o,t)})},t.prototype._renderSubView=function(e,i,o){var n=this.app.webix.$$(e.id);return i.render(n,o,this).then(function(o){return e.view&&e.view!==i&&e.view.destructor(),e.view=i,e.id=o.config.id,i instanceof t&&(i._parentFrame=e),o})},t.prototype._finishShow=function(e,t){var i;return this._index?(i=this._renderPartial(e.slice(this._index-1)),this.app.getRouter().set(t,{silent:!0}),this.app.callEvent("app:route",[e])):(e.map(function(e){return e.index=0}),i=this._renderPartial([null].concat(e))),i},t.prototype._renderPartial=function(e){return this._init_url_data(e),this._urlChange(e)},t.prototype._destroyKids=function(){for(var e=this._children,t=e.length-1;t>=0;t--)e[t]&&e[t].destructor&&e[t].destructor();this._children=[]},t}(o),u=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),d=function(e){function t(t,i,o){var n=e.call(this,t,i)||this;return n._ui=o,n._windows=[],n}return u(t,e),t.prototype.getRoot=function(){if(this.app.config.jet1xMode){var e=this.getParentView();if(e)return e.getRoot()}return this._root},t.prototype.config=function(){return this._ui.$ui||this._ui},t.prototype.destructor=function(){var t=this._ui.$ondestroy;t&&t();for(var i=0,o=this._windows;i<o.length;i++){o[i].destructor()}e.prototype.destructor.call(this)},t.prototype.show=function(t,i){if(0===t.indexOf("/")||0===t.indexOf("./"))return e.prototype.show.call(this,t,i);e.prototype.show.call(this,"../"+t,i)},t.prototype.init=function(){this.app.config.legacyEarlyInit&&this._realInitHandler()},t.prototype.ready=function(){this.app.config.legacyEarlyInit||this._realInitHandler()},t.prototype._realInitHandler=function(){var e=this._ui.$oninit;if(e){var i=this.getRoot();e(i,i.$scope)}var o=this._ui.$onevent;if(o)for(var n in o)this.on(this.app,n,o[n]);var r=this._ui.$windows;if(r)for(var s=0,a=r;s<a.length;s++){var l=a[s];if(l.$ui){var c=new t(this.app,this.getName(),l);c.render(document.body),this._windows.push(c)}else this.ui(l)}},t.prototype._urlChange=function(t){var i=this;return e.prototype._urlChange.call(this,t).then(function(){var e=i._ui.$onurlchange;if(e){var o=i.getRoot();e(t[0].params,t.slice(1),o.$scope)}})},t}(c),p=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),h=function(e){function t(t,i,o){var n=e.call(this,t,i)||this;return n._ui=o,n}return p(t,e),t.prototype.config=function(){return this._ui},t}(c),f=i(58),_=i.n(f),g=function(){function e(e,t){var i=this;this.config=t||{},this._prefix=this.config.routerPrefix,void 0===this._prefix&&(this._prefix="!");var o=function(e){};_()(this._prefix+"*",function(){return i._lastUrl="",o(i.get())}),o=e}return e.prototype.set=function(e,t){if(this.config.routes){var i=e.split("?",2);for(var o in this.config.routes)if(this.config.routes[o]===i[0]){e=o+(i.length>1?"?"+i[1]:"");break}}this._lastUrl=e,_.a.navigate(this._prefix+e,t)},e.prototype.get=function(){var e=this._lastUrl||(window.location.hash||"").replace("#"+this._prefix,"");if(this.config.routes){var t=e.split("?",2),i=this.config.routes[t[0]];i&&(e=i+(t.length>1?"?"+t[1]:""))}return e},e}(),b=(i(80),"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}),w=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),v=function(e){function t(t){var i=e.call(this)||this;return i.webix=t.webix||webix,i.config=i.webix.extend({name:"App",version:"1.0",start:"/home"},t,!0),i._name=i.config.name,i._services={},webix.extend(i,webix.EventSystem),i}return w(t,e),t.prototype.getService=function(e){var t=this._services[e];return"function"==typeof t&&(t=this._services[e]=t(this)),t},t.prototype.setService=function(e,t){this._services[e]=t},t.prototype.copyConfig=function(e,t,i){if(e.$ui?e={$subview:new d(this,"",e)}:(e instanceof o||"function"==typeof e&&e.prototype instanceof o)&&(e={$subview:e}),e.$subview)return this.addSubView(e,t,i);for(var n in t=t||(e instanceof Array?[]:{}),e){var r=e[n];"function"==typeof r&&r.prototype instanceof o&&(r={$subview:r}),!r||"object"!==(void 0===r?"undefined":b(r))||r instanceof webix.DataCollection||r instanceof RegExp?t[n]=r:r instanceof Date?t[n]=new Date(r):t[n]=this.copyConfig(r,r instanceof Array?[]:{},i)}return t},t.prototype.getRouter=function(){return this.$router},t.prototype.clickHandler=function(e){if(e){var t=e.target||e.srcElement;if(t&&t.getAttribute){var i=t.getAttribute("trigger");i&&this.trigger(i);var o=t.getAttribute("route");o&&this.show(o)}}},t.prototype.refresh=function(){var e=this._container;this._view.destructor(),this._view=this._container=null,this.render(e,n(this.getRouter().get()),this._parent)},t.prototype.loadView=function(e){var t=this,o=this.config.views,n=null;if(""===e)return Promise.resolve(this._loadError("",new Error("Webix Jet: Empty url segment")));try{o&&"string"==typeof(n="function"==typeof o?o(e):o[e])&&(e=n,n=null),n||(e=e.replace(/\./g,"/"),n=i(81)("./"+e))}catch(t){n=this._loadError(e,t)}return n.then||(n=Promise.resolve(n)),n=n.then(function(e){return e.__esModule?e.default:e}).catch(function(i){return t._loadError(e,i)})},t.prototype.createFromURL=function(e,t){var i=this,o=e[0],n=o.page;return t&&t.getName()===n?Promise.resolve(t):this.loadView(o.page).then(function(e){return i.createView(e,n)})},t.prototype.createView=function(e,t){if("function"==typeof e){if(e.prototype instanceof o)return new e(this,t);e=e()}return e instanceof o?e:e.$ui?new d(this,t,e):new h(this,t,e)},t.prototype.show=function(e){return this.$router.get()!==e?this._render(e):Promise.resolve(!0)},t.prototype.canNavigate=function(e,t){var i={url:n(e),redirect:e,confirm:Promise.resolve(!0)};return this.callEvent("app:guard",[e,t||this._view,i])?i.confirm.catch(function(){return i.redirect=null}).then(function(){return i.redirect}):Promise.reject("")},t.prototype.destructor=function(){this._view.destructor()},t.prototype.trigger=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];this.apply(e,t)},t.prototype.apply=function(e,t){this.callEvent(e,t)},t.prototype.action=function(e){return this.webix.bind(function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];this.apply(e,t)},this)},t.prototype.on=function(e,t){this.attachEvent(e,t)},t.prototype.use=function(e,t){e(this,null,t)},t.prototype.error=function(e,t){if(this.callEvent(e,t),this.callEvent("app:error",t),this.config.debug)for(var i=0;i<t.length;i++)if(console.error(t[i]),t[i]instanceof Error){var o=t[i].message;0===o.indexOf("Module build failed")?(o=o.replace(/\x1b\[[0-9;]*m/g,""),document.body.innerHTML="<pre style='font-size:16px; background-color: #ec6873; color: #000; padding:10px;'>"+o+"</pre>"):(o+="<br><br>Check console for more details",webix.message({type:"error",text:o,expire:-1}))}},t.prototype._render=function(e){var t=this;!this.$router&&(webix.attachEvent("onClick",function(e){return t.clickHandler(e)}),e=this._first_start(e));var i="string"==typeof e?e:r(e);return this.canNavigate(i).then(function(e){return null!==e?(t.$router.set(e,{silent:!0}),t._render_stage(e)):null})},t.prototype._render_stage=function(e){var t=this,i="string"==typeof e?n(e):e;return webix.ui.freeze(function(){return t.createFromURL(i,t._view).then(function(e){var o=t._view;return t._view=e,e.render(t._container,i,t._parent).then(function(n){return o&&o!==t._view&&o.destructor(),t._view.getRoot().getParentView()&&(t._container=n),t._root=n,t.callEvent("app:route",[i]),e})}).catch(function(e){t.error("app:error:render",[e])})})},t.prototype._urlChange=function(e){return alert("Not implemented"),Promise.resolve(!0)},t.prototype._first_start=function(e){var t=this;if(this.$router=new(this.config.router||g)(function(e){return setTimeout(function(){t._render(e)},1)},this.config),this._container===document.body&&!1!==this.config.animation){var i=this._container;webix.html.addCss(i,"webixappstart"),setTimeout(function(){webix.html.removeCss(i,"webixappstart"),webix.html.addCss(i,"webixapp")},10)}return e&&1!==e.length||(e=this.$router.get()||this.config.start,this.$router.set(e,{silent:!0})),e},t.prototype._loadError=function(e,t){return this.error("app:error:resolve",[t,e]),{template:" "}},t.prototype.addSubView=function(e,t,i){var n=!0!==e.$subview?e.$subview:null,r=e.name||(n?this.webix.uid():"default");t.id=e.id||"s"+this.webix.uid();var s=i[r]={id:t.id,url:n};return s.url instanceof o&&(s.view=s.url),t},t}(o),$=(function(){function e(e,t){this.name=t.storeName||t.id+":route",this.cb=e}e.prototype.set=function(e,t){var i=this;webix.storage.session.put(this.name,e),t&&t.silent||setTimeout(function(){return i.cb(e)},1)},e.prototype.get=function(){return webix.storage.session.get(this.name)}}(),function(){function e(e,t){var i=this;this.cb=e,window.onpopstate=function(){return i.cb(i.get())},this.prefix=t.routerPrefix||""}e.prototype.set=function(e,t){var i=this;this.get()!==e&&window.history.pushState(null,null,this.prefix+e),t&&t.silent||setTimeout(function(){return i.cb(e)},1)},e.prototype.get=function(){var e=window.location.pathname.replace(this.prefix,"");return"/"!==e?e:""}}(),function(){function e(e,t){this.path="",this.cb=e}return e.prototype.set=function(e,t){var i=this;this.path=e,t&&t.silent||setTimeout(function(){return i.cb(e)},1)},e.prototype.get=function(){return this.path},e}());i(74);i.d(t,"b",function(){return v}),i.d(t,"c",function(){return c}),i.d(t,"a",function(){return $});window.Promise||(window.Promise=webix.promise)},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(0);var r=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this;this.app;return{view:"toolbar",height:36,css:"custom_tool_bar",parent:void 0,cols:[{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-angle-double-left'></span>",width:50,click:function(){e.$$("__page").setValue("1"),e.$$("__page").refresh()}},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-angle-left'></span>",width:50,click:function(){var t=+e.$$("__page").getValue()-1;t>0&&(e.$$("__page").setValue(t),e.$$("__page").refresh())}},{width:250,type:"wide",css:"lay_pg",cols:[{view:"text",label:"Страница",localId:"__page",labelWidth:70,width:150,value:"1",css:"raw_page",manual:!0,on:{onChange:function(t,i){if(e.$$("__page").config.manual){var o=void 0;o=1==+i&&0==+t?1:e.$$("__page").getValue();var r=e.getRoot().config.parent.config.posPpage,s=Math.ceil(e.getRoot().config.parent.config.totalPos/r);try{o=+o}catch(e){}if("number"==typeof o&&o>=0&&(s=o<=(0===s)?1:s)){var a=(o-1)*r+1,l=e.getRoot().config.parent;if(l){var c=Object(n.getDtParams)(l),u=void 0,d=void 0;try{u="__dtd"===e.getRoot().config.parent.$scope.getParentView().getRoot().getChildViews()[1].getChildViews()[0].config.name}catch(e){}u&&(d=1===e.checkbar.getValue()?"0,100":e.bnum.getValue()),Object(n.get_data_test)({view:e.getRoot().config.parent,navBar:e.getRoot(),start:a,count:c[1],searchBar:e.getRoot().config.parent.config.searchBar,method:e.getRoot().config.parent.config.searchMethod,field:c[2],direction:c[3],filter:c[0],cbars:d})}}}else e.$$("__page").config.manual=!0}}},{view:"label",label:"из",width:30},{view:"label",label:"1",width:50,css:"p_center_p"}]},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-angle-right'></span>",width:50,click:function(){var t=+e.$$("__page").getValue()+1;t<=Math.ceil(e.getRoot().config.parent.config.totalPos/e.getRoot().config.parent.config.posPpage)&&(e.$$("__page").setValue(t),e.$$("__page").refresh())}},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-angle-double-right'></span>",width:50,click:function(){var t=Math.ceil(e.getRoot().config.parent.config.totalPos/e.getRoot().config.parent.config.posPpage);e.$$("__page").setValue(t),e.$$("__page").refresh()}},{},{view:"label",label:"Всего записей: 0",width:180}]}},t.prototype.ready=function(e){var t=e.getParentView().getParentView().$scope.$$("_chbar"),i=e.getParentView().getParentView().$scope.$$("_bnum");t&&(this.checkbar=t),i&&(this.bnum=i)},t.prototype.init=function(e){this.getRoot().config.parent=e.getParentView().$scope.$$("__table")},t}(o.c);t.default=r},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(0);var r=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this;return{view:"cWindow",modal:!0,on:{onHide:function(){e.$$("_n_f").clear(),e.$$("_n_f").clearValidation()}},body:{view:"form",localId:"_n_f",_params:{},margin:0,rules:{id:function(e){var t=this.$scope.app.config.r_url+"?check"+this.config._params.type,i={};i.check=e,i.user=this.$scope.app.config.user;var o=!1,r=Object(n.request)(t,i,!0).response;return((r=Object(n.checkVal)(r,"s"))||this.config._params.text)&&(o=!0),o},text:webix.rules.isNotEmpty},elements:[{view:"text",localId:"_id",label:"ID",value:"",width:320,name:"id",placeholder:"Введите значение",readonly:!1,required:!0,invalidMessage:"Такой ID уже есть"},{view:"text",label:"Название",value:"",width:320,name:"text",placeholder:"Введите значение",required:!0,invalidMessage:"Введите название"},{height:15},{height:30,cols:[{view:"button",type:"base",label:"Отменить",width:120,click:function(){e.hide()}},{},{view:"button",type:"base",label:"Сохранить",width:120,click:function(){if(e.$$("_n_f").validate({hidden:!1,disabled:!1})){var t=e.$$("_n_f").getValues(),i={},o=e.$$("_n_f").config._params;i.value=t.text,i.user=e.app.config.user,i.id=o.text?o.id:t.id;var r="new"===o.mode?e.app.config.r_url+"?set"+o.type:e.app.config.r_url+"?upd"+o.type,s=Object(n.request)(r,i,!0).response;(s=Object(n.checkVal)(s,"s"))&&o.callback(s,o.source),e.hide()}}}]}]}}},t.prototype.show=function(e,t){if(this.$$("_n_f").config._params=t,this.getRoot().getHead().getChildViews()[0].setValue(e),this.$$("_id").define("readonly",!1),t.id_is){var i={text:t.text,id:t.id_is};this.$$("_n_f").parse(i),this.$$("_id").define("readonly",!0)}if(t.text){var o={text:t.text,id:t.id};this.$$("_n_f").parse(o),this.$$("_id").define("readonly",!0)}this.$$("_id").refresh(),this.getRoot().show()},t.prototype.hide=function(){this.getRoot().hide()},t.prototype.getValues=function(){return this.getRoot().getBody().getValues()},t}(o.c);t.default=r},function(e,t,i){"use strict";i.r(t);var o=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this;return{view:"cWindow",modal:!0,height:.8*document.documentElement.clientHeight,on:{onHide:function(){e.$$("_tb").clear(),e.$$("_hist").clearAll(),e.$$("_tb").reconstruct()}},body:{view:"toolbar",localId:"_tb",searchBar:void 0,cols:[{view:"list",localId:"_hist",width:.5*document.documentElement.clientWidth,select:!0,resizeColumn:!0,navigation:"row",editable:!1,on:{onItemDblClick:function(t){var i=e.$$("_tb").config.searchBar;t=e.$$("_hist").getItem(t).value,i.setValue(t),i.refresh(),e.getRoot().hide(),i.callEvent("onKeyPress",[13])}}},{}]}}},t.prototype.show=function(e,t){this.getRoot().getHead().getChildViews()[0].setValue("История поиска"),this.getRoot().show(),this.$$("_tb").config.searchBar=t,e&&this.$$("_hist").parse(e)},t.prototype.init=function(){},t}(i(1).c);t.default=o},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(10),r=i(6),s=i(11),a=i(12),l=i(0);var c=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e,t,i=this,o=this.app;function n(e){l.vendor.add(e,0)}function r(e){l.dv.add(e,0)}return{view:"cWindow",modal:!0,on:{onHide:function(){l.barcodes.clearAll(),this.$scope.$$("new_form").clear(),this.$scope.$$("new_form").reconstruct()}},body:{view:"form",localId:"new_form",margin:0,spr:!1,search_bar:void 0,rules:{c_tovar:webix.rules.isNotEmpty,id_strana:webix.rules.isNotEmpty,id_zavod:webix.rules.isNotEmpty,id_dv:webix.rules.isNotEmpty},elements:[{rows:[{view:"label",label:"Название товара:",name:"t_name"},{view:"text",label:"",value:"",name:"c_tovar",required:!0,css:"raw_text",localId:"inputTxt"},{height:10,width:700},{cols:[{rows:[{view:"label",label:"Страна:",name:"s_name"},{view:"combo",width:400,value:"",name:"id_strana",required:!0,options:{filter:function(e,t){return t=t.toString().toLowerCase(),t=new RegExp(".*"+t.replace(/ /g,".*")+".*"),-1!=e.c_strana.toString().toLowerCase().search(t)},body:{template:"#c_strana#",yCount:7}},on:{onAfterRender:function(){this.getList().sync(l.strana)},onChange:function(e,t,i){}}},{view:"label",label:"Производитель:",name:"v_name"},{cols:[{view:"combo",label:"",value:"",name:"id_zavod",required:!0,options:{filter:function(e,t){return t=t.toString().toLowerCase(),-1!=e.c_zavod.toString().toLowerCase().search(t)},body:{template:"#c_zavod#",yCount:7}},on:{onAfterRender:function(){this.getList().sync(l.vendor)}}},{view:"button",type:"base",label:"+",width:30,hidden:!o.config.roles[o.config.role].vendoradd,click:function(){var e={new_name:"c_zavod",url:"Zavod",callback:n};i.popstri.show("Добавление производителя",e)}}]},{view:"label",label:"Д. вещество:",name:"dv_name"},{cols:[{view:"combo",label:"",value:"",name:"id_dv",required:!0,options:{filter:function(e,t){return t=t.toString().toLowerCase(),t=new RegExp(".*"+t.replace(/ /g,".*")+".*"),-1!=e.act_ingr.toString().toLowerCase().search(t)},body:{autoheight:!1,view:"list",type:{height:"auto"},template:"<div class='comboList'>#act_ingr#</div>",height:200,yCount:0}},on:{onAfterRender:function(){this.getList().sync(l.dv)}}},{view:"button",type:"base",label:"+",width:30,hidden:!o.config.roles[o.config.role].vendoradd,click:function(){var e={new_name:"act_ingr",url:"Dv1",callback:r};i.popstri.show("Добавление д.вещества",e)}}]},{view:"label",label:"Форма выпуска:"},(e={view:"text",label:"",value:"",labelPosition:"left",readonly:!0,name:"issue",localId:"_issue",css:"raw_text"},e.readonly=!0,e.click=function(){var e=i.$$("new_form").getValues().id_spr;i.popis.show("Редактирование форм выпуска",e,i)},e),(t={view:"text",label:"Штрих-код:",value:"",labelPosition:"top",readonly:!0,name:"barcode",localId:"_barc",css:"raw_text"},t.readonly=!0,t.click=function(){var e=i.$$("new_form").getValues().id_spr;i.popbar.show("Редактирование ш.кодов",e,i)},t),{view:"text",label:"Товарная группа:",labelPosition:"top",value:"",name:"c_tgroup",localId:"_c_tgroup",css:"raw_text",readonly:!0,click:function(){var e=i.$$("new_form").getValues().id_spr;i.poptg.show("Редактирование товарных групп",e,i)}}]},{width:5},{rows:[{view:"form",css:"borders",localId:"new_f_right",elements:[{height:5},{cols:[{view:"checkbox",labelRight:"Рецептурный",labelWidth:0,align:"left",name:"_prescr"},{view:"checkbox",labelRight:"Обязательный",labelWidth:0,align:"left",name:"_mandat"}]},{view:"combo",label:"Сезон:",labelPosition:"top",value:"",name:"id_sezon",css:"small",options:{filter:function(e,t){return t=t.toString().toLowerCase(),t=new RegExp(".*"+t.replace(/ /g,".*")+".*"),-1!=e.sezon.toString().toLowerCase().search(t)},body:{template:"#sezon#",yCount:5}},on:{onAfterRender:function(){this.getList().sync(l.sezon)}}},{view:"combo",label:"Условия хранения:",labelPosition:"top",value:"",name:"id_usloviya",css:"small",options:{filter:function(e,t){return t=t.toString().toLowerCase(),t=new RegExp(".*"+t.replace(/ /g,".*")+".*"),-1!=e.usloviya.toString().toLowerCase().search(t)},body:{template:"#usloviya#",yCount:5}},on:{onAfterRender:function(){this.getList().sync(l.hran)}}},{view:"combo",label:"Группа:",labelPosition:"top",value:"",name:"id_group",css:"small",options:{filter:function(e,t){return t=t.toString().toLowerCase(),t=new RegExp(".*"+t.replace(/ /g,".*")+".*"),-1!=e.group.toString().toLowerCase().search(t)},body:{autoheight:!1,view:"list",type:{height:"auto"},template:"<div class='comboList'>#group#</div>",height:200,yCount:0}},on:{onAfterRender:function(){this.getList().sync(l.group)}}},{view:"combo",label:"НДС:",labelPosition:"top",value:"",name:"id_nds",css:"small",options:{body:{template:"#nds#",yCount:5}},on:{onAfterRender:function(){this.getList().sync(l.nds)}}}]}]}]},{cols:[{view:"button",type:"base",label:"Отменить",width:120,height:32,click:function(){i.hide()}},{},o.config.roles[o.config.role].spredit?{view:"button",type:"base",label:"Сохранить",width:120,height:32,hidden:!o.config.roles[o.config.role].spredit,click:function(){if(i.$$("new_form").validate({hidden:!1,disabled:!1})){var e=i.$$("new_form").getValues(),t=i.$$("new_f_right").getValues(),o={};o.id_spr=e.id_spr?e.id_spr:-1,o.barcode=e.barcode,o.issue=e.issue,o.c_tovar=e.c_tovar,o.id_strana=e.id_strana,o.id_zavod=e.id_zavod,o.id_dv=e.id_dv,o.c_opisanie=e.c_opisanie,o.prescr=1===t._prescr,o.mandat=1===t._mandat,o.id_sezon=t.id_sezon,o.id_usloviya=t.id_usloviya,o.id_group=t.id_group,o.id_nds=t.id_nds;var n=$$("prcs_dc").getCursor();n&&$$("prcs_dc").getItem(n).sh_prc?o.sh_prc=$$("prcs_dc").getItem(n).sh_prc||void 0:o.sh_prc=void 0,o.c_tgroup=e.c_tgroup,o.user=i.app.config.user;var r=i.app.config.r_url+"?setSpr",s=Object(l.request)(r,o,!0).response;(s=Object(l.checkVal)(s,"s"))&&s.new&&i.$$("new_form").config.spr?Object(l.delPrc)(o,i):i.$$("new_form").config.search_bar.callEvent("onKeyPress",[13]),i.$$("new_form").config.spr=!1,i.hide()}}}:{width:1}]}]}]}}},t.prototype.show=function(e,t,i){this.$$("new_form").config.search_bar=t,i&&(this.$$("new_form").parse(i),this.$$("new_f_right").parse(i),this.$$("new_form").config.spr=!0),this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show(),this.$$("inputTxt").focus()},t.prototype.hide=function(){this.getRoot().hide()},t.prototype.init=function(){this.popstri=this.ui(n.default),this.popbar=this.ui(r.default),this.poptg=this.ui(s.default),this.popis=this.ui(a.default)},t}(o.c);t.default=c},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(0),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this;return{view:"cWindow",modal:!0,on:{onHide:function(){e.$$("_nbar").setValue(""),e.$$("b_code").setValue("0000000000000"),e.$$("_n_b").reconstruct()},onShow:function(){e.$$("_nbar").setValue(""),e.$$("b_code").setValue("0000000000000");var t=e.$$("_n_b").config.id_spr;Object(n.get_bars)(e,t),e.$$("b_list").clearAll(),e.$$("b_list").parse(n.barcodes)}},body:{view:"form",localId:"_n_b",margin:0,id_spr:void 0,th:void 0,callback:void 0,elements:[{rows:[{cols:[{view:"text",label:"Название",value:"",name:"_new_bar",placeholder:"Введите новый штрихкод",localId:"_nbar",required:!1},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-plus'></span>",width:30,click:function(){if(function(e){var t=0;if(isNaN(e)||13!==e.length)return!1;for(var i=0;i<13;i++)t+=Number(e[i])*(i%2*2+1);return!(t%10)}(e.$$("_nbar").getValue())){var t={barcode:e.$$("_nbar").getValue()};e.$$("b_list").add(t),e.$$("_nbar").setValue("")}}}]},{cols:[{view:"activeList",activeContent:{deleteBut:{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-minus'></span>",width:30,click:function(t,i){var o=e.$$("b_list").locate(i);e.$$("b_list").callEvent("onItemDblClick",[o])}}},localId:"b_list",width:250,height:350,type:{height:32},template:"<div class ='barcode'>#barcode#</div><div class = 'butt1'>{common.deleteBut()}</div>",select:!0,on:{onAfterSelect:function(){var e=this.getSelectedItem();this.$scope.$$("b_code").setValue(e.barcode)},onItemDblClick:function(e){this.remove(e),this.$scope.$$("b_code").setValue("0000000000000")}}},{width:10},{rows:[{view:"barcode",type:"ean13",value:"0000000000000",width:300,name:"_new_",localId:"b_code",hieght:200},{}]}]},{height:10},{cols:[{view:"button",type:"base",label:"Отменить",width:120,click:function(){e.hide()}},{},{view:"button",type:"base",label:"Применить",width:120,click:function(){e.$$("b_list").selectAll();var t=e.$$("b_list").getSelectedItem(),i="",o=e.$$("_n_b").config.th,n=e.$$("_n_b").config.id_spr,s=e.$$("_n_b").config.callback;if(t){void 0===t||r(t);try{t.forEach(function(e,t,o){i+=e.barcode+" "})}catch(e){i=t.barcode}}o&&o.$$("_barc").setValue(i),s&&s(n,i),e.hide()}}]}]}]}}},t.prototype.show=function(e,t,i,o){this.$$("_n_b").config.id_spr=t,this.$$("_n_b").config.th=i,this.$$("_n_b").config.callback=o,this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show()},t.prototype.hide=function(){this.getRoot().hide()},t}(o.c);t.default=s},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(0);var r=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this;return{view:"cWindow",modal:!0,body:{view:"form",margin:0,_params:{},elements:[{view:"label",label:"Подтвердите",height:44,align:"center"},{cols:[{view:"button",type:"base",label:"Нет",width:120,height:44,click:function(){e.getRoot().getBody().config._params={},e.hide()}},{},{view:"button",type:"base",label:"Да",width:120,height:44,localId:"_yes"}]}],on:{onShow:function(){e.$$("_yes").focus()}}}}},t.prototype.show=function(e,t){this.getRoot().getHead().getChildViews()[0].setValue("Подтвердите действие"),t&&(this.getRoot().getBody().config._params=t,"?setLnk"===t.command)?this.getRoot().$scope.$$("_yes").callEvent("onItemClick"):(this.getRoot().getBody().getChildViews()[0].setValue(e),this.getRoot().show())},t.prototype.hide=function(){this.getRoot().hide()},t.prototype.getValues=function(){return this.getRoot().getBody().getValues()},t.prototype.init=function(){var e=this;this.$$("_yes").attachEvent("onItemClick",function(){var t=e.getRoot().getBody().config._params,i=t.sh_prc?t.sh_prc:void 0,o=e.app.config.user,r=e.app.config.r_url+t.command,s=t.type?t.type:void 0,a=t.action?t.action:"no_action",l=t.id_spr?t.id_spr:void 0,c=t.callback?t.callback:void 0,u=t.th?t.th:void 0,d={user:o,sh_prc:i,action:a,id_spr:l};e.hide(),"sync"===s||Object(n.request)(r,d).then(function(e){(e=Object(n.checkVal)(e,"a"))&&c&&c(e,u)})})},t}(o.c);t.default=r},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(0);var r=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this,t=this.app;function i(e,i){var o=e.getRoot().getBody().config._params,r=o.sh_prc,s=e.app.config.user,a=e.app.config.r_url+o.command,l=o.callback,c={user:s,sh_prc:r,action:i};e.hide(),"sync"===o.type?console.log("sync"):Object(n.request)(a,c).then(function(a){if((a=Object(n.checkVal)(a,"a"))&&(l&&l(a),"return"===i)){var c=Object(n.checkVal)(Object(n.request)(e.app.config.r_url+"?getPrcsItem",{user:s,sh_prc:r},!0).response,"s").datas;Object(n.parseToLink)(c),t.config.roles[t.config.role].skipped||o.parent.getRoot().getParentView().$scope.hide()}})}return{view:"cWindow",modal:!0,body:{view:"form",margin:0,_params:{},elements:[{view:"label",label:"Причина разрыва связкии",height:44,align:"center"},{cols:[{view:"button",type:"base",label:"Ошибка",width:120,height:44,click:function(){i(e,"return"),e._break.hide()}},{},{view:"button",type:"base",label:"Устарела",width:120,height:44,hidden:!t.config.roles[t.config.role].lnkdel,click:function(){i(e,"delete")}}]}]}}},t.prototype.show=function(e,t,i){this._break=i,this.getRoot().getHead().getChildViews()[0].setValue("Подтвердите действие"),t&&(this.getRoot().getBody().config._params=t),this.getRoot().getBody().getChildViews()[0].setValue(e),this.getRoot().show()},t.prototype.hide=function(){this.getRoot().hide()},t.prototype.getValues=function(){return this.getRoot().getBody().getValues()},t}(o.c);t.default=r},function(e,t,i){"use strict";i.r(t);var o=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this;return{view:"cWindow",modal:!0,body:{view:"form",margin:0,_params:{},on:{onShow:function(e){$$("_yes").focus()}},elements:[{view:"label",label:"Подтвердите",height:44,align:"center"},{cols:[{view:"button",type:"base",label:"Нет",width:120,height:44,click:function(){e.getRoot().getBody().config._params={},e.hide()}},{},{view:"button",type:"base",label:"Да",width:120,height:44,localId:"_yes",click:function(){var t=e.getRoot().getBody().config._params,i=t.callback?t.callback:void 0;e.hide(),i&&i(t.params)}}]}]}}},t.prototype.show=function(e,t){this.getRoot().getHead().getChildViews()[0].setValue("Подтвердите действие"),t&&(this.getRoot().getBody().config._params=t),this.getRoot().getBody().getChildViews()[0].setValue(e),this.getRoot().show()},t.prototype.hide=function(){this.getRoot().hide()},t}(i(1).c);t.default=o},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(0);var r=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this;return{view:"cWindow",modal:!0,on:{onHide:function(){e.$$("_n_f").clear(),e.$$("_n_f").clearValidation()}},body:{view:"form",localId:"_n_f",_params:{},margin:0,rules:{_new_str:function(e){var t=this.config._params,i=this.$scope.app.config.r_url+"?check"+t.url,o={};o[t.new_name]=e,o.user=this.$scope.app.config.user;var r=Object(n.request)(i,o,!0).response,s=!1;return(r=Object(n.checkVal)(r,"s"))&&(s=!0),s}},elements:[{view:"text",label:"Название",value:"",width:320,name:"_new_str",required:!0,placeholder:"Введите новое значение",invalidMessage:"Такое название уже есть"},{cols:[{view:"button",type:"base",label:"Отменить",width:120,click:function(){e.hide()}},{},{view:"button",type:"base",label:"Сохранить",width:120,click:function(){if(e.$$("_n_f").validate({hidden:!1,disabled:!1})){var t=e.$$("_n_f").getValues(),i={},o=e.$$("_n_f").config._params;i[o.new_name]=t._new_str,i.user=e.app.config.user,i.id_spr=!!o.id_spr&&o.id_spr;var r=e.app.config.r_url+"?set"+o.url,s=Object(n.request)(r,i,!0).response;(s=Object(n.checkVal)(s,"s"))&&o.callback(s),e.hide()}}}]}]}}},t.prototype.show=function(e,t){this.$$("_n_f").config._params=t,this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show()},t.prototype.hide=function(){this.getRoot().hide()},t.prototype.getValues=function(){return this.getRoot().getBody().getValues()},t}(o.c);t.default=r},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(0),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this;return{view:"cWindow",modal:!0,on:{onHide:function(){e.$$("_filt").setValue(""),e.$$("t_list").clearAll(),e.$$("e_list").clearAll(),e.$$("_n_tg").reconstruct()},onShow:function(){e.$$("_filt").setValue("");var t=e.$$("_n_tg").config.id_spr;Object(n.get_tg)(e,t);var i=e.$$("e_list");i.clearAll(!0),e.$$("t_list").clearAll(),e.$$("t_list").parse(n.tg);var o=n.allTg.data.order;o.forEach(function(e,t,o){i.add(n.allTg.getItem(e))}),(o=e.$$("t_list").data.order).forEach(function(e,t,o){i.remove(e)}),e.$$("_filt").focus()}},body:{view:"form",localId:"_n_tg",margin:0,id_spr:void 0,th:void 0,callback:void 0,elements:[{rows:[{view:"text",label:"Название",value:"",name:"_filter",placeholder:"Введите название группы",localId:"_filt",on:{onTimedKeyPress:function(e,t){var i=this.getValue().toString().toLowerCase();this.$scope.$$("e_list").filter("c_tgroup",i)}}},{cols:[{rows:[{view:"label",label:"Товарные группы"},{view:"list",localId:"t_list",width:350,height:.7*document.documentElement.clientHeight,template:"#c_tgroup#",select:!0,on:{onItemDblClick:function(e){var t=this.getItem(e);this.remove(e),this.$scope.$$("e_list").add(t),this.$scope.$$("e_list").sort("c_tgroup","asc")}}}]},{width:10},{rows:[{view:"label",label:"Все товарные группы"},{view:"list",localId:"e_list",width:350,template:"#c_tgroup#",select:!0,on:{onItemDblClick:function(e){var t=this.getItem(e);this.remove(e),this.$scope.$$("t_list").add(t),this.$scope.$$("t_list").sort("c_tgroup","asc")}}}]}]},{height:10},{cols:[{view:"button",type:"base",label:"Отменить",width:120,click:function(){e.hide()}},{},{view:"button",type:"base",label:"Применить",width:120,click:function(){e.$$("t_list").selectAll();var t=e.$$("t_list").getSelectedItem(),i="",o=e.$$("_n_tg").config.th,n=e.$$("_n_tg").config.id_spr,s=e.$$("_n_tg").config.callback;if(t){void 0===t||r(t);try{t.forEach(function(e,t,o){i+=e.c_tgroup+"; "})}catch(e){i=t.c_tgroup}}o&&(o.$$("_c_tgroup").setValue(i),o.$$("_c_tgroup").refresh()),s&&s(n,i),e.hide()}}]}]}]}}},t.prototype.show=function(e,t,i,o){this.$$("_n_tg").config.id_spr=t,this.$$("_n_tg").config.th=i,this.$$("_n_tg").config.callback=o,this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show()},t.prototype.hide=function(){this.getRoot().hide()},t}(o.c);t.default=s},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(0),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this;this.app;return{view:"cWindow",modal:!0,on:{onHide:function(){},onShow:function(){}},body:{view:"form",localId:"_n_is",margin:0,id_spr:void 0,th:void 0,callback:void 0,elements:[{rows:[{view:"text",label:"Название",value:"",name:"_filter",placeholder:"Введите форму выпуска",localId:"_filt",on:{onTimedKeyPress:function(e,t){var i=this.getValue().toString().toLowerCase();this.$scope.$$("__e_table").filter("c_issue",i)}}},{cols:[{rows:[{view:"label",label:"Формы выпуска"},{view:"list",localId:"__table",width:350,height:.7*document.documentElement.clientHeight,template:"#c_issue#",select:!0,on:{onItemDblClick:function(e){var t=this.getItem(e);this.remove(e),this.$scope.$$("__e_table").add(t),this.$scope.$$("__e_table").sort("c_issue","asc")}}}]},{width:10},{rows:[{view:"label",label:"Все формы выпуска"},{view:"list",localId:"__e_table",width:350,template:"#c_issue#",select:!0,on:{onItemDblClick:function(e){var t=this.getItem(e);this.remove(e),this.$scope.$$("__table").add(t),this.$scope.$$("__table").sort("c_issue","asc")}}}]}]},{height:10},{cols:[{view:"button",type:"base",label:"Отменить",width:120,click:function(){e.hide()}},{},{view:"button",type:"base",label:"Применить",width:120,click:function(){e.$$("__table").selectAll();var t=e.$$("__table").getSelectedItem(),i="",o=e.$$("_n_is").config.th,n=e.$$("_n_is").config.id_spr,s=e.$$("_n_is").config.callback;if(t){void 0===t||r(t);try{t.forEach(function(e,t,o){i+=e.c_issue+"; "})}catch(e){i=t.c_issue}}o&&(o.$$("_issue").setValue(i),o.$$("_issue").refresh()),s&&s(n,i),e.hide()}}]}]}]}}},t.prototype.show=function(e,t,i,o){var r=this;this.$$("__e_table").clearAll(),this.$$("_n_is").reconstruct(),this.$$("__table").clearAll(),this.$$("_filt").setValue(""),this.$$("_n_is").config.id_spr=t,this.$$("_n_is").config.th=i,this.$$("_n_is").config.callback=o,this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show();var s=this.app.config.r_url+"?getIs",a={user:this.app.config.user,id_spr:t},l=Object(n.request)(s,a,!0).response;(l=Object(n.checkVal)(l,"s"))&&this.$$("__table").parse(l);var c=n.allIs.data.order;c.forEach(function(e,t,i){r.$$("__e_table").add(n.allIs.getItem(e))}),(c=this.$$("__table").data.order).forEach(function(e,t,i){r.$$("__e_table").remove(e)}),this.$$("_filt").focus()},t.prototype.hide=function(){this.getRoot().hide()},t}(o.c);t.default=s},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(10),r=i(6),s=i(11),a=i(12),l=i(0);var c=function(e){function t(i,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,i));return n.customData=o,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e,t,i=this,o=this.app;function n(e){l.vendor.add(e,0)}function r(e){l.dv.add(e,0)}return{cols:[{width:160},{view:"form",css:"no_border",localId:"new_form",margin:0,spr:!1,search_bar:void 0,rules:{c_tovar:webix.rules.isNotEmpty,id_strana:webix.rules.isNotEmpty,id_zavod:webix.rules.isNotEmpty,id_dv:webix.rules.isNotEmpty},elements:[{view:"label",label:"",name:"idspr",css:{"margin-top":"0px !important"}},{rows:[{view:"label",label:"Название товара:",name:"t_name"},{view:"text",label:"",value:"",name:"c_tovar",required:!0,css:"raw_text"},{height:10,width:1e3},{cols:[{rows:[{cols:[{rows:[{view:"label",label:"Страна:",name:"s_name"},{view:"combo",width:350,value:"",name:"id_strana",required:!0,options:{filter:function(e,t){return t=t.toString().toLowerCase(),t=new RegExp(".*"+t.replace(/ /g,".*")+".*"),-1!=e.c_strana.toString().toLowerCase().search(t)},body:{template:"#c_strana#",yCount:7}},on:{onAfterRender:function(){this.getList().sync(l.strana)}}}]},{rows:[{view:"label",label:"Производитель:",name:"v_name"},{cols:[{view:"combo",width:320,label:"",value:"",name:"id_zavod",required:!0,options:{filter:function(e,t){return t=t.toString().toLowerCase(),-1!=e.c_zavod.toString().toLowerCase().search(t)},body:{template:"#c_zavod#",yCount:7}},on:{onAfterRender:function(){this.getList().sync(l.vendor)}}},{view:"button",type:"base",label:"+",width:30,hidden:!o.config.roles[o.config.role].vendoradd,click:function(){var e={new_name:"c_zavod",url:"Zavod",callback:n};i.popstri.show("Добавление производителя",e)}}]}]}]},{cols:[{rows:[{view:"label",label:"Д. вещество:",name:"dv_name"},{cols:[{view:"combo",label:"",value:"",name:"id_dv",required:!0,options:{filter:function(e,t){return t=t.toString().toLowerCase(),t=new RegExp(".*"+t.replace(/ /g,".*")+".*"),-1!=e.act_ingr.toString().toLowerCase().search(t)},body:{autoheight:!1,view:"list",type:{height:"auto",width:"auto"},template:"<div class='comboList'>#act_ingr#</div>",height:200,yCount:0}},on:{onAfterRender:function(){this.getList().sync(l.dv)}}},{view:"button",type:"base",label:"+",width:30,hidden:!o.config.roles[o.config.role].vendoradd,click:function(){var e={new_name:"act_ingr",url:"Dv1",callback:r};i.popstri.show("Добавление д.вещества",e)}}]}]},{rows:[{view:"label",label:"Форма выпуска:"},(e={view:"text",label:"",value:"",labelPosition:"left",readonly:!0,name:"issue",localId:"_issue",css:"raw_text"},e.readonly=!0,e.click=function(){var e=i.$$("new_form").getValues().id_spr;i.popis.show("Редактирование форм выпуска",e,i)},e)]}]},{rows:[{view:"label",label:"Штрих-код:"},(t={view:"text",label:"",value:"",labelPosition:"left",readonly:!0,name:"barcode",localId:"_barc",css:"raw_text"},t.readonly=!0,t.click=function(){var e=i.$$("new_form").getValues().id_spr;i.popbar.show("Редактирование ш.кодов",e,i)},t)]},{rows:[{view:"label",label:"Товарная группа:"},{view:"text",label:"",labelPosition:"left",value:"",name:"c_tgroup",localId:"_c_tgroup",css:"raw_text",readonly:!0,click:function(){var e=i.$$("new_form").getValues().id_spr;i.poptg.show("Редактирование товарных групп",e,i)}}]}]},{width:5},{rows:[{type:"form",css:"borders",localId:"new_f_right",rows:[{css:{"margin-top":"0px !important;"},cols:[{view:"checkbox",labelRight:"Рецептурный",labelWidth:0,align:"left",name:"_prescr"},{view:"checkbox",labelRight:"Обязательный",labelWidth:0,align:"left",name:"_mandat"}]},{view:"combo",label:"Сезон:",labelPosition:"top",value:"",name:"id_sezon",css:"small",options:{filter:function(e,t){return t=t.toString().toLowerCase(),t=new RegExp(".*"+t.replace(/ /g,".*")+".*"),-1!=e.sezon.toString().toLowerCase().search(t)},body:{template:"#sezon#",yCount:5}},on:{onAfterRender:function(){this.getList().sync(l.sezon)}}},{view:"combo",label:"Условия хранения:",labelPosition:"top",value:"",name:"id_usloviya",css:"small",options:{filter:function(e,t){return t=t.toString().toLowerCase(),t=new RegExp(".*"+t.replace(/ /g,".*")+".*"),-1!=e.usloviya.toString().toLowerCase().search(t)},body:{template:"#usloviya#",yCount:5}},on:{onAfterRender:function(){this.getList().sync(l.hran)}}},{view:"combo",label:"Группа:",labelPosition:"top",value:"",name:"id_group",css:"small",options:{filter:function(e,t){return t=t.toString().toLowerCase(),t=new RegExp(".*"+t.replace(/ /g,".*")+".*"),-1!=e.group.toString().toLowerCase().search(t)},body:{autoheight:!1,view:"list",type:{height:"auto"},template:"<div class='comboList'>#group#</div>",height:200,yCount:0}},on:{onAfterRender:function(){this.getList().sync(l.group)}}},{view:"combo",label:"НДС:",labelPosition:"top",value:"",name:"id_nds",css:"small",options:{body:{template:"#nds#",yCount:5}},on:{onAfterRender:function(){this.getList().sync(l.nds)}}}]}]}]},{cols:[{view:"button",type:"base",label:"Отменить",width:120,height:32,hidden:!1,click:function(){i.customData.dt.closeSub(i.customData.item.id)}},{},{view:"button",type:"base",label:"Сохранить",width:120,height:32,hidden:!o.config.roles[o.config.role].spredit,click:function(){if(i.$$("new_form").validate({hidden:!1,disabled:!1})){var e=i.$$("new_form").getValues(),t={};t.id_spr=e.id_spr?e.id_spr:-1,t.barcode=e.barcode,t.issue=e.issue,t.c_tovar=e.c_tovar,t.id_strana=e.id_strana,t.id_zavod=e.id_zavod,t.id_dv=e.id_dv,t.c_opisanie=e.c_opisanie,t.prescr=1===e._prescr,t.mandat=1===e._mandat,t.id_sezon=e.id_sezon,t.id_usloviya=e.id_usloviya,t.id_group=e.id_group,t.id_nds=e.id_nds;var o=$$("prcs_dc").getCursor();o&&$$("prcs_dc").getItem(o).sh_prc?t.sh_prc=$$("prcs_dc").getItem(o).sh_prc||void 0:t.sh_prc=void 0,t.c_tgroup=e.c_tgroup,t.user=i.app.config.user;var n=i.app.config.r_url+"?setSpr",r=Object(l.request)(n,t,!0).response;if((r=Object(l.checkVal)(r,"s"))&&r.new&&i.$$("new_form").config.spr)Object(l.delPrc)(t,i);else{var s=+i.$$("new_form").config.pag.getValue();i.$$("new_form").config.pag.callEvent("onChange",[s,s+1]),l.barcodes.clearAll(),i.$$("new_form").clear(),i.$$("new_form").reconstruct()}i.$$("new_form").config.spr=!1,i.customData.dt.focusEditor()}}}]}]}]}]}},t.prototype.ready=function(e){this.$$("new_form").config.search_bar=this.customData.search_bar,this.$$("new_form").config.dt=this.customData.dt,this.$$("new_form").config.pag=this.customData.pager;var t=this.customData.item,i=this.customData.header;t&&(i&&(t.idspr=i),this.$$("new_form").parse(t),this.$$("new_form").config.spr=!0)},t.prototype.init=function(){this.popstri=this.ui(n.default),this.popbar=this.ui(r.default),this.poptg=this.ui(s.default),this.popis=this.ui(a.default)},t}(o.c);t.default=c},function(e,t,i){var o;"function"==typeof Symbol&&Symbol.iterator;!function(n){"use strict";function r(e,t){var i=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(i>>16)<<16|65535&i}function s(e,t,i,o,n,s){return r(function(e,t){return e<<t|e>>>32-t}(r(r(t,e),r(o,s)),n),i)}function a(e,t,i,o,n,r,a){return s(t&i|~t&o,e,t,n,r,a)}function l(e,t,i,o,n,r,a){return s(t&o|i&~o,e,t,n,r,a)}function c(e,t,i,o,n,r,a){return s(t^i^o,e,t,n,r,a)}function u(e,t,i,o,n,r,a){return s(i^(t|~o),e,t,n,r,a)}function d(e,t){var i,o,n,s,d;e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;var p=1732584193,h=-271733879,f=-1732584194,_=271733878;for(i=0;i<e.length;i+=16)o=p,n=h,s=f,d=_,h=u(h=u(h=u(h=u(h=c(h=c(h=c(h=c(h=l(h=l(h=l(h=l(h=a(h=a(h=a(h=a(h,f=a(f,_=a(_,p=a(p,h,f,_,e[i],7,-680876936),h,f,e[i+1],12,-389564586),p,h,e[i+2],17,606105819),_,p,e[i+3],22,-1044525330),f=a(f,_=a(_,p=a(p,h,f,_,e[i+4],7,-176418897),h,f,e[i+5],12,1200080426),p,h,e[i+6],17,-1473231341),_,p,e[i+7],22,-45705983),f=a(f,_=a(_,p=a(p,h,f,_,e[i+8],7,1770035416),h,f,e[i+9],12,-1958414417),p,h,e[i+10],17,-42063),_,p,e[i+11],22,-1990404162),f=a(f,_=a(_,p=a(p,h,f,_,e[i+12],7,1804603682),h,f,e[i+13],12,-40341101),p,h,e[i+14],17,-1502002290),_,p,e[i+15],22,1236535329),f=l(f,_=l(_,p=l(p,h,f,_,e[i+1],5,-165796510),h,f,e[i+6],9,-1069501632),p,h,e[i+11],14,643717713),_,p,e[i],20,-373897302),f=l(f,_=l(_,p=l(p,h,f,_,e[i+5],5,-701558691),h,f,e[i+10],9,38016083),p,h,e[i+15],14,-660478335),_,p,e[i+4],20,-405537848),f=l(f,_=l(_,p=l(p,h,f,_,e[i+9],5,568446438),h,f,e[i+14],9,-1019803690),p,h,e[i+3],14,-187363961),_,p,e[i+8],20,1163531501),f=l(f,_=l(_,p=l(p,h,f,_,e[i+13],5,-1444681467),h,f,e[i+2],9,-51403784),p,h,e[i+7],14,1735328473),_,p,e[i+12],20,-1926607734),f=c(f,_=c(_,p=c(p,h,f,_,e[i+5],4,-378558),h,f,e[i+8],11,-2022574463),p,h,e[i+11],16,1839030562),_,p,e[i+14],23,-35309556),f=c(f,_=c(_,p=c(p,h,f,_,e[i+1],4,-1530992060),h,f,e[i+4],11,1272893353),p,h,e[i+7],16,-155497632),_,p,e[i+10],23,-1094730640),f=c(f,_=c(_,p=c(p,h,f,_,e[i+13],4,681279174),h,f,e[i],11,-358537222),p,h,e[i+3],16,-722521979),_,p,e[i+6],23,76029189),f=c(f,_=c(_,p=c(p,h,f,_,e[i+9],4,-640364487),h,f,e[i+12],11,-421815835),p,h,e[i+15],16,530742520),_,p,e[i+2],23,-995338651),f=u(f,_=u(_,p=u(p,h,f,_,e[i],6,-198630844),h,f,e[i+7],10,1126891415),p,h,e[i+14],15,-1416354905),_,p,e[i+5],21,-57434055),f=u(f,_=u(_,p=u(p,h,f,_,e[i+12],6,1700485571),h,f,e[i+3],10,-1894986606),p,h,e[i+10],15,-1051523),_,p,e[i+1],21,-2054922799),f=u(f,_=u(_,p=u(p,h,f,_,e[i+8],6,1873313359),h,f,e[i+15],10,-30611744),p,h,e[i+6],15,-1560198380),_,p,e[i+13],21,1309151649),f=u(f,_=u(_,p=u(p,h,f,_,e[i+4],6,-145523070),h,f,e[i+11],10,-1120210379),p,h,e[i+2],15,718787259),_,p,e[i+9],21,-343485551),p=r(p,o),h=r(h,n),f=r(f,s),_=r(_,d);return[p,h,f,_]}function p(e){var t,i="",o=32*e.length;for(t=0;t<o;t+=8)i+=String.fromCharCode(e[t>>5]>>>t%32&255);return i}function h(e){var t,i=[];for(i[(e.length>>2)-1]=void 0,t=0;t<i.length;t+=1)i[t]=0;var o=8*e.length;for(t=0;t<o;t+=8)i[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return i}function f(e){var t,i,o="";for(i=0;i<e.length;i+=1)t=e.charCodeAt(i),o+="0123456789abcdef".charAt(t>>>4&15)+"0123456789abcdef".charAt(15&t);return o}function _(e){return unescape(encodeURIComponent(e))}function g(e){return function(e){return p(d(h(e),8*e.length))}(_(e))}function b(e,t){return function(e,t){var i,o,n=h(e),r=[],s=[];for(r[15]=s[15]=void 0,n.length>16&&(n=d(n,8*e.length)),i=0;i<16;i+=1)r[i]=909522486^n[i],s[i]=1549556828^n[i];return o=d(r.concat(h(t)),512+8*t.length),p(d(s.concat(o),640))}(_(e),_(t))}function w(e,t,i){return t?i?b(t,e):function(e,t){return f(b(e,t))}(t,e):i?g(e):function(e){return f(g(e))}(e)}void 0===(o=function(){return w}.call(t,i,t,e))||(e.exports=o)}()},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(21),r=i(0);var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){return{view:"layout",css:"margin-zero",rows:[{$subview:n.default,name:"top_menu"},{$subview:!0}]}},t.prototype.ready=function(e){this.show("adm-linker")},t.prototype.init=function(){var e=this.app,t=e.config.searchDelay;setTimeout(r.get_refs,0*t,{app:e,type:"async",method:"getRoles",store:"roles_dc"})},t}(o.c);t.default=s},function(e,t,i){"use strict";i.r(t);var o=i(1),n=(i(0),i(37)),r=i(23),s=i(39),a=i(24),l=i(22),c=i(26),u=i(27),d=i(36),p=i(40),h=i(28);var f=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){this.app;return{view:"layout",type:"clean",rows:[{view:"toolbar",height:40,css:{"border-top":"0px"},cols:[{},{}]},{height:3},{view:"tabview",multiview:!0,cells:[{header:"<span style='line-height: 20px;'>Эталоны</span>",width:120,body:{view:"layout",rows:[{$subview:n.default}]}},{header:"<span style='line-height: 20px;'>Формы выпуска</span>",width:120,body:{view:"layout",rows:[{$subview:h.default}]}},{header:"<span style='line-height: 20px;'>Страны</span>",width:120,body:{view:"layout",rows:[{$subview:r.default}]}},{header:"<span style='line-height: 20px;'>Производители</span>",width:120,body:{view:"layout",rows:[{$subview:s.default}]}},{header:"<span style='line-height: 20px;'>ДВ</span>",width:120,body:{view:"layout",rows:[{$subview:a.default}]}},{header:"<span style='line-height: 20px;'>Штрихкоды</span>",width:120,body:{view:"layout",rows:[{$subview:l.default}]}},{header:"<span style='line-height: 20px;'>Группы</span>",width:120,body:{view:"layout",rows:[{$subview:c.default}]}},{header:"<span style='line-height: 20px;'>Условия хранения</span>",width:140,body:{view:"layout",rows:[{$subview:u.default}]}},{header:"<span style='line-height: 20px;'>НДС</span>",width:120,body:{view:"layout",rows:[{$subview:d.default}]}},{header:"<span style='line-height: 20px;'>Сезоны</span>",width:120,body:{view:"layout",rows:[{$subview:p.default}]}}]}]}},t}(o.c);t.default=f},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(0),r=i(7),s=i(2);var a=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e,t=this,i=this.app,o=this,r=function(){var e=t.$$("__table").getSelectedId();t.$$("__table").remove(e)},a=i.config.r_url+"?getSupplAll",l={user:i.config.user},c=Object(n.checkVal)(Object(n.request)(a,l,!0).response,"s"),u=[];c&&(u=c);var d={view:"datatable",name:"__dt_s",localId:"__table",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:{autowidth:!0},startPos:1,posPpage:i.config.posPpage,totalPos:1250,old_stri:" ",searchBar:void 0,searchMethod:"getPrcsSkip",fi:"c_tovar",di:"asc",columns:[{id:"id_tovar",width:80,hidden:!0,header:[{text:"ID товара"}]},{id:"sh_prc",width:280,hidden:!0,header:[{text:"sh_prc"},{content:"cFilt",inputConfig:{pager:2}}]},{id:"c_tovar",fillspace:1,sort:"server",headermenu:!1,header:[{text:"Название"},{content:"cFilt",inputConfig:{pager:2}}]},{id:"c_vnd",sort:"server",width:200,header:[{text:"Поставщик"},{content:"richFilt",compare:n.compareTrue,inputConfig:{inputtype:"combo",options:{filter:n.mcf_filter,data:u}}}]},{id:"c_zavod",sort:"server",width:200,header:[{text:"Производитель"},{content:"cFilt",inputConfig:{pager:2}}]},{id:"dt",width:200,sort:"server",format:n.dt_formating_sec,css:"center_p",header:[{text:"Дата изменения"},{content:"dateRangeFilter",compare:n.compareTrue,inputConfig:{format:n.dt_formating,width:180},suggest:{view:"daterangesuggest",body:{timepicker:!1,calendarCount:2}}}]},{id:"source",width:150,hidden:!0,header:[{text:"Источник"},{content:"richFilt",compare:n.compareTrue,inputConfig:{pager:2,options:[{id:"0",value:"Без источника"},{id:"1",value:"PLExpert"},{id:"2",value:"Склад"},{id:"3",value:"Агент"},{id:"4",value:"edocs"}]}}]},{id:"id_org",width:100,hidden:!0,header:[{text:"id_org"},{content:"cFilt",inputConfig:{pager:2}}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onBeforeSort:function(e,i){t.$$("__table").config.fi=e,t.$$("__table").config.di=i;var n=o.getRoot().getChildViews()[2].$scope.$$("__page").getValue();o.getRoot().getChildViews()[2].$scope.$$("__page").setValue(0==+n?"1":"0"),o.getRoot().getChildViews()[2].$scope.$$("__page").refresh()},onItemDblClick:function(e){this.$scope.app.config.user;var t=this.$scope.app;if(t.config.roles[t.config.role].adm){var i=this.getSelectedItem().sh_prc,o={command:"?returnLnk"};o.sh_prc=i,o.type="async",o.callback=r,this.$scope.popconfirm.show("Вернуть на сведение?",o)}},onKeyPress:function(e,t){"text"!==document.activeElement.type&&13===e&&this.getSelectedItem()&&this.callEvent("onItemDblClick")},onAfterLoad:function(){this.hideProgress()}}};return{view:"layout",type:"clean",rows:[{rows:[{view:"toolbar",css:{"border-top":"0px"},height:40,cols:[{},{view:"button",type:"htmlbutton",tooltip:"Обновить",localId:"_renew",resizable:!0,sWidth:136,eWidth:40,label:"",width:40,extLabel:"<span style='line-height: 20px;padding-left: 5px'>Обновить</span>",oldLabel:"<span class='webix_icon fa-refresh'></span>",click:function(){t.$$("__table").callEvent("onBeforeSort")}},(e={view:"button",tooltip:"Сбросить фильтры",type:"imageButton",image:"./addons/img/unfilter.svg",width:40,localId:"_unfilt",resizable:!0,sWidth:180,eWidth:40,label:""},e.width=40,e.extLabel="<span style='line-height: 20px;padding-left: 5px'>Сбросить фильтры</span>",e.oldLabel="",e.click=function(){var e=t.$$("__table");e.config.columns.forEach(function(t){if(e.isColumnVisible(t.id)&&t.header[1])if("function"==typeof e.getFilter(t.id).setValue)e.getFilter(t.id).setValue("");else{var i=e.getFilter(t.id);i.readOnly||(i.value="")}}),t.$$("__table").callEvent("onBeforeSort")},e)]},{height:3}]},d,{$subview:s.default}]}},t.prototype.ready=function(){var e=[this.$$("_renew"),this.$$("_unfilt")];Object(n.setButtons)(this.app,e);var t=this.getRoot().getChildViews()[2].$scope.$$("__page").getValue();this.getRoot().getChildViews()[2].$scope.$$("__page").setValue(0==+t?"1":"0"),this.getRoot().getChildViews()[2].$scope.$$("__page").refresh();var i=this,o=webix.$$(this.$$("__table").getColumnConfig("dt").header[1].suggest.body.id);o.getChildViews()[1].getChildViews()[1].setValue("Применить"),o.getChildViews()[1].getChildViews()[1].define("click",function(){this._filter_timer&&window.clearTimeout(this._filter_timer),this._filter_timer=window.setTimeout(function(){var e=i.getRoot().getChildViews()[2].$scope,t=e.$$("__page").getValue();e.$$("__page").setValue(0==+t?"1":"0"),e.$$("__page").refresh()},webix.ui.datafilter.textWaitDelay),this.getParentView().getParentView().hide()}),this.$$("__table").getFilter("c_tovar").focus(),this.$$("__table").markSorting(this.$$("__table").config.fi,this.$$("__table").config.di)},t.prototype.init=function(){this.popconfirm=this.ui(r.default)},t}(o.c);t.default=a},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(0),r=i(2);var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e,t=this,i=this.app,o=this,s=i.config.r_url+"?getSupplAll",a={user:i.config.user},l=Object(n.checkVal)(Object(n.request)(s,a,!0).response,"s"),c=[];l&&(c=l);var u={view:"datatable",name:"__dt_a",localId:"__table",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:{autowidth:!0},startPos:1,posPpage:i.config.posPpage,totalPos:0,fi:"dt",di:"desc",searchBar:void 0,searchMethod:"getPrcsAll",old_stri:"",columns:[{id:"id_tovar",width:80,hidden:!0,header:[{text:"ID товара"}]},{id:"sh_prc",width:280,hidden:!0,header:[{text:"sh_prc"},{content:"cFilt",inputConfig:{pager:2}}]},{id:"c_tovar",fillspace:1,sort:"server",headermenu:!1,header:[{text:"Название"},{content:"cFilt",inputConfig:{pager:2}}]},{id:"c_vnd",sort:"server",width:200,header:[{text:"Поставщик"},{content:"richFilt",compare:n.compareTrue,inputConfig:{inputtype:"combo",options:{filter:n.mcf_filter,data:c}}}]},{id:"c_zavod",sort:"server",width:200,header:[{text:"Производитель"},{content:"cFilt",inputConfig:{pager:2}}]},{id:"c_user",sort:"server",width:160,header:[{text:"Группа пользователей"},{content:"richFilt",compare:n.compareTrue,inputConfig:{options:[{id:0,value:"Пользователь"},{id:9,value:"Сводильщик"},{id:10,value:"Админ"},{id:34,value:"Суперадмин"},{id:100,value:"Не назначен"}]}}]},{id:"dt",width:200,sort:"server",format:n.dt_formating_sec,css:"center_p",header:[{text:"Дата добавления"},{content:"dateRangeFilter",compare:n.compareTrue,inputConfig:{format:n.dt_formating,width:180},suggest:{view:"daterangesuggest",body:{timepicker:!1,calendarCount:2}}}]},{id:"source",width:150,hidden:!0,header:[{text:"Источник"},{content:"richFilt",compare:n.compareTrue,inputConfig:{options:[{id:"0",value:"Без источника"},{id:"1",value:"PLExpert"},{id:"2",value:"Склад"},{id:"3",value:"Агент"},{id:"4",value:"edocs"}]}}]},{id:"in_work",width:5,hidden:!0,headermenu:!1},{id:"in_work_name",width:100,hidden:!0,header:[{text:"В работе"}]},{id:"id_org",width:100,hidden:!0,header:[{text:"id_org"},{content:"cFilt",inputConfig:{pager:2}}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(e){webix.extend(this,webix.ProgressBar),e.order.forEach(function(t,i,o){var n=e.getItem(t);"-1"!==n.in_work&&(n.$css="table_row_light")})},onBeforeSort:function(e,i){t.$$("__table").config.fi=e,t.$$("__table").config.di=i;var n=o.getRoot().getChildViews()[2].$scope.$$("__page").getValue();o.getRoot().getChildViews()[2].$scope.$$("__page").setValue(0==+n?"1":"0"),o.getRoot().getChildViews()[2].$scope.$$("__page").refresh()},onItemDblClick:function(e){var r=t.$$("__table").getSelectedItem();r&&(e&&r.id!==e.row||(1==+$$("_link_by").getValue()?i.config.roles[i.config.role].lnkdel||r.c_user===t.app.config.user?($$("_suppl").config.state=!0,Object(n.parseToLink)(r),setTimeout(function(){t.getRoot().getTopParentView().getChildViews()[1].getChildViews()[0].getChildViews()[1].getChildViews()[1].setValue("app-nav")},300),setTimeout(function(){var e=o.getRoot().getChildViews()[2].$scope.$$("__page").getValue();o.getRoot().getChildViews()[2].$scope.$$("__page").setValue(0==+e?"1":"0"),o.getRoot().getChildViews()[2].$scope.$$("__page").refresh()},800)):webix.message({text:"Упс. Нет доступа.",type:"debug"}):webix.message({text:"Выберите сведение по поставщикам",type:"debug"})))},onKeyPress:function(e,t){"text"!==document.activeElement.type&&13===e&&this.getSelectedItem()&&this.callEvent("onItemDblClick")},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(e){}}};return{view:"layout",type:"clean",rows:[{rows:[{view:"toolbar",css:{"border-top":"0px"},height:40,cols:[{view:"label",template:"Для ускорения ограничивайте поиск названием"},{view:"button",type:"htmlbutton",tooltip:"Обновить",localId:"_renew",resizable:!0,sWidth:136,eWidth:40,label:"",width:40,extLabel:"<span style='line-height: 20px;padding-left: 5px'>Обновить</span>",oldLabel:"<span class='webix_icon fa-refresh'></span>",click:function(){t.$$("__table").callEvent("onBeforeSort")}},(e={view:"button",tooltip:"Сбросить фильтры",type:"imageButton",image:"./addons/img/unfilter.svg",width:40,localId:"_unfilt",resizable:!0,sWidth:180,eWidth:40,label:""},e.width=40,e.extLabel="<span style='line-height: 20px;padding-left: 5px'>Сбросить фильтры</span>",e.oldLabel="",e.click=function(){var e=t.$$("__table");e.config.columns.forEach(function(t){if(e.isColumnVisible(t.id)&&t.header[1])if("function"==typeof e.getFilter(t.id).setValue)e.getFilter(t.id).setValue("");else{var i=e.getFilter(t.id);i.readOnly||(i.value="")}}),t.$$("__table").callEvent("onBeforeSort")},e)]},{height:3}]},u,{$subview:r.default}]}},t.prototype.ready=function(){var e=[this.$$("_renew"),this.$$("_unfilt")];Object(n.setButtons)(this.app,e);var t=this.getRoot().getChildViews()[2].$scope.$$("__page").getValue();this.getRoot().getChildViews()[2].$scope.$$("__page").setValue(0==+t?"1":"0"),this.getRoot().getChildViews()[2].$scope.$$("__page").refresh();var i=this.app,o=this;this.$$("__table").isColumnVisible("c_user")&&(i.config.roles[i.config.role].lnkdel?this.$$("__table").getFilter("c_user").readOnly=!1:(this.$$("__table").getFilter("c_user").value=this.app.config.role,this.$$("__table").getFilter("c_user").readOnly=!0)),$$(this.$$("__table").getColumnConfig("dt").header[1].suggest.body.id).getChildViews()[1].getChildViews()[1].setValue("Применить"),$$(this.$$("__table").getColumnConfig("dt").header[1].suggest.body.id).getChildViews()[1].getChildViews()[1].define("click",function(){this._filter_timer&&window.clearTimeout(this._filter_timer),this._filter_timer=window.setTimeout(function(){var e=o.getRoot().getChildViews()[2],t=(e=e.$scope).$$("__page").getValue();e.$$("__page").setValue(0==+t?"1":"0"),e.$$("__page").refresh()},webix.ui.datafilter.textWaitDelay),this.getParentView().getParentView().hide()}),this.$$("__table").getFilter("c_tovar").focus(),this.$$("__table").markSorting(this.$$("__table").config.fi,this.$$("__table").config.di)},t}(o.c);t.default=s},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(4),r=i(5),s=i(0),a=i(8);var l=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e,t=this,i=(this.app,function(){return t.getRoot().getChildViews()[2].getChildViews()[0]});return{view:"layout",type:"clean",rows:[{view:"toolbar",css:{"border-top":"0px"},cols:[{view:"text",label:"",placeholder:"Строка поиска",height:40,fillspace:!0,localId:"_ls",on:{onKeyPress:function(e,o){var n=this;clearTimeout(this.config._keytimed),Object(s.checkKey)(e)&&(this.config._keytimed=setTimeout(function(){var e=i();if(e){var o=Object(s.getDtParams)(e);Object(s.get_data_test)({view:e,navBar:t.getRoot().getChildViews()[2].getChildViews()[1],start:1,count:o[1],searchBar:n.$scope.$$("_ls").config.id,method:t.getRoot().getChildViews()[2].getChildViews()[0].config.searchMethod,field:o[2],direction:o[3],filter:o[0]})}},this.$scope.app.config.searchDelay))}}},{view:"button",type:"htmlbutton",localId:"_history",resizable:!0,sWidth:126,eWidth:40,label:"",width:40,extLabel:"<span style='line-height: 20px;padding-left: 5px'>История</span>",oldLabel:"<span class='webix_icon fa-history'></span>",click:function(){var e=webix.storage.session.get(i().config.name);t.pophistory.show(e,t.$$("_ls"))}},{view:"checkbox",labelRight:"<span style='color: white'>Поиск по эталонам</span>",labelWidth:0,value:this.lch,width:150,localId:"_spr_ch",on:{onChange:function(){t.$$("_ls").setValue("");var e=t.$$("_spr_ch").getValue(),i=t.getRoot().getParentView().getParentView().getChildViews()[1].config.options,o=void 0,n=t.getRoot().getParentView().getParentView().getChildViews()[1].getValue();0===e?(t.lch=0,o="<span class='webix_icon fa-stumbleupon'></span><span style='line-height: 20px;'>Связки</span>"):1===e&&(t.lch=1,o="<span class='webix_icon fa-stumbleupon'></span><span style='line-height: 16px; font-size: 80%'>Связки:Эталоны</span>"),i.forEach(function(e,i,r){+e.id==+n&&(e.value=o,t.getRoot().getParentView().getParentView().getChildViews()[1].refresh())});var r=1===t.lch?"links_form_spr":"links_form_lnk";t.show(r)}}},(e={view:"button",width:40,tooltip:"Сбросить фильтры",type:"imageButton",image:"./addons/img/unfilter.svg",localId:"_unfilt",resizable:!0,sWidth:180,eWidth:40,label:""},e.width=40,e.extLabel="<span style='line-height: 20px;padding-left: 5px'>Сбросить фильтры</span>",e.oldLabel="",e.click=function(){t.$$("_br").hide(),t.$$("_ls").setValue("");var e=i();$$(e).config.columns.forEach(function(t){if(e.isColumnVisible(t.id)&&t.header[1])if("function"==typeof e.getFilter(t.id).setValue)e.getFilter(t.id).setValue("");else{var i=e.getFilter(t.id);i.readOnly||(i.value="")}}),t.$$("_ls").callEvent("onKeyPress",[13])},e),{view:"button",type:"htmlbutton",hidden:!1,localId:"_br",resizable:!0,sWidth:140,eWidth:40,label:"",width:40,extLabel:"<span style='line-height: 20px;padding-left: 5px'>Разорвать</span>",oldLabel:"<span style='color: red', class='webix_icon fa-unlink'></span>",click:function(){i().callEvent("onItemDblClick")}}]},{height:3},{$subview:!0}]}},t.prototype.ready=function(){var e=[this.$$("_history"),this.$$("_br"),this.$$("_unfilt")];Object(s.setButtons)(this.app,e);this.getRoot().getParentView().getParentView().getChildViews()[1].config.options;var t=1===this.app.config.lch?"links_form_spr":"links_form_lnk";this.show(t)},t.prototype.init=function(){this.lch=0,this.popnew=this.ui(r.default),this.popunlink=this.ui(a.default),this.pophistory=this.ui(n.default)},t}(o.c);t.default=l},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(4),r=i(0),s=i(2),a=i(51),l=i(53),c=i(54);var u=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e,t,i=this,o=this.app,n=this;return{view:"layout",type:"clean",rows:[{view:"toolbar",css:{"border-top":"0px"},cols:[{view:"text",label:"",placeholder:"Строка поиска",height:40,fillspace:!0,localId:"_ls",on:{onKeyPress:function(e,t){clearTimeout(this.config._keytimed),Object(r.checkKey)(e)&&(this.config._keytimed=setTimeout(function(){var e=n.getRoot().getChildViews()[2].getChildViews()[0].getChildViews()[1],t=e.$scope.$$("__page").getValue();e.$scope.$$("__page").setValue(0==+t?"1":"0"),e.$scope.$$("__page").refresh()},this.$scope.app.config.searchDelay))}}},{view:"checkbox",labelRight:"<span style='color: white'>Без писем</span>",labelWidth:0,tooltip:"Отображать только записи где нет писем",width:100,localId:"_noMail",css:"check",on:{onChange:function(){1===this.getValue()?this.$scope.$$("__table").define({searchMethod:"getBrakSearchNoMail"}):this.$scope.$$("__table").define({searchMethod:"getBrakSearch"}),this.$scope._search.callEvent("onKeyPress",[13]),this.$scope._search.focus()}}},{view:"checkbox",labelRight:"<span style='color: white'>Проверять с письмами</span>",labelWidth:0,tooltip:"При сохранении новых писем проверять записи с письмами",value:0,hidden:!0,width:160,localId:"_check_w_mails",on:{onChange:function(){webix.message({text:"Опция пока не доступна",type:"error",delay:1e3})}}},{view:"button",type:"htmlbutton",localId:"_history",resizable:!0,sWidth:116,eWidth:40,label:"",width:40,tooltip:"История поиска",extLabel:"<span style='line-height: 20px;padding-left: 5px'>История</span>",oldLabel:"<span class='webix_icon fa-history'></span>",click:function(){var e=webix.storage.session.get(i.$$("__table").config.name);i.pophistory.show(e,i.$$("_ls"))}},{view:"button",type:"htmlbutton",localId:"_renew",resizable:!0,sWidth:116,eWidth:40,label:"",width:40,tooltip:"Обновить таблицу",extLabel:"<span style='line-height: 20px;padding-left: 5px'>Обновить</span>",oldLabel:"<span class='webix_icon fa-refresh'></span>",click:function(){var e=n.getRoot().getChildViews()[2].getChildViews()[0].getChildViews()[1],t=e.$scope.$$("__page").getValue();e.$scope.$$("__page").setValue(0==+t?"1":"0"),e.$scope.$$("__page").refresh()}},(e={view:"button",width:40,tooltip:"Сбросить фильтры",type:"imageButton",image:"./addons/img/unfilter.svg",localId:"_unfilt",resizable:!0,sWidth:180,eWidth:40,label:""},e.width=40,e.extLabel="<span style='line-height: 20px;padding-left: 5px'>Сбросить фильтры</span>",e.oldLabel="",e.click=function(){i.$$("_ls").setValue("");var e=i.$$("__table");Object(r.unFilter)(e);var t=n.getRoot().getChildViews()[2].getChildViews()[0].getChildViews()[1],o=t.$scope.$$("__page").getValue();t.$scope.$$("__page").setValue(0==+o?"1":"0"),t.$scope.$$("__page").refresh()},e),{view:"button",type:"htmlbutton",tooltip:"Загрузить брак",localId:"_fileload",resizable:!0,sWidth:155,eWidth:40,label:"",width:40,extLabel:"<span style='line-height: 20px;padding-left: 5px'>Загрузить брак</span>",oldLabel:"<span class='webix_icon fa-upload'></span>",click:function(){i.pop_upl.show_window("Загрузка файла")}},{view:"button",type:"htmlbutton",tooltip:"Сверить базу забраковки с внешним файлом",localId:"_filecheck",resizable:!0,sWidth:155,eWidth:40,label:"",width:40,extLabel:"<span style='line-height: 20px;padding-left: 5px'>Сверить брак</span>",oldLabel:"<span class='webix_icon fa-check'></span>",click:function(){i.pop_check.show_w()}},{view:"button",type:"htmlbutton",hidden:!0,tooltip:"Удалить письмо",localId:"_delletter",resizable:!0,sWidth:155,eWidth:40,label:"",width:40,extLabel:"<span style='line-height: 20px;padding-left: 5px'>Удалить письмо</span>",oldLabel:"<span class='webix_icon fa-trash'></span>",click:function(){var e=i.$$("__table").getSelectedId(),t=i.$$("__table").getSubView(e);if(t){var n=t.getSelectedId();if(n){var s=o.config.r_url+"?delBrakMail",a={user:o.config.user,id:n,f_name:t.getItem(n).f_name},l=Object(r.request)(s,a,!0).response;(l=Object(r.checkVal)(l,"s"))&&(i.$$("_delletter").hide(),i.$$("__table").getSelectedItem().m_count=+l.m_count,i.sideView.$scope.clear_info(),i.sideView.$scope.disable_info(),t.remove(n),i.$$("__table").closeSub(e),i.$$("__table").openSub(e,i.$$("__table")))}}}}]},{height:3},{view:"layout",cols:[{css:{"border-left":"1px solid #dddddd !important"},rows:[{view:"datatable",name:"__brak",localId:"__table",select:!0,borderless:!0,rowHeight:30,fixedRowHeight:!1,headermenu:{autowidth:!0},resizeColumn:!0,startPos:1,posPpage:o.config.posPpage,totalPos:0,fi:"dt",di:"desc",searchBar:void 0,searchMethod:"getBrakSearch",old_stri:"",subview:function(e,t){var n=i.$$("__table").getItem(e.id),s=o.config.r_url+"?getBrakMail",a={sh_prc:n.sh_prc,series:n.series,user:o.config.user},l=Object(r.checkVal)(Object(r.request)(s,a,!0).response,"s");l.push({id:99999999,n_doc:"...добавить письмо"});var c=l.length,u={view:"list",localId:"__list",$scope:i,$new:!1,oldSelectedItem:void 0,css:"sublist",item:{height:32},borderless:!0,navigation:!0,select:!0,scroll:!1,height:32*c,template:"#n_doc#",on:{onBeforeUnSelect:function(e){this.$scope.$$("_delletter").hide()},onBeforeSelect:function(e){if(!0===this.config.$new)return webix.message("Сначала сохраните изменения"),!1},onAfterSelect:function(e){this.$scope.sideView.$scope.enable_info();var t=this.getSelectedItem();this.oldSelectedItem=t.id,99999999===t.id?(t.n_doc="Новое письмо",t.name=n.c_name,t.t_name=n.c_name,t.series=n.series,t.vendor=n.c_zavod,t.sh_prc=n.sh_prc,this.refresh(),this.config.$new=!0):this.$scope.$$("_delletter").show(),this.$scope.sideView.$scope.load_data(t,this,this.$scope.$$("__table")),this.$scope.sideView.$scope.enable_info()}},data:l};return webix.ui(u,t)},columns:[{id:"id",width:270,hidden:!0,headermenu:!1,header:[{text:"id"}]},{id:"sh_prc",width:270,hidden:!0,header:[{text:"Хэш"}]},{id:"series",width:100,hidden:!1,sort:"server",header:[{text:"Серия"}]},{id:"c_name",fillspace:!0,sort:"server",header:[{text:"Наименование"}],headermenu:!1},{id:"c_zavod",width:200,hidden:!1,sort:"server",header:[{text:"Производитель"}]},{id:"razbr",width:100,hidden:!1,header:[{text:"Разбраковка"}],css:"center_p",template:"{common.checkbox()}"},(t={id:"dt",width:140,sort:"server",hidden:!1},t.sort="server",t.format=r.dt_formating,t.css="center_p",t.header=[{text:"Дата добавления"},{content:"dateRangeFilter",compare:r.compareTrue,inputConfig:{format:r.dt_formating,width:120},suggest:{view:"daterangesuggest",body:{timepicker:!1,calendarCount:2}}}],t)],on:{"data->onParse":function(e,t){this.clearAll()},onCheck:function(e,t,i){var n=this.getItem(e),s=o.config.r_url+"?setRazbr",a={user:o.config.user,sh_prc:n.sh_prc,series:n.series,razbr:i};Object(r.request)(s,a,!0).response},onBeforeRender:function(e){webix.extend(this,webix.ProgressBar),function(e){e.order.forEach(function(t,i,o){var n=e.getItem(t);n.$css=0==+n.m_count?"highlighted":"nothing"})}(e)},onSubViewClose:function(e){this.$scope.sideView.$scope.hide_b(),delete this.getItem(e).$subContent,delete this.getItem(e).$subHeight,delete this.getItem(e).$subOpen},onItemClick:function(e){},onBeforeSort:function(e,t){i.$$("__table").config.fi=e,i.$$("__table").config.di=t;var o=n.getRoot().getChildViews()[2].getChildViews()[0].getChildViews()[1],r=o.$scope.$$("__page").getValue();o.$scope.$$("__page").setValue(0==+r?"1":"0"),o.$scope.$$("__page").refresh()},onItemDblClick:function(e){},onKeyPress:function(e,t){13===e&&this.getSelectedItem()&&this.callEvent("onItemDblClick")},onBeforeSelect:function(e){},onBeforeUnSelect:function(e){this.$scope.$$("_delletter").hide(),this.$scope.sideView.$scope.clear_info(),this.$scope.sideView.$scope.disable_info(),this.getItem(e.id)&&this.closeSub(e.id)},onAfterSelect:function(e){this.openSub(e.id,this)},onAfterLoad:function(){this.hideProgress()}}},{$subview:s.default}]},{$subview:a.default}]}]}},t.prototype.ready=function(){var e=[this.$$("_history"),this.$$("_unfilt"),this.$$("_fileload"),this.$$("_delletter"),this.$$("_renew"),this.$$("_filecheck")];Object(r.setButtons)(this.app,e);var t=this;$$(this.$$("__table").getColumnConfig("dt").header[1].suggest.body.id).getChildViews()[1].getChildViews()[1].setValue("Применить"),$$(this.$$("__table").getColumnConfig("dt").header[1].suggest.body.id).getChildViews()[1].getChildViews()[1].define("click",function(){this._filter_timer&&window.clearTimeout(this._filter_timer),this._filter_timer=window.setTimeout(function(){var e=t.getRoot().getChildViews()[2].getChildViews()[0],i=(e=e.getChildViews()[1].$scope).$$("__page").getValue();e.$$("__page").setValue(0==+i?"1":"0"),e.$$("__page").setValue("0"),e.$$("__page").refresh()},webix.ui.datafilter.textWaitDelay),this.getParentView().getParentView().hide()}),this._search=this.$$("_ls"),this.$$("__table").config.searchBar=this._search.config.id,this.sideView=this.getRoot().getChildViews()[2].getChildViews()[1],this._search.callEvent("onKeyPress",[13]),this._search.focus()},t.prototype.init=function(){this.pophistory=this.ui(n.default),this.pop_upl=this.ui(l.default),this.pop_check=this.ui(c.default)},t}(o.c);t.default=u},function(e,t,i){"use strict";i.r(t);var o=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this;return{view:"toolbar",css:{"border-top":"0px"},height:40,cols:[{view:"combo",localId:"_options",value:11,width:220,options:{body:{yCount:11},data:[{id:11,value:"Сервис"},{id:10,value:"Пользователи"}]},on:{onChange:function(){var t=e.$$("_options").getValue(),i=10==+t?"adm-users":"adm-linker";e.show(i)}}},{}]}},t}(i(1).c);t.default=o},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(4),r=i(0);var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e,t=this;return{view:"layout",rows:[{height:40,view:"toolbar",cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Начните набирать название товара здесь",fillspace:!0,localId:"_sb",keyPressTimeout:900,tooltip:"поиск по ШК",_keytimed:void 0,on:{onKeyPress:function(e,t){var i=this;clearTimeout(this.config._keytimed),Object(r.checkKey)(e)&&(this.config._keytimed=setTimeout(function(){var e=i.$scope.getRoot().getChildViews()[1].getChildViews()[0];if(e){var t=Object(r.getDtParams)(e),o=1===i.$scope.$$("_chbar").getValue()?"0,100":i.$scope.$$("_bnum").getValue();Object(r.get_data_test)({view:e,navBar:i.$scope.getRoot().getChildViews()[1].getChildViews()[1],start:1,count:t[1],searchBar:i.$scope.getRoot().getChildViews()[1].getChildViews()[0].config.searchBar,method:i.$scope.getRoot().getChildViews()[1].getChildViews()[0].config.searchMethod,field:t[2],direction:t[3],filter:t[0],cbars:o})}},this.$scope.app.config.searchDelay))}}},(e={view:"button",type:"htmlbutton",width:35,localId:"_history",resizable:!0,sWidth:126,eWidth:40,label:""},e.width=40,e.extLabel="<span style='line-height: 20px;padding-left: 5px'>История</span>",e.oldLabel="<span class='webix_icon fa-history'></span>",e.click=function(){var e=t.getRoot().getChildViews()[1].getChildViews()[0],i=webix.storage.session.get(e.config.name);t.pophistory.show(i,t.$$("_sb"))},e),{view:"rangeslider",label:"Диапазон кол-ва ШК",value:"0,15",width:350,labelWidth:140,hidden:function(){return 1===this.$scope.$$("_chbar").getValue()},localId:"_bnum",title:webix.template("#value#"),stringResult:!0,max:15,min:0,on:{onChange:function(){t.$$("_sb").focus()}}},{view:"checkbox",labelRight:"<span style='color: white'>Все</span>",labelWidth:0,value:1,width:60,localId:"_chbar",on:{onChange:function(){t.$$("_sb").focus(),1===t.$$("_chbar").getValue()?t.$$("_bnum").hide():t.$$("_bnum").show()}}},{view:"checkbox",labelRight:"<span style='color: white'>Поиск по справочнику</span>",labelWidth:0,value:1,width:160,on:{onChange:function(){this.$scope.$$("_sb").setValue(""),1===this.getValue()?(this.$scope.$$("_sb").define("placeholder","Начните набирать название товара"),0===this.$scope.$$("_chbar").getValue()&&this.$scope.$$("_bnum").show(),this.$scope.$$("_chbar").show(),this.$scope.show("adm-barcodes-s")):0===this.getValue()&&(this.$scope.$$("_sb").define("placeholder","Начните набирать баркод"),this.$scope.$$("_bnum").hide(),this.$scope.$$("_chbar").hide(),this.$scope.show("adm-barcodes-b")),this.$scope.$$("_sb").refresh()}}}]},{$subview:!0}]}},t.prototype.ready=function(){var e=[this.$$("_history")];Object(r.setButtons)(this.app,e)},t.prototype.init=function(){this.pophistory=this.ui(n.default),this.show("adm-barcodes-s")},t}(o.c);t.default=s},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(0),r=i(3);var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this;return{view:"layout",rows:[{height:40,view:"toolbar",cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Строка поиска",keyPressTimeout:900,tooltip:"поиск по стране",on:{onTimedKeyPress:function(e,t){var i=this.getValue().toString().toLowerCase();this.$scope.$$("__table").filter(function(e){return-1!=e.c_strana.toString().toLowerCase().indexOf(i)})}}},{view:"button",type:"htmlbutton",tooltip:"Добавить страну",localId:"_add",resizable:!0,sWidth:180,eWidth:40,label:"",width:40,extLabel:"<span style='line-height: 20px;padding-left: 5px'>Добавить страну</span>",oldLabel:"<span class='webix_icon fa-plus'></span>",click:function(){var t={type:"Strana",callback:n.addStrana,mode:"new",source:e.$$("__table")};e.popnew.show("Добавление страны",t)}},{view:"button",type:"htmlbutton",hidden:!0,localId:"_del",tooltip:"Удалить страну",resizable:!0,sWidth:180,eWidth:40,label:"",width:40,extLabel:"<span style='line-height: 20px;padding-left: 5px;'>Удалить страну</span>",oldLabel:"<span style='color: red', class='webix_icon fa-times'></span>",click:function(){var t=e.$$("__table").getSelectedItem().id,i={};i.user=e.app.config.user,i.id=t;var o=e.app.config.r_url+"?delStrana",r=Object(n.request)(o,i,!0).response;(r=Object(n.checkVal)(r,"s"))&&(Object(n.delStrana)(r.id),e.$$("_del").hide())}}]},{view:"datatable",name:"_country",localId:"__table",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,startPos:1,posPpage:20,totalPos:1250,old_stri:"",columns:[{id:"id",width:75,header:[{text:"ID"}]},{id:"c_strana",headermenu:!1,fillspace:1,sort:"text",header:[{text:"Страна"}]},{id:"id_state",width:150,header:[{text:"Статус"}]},{id:"dt",width:250,header:[{text:"Дата заведения"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){this.count||this.showProgress({type:"icon",icon:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>'})},onItemDblClick:function(e){var t={text:(e=this.getSelectedItem()).c_strana,id:e.id,type:"Strana",callback:n.updStrana,mode:"upd",source:this};this.$scope.popnew.show("Редактирование страны",t)},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(){e.$$("_del").show()},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}}]}},t.prototype.ready=function(){var e=[this.$$("_add"),this.$$("_del")];Object(n.setButtons)(this.app,e)},t.prototype.init=function(){this.popnew=this.ui(r.default),webix.extend(this.$$("__table"),webix.ProgressBar),this.$$("__table").sync(n.strana.data)},t}(o.c);t.default=s},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(0),r=i(25);var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this;return{view:"layout",rows:[{height:40,view:"toolbar",cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Строка поиска",keyPressTimeout:900,tooltip:"поиск по действующему веществу",on:{onTimedKeyPress:function(e,t){var i=this.getValue().toString().toLowerCase();this.$scope.$$("__table").filter(function(e){return-1!=e.act_ingr.toString().toLowerCase().indexOf(i)})}}},{view:"button",type:"htmlbutton",tooltip:"Добавить действующее вещество",localId:"_add",resizable:!0,sWidth:180,eWidth:40,label:"",width:40,extLabel:"<span style='line-height: 20px;padding-left: 5px'>Добавить ДВ</span>",oldLabel:"<span class='webix_icon fa-plus'></span>",click:function(){var t={type:"Dv",callback:n.addDv,mode:"new",source:e.$$("__table")};e.popnew.show("Добавление действующего в-ва",t)}},{view:"button",type:"htmlbutton",hidden:!0,localId:"_del",tooltip:"Удалить дейтсвующее вещество",resizable:!0,sWidth:180,eWidth:40,label:"",width:40,extLabel:"<span style='line-height: 20px;padding-left: 5px;'>Удалить ДВ</span>",oldLabel:"<span style='color: red', class='webix_icon fa-times'></span>",click:function(){var t=e.$$("__table").getSelectedItem().id,i={};i.user=e.app.config.user,i.id=t;var o=e.app.config.r_url+"?delDv",r=Object(n.request)(o,i,!0).response;(r=Object(n.checkVal)(r,"s"))&&(Object(n.delDv)(r.id),e.$$("_del").hide())}}]},{view:"datatable",name:"_dv",localId:"__table",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,startPos:1,posPpage:20,totalPos:1250,old_stri:"",columns:[{id:"id",width:75,sort:"text",header:[{text:"ID"}]},{id:"act_ingr",fillspace:1,sort:"text",headermenu:!1,header:[{text:"Действующее вещество"}]},{id:"oa",width:200,sort:"text",header:[{text:"Обязательный ассортимент"},{content:"selectFilter"}]},{id:"id_state",width:150,hidden:!0,header:[{text:"Статус"}]},{id:"dt",width:250,header:[{text:"Дата заведения"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){this.count||this.showProgress({type:"icon",icon:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>'})},onItemDblClick:function(e){var t={text:(e=this.getSelectedItem()).act_ingr,id:e.id,oa:e.oa,type:"Dv",callback:n.updDv,mode:"upd",source:this};this.$scope.popnew.show("Редактирование действующего в-ва",t)},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(){e.$$("_del").show()},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}}]}},t.prototype.ready=function(){var e=[this.$$("_add"),this.$$("_del")];Object(n.setButtons)(this.app,e)},t.prototype.init=function(){this.popnew=this.ui(r.default),webix.extend(this.$$("__table"),webix.ProgressBar),this.$$("__table").sync(n.dv.data)},t}(o.c);t.default=s},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(0);var r=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this;return{view:"cWindow",modal:!0,on:{onHide:function(){e.$$("_n_f").clear(),e.$$("_n_f").clearValidation()}},body:{view:"form",localId:"_n_f",_params:{},margin:0,rules:{id:function(e){var t=this.$scope.app.config.r_url+"?check"+this.config._params.type,i={};i.check=e,i.user=this.$scope.app.config.user;var o=!1;if("new"==this.$scope.$$("_n_f").config._params.mode){var r=Object(n.request)(t,i,!0).response;((r=Object(n.checkVal)(r,"s"))||this.config._params.text)&&(o=!0)}else o=!0;return o},text:webix.rules.isNotEmpty},elements:[{view:"text",localId:"_id",label:"ID",value:"",name:"id",placeholder:"Введите значение",readonly:!0,required:!0,invalidMessage:"Такой ID уже есть"},{view:"text",label:"Название",value:"",name:"text",placeholder:"Введите значение",required:!0,invalidMessage:"Введите название"},{view:"select",label:"Обязательный ассортимент",value:3,labelWidth:200,width:450,name:"oa",options:[{id:3,value:"Нет"},{id:1,value:"Для аптек"},{id:2,value:"Для аптек и аптечных пунктов"}],labelAlign:"left"},{height:15},{height:30,cols:[{view:"button",type:"base",label:"Отменить",width:120,click:function(){e.hide()}},{},{view:"button",type:"base",label:"Сохранить",width:120,click:function(){if(e.$$("_n_f").validate({hidden:!1,disabled:!1})){var t=e.$$("_n_f").getValues(),i={},o=e.$$("_n_f").config._params;i.value=t.text,i.user=e.app.config.user,i.id="upd"===o.mode?o.id:t.id,i.oa=t.oa;var r="new"===o.mode?e.app.config.r_url+"?set"+o.type:e.app.config.r_url+"?upd"+o.type,s=Object(n.request)(r,i,!0).response;(s=Object(n.checkVal)(s,"s"))&&o.callback(s,o.source),e.hide()}}}]}]}}},t.prototype.show=function(e,t){if(this.$$("_n_f").config._params=t,this.getRoot().getHead().getChildViews()[0].setValue(e),"upd"===t.mode){var i="Для аптек"===t.oa?1:"Для аптек и аптечных пунктов"===t.oa?2:3,o={text:t.text,id:t.id,oa:i};this.$$("_n_f").parse(o),this.$$("_id").define("readonly",!0)}else this.$$("_id").define("readonly",!1);this.$$("_id").refresh(),this.getRoot().show()},t.prototype.hide=function(){this.getRoot().hide()},t.prototype.getValues=function(){return this.getRoot().getBody().getValues()},t}(o.c);t.default=r},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(0),r=i(3);var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this;return{view:"layout",rows:[{height:40,view:"toolbar",cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Строка поиска",keyPressTimeout:900,tooltip:"поиск по группе",on:{onTimedKeyPress:function(e,t){var i=this.getValue().toString().toLowerCase();this.$scope.$$("__table").filter(function(e){return-1!=e.group.toString().toLowerCase().indexOf(i)})}}},{view:"button",type:"htmlbutton",tooltip:"Добавить группу",localId:"_add",resizable:!0,sWidth:180,eWidth:40,label:"",width:40,extLabel:"<span style='line-height: 20px;padding-left: 5px'>Добавить группу</span>",oldLabel:"<span class='webix_icon fa-plus'></span>",click:function(){var t={type:"Gr",callback:n.addGr,mode:"new",source:e.$$("__table")};e.popnew.show("Добавление группы",t)}},{view:"button",type:"htmlbutton",hidden:!0,localId:"_del",tooltip:"Удалить группу",resizable:!0,sWidth:180,eWidth:40,label:"",width:40,extLabel:"<span style='line-height: 20px;padding-left: 5px;'>Удалить гпуппу</span>",oldLabel:"<span style='color: red', class='webix_icon fa-times'></span>",click:function(){var t=e.$$("__table").getSelectedItem().id,i={};i.user=e.app.config.user,i.id=t;var o=e.app.config.r_url+"?delGr",r=Object(n.request)(o,i,!0).response;(r=Object(n.checkVal)(r,"s"))&&(Object(n.delGr)(r.id),e.$$("_del").hide())}}]},{view:"datatable",name:"_groups",localId:"__table",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,startPos:1,posPpage:20,totalPos:1250,old_stri:"",columns:[{id:"id",width:200,header:[{text:"ID"}]},{id:"group",headermenu:!1,fillspace:1,sort:"text",header:[{text:"Группа"}]},{id:"id_state",width:150,header:[{text:"Статус"}]},{id:"dt",width:250,header:[{text:"Дата заведения"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){this.count||this.showProgress({type:"icon",icon:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>'})},onItemDblClick:function(e){var t={text:(e=this.getSelectedItem()).group,id:e.id,type:"Gr",callback:n.updGr,mode:"upd",source:this};this.$scope.popnew.show("Редактирование группы",t)},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(){e.$$("_del").show()},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}}]}},t.prototype.ready=function(){var e=[this.$$("_add"),this.$$("_del")];Object(n.setButtons)(this.app,e)},t.prototype.init=function(){this.popnew=this.ui(r.default),webix.extend(this.$$("__table"),webix.ProgressBar),this.$$("__table").sync(n.group.data)},t}(o.c);t.default=s},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(0),r=i(3);var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this;return{view:"layout",rows:[{height:40,view:"toolbar",cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Строка поиска",keyPressTimeout:900,tooltip:"поиск по условиям хранения",on:{onTimedKeyPress:function(e,t){var i=this.getValue().toString().toLowerCase();this.$scope.$$("__table").filter(function(e){return-1!=e.usloviya.toString().toLowerCase().indexOf(i)})}}},{view:"button",type:"htmlbutton",tooltip:"Добавить условия хранения",localId:"_add",resizable:!0,sWidth:180,eWidth:40,label:"",width:40,extLabel:"<span style='line-height: 20px;padding-left: 5px'>Добавить условия</span>",oldLabel:"<span class='webix_icon fa-plus'></span>",click:function(){var t={type:"Hran",callback:n.addHran,mode:"new",source:e.$$("__table")};e.popnew.show("Добавление условия хранения",t)}},{view:"button",type:"htmlbutton",localId:"_del",hidden:!0,tooltip:"Удалить условия хранения",resizable:!0,sWidth:180,eWidth:40,label:"",width:40,extLabel:"<span style='line-height: 20px;padding-left: 5px;'>Удалить условия</span>",oldLabel:"<span style='color: red', class='webix_icon fa-times'></span>",click:function(){var t=e.$$("__table").getSelectedItem().id,i={};i.user=e.app.config.user,i.id=t;var o=e.app.config.r_url+"?delHran",r=Object(n.request)(o,i,!0).response;(r=Object(n.checkVal)(r,"s"))&&(Object(n.delHran)(r.id),e.$$("_del").hide())}}]},{view:"datatable",name:"_hran",localId:"__table",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,startPos:1,posPpage:20,totalPos:1250,old_stri:"",columns:[{id:"id",width:200,header:[{text:"ID"}]},{id:"usloviya",headermenu:!1,fillspace:1,sort:"text",header:[{text:"Условия хранения"}]},{id:"id_state",width:150,header:[{text:"Статус"}]},{id:"dt",width:250,header:[{text:"Дата заведения"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){this.count||this.showProgress({type:"icon",icon:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>'})},onItemDblClick:function(e){var t={text:(e=this.getSelectedItem()).usloviya,id:e.id,type:"Hran",callback:n.updHran,mode:"upd",source:this};this.$scope.popnew.show("Редактирование условия хранения",t)},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(){e.$$("_del").show()},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}}]}},t.prototype.ready=function(){var e=[this.$$("_add"),this.$$("_del")];Object(n.setButtons)(this.app,e)},t.prototype.init=function(){this.popnew=this.ui(r.default),webix.extend(this.$$("__table"),webix.ProgressBar),this.$$("__table").sync(n.hran.data)},t}(o.c);t.default=s},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(0),r=i(3);var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this,t=this.app;return{view:"layout",rows:[{height:40,view:"toolbar",cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Строка поиска",keyPressTimeout:900,tooltip:"поиск по форме выпуска",on:{onTimedKeyPress:function(e,t){var i=this.getValue().toString().toLowerCase();this.$scope.$$("__table").filter(function(e){return-1!=e.c_issue.toString().toLowerCase().indexOf(i)})}}},{view:"button",type:"htmlbutton",tooltip:"Добавить форму выпуска",localId:"_add",resizable:!0,sWidth:180,eWidth:40,label:"",width:40,extLabel:"<span style='line-height: 20px;padding-left: 5px'>Добавить форму</span>",oldLabel:"<span class='webix_icon fa-plus'></span>",click:function(){var i=t.config.r_url+"?getIsId",o={user:t.config.user},r=Object(n.request)(i,o,!0).response;o={type:"Issue",callback:n.addIssue,mode:"new",source:e.$$("__table")},(r=Object(n.checkVal)(r,"s"))&&(o.id_is=r),e.popnew.show("Добавление формы выпуска",o)}},{view:"button",type:"htmlbutton",hidden:!0,localId:"_del",tooltip:"Удалить форму выпуска",resizable:!0,sWidth:180,eWidth:40,label:"",width:40,extLabel:"<span style='line-height: 20px;padding-left: 5px;'>Удалить форму</span>",oldLabel:"<span style='color: red', class='webix_icon fa-times'></span>",click:function(){var t=e.$$("__table").getSelectedItem().id,i={};i.user=e.app.config.user,i.id=t;var o=e.app.config.r_url+"?delIssue",r=JSON.parse(Object(n.request)(o,i,!0).response);r.result?(console.log(r.ret_val.id),Object(n.delIssue)(r.ret_val.id),e.$$("_del").hide()):webix.message({type:"error",text:r.ret_val})}}]},{view:"datatable",name:"_issues",localId:"__table",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,startPos:1,posPpage:20,totalPos:1250,old_stri:"",columns:[{id:"id",sort:"text",width:75,header:[{text:"ID"}]},{id:"c_issue",headermenu:!1,fillspace:1,sort:"text",header:[{text:"Форма выпуска"}]},{id:"id_state",width:150,header:[{text:"Статус"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){this.count||this.showProgress({type:"icon",icon:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>'})},onItemDblClick:function(e){var t={text:(e=this.getSelectedItem()).c_issue,id:e.id,type:"Issue",callback:n.updIssue,mode:"upd",source:this};this.$scope.popnew.show("Редактирование формы выпуска",t)},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(){e.$$("_del").show()},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}}]}},t.prototype.ready=function(){var e=[this.$$("_add"),this.$$("_del")];Object(n.setButtons)(this.app,e)},t.prototype.init=function(){this.popnew=this.ui(r.default),webix.extend(this.$$("__table"),webix.ProgressBar),this.$$("__table").sync(n.allIs.data)},t}(o.c);t.default=s},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(0);var r=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this,t=this.app;return{view:"layout",css:{"border-left":"1px solid #dddddd !important"},rows:[{height:40,view:"toolbar",borderless:!0,cols:[{},{view:"button",type:"htmlbutton",localId:"_renew",resizable:!0,sWidth:136,eWidth:40,label:"",width:40,tooltip:"Обновить таблицу",extLabel:"<span style='line-height: 20px;padding-left: 5px'>Обновить</span>",oldLabel:"<span class='webix_icon fa-refresh'></span>",click:function(){e.ready()}},{view:"button",type:"htmlbutton",localId:"_apply",hidden:!0,resizable:!0,sWidth:130,eWidth:40,label:"",width:40,extLabel:"<span style='line-height: 20px;padding-left: 5px'>Применить</span>",oldLabel:"<span class='webix_icon fa-check'></span>",click:function(){var i={};i.p=e.$$("_lTable").serialize(),i.r=e.$$("_rTable").serialize(),e.hide_b();var o=t.config.user,r=t.config.r_url+"?setLinkCodes",s={user:o,data:i};Object(n.request)(r,s).then(function(e){e=Object(n.checkVal)(e,"a"),console.log("ret",e)})}},{view:"button",type:"htmlbutton",localId:"_cancel",hidden:!0,resizable:!0,sWidth:130,eWidth:40,label:"",width:40,extLabel:"<span style='line-height: 20px;padding-left: 5px'>Отменить</span>",oldLabel:"<span class='webix_icon fa-times'></span>",click:function(){e.ready()}}]},{cols:[{rows:[{cols:[{view:"label",label:"Сводить по кодам автоматически",css:"c-label",height:40,fillspace:!0},{view:"button",tooltip:"Перенести все",type:"htmlbutton",label:"<span class='webix_icon fa-angle-double-right'></span>",localId:"_to_r",resizable:!1,width:40,click:function(){var t=e.$$("_lTable").serialize();e.$$("_lTable").clearAll(),t.forEach(function(t){delete t.id,e.$$("_rTable").add(t)}),e.show_b()}},{view:"button",tooltip:"Сбросить фильтры",type:"imageButton",image:"./addons/img/unfilter.svg",localId:"_unfilt_p",resizable:!1,label:"",width:40,click:function(){var t=e.$$("_lTable");Object(n.unFilter)(t),e.$$("_lTable").filterByAll()}}]},{view:"datatable",name:"_pTable",localId:"_lTable",select:!0,borderless:!0,rowHeight:30,fixedRowHeight:!1,headermenu:!1,resizeColumn:!0,fi:"c_vnd",di:"asc",searchBar:void 0,searchMethod:"getLinkCodes",old_stri:"",columns:[{id:"id_vnd",width:270,hidden:!1,sort:"int",header:[{text:"Код поставщика"},{content:"textFilter"}]},{id:"c_vnd",hidden:!1,sort:"string",fillspace:!0,header:[{text:"Название поставщика"},{content:"textFilter"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onItemDblClick:function(e){var t=this.getItem(e);this.$scope.show_b(),this.remove(e),delete t.id,this.$scope.$$("_rTable").add(t,0)},onKeyPress:function(e,t){13===e&&this.getSelectedItem()&&this.callEvent("onItemDblClick")},onAfterLoad:function(){this.hideProgress()}}}]},{width:10},{rows:[{cols:[{view:"label",label:"Не сводить по кодам автоматически",css:"c-label",height:40,fillspace:!0},{view:"button",tooltip:"Перенести все",type:"htmlbutton",label:"<span class='webix_icon fa-angle-double-left'></span>",localId:"_to_l",resizable:!1,width:40,click:function(){var t=e.$$("_rTable").serialize();e.$$("_rTable").clearAll(),t.forEach(function(t){delete t.id,e.$$("_lTable").add(t)}),e.show_b()}},{view:"button",tooltip:"Сбросить фильтры",type:"imageButton",image:"./addons/img/unfilter.svg",localId:"_unfilt_r",resizable:!1,label:"",width:40,click:function(){var t=e.$$("_rTable");Object(n.unFilter)(t),e.$$("_rTable").filterByAll()}}]},{view:"datatable",name:"_nrTable",localId:"_rTable",select:!0,borderless:!0,rowHeight:30,fixedRowHeight:!1,headermenu:!1,resizeColumn:!0,fi:"c_vnd",di:"asc",searchBar:void 0,searchMethod:"getLinkCodes",old_stri:"",columns:[{id:"id_vnd",width:270,hidden:!1,sort:"int",header:[{text:"Код поставщика"},{content:"textFilter"}]},{id:"c_vnd",hidden:!1,sort:"string",fillspace:!0,header:[{text:"Название поставщика"},{content:"textFilter"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onItemDblClick:function(e){var t=this.getItem(e);this.$scope.show_b(),this.remove(e),delete t.id,this.$scope.$$("_lTable").add(t,0)},onKeyPress:function(e,t){13===e&&this.getSelectedItem()&&this.callEvent("onItemDblClick")},onAfterLoad:function(){this.hideProgress()}}}]}]}]}},t.prototype.init=function(){},t.prototype.show_b=function(){this.$$("_apply").show(),this.$$("_cancel").show()},t.prototype.hide_b=function(){this.$$("_apply").hide(),this.$$("_cancel").hide()},t.prototype.ready=function(){var e=this;this.hide_b(),this.$$("_lTable").clearAll(),this.$$("_rTable").clearAll();var t=[this.$$("_renew"),this.$$("_apply"),this.$$("_cancel")];Object(n.setButtons)(this.app,t);var i=this.app.config.user,o=this.app.config.r_url+"?getLinkCodes",r={user:i};Object(n.request)(o,r).then(function(t){(t=Object(n.checkVal)(t,"a"))&&(t.p.forEach(function(t){e.$$("_lTable").add(t)}),t.r.forEach(function(t){e.$$("_rTable").add(t)}))})},t}(o.c);t.default=r},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(0),r=i(31);var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e,t=this,i=this.app,o={rows:[{cols:[{view:"label",label:"Постащики, запрещенные к сведению",css:"c-label",height:40,fillspace:!0},{view:"button",tooltip:"Перенести все",type:"htmlbutton",label:"<span class='webix_icon fa-angle-double-right'></span>",localId:"_to_r",resizable:!1,width:40,click:function(){var e=t.$$("_lTable").serialize();t.$$("_lTable").clearAll(),e.forEach(function(e){delete e.id,t.$$("_rTable").add(e),t.show_b()})}},{view:"button",tooltip:"Перенести выделенные",type:"htmlbutton",hidden:!0,label:"<span class='webix_icon fa-angle-right'></span>",localId:"_to_r_s",resizable:!1,width:40,click:function(){var e=t.$$("_lTable").getSelectedId();e.length||(e=[e]),e.forEach(function(e){var i=t.$$("_lTable").getItem(e);delete i.id,t.$$("_rTable").add(i,0),t.$$("_lTable").remove(e),t.show_b()})}},{view:"button",tooltip:"Сбросить фильтры",type:"imageButton",image:"./addons/img/unfilter.svg",localId:"_unfilt_p",resizable:!1,label:"",width:40,click:function(){var e=t.$$("_lTable");unFilter(e),t.$$("_lTable").filterByAll()}}]},{view:"datatable",name:"_lTable",localId:"_lTable",select:!0,multiselect:!0,borderless:!0,rowHeight:30,fixedRowHeight:!1,headermenu:!1,resizeColumn:!0,onMouseMove:!0,columns:[{id:"code",header:[{text:"Код поставщика"},{content:"textFilter"}]},{id:"name",fillspace:!0,header:[{text:"Наименование поставщика"},{content:"textFilter"}]},{id:"owner",width:150,header:[{text:"Кто добавил"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onMouseMoving:function(e){if("webix_ss_center_scroll"===e.target.parentElement.parentElement.className&&1===e.buttons){var t=e.target.getAttribute("aria-rowindex"),i=this.data.order[t];this.getItem(i);this.isSelected(i)||(this.select(i,!0),this.$scope.$$("_to_r_s").show())}return!0},onAfterSelect:function(e){this.$scope.$$("_to_r_s").show()},onAfterUnSelect:function(){var e=this,t=!1;this.data.order.forEach(function(i){e.isSelected(i)&&(t=!0)}),t||this.$scope.$$("_to_r_s").hide()},onItemDblClick:function(e){var t=this.getItem(e);this.$scope.newcode.show("Редактирование поставщика",this.$scope.$$("_lTable"),t)},onKeyPress:function(e,t){13===e&&this.getSelectedItem()&&this.callEvent("onItemDblClick")},onAfterLoad:function(){this.hideProgress()}}}]},r={rows:[{cols:[{view:"label",label:"Поставщики",css:"c-label",height:40,fillspace:!0},{view:"button",type:"htmlbutton",hidden:!i.config.roles[i.config.role].useradd,tooltip:"Добавить исключение",localId:"_add",resizable:!0,sWidth:130,eWidth:40,label:"",width:40,extLabel:"<span style='line-height: 20px;padding-left: 5px'>исключение</span>",oldLabel:"<span class='webix_icon fa-plus'></span>",click:function(){t.newcode.show("Добавление нового поставщика",t.$$("_rTable"))}},(e={view:"button",type:"htmlbutton",hidden:!i.config.roles[i.config.role].useradd},e.hidden=!0,e.tooltip="Удалить исключение",e.localId="_del",e.resizable=!0,e.sWidth=130,e.eWidth=40,e.label="",e.width=40,e.extLabel="<span style='line-height: 20px;padding-left: 5px'>исключение</span>",e.oldLabel="<span class='webix_icon fa-minus', style='color: red'></span>",e.click=function(){webix.message({text:"Удаление поставщика",type:"debug",width:"400px",delay:"5"})},e),{view:"button",tooltip:"Перенести выделенные",type:"htmlbutton",hidden:!0,label:"<span class='webix_icon fa-angle-left'></span>",localId:"_to_l_s",resizable:!1,width:40,click:function(){var e=t.$$("_rTable").getSelectedId();e.length||(e=[e]),e.forEach(function(e){var i=t.$$("_rTable").getItem(e);delete i.id,t.$$("_lTable").add(i,0),t.$$("_rTable").remove(e),t.show_b()})}},{view:"button",tooltip:"Перенести все",type:"htmlbutton",label:"<span class='webix_icon fa-angle-double-left'></span>",localId:"_to_l",resizable:!1,width:40,click:function(){var e=t.$$("_rTable").serialize();t.$$("_rTable").clearAll(),e.forEach(function(e){delete e.id,t.$$("_lTable").add(e),t.show_b()})}},{view:"button",tooltip:"Сбросить фильтры",type:"imageButton",image:"./addons/img/unfilter.svg",localId:"_unfilt_r",resizable:!1,label:"",width:40,click:function(){var e=t.$$("_rTable");unFilter(e),t.$$("_rTable").filterByAll()}}]},{view:"datatable",name:"_rTable",localId:"_rTable",select:!0,multiselect:!0,borderless:!0,rowHeight:30,fixedRowHeight:!1,headermenu:!1,resizeColumn:!0,onMouseMove:!0,columns:[{id:"code",header:[{text:"Код поставщика"},{content:"textFilter"}]},{id:"name",fillspace:!0,header:[{text:"Наименование поставщика"},{content:"textFilter"}]},{id:"owner",width:150,header:[{text:"Кто добавил"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onMouseMoving:function(e){if("webix_ss_center_scroll"===e.target.parentElement.parentElement.className&&1===e.buttons){var t=e.target.getAttribute("aria-rowindex"),i=this.data.order[t];this.getItem(i);this.isSelected(i)||(this.select(i,!0),this.$scope.$$("_to_l_s").show(),this.$scope.$$("_del").show())}return!0},onAfterSelect:function(e){this.$scope.$$("_to_l_s").show(),this.$scope.$$("_del").show()},onAfterUnSelect:function(){var e=this,t=!1;this.data.order.forEach(function(i){e.isSelected(i)&&(t=!0)}),t||(this.$scope.$$("_to_l_s").hide(),this.$scope.$$("_del").hide())},onItemDblClick:function(e){var t=this.getItem(e);this.$scope.newcode.show("Редактирование поставщика",this.$scope.$$("_rTable"),t)},onKeyPress:function(e,t){13===e&&this.getSelectedItem()&&this.callEvent("onItemDblClick")},onAfterLoad:function(){this.hideProgress()}}}]},s={height:40,view:"toolbar",borderless:!0,cols:[{},{view:"button",type:"htmlbutton",localId:"_renew",resizable:!0,sWidth:136,eWidth:40,label:"",width:40,tooltip:"Обновить таблицу",extLabel:"<span style='line-height: 20px;padding-left: 5px'>Обновить</span>",oldLabel:"<span class='webix_icon fa-refresh'></span>",click:function(){t.ready()}},{view:"button",type:"htmlbutton",localId:"_apply",hidden:!0,resizable:!0,sWidth:130,eWidth:40,label:"",width:40,extLabel:"<span style='line-height: 20px;padding-left: 5px'>Применить</span>",oldLabel:"<span class='webix_icon fa-check'></span>",click:function(){var e={};e.l=t.$$("_lTable").serialize(),e.r=t.$$("_rTable").serialize();var o=i.config.user,r=i.config.r_url+"?setLinkSuppl",s={user:o,data:e};console.log("data",s),Object(n.request)(r,s).then(function(e){(e=Object(n.checkVal)(e,"a"))&&t.hide_b()})}},{view:"button",type:"htmlbutton",localId:"_cancel",hidden:!0,resizable:!0,sWidth:130,eWidth:40,label:"",width:40,extLabel:"<span style='line-height: 20px;padding-left: 5px'>Отменить</span>",oldLabel:"<span class='webix_icon fa-times'></span>",click:function(){t.ready()}}]};i.config.roles[i.config.role].useradd;return{view:"layout",css:{"border-left":"1px solid #dddddd !important"},rows:[s,{cols:[o,{width:10},r]}]}},t.prototype.show_b=function(){this.$$("_apply").show(),this.$$("_cancel").show()},t.prototype.hide_b=function(){this.$$("_apply").hide(),this.$$("_cancel").hide()},t.prototype.init=function(){this.newcode=this.ui(r.default)},t.prototype.ready=function(){var e=this;this.$$("_lTable").clearAll(),this.$$("_rTable").clearAll();var t=[this.$$("_renew"),this.$$("_apply"),this.$$("_cancel"),this.$$("_add"),this.$$("_del")];Object(n.setButtons)(this.app,t);var i=this.app.config.user,o=this.app.config.r_url+"?getLinkSuppl",r={user:i};Object(n.request)(o,r).then(function(t){(t=Object(n.checkVal)(t,"a"))&&(t.r.forEach(function(t){e.$$("_lTable").add(t)}),t.p.forEach(function(t){e.$$("_rTable").add(t)}))}),this.hide_b()},t}(o.c);t.default=s},function(e,t,i){"use strict";i.r(t);var o=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this,t=this.app,i=this;return{view:"cWindow",modal:!0,on:{onShow:function(){e.$$("code").focus()},onHide:function(){e.$$("_n_f").clear(),e.$$("_n_f").clearValidation()}},body:{view:"form",localId:"_n_f",parent:void 0,item:void 0,margin:0,rules:{code:function(e){var t=!0;if(parseFloat(e)==e){var o=i.$$("_n_f").config.parent;o&&o.eachRow(function(i){+o.getItem(i).code==+e&&(t=!1)},!0)}else t=!1;return i.$$("_n_f").config.item&&(t=!0),t},name:webix.rules.isNotEmpty},elements:[{cols:[{view:"text",localId:"code",label:"Код",value:"",width:120,name:"code",labelPosition:"top",labelAlign:"center",required:!0,invalidMessage:"Ошибочный код",readonly:!0},{view:"text",label:"Название",value:"",width:220,name:"name",labelPosition:"top",labelAlign:"center",localId:"name",required:!0,invalidMessage:"Введите значение"},{view:"text",label:"Непонятное поле",value:"",width:150,name:"inn",labelPosition:"top",labelAlign:"center",localId:"inn",required:!1,invalidMessage:"Введите значение"}]},{height:15},{height:30,cols:[{view:"button",type:"base",label:"Отменить",width:120,click:function(){e.hide()}},{},{view:"button",type:"base",label:"Сохранить",width:120,click:function(){if(e.$$("_n_f").validate({hidden:!1,disabled:!1})){var i=e.$$("_n_f").getValues();i.change=2,i.process=1,i.owner=t.config.user,e.$$("_n_f").config.item?e.$$("_n_f").config.parent.updateItem(e.$$("_n_f").config.item.id,i):e.$$("_n_f").config.parent.add(i,0),e.hide(),e.$$("_n_f").config.parent.$scope.show_b()}}}]}]}}},t.prototype.show=function(e,t,i){this.$$("_n_f").config.parent=t,this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show(),i?(this.$$("_n_f").config.item=i,this.$$("code").setValue(i.code),this.$$("name").setValue(i.name),this.$$("inn").setValue(i.inn),this.$$("code").define({readonly:!0})):(this.$$("_n_f").config.item=void 0,this.$$("code").define({readonly:!1})),this.$$("_n_f").refresh(),this.$$("code").refresh()},t.prototype.hide=function(){this.getRoot().hide()},t}(i(1).c);t.default=o},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(0),r=i(33);var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e,t=this,i=this.app;return{view:"layout",css:{"border-left":"1px solid #dddddd !important"},rows:[{height:40,view:"toolbar",borderless:!0,cols:[{},{view:"button",type:"htmlbutton",localId:"_renew",resizable:!0,sWidth:136,eWidth:40,label:"",width:40,tooltip:"Обновить таблицу",extLabel:"<span style='line-height: 20px;padding-left: 5px'>Обновить</span>",oldLabel:"<span class='webix_icon fa-refresh'></span>",click:function(){t.ready()}},{view:"button",type:"htmlbutton",localId:"_apply",hidden:!0,resizable:!0,sWidth:130,eWidth:40,label:"",width:40,extLabel:"<span style='line-height: 20px;padding-left: 5px'>Применить</span>",oldLabel:"<span class='webix_icon fa-check'></span>",click:function(){var e={};e.l=t.$$("_lTable").serialize(),e.r=t.$$("_rTable").serialize();var o=i.config.user,r=i.config.r_url+"?setLinkExcludes",s={user:o,data:e};Object(n.request)(r,s).then(function(e){(e=Object(n.checkVal)(e,"a"))&&t.hide_b()})}},{view:"button",type:"htmlbutton",localId:"_cancel",hidden:!0,resizable:!0,sWidth:130,eWidth:40,label:"",width:40,extLabel:"<span style='line-height: 20px;padding-left: 5px'>Отменить</span>",oldLabel:"<span class='webix_icon fa-times'></span>",click:function(){t.ready()}}]},{cols:[{rows:[{cols:[{view:"label",label:"Слова исключения из сведения",css:"c-label",height:40,fillspace:!0},{view:"button",tooltip:"Перенести все",type:"htmlbutton",label:"<span class='webix_icon fa-angle-double-right'></span>",localId:"_to_r",resizable:!1,width:40,click:function(){var e=t.$$("_lTable").serialize();t.$$("_lTable").clearAll(),e.forEach(function(e){delete e.id,t.$$("_rTable").add(e),t.show_b()})}},{view:"button",tooltip:"Перенести выделенные",type:"htmlbutton",hidden:!0,label:"<span class='webix_icon fa-angle-right'></span>",localId:"_to_r_s",resizable:!1,width:40,click:function(){var e=t.$$("_lTable").getSelectedId();e.length||(e=[e]),e.forEach(function(e){var i=t.$$("_lTable").getItem(e);delete i.id,t.$$("_rTable").add(i,0),t.$$("_lTable").remove(e),t.show_b()})}},{view:"button",tooltip:"Сбросить фильтры",type:"imageButton",image:"./addons/img/unfilter.svg",localId:"_unfilt_p",resizable:!1,label:"",width:40,click:function(){var e=t.$$("_lTable");Object(n.unFilter)(e),t.$$("_lTable").filterByAll()}}]},{view:"datatable",name:"_lTable",localId:"_lTable",select:!0,multiselect:!0,borderless:!0,rowHeight:30,fixedRowHeight:!1,headermenu:!1,resizeColumn:!0,onMouseMove:!0,columns:[{id:"name",fillspace:!0,header:[{text:"Наименование исключения"},{content:"textFilter"}]},{id:"options_st",header:[{text:"Параметры исключения",colspan:2,css:{"text-align":"center"}},{text:"Начинается",css:{"text-align":"center"}}],template:function(e,t,i){return i?"<span class='webix_icon fa-check'></span>":"<span></span>"},width:100,css:"center_p"},{id:"options_in",header:["",{text:"Содержит",css:{"text-align":"center"}}],template:function(e,t,i){return i?"<span class='webix_icon fa-check'></span>":"<span></span>"},width:100,css:"center_p"},{id:"owner",width:150,header:[{text:"Кто добавил"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onMouseMoving:function(e){if("webix_ss_center_scroll"===e.target.parentElement.parentElement.className&&1===e.buttons){var t=e.target.getAttribute("aria-rowindex"),i=this.data.order[t];this.getItem(i);this.isSelected(i)||(this.select(i,!0),this.$scope.$$("_to_r_s").show())}return!0},onAfterSelect:function(e){this.$scope.$$("_to_r_s").show()},onAfterUnSelect:function(){var e=this,t=!1;this.data.order.forEach(function(i){e.isSelected(i)&&(t=!0)}),t||this.$scope.$$("_to_r_s").hide()},onItemDblClick:function(e){var t=this.getItem(e);this.$scope.newexclude.show("Редактирование исключения",this.$scope.$$("_lTable"),t)},onKeyPress:function(e,t){13===e&&this.getSelectedItem()&&this.callEvent("onItemDblClick")},onAfterLoad:function(){this.hideProgress()}}}]},{width:10},{rows:[{cols:[{view:"label",label:"Общий список слов исключений",css:"c-label",height:40,fillspace:!0},{view:"button",type:"htmlbutton",hidden:!i.config.roles[i.config.role].useradd,tooltip:"Добавить исключение",localId:"_add",resizable:!0,sWidth:130,eWidth:40,label:"",width:40,extLabel:"<span style='line-height: 20px;padding-left: 5px'>исключение</span>",oldLabel:"<span class='webix_icon fa-plus'></span>",click:function(){t.newexclude.show("Добавление нового исключения",t.$$("_rTable"))}},(e={view:"button",type:"htmlbutton",hidden:!i.config.roles[i.config.role].useradd},e.hidden=!0,e.tooltip="Удалить исключение",e.localId="_del",e.resizable=!0,e.sWidth=130,e.eWidth=40,e.label="",e.width=40,e.extLabel="<span style='line-height: 20px;padding-left: 5px'>исключение</span>",e.oldLabel="<span class='webix_icon fa-minus', style='color: red'></span>",e.click=function(){webix.message({text:"Удаление исключения",type:"debug",width:"400px",delay:"5"})},e),{view:"button",tooltip:"Перенести выделенные",type:"htmlbutton",hidden:!0,label:"<span class='webix_icon fa-angle-left'></span>",localId:"_to_l_s",resizable:!1,width:40,click:function(){var e=t.$$("_rTable").getSelectedId();e.length||(e=[e]),e.forEach(function(e){var i=t.$$("_rTable").getItem(e);delete i.id,t.$$("_lTable").add(i,0),t.$$("_rTable").remove(e),t.show_b()})}},{view:"button",tooltip:"Перенести все",type:"htmlbutton",label:"<span class='webix_icon fa-angle-double-left'></span>",localId:"_to_l",resizable:!1,width:40,click:function(){var e=t.$$("_rTable").serialize();t.$$("_rTable").clearAll(),e.forEach(function(e){delete e.id,t.$$("_lTable").add(e),t.show_b()})}},{view:"button",tooltip:"Сбросить фильтры",type:"imageButton",image:"./addons/img/unfilter.svg",localId:"_unfilt_r",resizable:!1,label:"",width:40,click:function(){var e=t.$$("_rTable");Object(n.unFilter)(e),t.$$("_rTable").filterByAll()}}]},{view:"datatable",name:"_rTable",localId:"_rTable",select:!0,multiselect:!0,borderless:!0,rowHeight:30,fixedRowHeight:!1,headermenu:!1,resizeColumn:!0,onMouseMove:!0,columns:[{id:"name",fillspace:!0,header:[{text:"Наименование исключения"},{content:"textFilter"}]},{id:"options_st",header:[{text:"Параметры исключения",colspan:2,css:{"text-align":"center"}},{text:"Начинается",css:{"text-align":"center"}}],template:function(e,t,i){return i?"<span class='webix_icon fa-check'></span>":"<span></span>"},width:100,css:"center_p"},{id:"options_in",header:["",{text:"Содержит",css:{"text-align":"center"}}],template:function(e,t,i){return i?"<span class='webix_icon fa-check'></span>":"<span></span>"},width:100,css:"center_p"},{id:"owner",width:150,header:[{text:"Кто добавил"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onMouseMoving:function(e){if("webix_ss_center_scroll"===e.target.parentElement.parentElement.className&&1===e.buttons){var t=e.target.getAttribute("aria-rowindex"),i=this.data.order[t];this.getItem(i);this.isSelected(i)||(this.select(i,!0),this.$scope.$$("_to_l_s").show(),this.$scope.$$("_del").show())}return!0},onAfterSelect:function(e){this.$scope.$$("_to_l_s").show(),this.$scope.$$("_del").show()},onAfterUnSelect:function(){var e=this,t=!1;this.data.order.forEach(function(i){e.isSelected(i)&&(t=!0)}),t||(this.$scope.$$("_to_l_s").hide(),this.$scope.$$("_del").hide())},onItemDblClick:function(e){var t=this.getItem(e);this.$scope.newexclude.show("Редактирование исключения",this.$scope.$$("_rTable"),t)},onKeyPress:function(e,t){13===e&&this.getSelectedItem()&&this.callEvent("onItemDblClick")},onAfterLoad:function(){this.hideProgress()}}}]}]}]}},t.prototype.init=function(){this.newexclude=this.ui(r.default)},t.prototype.show_b=function(){this.$$("_apply").show(),this.$$("_cancel").show()},t.prototype.hide_b=function(){this.$$("_apply").hide(),this.$$("_cancel").hide()},t.prototype.ready=function(e){var t=this;this.$$("_lTable").clearAll(),this.$$("_rTable").clearAll();var i=[this.$$("_renew"),this.$$("_apply"),this.$$("_cancel"),this.$$("_add"),this.$$("_del")];Object(n.setButtons)(this.app,i);var o=this.app.config.user,r=this.app.config.r_url+"?getLinkExcludes",s={user:o};Object(n.request)(r,s).then(function(e){(e=Object(n.checkVal)(e,"a"))&&(e.l.forEach(function(e){t.$$("_lTable").add(e)}),e.r.forEach(function(e){t.$$("_rTable").add(e)}))}),this.hide_b()},t}(o.c);t.default=s},function(e,t,i){"use strict";i.r(t);var o=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this,t=this.app;return{view:"cWindow",modal:!0,on:{onShow:function(){e.$$("name").focus()},onHide:function(){e.$$("_n_f").clear(),e.$$("_n_f").clearValidation()}},body:{view:"form",localId:"_n_f",parent:void 0,item:void 0,margin:0,rules:{name:webix.rules.isNotEmpty},elements:[{cols:[{view:"text",label:"Слово исключение",value:"",width:220,name:"name",labelPosition:"top",labelAlign:"center",required:!0,invalidMessage:"Введите значение",localId:"name"},{view:"radio",label:"условие",value:1,width:220,labelPosition:"top",labelAlign:"center",vertical:!1,localId:"conditions",options:[{id:0,value:"<span style='color: #666666'>начинается</span>"},{id:1,value:"<span style='color: #666666'>содержит</span>"}]}]},{height:15},{height:30,cols:[{view:"button",type:"base",label:"Отменить",width:120,click:function(){e.hide()}},{},{view:"button",type:"base",label:"Сохранить",width:120,click:function(){if(e.$$("_n_f").validate({hidden:!1,disabled:!1})){var i=e.$$("_n_f").getValues();i.change=2,i.process=1;var o=e.$$("conditions").getValue();1==+o?(i.options_st=0,i.options_in=1):0==+o&&(i.options_st=1,i.options_in=0),i.owner=t.config.user,e.$$("_n_f").config.item?e.$$("_n_f").config.parent.updateItem(e.$$("_n_f").config.item.id,i):e.$$("_n_f").config.parent.add(i,0),e.hide(),e.$$("_n_f").config.parent.$scope.show_b()}}}]}]}}},t.prototype.show=function(e,t,i){this.$$("_n_f").config.parent=t,this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show(),i?(this.$$("_n_f").config.item=i,this.$$("name").setValue(i.name),this.$$("conditions").setValue(i.options_st?0:1),this.$$("_n_f").refresh()):this.$$("_n_f").config.item=void 0},t.prototype.hide=function(){this.getRoot().hide()},t}(i(1).c);t.default=o},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(0),r=i(35);var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this;this.app;return{view:"layout",css:{"border-left":"1px solid #dddddd !important"},rows:[{height:40,view:"toolbar",borderless:!0,cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Строка поиска",tooltip:"Поиск"},{view:"button",type:"htmlbutton",localId:"_add",resizable:!0,sWidth:75,eWidth:40,label:"",width:40,extLabel:"<span style='line-height: 20px;padding-left: 5px'>файл</span>",oldLabel:"<span class='webix_icon fa-plus'></span>",click:function(){e.pop_upl.show_window("Загрузка файла")}},{view:"button",type:"htmlbutton",localId:"_renew",resizable:!0,sWidth:136,eWidth:40,label:"",width:40,extLabel:"<span style='line-height: 20px;padding-left: 5px'>Обновить</span>",oldLabel:"<span class='webix_icon fa-refresh'></span>",click:function(){var t=e.app.config.user,i=e.app.config.r_url+"?getTasks",o={user:t};Object(n.request)(i,o).then(function(t){(t=Object(n.checkVal)(t,"a")).length>0?e.$$("__table").parse(t):e.$$("__table").clearAll()})}}]},{view:"datatable",name:"_files",localId:"__table",select:!0,resizeColumn:!0,borderless:!0,navigation:"row",rowHeight:32,fixedRowHeight:!1,rowLineHeight:32,editable:!1,columns:[{id:"uin",width:260,header:[{text:"Идентификатор задания"}]},{id:"vendor",fillspace:1,header:[{text:"Поставщик"}]},{id:"customer",width:150,header:[{text:"Клиент"}]},{id:"source",width:130,header:[{text:"Источник"}]},{id:"count",width:130,header:[{text:"Осталось позиций"}]},{id:"dt",width:200,format:n.dt_formating_sec,header:[{text:"Время добавления"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)}}}]}},t.prototype.init=function(){this.pop_upl=this.ui(r.default)},t.prototype.ready=function(e){var t=this,i=[this.$$("_renew"),this.$$("_add")];Object(n.setButtons)(this.app,i);var o=this.app.config.user,r=this.app.config.r_url+"?getTasks",s={user:o};Object(n.request)(r,s).then(function(e){(e=Object(n.checkVal)(e,"a")).length>0&&t.$$("__table").parse(e)})},t}(o.c);t.default=s},function(e,t,i){"use strict";i.r(t);var o=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this;this.app;return{view:"cWindow",modal:!1,on:{onHide:function(){e.$$("__upl_1").files.clearAll()}},body:{view:"form",rows:[{view:"uploader",localId:"__upl_1",type:"iconButton",icon:"plus-circle",multiple:!0,autosend:!1,align:"left",label:"Добавить файл",directory:!1,accept:"application/nolink",urlData:{},link:void 0,upload:"localhost"===location.hostname?"http://saas.local/linker_upl":"../linker_upl",datatype:"json",on:{onUploadComplete:function(t){console.log("ok",t),e.hide_window()}}},{view:"list",localId:"_f_list",type:"uploader",autoheight:!0,borderless:!0},{view:"button",label:"Отправить",type:"iconButton",icon:"upload",click:function(){e.$$("__upl_1").files.data.each(function(t){t.urlData={filename:t.name,source:"linker"},e.$$("__upl_1").send(t.id)})}}]}}},t.prototype.ready=function(){this.$$("__upl_1").define({link:this.$$("_f_list").config.id}),this.$$("__upl_1").refresh()},t.prototype.show_window=function(e){this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show(),this.$$("__upl_1").fileDialog()},t.prototype.hide_window=function(){this.getRoot().hide()},t.prototype.init=function(){},t}(i(1).c);t.default=o},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(0),r=i(3);var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this;return{view:"layout",rows:[{height:40,view:"toolbar",cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Строка поиска",keyPressTimeout:900,tooltip:"поиск по НДС",on:{onTimedKeyPress:function(e,t){var i=this.getValue().toString().toLowerCase();this.$scope.$$("__table").filter(function(e){return-1!=e.nds.toString().toLowerCase().indexOf(i)})}}},{view:"button",type:"htmlbutton",tooltip:"Добавить НДС",localId:"_add",resizable:!0,sWidth:180,eWidth:40,label:"",width:40,extLabel:"<span style='line-height: 20px;padding-left: 5px'>Добавить НДС</span>",oldLabel:"<span class='webix_icon fa-plus'></span>",click:function(){var t={type:"Nds",callback:n.addNds,mode:"new",source:e.$$("__table")};e.popnew.show("Добавление НДС",t)}},{view:"button",type:"htmlbutton",hidden:!0,localId:"_del",tooltip:"Удалить НДС",resizable:!0,sWidth:180,eWidth:40,label:"",width:40,extLabel:"<span style='line-height: 20px;padding-left: 5px;'>Удалить НДС</span>",oldLabel:"<span style='color: red', class='webix_icon fa-times'></span>",click:function(){var t=e.$$("__table").getSelectedItem().id,i={};i.user=e.app.config.user,i.id=t;var o=e.app.config.r_url+"?delNds",r=Object(n.request)(o,i,!0).response;(r=Object(n.checkVal)(r,"s"))&&(Object(n.delNds)(r.id),e.$$("_del").hide())}}]},{view:"datatable",name:"_nds",localId:"__table",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,startPos:1,posPpage:20,totalPos:1250,old_stri:"",columns:[{id:"id",width:200,header:[{text:"ID"}]},{id:"nds",headermenu:!1,fillspace:1,sort:"text",header:[{text:"НДС"}]},{id:"id_state",width:150,header:[{text:"Статус"}]},{id:"dt",width:250,header:[{text:"Дата заведения"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){this.count||this.showProgress({type:"icon",icon:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>'})},onItemDblClick:function(e){var t={text:(e=this.getSelectedItem()).nds,id:e.id,type:"Nds",callback:n.updNds,mode:"upd",source:this};this.$scope.popnew.show("Редактирование НДС",t)},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(){e.$$("_del").show()},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}}]}},t.prototype.ready=function(){var e=[this.$$("_add"),this.$$("_del")];Object(n.setButtons)(this.app,e)},t.prototype.init=function(){this.popnew=this.ui(r.default),webix.extend(this.$$("__table"),webix.ProgressBar),this.$$("__table").sync(n.nds.data)},t}(o.c);t.default=s},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(5),r=i(4),s=i(0),a=i(2),l=i(13),c=i(38);var u=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this,t=this.app,i=this,o=$$("sezon_dc").data.getRange($$("sezon_dc").data.getFirstId(),$$("sezon_dc").data.getLastId()),n=[],r=[],c=[],u=[],d=[],p=[],h=[];if(o.forEach(function(e,t,i){var o={id:e.id,value:e.sezon};n.push(o)}),(o=$$("hran_dc").data.getRange($$("hran_dc").data.getFirstId(),$$("hran_dc").data.getLastId())).forEach(function(e,t,i){var o={id:e.id,value:e.usloviya};u.push(o)}),(o=$$("nds_dc").data.getRange($$("nds_dc").data.getFirstId(),$$("nds_dc").data.getLastId())).forEach(function(e,t,i){var o={id:e.id,value:e.nds};c.push(o)}),(o=$$("group_dc").data.getRange($$("group_dc").data.getFirstId(),$$("group_dc").data.getLastId())).forEach(function(e,t,i){var o={id:e.id,value:e.group};r.push(o)}),(o=$$("strana_dc").data.getRange($$("strana_dc").data.getFirstId(),$$("strana_dc").data.getLastId())).forEach(function(e,t,i){var o={id:e.id,value:e.c_strana};d.push(o)}),(o=$$("dv_dc").data.getRange($$("dv_dc").data.getFirstId(),$$("dv_dc").data.getLastId())).forEach(function(e,t,i){var o={id:e.id,value:e.act_ingr};p.push(o)}),(o=$$("vendor_dc").data.getRange($$("vendor_dc").data.getFirstId(),$$("vendor_dc").data.getLastId())).length>1)o.forEach(function(e,t,i){var o={id:e.id,value:e.c_zavod};h.push(o)});else{var f=t.config.r_url+"?getVendorAll",_={user:t.config.user},g=Object(s.checkVal)(Object(s.request)(f,_,!0).response,"s");g&&g.forEach(function(e,t,i){var o={id:e.id,value:e.c_zavod};h.push(o)})}return{view:"layout",rows:[{view:"toolbar",height:40,cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Введите наименование",localId:"_sb",on:{onKeyPress:function(e,t){clearTimeout(this.config._keytimed),Object(s.checkKey)(e)&&(this.config._keytimed=setTimeout(function(){var e=i.getRoot().getChildViews()[2].$scope.$$("__page").getValue();i.getRoot().getChildViews()[2].$scope.$$("__page").setValue(0==+e?"1":"0"),i.getRoot().getChildViews()[2].$scope.$$("__page").refresh()},this.$scope.app.config.searchDelay))}}},{view:"button",type:"htmlbutton",localId:"_history",resizable:!0,sWidth:126,eWidth:40,label:"",width:40,extLabel:"<span style='line-height: 20px;padding-left: 5px'>История</span>",oldLabel:"<span class='webix_icon fa-history'></span>",click:function(){var t=webix.storage.session.get(e.$$("__table").config.name);e.pophistory.show(t,e.$$("_sb"))}},{view:"button",tooltip:"Сбросить фильтры",type:"imageButton",image:"./addons/img/unfilter.svg",localId:"_unfilt",resizable:!0,sWidth:180,eWidth:40,label:"",width:40,extLabel:"<span style='line-height: 20px;padding-left: 5px'>Сбросить фильтры</span>",oldLabel:"",click:function(){var t=e.$$("__table");t.config.columns.forEach(function(e){t.isColumnVisible(e.id)&&e.header[1]&&("function"==typeof t.getFilter(e.id).setValue?t.getFilter(e.id).setValue(""):t.getFilter(e.id).value="")}),e.$$("_sb").callEvent("onKeyPress",[13])}},{view:"button",type:"htmlbutton",tooltip:"Добавить эталон",localId:"_add",resizable:!0,sWidth:180,eWidth:40,label:"",width:40,extLabel:"<span style='line-height: 20px;padding-left: 5px'>Добавить эталон</span>",oldLabel:"<span class='webix_icon fa-plus'></span>",click:function(){e.popnew.show("Новый эталон",e.$$("_sb"))}},{view:"button",type:"htmlbutton",hidden:!0,localId:"_del",tooltip:"Удалить эталон",resizable:!0,sWidth:180,eWidth:40,label:"",width:40,extLabel:"<span style='line-height: 20px;padding-left: 5px;'>Удалить эталон</span>",oldLabel:"<span style='color: red', class='webix_icon fa-times'></span>",click:function(){var t=e.$$("__table").getSelectedItem();e.poprelink.show("Удаление эталона. Выберите товар, к которому будут привязаны связки и штрихкоды удаляемого",t,e)}}]},{view:"datatable",name:"__dt_as",localId:"__table",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:{autowidth:!0},subview:function(t,i){var o=e.$$("__table").getItem(t.id);o=o.id_spr,(o=Object(s.get_spr)(e,o)).id=t.id,o.s_name="Страна: "+o.c_strana,o.t_name="Название товара: "+o.c_tovar,o.v_name="Производитель: "+o.c_zavod,o.dv_name="Д. вещество: "+o.c_dv;var n=new l.default(e.app,{pager:e.$$("__table").getParentView().getChildViews()[2].$scope.$$("__page"),dt:e.$$("__table"),item:o,header:"<span style='color: red; text-transform: uppercase;'>Редактирование записи </span>"+o.id_spr,search_bar:e.$$("_sb")});return e.ui(n,{container:i}),n.getRoot()},startPos:1,posPpage:t.config.posPpage,totalPos:1250,fi:"c_tovar",di:"asc",searchBar:void 0,searchMethod:"getSprSearchAdm",old_stri:"",css:"dt_css",columns:[{id:"id_mnn",width:75,template:function(e){return 0!=+e.id_dv?"<span class='webix_icon fa-check-circle', style='color: green'></span>":"<span class='webix_icon fa-times-circle', style='color: red'></span>"},css:"center_p",header:[{text:"МНН"}]},{id:"id_spr",width:80,sort:"server",header:[{text:"IDSPR"},{content:"cFilt",inputConfig:{pager:2}}],headermenu:!1},{id:"c_tovar",fillspace:1,sort:"server",header:[{text:"Наименование"}],headermenu:!1},{id:"id_zavod",sort:"server",width:300,header:[{text:"Производитель"},{content:"richFilt",compare:s.compareTrue,inputConfig:{inputtype:"combo",options:{data:h}}}]},{id:"id_strana",sort:"server",width:200,header:[{text:"Страна"},{content:"richFilt",compare:s.compareTrue,inputConfig:{inputtype:"combo",options:{data:d}}}]},{id:"c_dv",hidden:!0,sort:"server",width:300,header:[{text:"Д. в-во"},{content:"richFilt",compare:s.compareTrue,inputConfig:{inputtype:"combo",options:{data:p}}}]},{id:"c_group",hidden:!0,width:300,header:[{text:"Группа"},{content:"richFilt",compare:s.compareTrue,inputConfig:{inputtype:"combo",options:{data:r}}}]},{id:"c_nds",hidden:!0,width:150,header:[{text:"НДС"},{content:"richFilt",compare:s.compareTrue,inputConfig:{options:c}}]},{id:"c_hran",hidden:!0,width:150,header:[{text:"Условия хранения"},{content:"richFilt",compare:s.compareTrue,inputConfig:{options:u}}]},{id:"c_sezon",hidden:!0,width:180,header:[{text:"Сезонность"},{content:"richFilt",compare:s.compareTrue,inputConfig:{options:n}}]},{id:"mandat",width:100,template:function(e){return e.c_mandat?"<div><span class='webix_icon fa-check-circle'></span></div>":"<div><span class='webix_icon fa-times'></span></div>"},hidden:!0,css:"center_p",header:[{text:"Обязательный"},{content:"richFilt",compare:s.compareTrue,inputConfig:{options:[{id:1,value:"Да"},{id:2,value:"Нет"}]}}]},{id:"prescr",width:100,hidden:!0,css:"center_p",template:function(e){return e.c_prescr?"<div><span class='webix_icon fa-check-circle'></span></div>":"<div><span class='webix_icon fa-times'></span></div>"},header:[{text:"Рецептурный"},{content:"richFilt",compare:s.compareTrue,inputConfig:{options:[{id:1,value:"Да"},{id:2,value:"Нет"}]}}]},{id:"dt",width:200,sort:"server",format:s.dt_formating_sec,css:"center_p",header:[{text:"Дата изменения"},{content:"dateRangeFilter",compare:s.compareTrue,inputConfig:{format:s.dt_formating,width:180},suggest:{view:"daterangesuggest",body:{timepicker:!1,calendarCount:2}}}]}],on:{"data->onParse":function(e,t){this.clearAll(),this.$scope.$$("_del").hide()},onBeforeSort:function(t,o){e.$$("__table").config.fi=t,e.$$("__table").config.di=o;var n=i.getRoot().getChildViews()[2].$scope.$$("__page").getValue();i.getRoot().getChildViews()[2].$scope.$$("__page").setValue(0==+n?"1":"0"),i.getRoot().getChildViews()[2].$scope.$$("__page").refresh()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onSubViewClose:function(e){delete this.getItem(e).$subContent,delete this.getItem(e).$subHeight,delete this.getItem(e).$subOpen},onItemDblClick:function(e){this.openSub(this.getSelectedId())},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(){e.$$("_del").show()},onKeyPress:function(e,t){13===e&&this.getSelectedItem()&&this.callEvent("onItemDblClick")}}},{$subview:a.default}]}},t.prototype.ready=function(){var e=this;$$(this.$$("__table").getColumnConfig("dt").header[1].suggest.body.id).getChildViews()[1].getChildViews()[1].setValue("Применить"),$$(this.$$("__table").getColumnConfig("dt").header[1].suggest.body.id).getChildViews()[1].getChildViews()[1].define("click",function(){this._filter_timer&&window.clearTimeout(this._filter_timer),this._filter_timer=window.setTimeout(function(){var t=e.getRoot().getChildViews()[2].$scope,i=t.$$("__page").getValue();t.$$("__page").setValue(0==+i?"1":"0"),t.$$("__page").refresh()},webix.ui.datafilter.textWaitDelay),this.getParentView().getParentView().hide()});var t=[this.$$("_history"),this.$$("_unfilt"),this.$$("_add"),this.$$("_del")];Object(s.setButtons)(this.app,t),this.$$("__table").config.searchBar=this.$$("_sb"),this.$$("_sb").callEvent("onKeyPress",[13]),this.$$("_sb").focus()},t.prototype.init=function(){this.popnew=this.ui(n.default),this.pophistory=this.ui(r.default),this.poprelink=this.ui(c.default)},t}(o.c);t.default=u},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(0),r=i(2);var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this,t=this.app;var i=$$("sezon_dc").data.getRange($$("sezon_dc").data.getFirstId(),$$("sezon_dc").data.getLastId()),o=[],s=[],a=[],l=[],c=[],u=[],d=[];if(i.forEach(function(e,t,i){var n={id:e.id,value:e.sezon};o.push(n)}),(i=$$("hran_dc").data.getRange($$("hran_dc").data.getFirstId(),$$("hran_dc").data.getLastId())).forEach(function(e,t,i){var o={id:e.id,value:e.usloviya};l.push(o)}),(i=$$("nds_dc").data.getRange($$("nds_dc").data.getFirstId(),$$("nds_dc").data.getLastId())).forEach(function(e,t,i){var o={id:e.id,value:e.nds};a.push(o)}),(i=$$("group_dc").data.getRange($$("group_dc").data.getFirstId(),$$("group_dc").data.getLastId())).forEach(function(e,t,i){var o={id:e.id,value:e.group};s.push(o)}),(i=$$("dv_dc").data.getRange($$("dv_dc").data.getFirstId(),$$("dv_dc").data.getLastId())).forEach(function(e,t,i){var o={id:e.id,value:e.act_ingr};u.push(o)}),(i=$$("strana_dc").data.getRange($$("strana_dc").data.getFirstId(),$$("strana_dc").data.getLastId())).length>1)i.forEach(function(e,t,i){var o={id:e.id,value:e.c_strana};c.push(o)});else{var p=t.config.r_url+"?getStranaAll",h={user:t.config.user},f=Object(n.checkVal)(Object(n.request)(p,h,!0).response,"s");f&&f.forEach(function(e,t,i){var o={id:e.id,value:e.c_strana};d.push(o)})}if((i=$$("vendor_dc").data.getRange($$("vendor_dc").data.getFirstId(),$$("vendor_dc").data.getLastId())).length>1)i.forEach(function(e,t,i){var o={id:e.id,value:e.c_zavod};d.push(o)});else{var _=t.config.r_url+"?getVendorAll",g={user:t.config.user},b=Object(n.checkVal)(Object(n.request)(_,g,!0).response,"s");b&&b.forEach(function(e,t,i){var o={id:e.id,value:e.c_zavod};d.push(o)})}var w={view:"layout",rows:[{view:"toolbar",rows:[{view:"label",label:"наименование удаляемого товара",localId:"old_tovar"},{height:40,cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Введите наименование",localId:"_sb",hidden:!1,on:{onKeyPress:function(e,t){var i=this;clearTimeout(this.config._keytimed),Object(n.checkKey)(e)&&(this.config._keytimed=setTimeout(function(){var e=i.$scope.$$("__table").getParentView(),t=e.getChildViews()[2].$scope.$$("__page").getValue();e.getChildViews()[2].$scope.$$("__page").setValue(0==+t?"1":"0"),e.getChildViews()[2].$scope.$$("__page").refresh()},this.$scope.app.config.searchDelay))}}},{view:"button",localId:"__reset",tooltip:"Сбросить фильтры",type:"imageButton",image:"./addons/img/unfilter.svg",width:38,on:{onItemClick:function(){var t=e.$$("__table");t.config.columns.forEach(function(e){t.isColumnVisible(e.id)&&e.header[1]&&("function"==typeof t.getFilter(e.id).setValue?t.getFilter(e.id).setValue(""):t.getFilter(e.id).value="")}),e.$$("_sb").callEvent("onKeyPress",[13])}}}]}]},{view:"datatable",name:"relink",localId:"__table",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:{autowidth:!0},startPos:1,posPpage:20,totalPos:1250,fi:"c_tovar",di:"asc",parent:void 0,searchBar:void 0,searchMethod:"getSprSearchAdm",old_spr:void 0,old_id:void 0,old_stri:"",css:"dt_css",columns:[{id:"id_spr",width:80,sort:"server",header:[{text:"IDSPR"},{content:"cFilt",inputConfig:{pager:2}}],headermenu:!1},{id:"c_tovar",fillspace:1,sort:"server",header:[{text:"Наименование"}],headermenu:!1},{id:"id_zavod",sort:"server",width:300,header:[{text:"Производитель"},{content:"richFilt",compare:n.compareTrue,inputConfig:{inputtype:"combo",options:{data:d}}}]},{id:"id_strana",sort:"server",width:200,header:[{text:"Страна"},{content:"richFilt",compare:n.compareTrue,inputConfig:{inputtype:"combo",options:{data:c}}}]},{id:"c_dv",hidden:!0,sort:"server",width:300,header:[{text:"Д. в-во"},{content:"richFilt",compare:n.compareTrue,inputConfig:{inputtype:"combo",options:{data:u}}}]},{id:"c_group",hidden:!0,width:300,header:[{text:"Группа"},{content:"richFilt",compare:n.compareTrue,inputConfig:{inputtype:"combo",options:{data:s}}}]},{id:"c_nds",hidden:!0,width:150,header:[{text:"НДС"},{content:"richFilt",compare:n.compareTrue,inputConfig:{options:a}}]},{id:"c_hran",hidden:!0,width:150,header:[{text:"Условия хранения"},{content:"richFilt",compare:n.compareTrue,inputConfig:{options:l}}]},{id:"c_sezon",hidden:!0,width:180,header:[{text:"Сезонность"},{content:"richFilt",compare:n.compareTrue,inputConfig:{options:o}}]},{id:"mandat",width:100,template:function(e){return e.c_mandat?"<div><span class='webix_icon fa-check-circle'></span></div>":"<div><span class='webix_icon fa-times'></span></div>"},hidden:!0,css:"center_p",header:[{text:"Обязательный"},{content:"richFilt",compare:n.compareTrue,inputConfig:{options:[{id:1,value:"Да"},{id:2,value:"Нет"}]}}]},{id:"prescr",width:100,hidden:!0,css:"center_p",template:function(e){return e.c_prescr?"<div><span class='webix_icon fa-check-circle'></span></div>":"<div><span class='webix_icon fa-times'></span></div>"},header:[{text:"Рецептурный"},{content:"richFilt",compare:n.compareTrue,inputConfig:{options:[{id:1,value:"Да"},{id:2,value:"Нет"}]}}]},{id:"dt",width:200,sort:"server",format:n.dt_formating_sec,css:"center_p",header:[{text:"Дата изменения"},{content:"dateRangeFilter",compare:n.compareTrue,inputConfig:{format:n.dt_formating,width:180},suggest:{view:"daterangesuggest",body:{timepicker:!1,calendarCount:2}}}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeSort:function(t,i){var o=e.$$("__table").getParentView();e.$$("__table").config.fi=t,e.$$("__table").config.di=i;var n=o.getChildViews()[2].$scope.$$("__page").getValue();o.getChildViews()[2].$scope.$$("__page").setValue(0==+n?"1":"0"),o.getChildViews()[2].$scope.$$("__page").refresh()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onItemDblClick:function(e){e=this.getItem(e.row);var i=t.config.r_url+"?delSpr",o={user:t.config.user,old_spr:this.$scope.$$("__table").config.old_spr,new_spr:e.id_spr},r=Object(n.request)(i,o,!0).response;(r=Object(n.checkVal)(r,"s"))&&(this.config.parent.$$("__table").remove(this.config.old_id),this.config.parent.$$("_del").hide(),this.$scope.hide())},onAfterLoad:function(){this.hideProgress()},onKeyPress:function(e,t){13===e&&this.getSelectedItem()&&this.callEvent("onItemDblClick")}}},{$subview:r.default}]};return{view:"cWindow",width:.95*document.documentElement.clientWidth,height:.95*document.documentElement.clientHeight,modal:!0,on:{onHide:function(){this.$scope.$$("__table").clearAll()}},body:w}},t.prototype.show=function(e,t,i){if(i&&(this.$$("__table").config.parent=i),t){this.$$("old_tovar").setValue("<span style='color:red'>"+t.id_spr+" </span>"+t.c_tovar),this.$$("__table").config.old_spr=t.id_spr,this.$$("__table").config.old_id=t.id,this.$$("__reset").callEvent("onItemClick");var o=t.c_tovar.split(" ")[0];this.$$("__table").config.searchBar.setValue(o)}this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show(),this.$$("_sb").callEvent("onKeyPress",[13])},t.prototype.hide=function(){this.getRoot().hide()},t.prototype.ready=function(){this.$$("__table").config.searchBar=this.$$("_sb")},t.prototype.init=function(){var e=this.$$("__table").getParentView();$$(this.$$("__table").getColumnConfig("dt").header[1].suggest.body.id).getChildViews()[1].getChildViews()[1].setValue("Применить"),$$(this.$$("__table").getColumnConfig("dt").header[1].suggest.body.id).getChildViews()[1].getChildViews()[1].define("click",function(){this._filter_timer&&window.clearTimeout(this._filter_timer),this._filter_timer=window.setTimeout(function(){var t=e.getChildViews()[2].$scope,i=t.$$("__page").getValue();t.$$("__page").setValue(0==+i?"1":"0"),t.$$("__page").refresh()},webix.ui.datafilter.textWaitDelay),this.getParentView().getParentView().hide()})},t}(o.c);t.default=s},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(0),r=i(3);var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this;return{view:"layout",rows:[{view:"toolbar",height:40,cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Строка поиска",keyPressTimeout:900,tooltip:"поиск по поставщику",on:{onTimedKeyPress:function(e,t){var i=this.getValue().toString().toLowerCase();this.$scope.$$("__table").filter(function(e){return-1!=e.c_zavod.toString().toLowerCase().indexOf(i)})}}},{view:"button",type:"htmlbutton",tooltip:"Добавить производителя",localId:"_add",resizable:!0,sWidth:200,eWidth:40,label:"",width:40,extLabel:"<span style='line-height: 20px;padding-left: 5px'>Добавить производителя</span>",oldLabel:"<span class='webix_icon fa-plus'></span>",click:function(){var t={type:"Vendor",callback:n.addVendor,mode:"new",source:e.$$("__table")};e.popnew.show("Добавление производителя",t)}},{view:"button",type:"htmlbutton",hidden:!0,localId:"_del",tooltip:"Удалить производителя",resizable:!0,sWidth:200,eWidth:40,label:"",width:40,extLabel:"<span style='line-height: 20px;padding-left: 5px;'>Удалить производителя</span>",oldLabel:"<span style='color: red', class='webix_icon fa-times'></span>",click:function(){var t=e.$$("__table").getSelectedItem().id,i={};i.user=e.app.config.user,i.id=t;var o=e.app.config.r_url+"?delVendor",r=Object(n.request)(o,i,!0).response;(r=Object(n.checkVal)(r,"s"))&&(Object(n.delVendor)(r.id),e.$$("_del").hide())}}]},{view:"datatable",name:"_vendors",localId:"__table",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,startPos:1,posPpage:20,totalPos:1250,old_stri:"",columns:[{id:"id",width:75,header:[{text:"ID"}]},{id:"c_zavod",headermenu:!1,fillspace:1,sort:"text",header:[{text:"Производитель"}]},{id:"id_state",width:150,header:[{text:"Статус"}]},{id:"dt",width:250,header:[{text:"Дата заведения"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){this.count||this.showProgress({type:"icon",icon:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>'})},onItemDblClick:function(e){var t={text:(e=this.getSelectedItem()).c_zavod,id:e.id,type:"Vendor",callback:n.updVendor,mode:"upd",source:this};this.$scope.popnew.show("Редактирование поставщика",t)},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(){e.$$("_del").show()},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}}]}},t.prototype.ready=function(){var e=[this.$$("_add"),this.$$("_del")];Object(n.setButtons)(this.app,e)},t.prototype.init=function(){this.popnew=this.ui(r.default),webix.extend(this.$$("__table"),webix.ProgressBar),this.$$("__table").sync(n.vendor.data)},t}(o.c);t.default=s},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(0),r=i(3);var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this;return{view:"layout",rows:[{view:"toolbar",height:40,cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Строка поиска",keyPressTimeout:900,tooltip:"поиск по сезону",on:{onTimedKeyPress:function(e,t){var i=this.getValue().toString().toLowerCase();this.$scope.$$("__table").filter(function(e){return-1!=e.sezon.toString().toLowerCase().indexOf(i)})}}},{view:"button",type:"htmlbutton",tooltip:"Добавить сезон",localId:"_add",resizable:!0,sWidth:180,eWidth:40,label:"",width:40,extLabel:"<span style='line-height: 20px;padding-left: 5px'>Добавить сезон</span>",oldLabel:"<span class='webix_icon fa-plus'></span>",click:function(){var t={type:"Sez",callback:n.addSez,mode:"new",source:e.$$("__table")};e.popnew.show("Добавление сезонности",t)}},{view:"button",type:"htmlbutton",hidden:!0,localId:"_del",tooltip:"Удалить сезон",resizable:!0,sWidth:180,eWidth:40,label:"",width:40,extLabel:"<span style='line-height: 20px;padding-left: 5px;'>Удалить сезон</span>",oldLabel:"<span style='color: red', class='webix_icon fa-times'></span>",click:function(){var t=e.$$("__table").getSelectedItem().id,i={};i.user=e.app.config.user,i.id=t;var o=e.app.config.r_url+"?delSez",r=Object(n.request)(o,i,!0).response;(r=Object(n.checkVal)(r,"s"))&&(Object(n.delSez)(r.id),e.$$("_del").hide())}}]},{view:"datatable",name:"_seasons",localId:"__table",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,startPos:1,posPpage:20,totalPos:1250,old_stri:"",columns:[{id:"id",width:200,header:[{text:"ID"}]},{id:"sezon",headermenu:!1,fillspace:1,sort:"text",header:[{text:"Сезон"}]},{id:"id_state",width:150,header:[{text:"Статус"}]},{id:"dt",width:250,header:[{text:"Дата заведения"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){this.count||this.showProgress({type:"icon",icon:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>'})},onItemDblClick:function(e){var t={text:(e=this.getSelectedItem()).sezon,id:e.id,type:"Sez",callback:n.updSez,mode:"upd",source:this};this.$scope.popnew.show("Редактирование сезонности",t)},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(){e.$$("_del").show()},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}}]}},t.prototype.ready=function(){var e=[this.$$("_add"),this.$$("_del")];Object(n.setButtons)(this.app,e)},t.prototype.init=function(){this.popnew=this.ui(r.default),webix.extend(this.$$("__table"),webix.ProgressBar),this.$$("__table").sync(n.sezon.data)},t}(o.c);t.default=s},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(0);var r=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this,t=this.app;return{view:"cWindow",modal:!0,on:{onHide:function(){e.$$("new_user").clear(),e.$$("new_user").clearValidation()},onShow:function(){e.$$("_pwrd").define({type:"password"}),e.$$("_eye").define({label:"<span class='webix_icon fa-eye'></span><span style='line-height: 20px;'></span>"}),e.$$("_pwrd").refresh(),e.$$("_eye").refresh()}},body:{view:"form",localId:"new_user",margin:0,_params:{},rules:{c_user:function(e){var t=this.$scope.app.config.r_url+"?check"+this.config._params.type,i={};i.check=e,i.user=this.$scope.app.config.user;var o=!1,r=Object(n.request)(t,i,!0).response;return((r=Object(n.checkVal)(r,"s"))||this.config._params.id)&&(o=!0),o},c_pwrd:webix.rules.isNotEmpty,id_role:webix.rules.isNotEmpty},elements:[{rows:[{view:"text",labelPosition:"top",label:"Пользователь:",value:"",name:"c_user",required:!0,invalidMessage:"Укажите коректное имя"},{height:10,width:600},{view:"label",label:"Пароль:"},{cols:[{view:"text",label:"",value:"",name:"c_pwrd",type:"password",localId:"_pwrd",required:!0,invalidMessage:"Пароль обязателен"},{view:"button",type:"htmlbutton",localId:"_eye",label:"<span class='webix_icon fa-eye'></span><span style='line-height: 20px;'></span>",width:30,hidden:!t.config.roles[t.config.role].userdel,_vis:!1,click:function(){e.$$("_eye").config._vis?(e.$$("_pwrd").define({type:"password"}),e.$$("_eye").define({label:"<span class='webix_icon fa-eye'></span><span style='line-height: 20px;'></span>"}),e.$$("_pwrd").refresh(),e.$$("_eye").refresh(),e.$$("_eye").config._vis=!1):e.$$("_eye").config._vis||(e.$$("_pwrd").define({type:"text"}),e.$$("_eye").define({label:"<span class='webix_icon fa-eye-slash'></span><span style='line-height: 20px;'></span>"}),e.$$("_pwrd").refresh(),e.$$("_eye").refresh(),e.$$("_eye").config._vis=!0)}}]},{view:"text",labelPosition:"top",label:"Группа:",name:"id_group"},{view:"text",labelPosition:"top",label:"Список ИНН:",value:"",name:"c_inn"},{view:"label",label:"Роль пользователя:"},{cols:[{view:"combo",label:"",value:"",name:"id_role",localId:"_rolesC",required:!0,invalidMessage:"Роль пользователя должна быть указана",options:{body:{template:"#r_name#",yCount:5}}},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-plus'></span><span style='line-height: 20px;'></span>",width:30,hidden:!t.config.roles[t.config.role].userdel,click:function(){webix.message({type:"debug",text:"Пока не реализованно"})}}]},{height:10,width:600},{cols:[{view:"button",type:"base",label:"Отменить",width:120,height:32,click:function(){e.hide()}},{},{view:"button",type:"base",label:"Сохранить",width:120,height:32,hidden:!t.config.roles[t.config.role].useradd,click:function(){if(e.$$("new_user").validate({hidden:!1,disabled:!1})){var t=e.$$("new_user").getValues();1==+t.id_role&&(t.id_role="0"),t.user=e.app.user;var i=t.id?e.app.config.r_url+"?updUser":e.app.config.r_url+"?setUser";Object(n.checkVal)(Object(n.request)(i,t,!0).response,"s")&&(i=e.app.config.r_url+"?getUsersAll",Object(n.request)(i,t).then(function(e){(e=Object(n.checkVal)(e,"a"))&&(this.$scope.users_dt.clearAll(),this.$scope.users_dt.parse(e))}),e.hide())}}}]}]}]}}},t.prototype.show=function(e,t,i){i&&(this.users_dt=i),t?(this.$$("new_user").parse(t),this.$$("new_user").config._params.id=t.id):(this.$$("new_user").clear(),this.$$("new_user").config._params={}),this.$$("new_user").config._params.type="User",this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show()},t.prototype.init=function(){var e=this.$$("_rolesC");e.getList().clearAll(),e.getList().parse(n.u_roles)},t.prototype.hide=function(){this.getRoot().hide()},t}(o.c);t.default=r},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(0),r=i(7);var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this,t={view:"datatable",name:"_roles",localId:"__table",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,css:"dt_css",columns:[{id:"act_name",width:375,header:[{text:"Тип действия"}]},{id:"user",fillspace:1,css:"center_p",template:"{common.checkbox()}",header:[{text:"Имя роли",colspan:5,css:"center_p"},{text:$$("roles_dc").getItem(1).r_name}]},{id:"linker",fillspace:1,css:"center_p",template:"{common.checkbox()}",header:[{},{text:$$("roles_dc").getItem(9).r_name}]},{id:"admin",css:"center_p",template:"{common.checkbox()}",fillspace:1,header:[{},{text:$$("roles_dc").getItem(10).r_name}]},{id:"superadmin",css:"center_p",template:"{common.checkbox()}",fillspace:1,header:[{},{text:$$("roles_dc").getItem(34).r_name}]},{id:"qqq",css:"center_p",template:"{common.checkbox()}",fillspace:1,header:[{},{text:$$("roles_dc").getItem(35).r_name}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onAfterLoad:function(){this.hideProgress()}}},i={height:40,view:"toolbar",cols:[{},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-times'></span><span style='line-height: 20px;'> Отменить</span>",width:140,click:function(){e.hide()}},{view:"button",type:"htmlbutton",hidden:!this.app.config.roles[this.app.config.role].userdel,label:"<span class='webix_icon fa-save'></span><span style='line-height: 20px;'> Сохранить</span>",width:140,click:function(){var t=e.$$("__table").serialize(),i=e.app.config.r_url+"?setAdmRoles",o={user:e.app.config.user,values:t},r=Object(n.checkVal)(Object(n.request)(i,o,!0).response,"s");if(r){var s={command:"?killAll",type:"async"};s.action=r,e.popconfirm.show("Отключить всех пользователей?",s),e.hide()}}}]};return{view:"cWindow",width:.8*document.documentElement.clientWidth,height:.8*document.documentElement.clientHeight,modal:!0,on:{onHide:function(){e.$$("__table").clearAll()},onShow:function(){var t=e,i=e.app.config.r_url+"?getAdmRoles",o={user:e.app.config.user};Object(n.request)(i,o).then(function(e){(e=Object(n.checkVal)(e,"a"))?t.$$("__table").parse(e):t.$$("__table").clearAll(),this.$scope.$$("__table").hideProgress()})}},body:{view:"layout",rows:[i,t]}}},t.prototype.show=function(e){this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show()},t.prototype.init=function(){this.popconfirm=this.ui(r.default)},t.prototype.hide=function(){this.getRoot().hide()},t}(o.c);t.default=s},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(0),r=i(44),s=i(4),a=i(5),l=i(7),c=i(45),u=i(46),d=i(47),p=i(48);var h=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this,t=this.app,i={view:"tabbar",popupWidth:170,tabMinWidth:170,tabMoreWidth:70,animate:!1,multiview:!0,on:{onOptionRemove:function(e){$$(e).destructor()}},options:[{value:"<span style='line-height: 20px;'> Линкер</span>",id:"app-nav",close:!1,width:172}]},o={view:"multiview",css:{"margin-right":"0px !important"},vis:!1,animate:!1,keepViews:!0,on:{onViewChange:function(e,t){var i=void 0;"app-nav"===e&&(i=this.$scope.$$("sideButton").config.formOpen,this.$scope.sideForm.hide_f(),this.$scope.$$("sideButton").config.formOpen=!1,this.config.vis=i),"app-nav"===t&&(i=this.config.vis)&&this.$scope.$$("sideButton").callEvent("onItemClick")}},cells:[{view:"layout",id:"app-nav",type:"clean",rows:[{view:"toolbar",css:{"border-top":"0px !important"},height:40,cols:[{view:"combo",hidden:t.config.link,name:"suppliers",id:"_suppl",manual:!1,state:!1,width:300,options:{filter:function(e,t){return t=t.toString().toLowerCase(),-1!=e.c_vnd.toString().toLowerCase().search(t)},body:{template:"#c_vnd# - #count#",yCount:10}},on:{onChange:function(){if($$("_suppl").config.manual)$$("_suppl").config.manual=!1;else{var t=$$("_suppl").getList();if(t.count()>0){var i=e.$$("_local_link_by").getValue(),o=t.getItem($$("_suppl").getValue()).id_vnd;1==+i?Object(n.get_prcs)(e,o):2==+i?Object(n.get_prcs_date)(e,o):3==+i&&Object(n.get_prcs_source)(e,o)}else Object(n.clear_names_bar)(e),e.getRoot().getChildViews()[1].getChildViews()[2].getChildViews()[0].getChildViews()[0].getChildViews()[0].setValue("")}}}},{view:"radio",label:"СВОДИТЬ ПО",value:1,css:"c-radio",id:"_link_by",labelWidth:100,width:405,localId:"_local_link_by",hidden:t.config.link,options:[{id:1,value:"<span style='color: white'>поставщикам</span>"},{id:2,value:"<span style='color: white'>дате</span>"},{id:3,value:"<span style='color: white'>источнику</span>"}],on:{onChange:function(){var e=+this.getValue();$$("_suppl").getList().clearAll(),$$("_suppl").setValue(""),1===e?Object(n.get_suppl)("_suppl",this.$scope,"?getSupplUnlnk"):2===e?Object(n.get_suppl)("_suppl",this.$scope,"?getDatesUnlnk"):3===e?Object(n.get_suppl)("_suppl",this.$scope,"?getSourceUnlnk"):webix.message({type:"error",text:"не сводим"})}}},{},{view:"button",type:"htmlbutton",tooltip:"Обновить",hidden:t.config.link,resizable:!0,sWidth:136,eWidth:38,label:"",width:38,extLabel:"<span style='line-height: 20px;padding-left: 5px'>Обновить</span>",oldLabel:"<span class='webix_icon fa-refresh'></span>",click:function(){2==+$$("_link_by").getValue()?Object(n.get_suppl)("_suppl",e,"?getDatesUnlnk"):3==+$$("_link_by").getValue()?Object(n.get_suppl)("_suppl",e,"?getSourceUnlnk"):Object(n.get_suppl)("_suppl",e,"?getSupplUnlnk")}}]},{view:"toolbar",id:"_names_bar",css:"header",localId:"_local_names_bar",rows:[{height:32,cols:[{view:"label",label:"",name:"_name",fillspace:1}]},{height:32,cols:[{view:"label",label:"",css:"header",name:"_vendor"},{},{view:"label",label:"",css:"right",name:"_count",width:320,click:function(){var t=$$("_suppl").getValue();t&&(t=$$("_suppl").getList().getItem(t).c_vnd,e.popunlink.show("Осталось связать в этой сессии по поставщику "+t))}},{width:10},{view:"button",type:"htmlbutton",hidden:t.config.link,label:"<span style='color: #3498db'>Обновить сессию</span>",width:200,click:function(){if($$("_suppl").getList().getItem($$("_suppl").getValue())){var t=$$("_suppl").getList().getItem($$("_suppl").getValue()).id_vnd;Object(n.get_prcs)(e,t)}}}]}]},{view:"toolbar",height:40,cols:[{view:"text",label:"",labelWidth:1,placeholder:"Строка поиска",id:"_spr_search",_keytimed:void 0,localId:"_local_spr_search",on:{onKeyPress:function(e,t){var i=this;clearTimeout(this.config._keytimed),Object(n.checkKey)(e)&&(this.config._keytimed=setTimeout(function(){var e=i.$scope.getParentView().getRoot().getChildViews()[0].getChildViews()[1].getChildViews()[2].getChildViews()[0].getChildViews()[3],t=e.getChildViews()[0];if(t){var o=Object(n.getDtParams)(t);Object(n.get_data_test)({view:t,navBar:e.getChildViews()[1],start:1,searchBar:t.config.searchBar,method:t.config.searchMethod,field:o[2],direction:o[3],filter:o[0],count:o[1]})}},this.$scope.app.config.searchDelay))}}},{view:"button",type:"htmlbutton",width:38,hidden:!0,label:"<span class='webix_icon fa-history'></span><span style='line-height: 20px;'></span>",click:function(){var t=e.getRoot().getChildViews()[1].getChildViews()[2].getChildViews()[0].getChildViews()[3].getChildViews()[0].config.name,i=webix.storage.session.get(t);e.pophistory.show(i,$$("_spr_search"))}},{view:"button",type:"htmlbutton",id:"_add",width:140,hidden:!0,localId:"_local_add",label:"Добавить (Ins)",hotkey:"insert",on:{onItemClick:function(){var t={},i=e.$$("_local_names_bar").getValues().p_name;t.t_name="Название товара:   "+i,t.c_tovar=i.toUpperCase(),e.popnew.show("Добавление в справочник",$$("_spr_search"),t)}}},{view:"button",type:"htmlbutton",id:"_link",localId:"_local_link",label:"<span class='webix_icon fa-link'></span><span style='line-height: 20px;'>  Связать (Ctrl+Home)</span>",hidden:!0,width:200,hotkey:"home+ctrl",click:function(){$$("_link").hide();var t=n.prcs.getItem(n.prcs.getCursor()).sh_prc,i=e.getRoot().getChildViews()[1].getChildViews()[2].getChildViews()[0].getChildViews()[3].getChildViews()[0].getSelectedItem().id_spr,o={};o.th=e,o.command="?setLnk",o.sh_prc=t,o.id_spr=i,o.type="async",o.callback=n.delPrc,e.popconfirm.show("Связать?",o)}},{view:"button",type:"htmlbutton",id:"_left",hidden:!0,localId:"_local_left",label:"<span class='webix_icon fa-angle-left'></span><span style='line-height: 20px;'>Ctrl+</span><span class='webix_icon fa-arrow-down'></span>",width:90,hotkey:"down+ctrl",click:function(){var t=$$("prcs_dc").getCursor(),i=void 0;$$("prcs_dc").data.order.forEach(function(e,o,n){e===t&&(i=o)}),(i-=1)<0&&(i=$$("prcs_dc").count()-1),t=$$("prcs_dc").data.order[+i],$$("prcs_dc").setCursor(t),Object(n.parse_unlinked_item)(e)}},{view:"button",type:"htmlbutton",id:"_skip",hidden:!0,localId:"_local_skip",label:"Пропустить (Ctrl+M)",width:160,hotkey:"m+ctrl",click:function(){var t=n.prcs.getItem(n.prcs.getCursor()).sh_prc,i={};i.th=e,i.command="?skipLnk",i.sh_prc=t,i.type="async",i.callback=n.delPrc,e.popconfirm.show("Пропустить?",i)}},{view:"button",type:"htmlbutton",id:"_right",hidden:!0,localId:"_local_right",label:"<span style='line-height: 20px;'>Ctrl+</span><span class='webix_icon fa-arrow-up'></span><span class='webix_icon fa-angle-right'></span>",width:90,hotkey:"up+ctrl",click:function(){var t=$$("prcs_dc").getCursor(),i=void 0;$$("prcs_dc").data.order.forEach(function(e,o,n){e===t&&(i=o)}),(i+=1)===$$("prcs_dc").count()-1&&(i=0),t=$$("prcs_dc").data.order[+i],$$("prcs_dc").setCursor(t),Object(n.parse_unlinked_item)(e)}},{view:"button",type:"htmlbutton",hidden:!1,localId:"sideButton",tooltip:"Информация о товаре",label:"<span class='webix_icon fa-caret-left'></span>",resizable:!1,sWidth:136,eWidth:38,width:38,extLabel:"<span style='line-height: 20px;padding-left: 5px'>О товаре</span>",oldLabel:"<span class='webix_icon fa-caret-left'></span>",formOpen:!1,on:{onItemClick:function(){var e=this.$scope.getParentView().getRoot().getChildViews()[0].getChildViews()[1].getChildViews()[2].getChildViews()[0].getChildViews()[3].getChildViews()[0];if(this.config.formOpen)this.define({label:"<span class='webix_icon fa-caret-left'></span>",formOpen:!1}),this.$scope.sideForm.hide_f();else{this.define({label:"<span class='webix_icon fa-caret-right'></span>",formOpen:!0}),this.$scope.sideForm.show_f(this.$scope.$$("sideButton").getNode());var t=e?e.getSelectedItem():void 0;t&&(t=t.id_spr,(t=Object(n.get_spr)(e.$scope,t)).s_name="Страна: "+t.c_strana,t.t_name="Название товара: "+t.c_tovar,t.v_name="Производитель: "+t.c_zavod,t.dv_name="Д. вещество: "+t.c_dv,this.$scope.sideForm.parse_f("Просмотр записи <span style='color: red'>"+t.id_spr+"</span>.  Изменения не будут сохранены",$$("_spr_search"),t))}this.refresh()}}}]},{$subview:c.default,name:"spr_dt"}]}]};return{cols:[{$subview:p.default},{borderless:!1,rows:[{height:1},i,o,{$subview:d.default}]}]}},t.prototype.ready=function(){var e=this;this.app.config.getButt(this.$$("sideMenu").getTopParentView()).forEach(function(t,i,o){t.define({width:e.app.config.expert?t.config.eWidth:t.config.sWidth,label:e.app.config.expert?t.config.oldLabel:t.config.oldLabel+t.config.extLabel}),t.refresh(),t.resize()})},t.prototype.init=function(){this.app.config.link||(2==+$$("_link_by").getValue()?Object(n.get_suppl)("_suppl",this,"?getDatesUnlnk"):3==+$$("_link_by").getValue()?Object(n.get_suppl)("_suppl",this,"?getSourceUnlnk"):Object(n.get_suppl)("_suppl",this,"?getSupplUnlnk")),this.sideForm=this.ui(u.default),this.popconfirm=this.ui(l.default),this.popnew=this.ui(a.default),this.popunlink=this.ui(r.default),this.pophistory=this.ui(s.default)},t}(o.c);t.default=h},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(0);var r=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this,t={view:"datatable",localId:"__table",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,old_stri:"",columns:[{id:"id_tovar",width:120,sort:"int",header:[{text:"ID поставщика"}]},{id:"c_tovar",fillspace:1,sort:"text",header:[{text:"Название"}]},{id:"c_zavod",sort:"text",width:300,header:[{text:"Производитель"}]}],on:{onItemDblClick:function(t){$$("prcs_dc").setCursor(t.row),Object(n.parse_unlinked_item)(e),e.getRoot().hide()},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")},onBeforeSelect:function(){}}};return{view:"cWindow",width:.8*document.documentElement.clientWidth,height:.8*document.documentElement.clientHeight,modal:!0,on:{onShow:function(){this.$scope.$$("__table").clearAll(),this.$scope.$$("__table").parse($$("prcs_dc"))}},body:t}},t.prototype.show=function(e){this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show()},t.prototype.hide=function(){this.getRoot().hide()},t}(o.c);t.default=r},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(5),r=i(0),s=i(2),a=i(13);var l=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this;return{view:"layout",css:{"border-bottom":"0px solid #dddddd !important"},rows:[{view:"datatable",css:{"margin-top":"-5px !important"},name:"__dt",localId:"__table",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:30,rowHeight:30,editable:!1,headermenu:{autowidth:!0},startPos:1,posPpage:this.app.config.posPpage,totalPos:0,fi:"c_tovar",di:"asc",old_stri:"",searchBar:"_spr_search",searchMethod:"getSprSearch",subview:function(t,i){var o=e.$$("__table").getItem(t.id);o=o.id_spr,(o=Object(r.get_spr)(e,o)).id=t.id,o.s_name="Страна: "+o.c_strana,o.t_name="Название товара: "+o.c_tovar,o.v_name="Производитель: "+o.c_zavod,o.dv_name="Д. вещество: "+o.c_dv;var n=new a.default(e.app,{pager:e.$$("__table").getParentView().getChildViews()[1].$scope.$$("__page"),dt:e.$$("__table"),item:o,header:"<span style='color: red; text-transform: uppercase;'>Редактирование записи </span>"+o.id_spr,search_bar:$$("_spr_search")});return e.ui(n,{container:i}),n.getRoot()},columns:[{id:"id_mnn",width:75,template:function(e){return 0!=+e.id_dv?"<span class='webix_icon fa-check-circle', style='color: green'></span>":"<span class='webix_icon fa-times-circle', style='color: red'></span>"},css:"center_p",header:[{text:"МНН"}]},{id:"id_spr",width:80,sort:"server",header:[{text:"IDSPR"},{content:"cFilt"}],headermenu:!1},{id:"c_tovar",fillspace:1,sort:"server",header:[{text:"Название"}],headermenu:!1},{id:"id_zavod",sort:"server",width:300,header:[{text:"Производитель"}]},{id:"id_strana",width:200,header:[{text:"Страна"}]},{id:"c_dv",hidden:!0,width:300,header:[{text:"Д. в-во"},{content:"richFilt",compare:r.compareTrue,inputConfig:{inputtype:"combo",pager:1,options:{data:[]}}}]},{id:"c_group",hidden:!0,width:150,header:[{text:"Группа"}]},{id:"c_nds",hidden:!0,width:150,header:[{text:"НДС"}]},{id:"c_hran",hidden:!0,width:150,header:[{text:"Условия хранения"}]},{id:"c_sezon",hidden:!0,width:150,header:[{text:"Сезонность"}]},{id:"mandat",width:100,template:function(e){return e.c_mandat?"<div><span class='webix_icon fa-check-circle'></span></div>":"<div><span></span></div>"},hidden:!0,css:"center_p",header:[{text:"Обязательный"}]},{id:"prescr",width:100,template:function(e){return e.c_prescr?"<div><span class='webix_icon fa-check-circle'></span></div>":"<div><span></span></div>"},hidden:!0,css:"center_p",header:[{text:"Рецептурный"}]}],on:{"data->onParse":function(e,t){if(this.$scope.getRoot().getParentView().$scope.$$("sideButton").config.formOpen){var i={s_name:"Страна: ",t_name:"Название товара: ",v_name:"Производитель: ",dv_name:"Д. вещество: "};this.$scope.getParentView().sideForm.parse_f("",$$("_spr_search"),i)}this.clearAll(),$$("_link").hide()},onAfterColumnShow:function(e){if("c_dv"===e){var t=this.getColumnConfig(e),i=[];$$("dv_dc").data.each(function(e){var t={id:e.id,value:e.act_ingr};i.push(t)}),setTimeout(function(){t.header[1].inputConfig.options.data=i},200)}},onBeforeSort:function(t,i){e.$$("__table").config.fi=t,e.$$("__table").config.di=i;var o=e.getRoot().getChildViews()[1].$scope.$$("__page").getValue();e.getRoot().getChildViews()[1].$scope.$$("__page").setValue(0==+o?"1":"0"),e.getRoot().getChildViews()[1].$scope.$$("__page").refresh()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onSubViewClose:function(e){delete this.getItem(e).$subContent,delete this.getItem(e).$subHeight,delete this.getItem(e).$subOpen},onItemDblClick:function(e){this.$scope.getRoot().getParentView().$scope.$$("sideButton");var t=this.getSelectedId();this.openSub(t)},onAfterLoad:function(){this.hideProgress()},onAfterSelect:function(){if(this.$scope.getRoot().getParentView().$scope.$$("sideButton").config.formOpen){var e=this.$scope.$$("__table").getSelectedItem();e=e.id_spr,(e=Object(r.get_spr)(this.$scope,e)).s_name="Страна: "+e.c_strana,e.t_name="Название товара: "+e.c_tovar,e.v_name="Производитель: "+e.c_zavod,e.dv_name="Д. вещество: "+e.c_dv,this.$scope.getParentView().sideForm.parse_f("Просмотр записи <span style='color: red'>"+e.id_spr+"</span>.  Изменения не будут сохранены",$$("_spr_search"),e)}$$("prcs_dc").count()>0&&$$("_link").show()},onKeyPress:function(e,t){13===e&&this.getSelectedItem()&&this.callEvent("onItemDblClick")}}},{$subview:s.default}]}},t.prototype.ready=function(){this.$$("__table").markSorting(this.$$("__table").config.fi,this.$$("__table").config.di)},t.prototype.init=function(){this.popnew=this.ui(n.default)},t}(o.c);t.default=l},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(0);var r=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e,t,i=this;this.app;return{view:"cWindow",localId:"sw",relative:!0,animate:!0,head:!1,resize:!1,modal:!1,on:{onHide:function(){n.barcodes.clearAll(),this.$scope.$$("new_form").clear(),this.$scope.$$("new_form").reconstruct()}},body:{view:"form",localId:"new_form",readonly:!0,margin:0,spr:!1,search_bar:void 0,rules:{c_tovar:webix.rules.isNotEmpty,id_strana:webix.rules.isNotEmpty,id_zavod:webix.rules.isNotEmpty,id_dv:webix.rules.isNotEmpty},elements:[{view:"label",label:"Просмотр записи",name:"idspr"},{rows:[{view:"label",label:"Название товара:",name:"t_name"},{view:"text",label:"",value:"",name:"c_tovar",required:!0,css:"raw_text"},{height:10,width:700},{cols:[{rows:[{view:"label",label:"Страна:",name:"s_name"},{view:"combo",width:400,value:"",name:"id_strana",required:!0,options:{filter:function(e,t){return t=t.toString().toLowerCase(),t=new RegExp(".*"+t.replace(/ /g,".*")+".*"),-1!=e.c_strana.toString().toLowerCase().search(t)},body:{template:"#c_strana#",yCount:7}},on:{onAfterRender:function(){this.getList().sync(n.strana)}}},{view:"label",label:"Производитель:",name:"v_name"},{view:"combo",label:"",value:"",name:"id_zavod",required:!0,options:{filter:function(e,t){return t=t.toString().toLowerCase(),-1!=e.c_zavod.toString().toLowerCase().search(t)},body:{template:"#c_zavod#",yCount:7}},on:{onAfterRender:function(){this.getList().sync(n.vendor)}}},{view:"label",label:"Д. вещество:",name:"dv_name"},{view:"combo",label:"",value:"",name:"id_dv",required:!0,options:{filter:function(e,t){return t=t.toString().toLowerCase(),t=new RegExp(".*"+t.replace(/ /g,".*")+".*"),-1!=e.act_ingr.toString().toLowerCase().search(t)},body:{autoheight:!1,view:"list",type:{height:"auto"},template:"<div class='comboList'>#act_ingr#</div>",height:200,yCount:0}},on:{onAfterRender:function(){this.getList().sync(n.dv)}}},{view:"label",label:"Форма выпуска:"},(e={view:"text",label:"",value:"",labelPosition:"left",readonly:!0,name:"issue",localId:"_issue",css:"raw_text"},e.readonly=!0,e),(t={view:"text",label:"Штрих-код:",value:"",labelPosition:"top",readonly:!0,name:"barcode",localId:"_barc",css:"raw_text"},t.readonly=!0,t),{view:"text",label:"Товарная группа:",labelPosition:"top",value:"",name:"c_tgroup",localId:"_c_tgroup",css:"raw_text",readonly:!0}]},{width:5},{rows:[{view:"form",css:"borders",localId:"new_f_right",elements:[{height:5},{cols:[{view:"checkbox",labelRight:"Рецептурный",labelWidth:0,align:"left",name:"_prescr"},{view:"checkbox",labelRight:"Обязательный",labelWidth:0,align:"left",name:"_mandat"}]},{view:"combo",label:"Сезон:",labelPosition:"top",value:"",name:"id_sezon",css:"small",options:{filter:function(e,t){return t=t.toString().toLowerCase(),t=new RegExp(".*"+t.replace(/ /g,".*")+".*"),-1!=e.sezon.toString().toLowerCase().search(t)},body:{template:"#sezon#",yCount:5}},on:{onAfterRender:function(){this.getList().sync(n.sezon)}}},{view:"combo",label:"Условия хранения:",labelPosition:"top",value:"",name:"id_usloviya",css:"small",options:{filter:function(e,t){return t=t.toString().toLowerCase(),t=new RegExp(".*"+t.replace(/ /g,".*")+".*"),-1!=e.usloviya.toString().toLowerCase().search(t)},body:{template:"#usloviya#",yCount:5}},on:{onAfterRender:function(){this.getList().sync(n.hran)}}},{view:"combo",label:"Группа:",labelPosition:"top",value:"",name:"id_group",css:"small",options:{filter:function(e,t){return t=t.toString().toLowerCase(),t=new RegExp(".*"+t.replace(/ /g,".*")+".*"),-1!=e.group.toString().toLowerCase().search(t)},body:{autoheight:!1,view:"list",type:{height:"auto"},template:"<div class='comboList'>#group#</div>",height:200,yCount:0}},on:{onAfterRender:function(){this.getList().sync(n.group)}}},{view:"combo",label:"НДС:",labelPosition:"top",value:"",name:"id_nds",css:"small",options:{body:{template:"#nds#",yCount:5}},on:{onAfterRender:function(){this.getList().sync(n.nds)}}}]}]}]},{cols:[{view:"button",type:"base",label:"Отменить",width:120,height:32,hidden:!0,click:function(){i.hide()}},{hidden:!0},{view:"button",type:"base",label:"Сохранить",width:120,height:32,hidden:!0,click:function(){if(i.$$("new_form").validate({hidden:!1,disabled:!1})){var e=i.$$("new_form").getValues(),t=i.$$("new_f_right").getValues(),o={};o.id_spr=e.id_spr?e.id_spr:-1,o.barcode=e.barcode,o.c_tovar=e.c_tovar,o.id_strana=e.id_strana,o.id_zavod=e.id_zavod,o.id_dv=e.id_dv,o.c_opisanie=e.c_opisanie,o.prescr=1===t._prescr,o.mandat=1===t._mandat,o.id_sezon=t.id_sezon,o.id_usloviya=t.id_usloviya,o.id_group=t.id_group,o.id_nds=t.id_nds;var r=$$("prcs_dc").getCursor();r&&$$("prcs_dc").getItem(r).sh_prc?o.sh_prc=$$("prcs_dc").getItem(r).sh_prc||void 0:o.sh_prc=void 0,o.c_tgroup=e.c_tgroup,o.user=i.app.config.user;var s=i.app.config.r_url+"?setSpr",a=Object(n.request)(s,o,!0).response;(a=Object(n.checkVal)(a,"s"))&&a.new&&i.$$("new_form").config.spr?Object(n.delPrc)(o,i):(i.$$("new_form").config.search_bar.callEvent("onKeyPress",[13]),n.barcodes.clearAll(),i.$$("new_form").clear(),i.$$("new_form").reconstruct()),i.$$("new_form").config.spr=!1}}}]}]}]}}},t.prototype.parse_f=function(e,t,i){this.$$("new_form").config.search_bar=t,i&&(i.idspr=e,this.$$("new_form").parse(i),this.$$("new_form").config.spr=!0)},t.prototype.show_f=function(e,t,i){this.$$("new_form").config.search_bar=t,i&&(this.$$("new_form").parse(i),this.$$("new_f_right").parse(i),this.$$("new_form").config.spr=!0),this.getRoot().show(e)},t.prototype.hide_f=function(){this.getRoot().hide()},t.prototype.init=function(){},t}(o.c);t.default=r},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(0);var r=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this.app.config.r_url+"?getVersion",t={user:this.app.config.user},i=Object(n.request)(e,t,!0).response,o=(i=Object(n.checkVal)(i,"s")).info.prod?"Production":"test";return{view:"toolbar",css:"header",cols:[{view:"label",label:"Вы находитесь на сервере:  "+location.hostname+" | fv. "+this.app.config.version+" | bv. "+i.info.version+" | "+o,css:{color:"#404040 !important","font-size":"11px !important"},height:12},{},{view:"button",type:"htmlbutton",width:32,hidden:!0,label:"<span class='webix_icon fa-info', style='color: #666666;'></span>"}]}},t}(o.c);t.default=r},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(0),r=i(17),s=i(18),a=i(19),l=i(15),c=i(49),u=i(50),d=i(20),p=i(16);var h=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this.app,t=this;function i(e,t){var i=e.$scope.getRoot().getTopParentView().getChildViews()[1].getChildViews()[0].getChildViews()[1],o=t===r.default?"<span class='webix_icon fa-archive'></span><span style='line-height: 20px;'>Пропущенные</span>":t===s.default?"<span class='webix_icon fa-unlink'></span><span style='line-height: 20px;'>Несвязанные</span>":t===a.default?"<span class='webix_icon fa-stumbleupon'></span><span style='line-height: 20px;'>Связки</span>":t===l.default?"<span class='webix_icon fa-magic'></span><span style='line-height: 20px;'>Админка</span>":t===d.default?"<span class='webix_icon fa-ban'></span><span style='line-height: 20px;'>Забраковка</span>":t===p.default?"<span class='webix_icon fa-stream'></span><span style='line-height: 20px;'>Справочники</span>":"",n=webix.uid(),c={id:n,value:o,width:172,close:!0},u={$scope:e.$scope,id:n,$subview:t};e.config.b_id=n,i.getChildViews()[2].addView(u),i.getChildViews()[1].addOption(c,!0)}function o(){var e=void 0;try{e=function e(t){var i=void 0;return t.forEach(function(t,o,n){var r=[],s=t;(r=t.config.multiview?$$($$(t.config.id).getValue()).getChildViews():t.getChildViews()).length>0&&(s=e(r)),s&&(i=s.$scope.$$("__table"))}),i}($$(t.getRoot().getParentView().getChildViews()[1].getChildViews()[2].getActiveId()).getChildViews()).config.id}catch(e){}return e}return{view:"toolbar",localId:"sideMenu",css:"side_tool_bar",borderless:!0,width:e.config.expert?44:140,rows:[{view:"button",type:"htmlbutton",tooltip:"Широкая/узкая панель",height:30,align:"left",localId:"_rbut",label:"<span class='side_icon webix_icon fa-bars'></span>",width:40,on:{onItemClick:function(){e.config.expert=!e.config.expert,this.$scope.$$("sideMenu").define({width:e.config.expert?44:140}),this.$scope.$$("sideMenu").resize(),this.$scope.ready();var t=e.config.r_url+"?setExpert",i={user:e.config.user,expert:e.config.expert?"1":"5"};Object(n.request)(t,i)}}},{view:"button",type:"htmlbutton",tooltip:"Персональные настройки",height:40,longPress:!1,resizable:!0,sWidth:136,eWidth:40,label:"",width:40,oldLabel:"<span class='side_icon webix_icon fa-cogs'></span>",extLabel:"<span class='side_icon', style='line-height: 20px; padding-left: 5px'>Настройки</span>",on:{onAfterRender:function(){var t=this,i=this.getNode();i.onmousedown=function(){t.interval=setInterval(function(){t.config.longPress=!0},e.config.popDelay),i.onmouseup=function(){clearInterval(t.interval)}}},onItemClick:function(t,i){var o=this;webix.html.addCss(this.$view,"bounceIn animated"),setTimeout(function(){webix.html.removeCss(o.$view,"bounceIn animated")},900),this.config.longTouch=!1,this.$scope.popprop.show_w("Персональные настройки: "+e.config.user)}}},{view:"button",type:"htmlbutton",tooltip:"Пишем выловленные баги сюда",height:40,b_id:void 0,longPress:!1,resizable:!0,sWidth:136,eWidth:40,label:"",width:40,hidden:!0,oldLabel:"<span class='side_icon webix_icon fa-bug'></span>",extLabel:"<span class='side_icon', style='line-height: 20px; padding-left: 5px'>Жуки</span>",on:{onAfterRender:function(){},onItemClick:function(){this.$scope.admMenu.isVisible()?this.$scope.admMenu.hide():this.$scope.admMenu.show(this.getNode()),webix.message("Пока недоступно")}}},{view:"button",type:"htmlbutton",tooltip:"Админка",height:40,b_id:void 0,longPress:!1,resizable:!0,sWidth:136,eWidth:40,label:"",width:40,hidden:!e.config.roles[e.config.role].adm,oldLabel:"<span class='side_icon webix_icon fa-magic'></span>",extLabel:"<span class='side_icon', style='line-height: 20px; padding-left: 5px'>Админка</span>",on:{onAfterRender:function(){var t=this,o=this.getNode();o.onmousedown=function(){t.interval=setInterval(function(){t.config.longPress=!0,i(t,l.default),clearInterval(t.interval)},e.config.popDelay),o.onmouseup=function(){clearInterval(t.interval)}}},onItemClick:function(){var e=this,t=this.$scope.getRoot().getTopParentView().getChildViews()[1].getChildViews()[0].getChildViews()[1],o=$$(this.config.b_id);this.config.longPress||(o?(webix.html.addCss(this.$view,"bounceIn animated"),setTimeout(function(){webix.html.removeCss(e.$view,"bounceIn animated")},900),t.getChildViews()[1].setValue(this.config.b_id)):i(this,l.default)),this.config.longPress=!1}}},{view:"button",type:"htmlbutton",tooltip:"Справочники",height:40,b_id:void 0,longPress:!1,resizable:!0,sWidth:136,eWidth:40,label:"",width:40,hidden:!e.config.roles[e.config.role].adm,oldLabel:"<span class='side_icon webix_icon fa-list-alt'></span>",extLabel:"<span class='side_icon', style='line-height: 20px; padding-left: 5px'>Справочники</span>",on:{onAfterRender:function(){var t=this,o=this.getNode();o.onmousedown=function(){t.interval=setInterval(function(){t.config.longPress=!0,i(t,p.default),clearInterval(t.interval)},e.config.popDelay),o.onmouseup=function(){clearInterval(t.interval)}}},onItemClick:function(){var e=this,t=this.$scope.getRoot().getTopParentView().getChildViews()[1].getChildViews()[0].getChildViews()[1],o=$$(this.config.b_id);this.config.longPress||(o?(webix.html.addCss(this.$view,"bounceIn animated"),setTimeout(function(){webix.html.removeCss(e.$view,"bounceIn animated")},900),t.getChildViews()[1].setValue(this.config.b_id)):i(this,p.default)),this.config.longPress=!1}}},{view:"button",type:"htmlbutton",tooltip:"Забраковка",height:40,b_id:void 0,longPress:!1,resizable:!0,sWidth:136,eWidth:40,label:"",width:40,hidden:!e.config.roles[e.config.role].skipped,oldLabel:"<span class='side_icon webix_icon fa-ban'></span>",extLabel:"<span class='side_icon', style='line-height: 20px; padding-left: 5px'>Забраковка</span>",on:{onAfterRender:function(){var t=this,o=this.getNode();o.onmousedown=function(){t.interval=setInterval(function(){t.config.longPress=!0,i(t,d.default),clearInterval(t.interval)},e.config.popDelay),o.onmouseup=function(){clearInterval(t.interval)}}},onItemClick:function(){var e=this,t=this.$scope.getRoot().getTopParentView().getChildViews()[1].getChildViews()[0].getChildViews()[1],o=$$(this.config.b_id);this.config.longPress||(o?(webix.html.addCss(this.$view,"bounceIn animated"),setTimeout(function(){webix.html.removeCss(e.$view,"bounceIn animated")},900),t.getChildViews()[1].setValue(this.config.b_id)):i(this,d.default)),this.config.longPress=!1}}},{view:"button",type:"htmlbutton",tooltip:"Пропущенные",height:40,b_id:void 0,longPress:!1,resizable:!0,sWidth:136,eWidth:40,label:"",width:40,oldLabel:"<span class='side_icon webix_icon fa-archive'></span>",hidden:!e.config.roles[e.config.role].skipped,extLabel:"<span class='side_icon', style='line-height: 20px; padding-left: 2px'>Пропущенные</span>",on:{onAfterRender:function(){var t=this,o=this.getNode();o.onmousedown=function(){t.interval=setInterval(function(){t.config.longPress=!0,i(t,r.default),clearInterval(t.interval)},e.config.popDelay),o.onmouseup=function(){clearInterval(t.interval)}}},onItemClick:function(){var e=this,t=this.$scope.getRoot().getTopParentView().getChildViews()[1].getChildViews()[0].getChildViews()[1],o=$$(this.config.b_id);this.config.longPress||(o?(webix.html.addCss(this.$view,"bounceIn animated"),setTimeout(function(){webix.html.removeCss(e.$view,"bounceIn animated")},900),t.getChildViews()[1].setValue(this.config.b_id)):i(this,r.default)),this.config.longPress=!1}}},{view:"button",type:"htmlbutton",tooltip:"Несвязанные",height:40,b_id:void 0,longPress:!1,resizable:!0,sWidth:136,eWidth:40,label:"",width:40,extLabel:"<span class='side_icon', style='line-height: 20px; padding-left: 5px'>Несвязанные</span>",oldLabel:"<span class='side_icon webix_icon fa-unlink'></span>",on:{onAfterRender:function(){var t=this,o=this.getNode();o.onmousedown=function(){t.interval=setInterval(function(){t.config.longPress=!0,i(t,s.default),clearInterval(t.interval)},e.config.popDelay),o.onmouseup=function(){clearInterval(t.interval)}}},onItemClick:function(){var e=this,t=this.$scope.getRoot().getTopParentView().getChildViews()[1].getChildViews()[0].getChildViews()[1],o=$$(this.config.b_id);this.config.longPress||(o?(webix.html.addCss(this.$view,"bounceIn animated"),setTimeout(function(){webix.html.removeCss(e.$view,"bounceIn animated")},900),t.getChildViews()[1].setValue(this.config.b_id)):i(this,s.default)),this.config.longPress=!1}}},{view:"button",type:"htmlbutton",tooltip:"Связки",height:40,b_id:void 0,longPress:!1,resizable:!0,sWidth:136,eWidth:40,label:"",width:40,extLabel:"<span class='side_icon', style='line-height: 20px; padding-left: 5px'>Связки</span>",oldLabel:"<span class='side_icon webix_icon fa-stumbleupon'></span>",on:{onAfterRender:function(){var t=this,o=this.getNode();o.onmousedown=function(){t.interval=setInterval(function(){t.config.longPress=!0,i(t,a.default),clearInterval(t.interval)},e.config.popDelay),o.onmouseup=function(){clearInterval(t.interval)}}},onItemClick:function(){var e=this,t=this.$scope.getRoot().getTopParentView().getChildViews()[1].getChildViews()[0].getChildViews()[1],o=$$(this.config.b_id);this.config.longPress||(o?(webix.html.addCss(this.$view,"bounceIn animated"),setTimeout(function(){webix.html.removeCss(e.$view,"bounceIn animated")},900),t.getChildViews()[1].setValue(this.config.b_id)):i(this,a.default)),this.config.longPress=!1}}},{view:"button",type:"htmlbutton",width:40,hidden:!1,tooltip:"Создание отчета по текущей таблице",id:"_rep_button",resizable:!0,sWidth:136,eWidth:40,label:"",extLabel:"<span class='side_icon', style='line-height: 20px; padding-left: 5px'>Отчеты</span>",oldLabel:"<span class='side_icon webix_icon fa-file'></span>",height:40,on:{onItemClick:function(){var e=$$(o());e&&"__brak"!==e.config.name&&this.$scope.popreport.show_w("Создание отчета",e)}}},{view:"button",type:"htmlbutton",height:40,b_id:void 0,longPress:!1,localId:"_spr",id:"_spr_button",resizable:!0,sWidth:136,eWidth:40,label:"",width:40,hidden:!e.config.roles[e.config.role].skipped,oldLabel:"<span class='side_icon webix_icon fa-database', style='color: green !important'></span>",extLabel:"<span class='side_icon', style='line-height: 20px; padding-left: 5px'>spr.db3</span>",lastModified:void 0,lastUser:void 0,tooltip:"Выгрузка spr.db3",tooltipTemplate:"Выгрузка spr.db3",on:{onItemClick:function(){var t=this;Object(n.checkSSE)(this)||(this.config.qw=setTimeout(function(){t.unblockEvent(),Object(n.spinIconDisable)(t)},6e5)),Object(n.spinIconEnable)(this),this.blockEvent();var i=e.config.user,o=e.config.r_url+"?processSpr",r={user:i,type:"spr"};Object(n.request)(o,r).then(function(e){e=Object(n.checkVal)(e,"a")})}}},{view:"button",type:"htmlbutton",height:40,b_id:void 0,longPress:!1,localId:"_spr_r",id:"_spr_roz_button",lastModified:void 0,lastUser:void 0,tooltip:"Выгрузка spr-roz.db3",tooltipTemplate:"Выгрузка spr-roz.db3",resizable:!0,sWidth:136,eWidth:40,label:"",width:40,hidden:!e.config.roles[e.config.role].skipped,oldLabel:"<span class='side_icon webix_icon fa-database', style='color: blue !important'></span>",extLabel:"<span class='side_icon', style='line-height: 20px; padding-left: 5px'>spr-roz.db3</span>",on:{onItemClick:function(){var t=this;Object(n.checkSSE)(this)||(this.config.qw=setTimeout(function(){t.unblockEvent(),Object(n.spinIconDisable)(t)},6e5)),Object(n.spinIconEnable)(this),this.blockEvent();var i=e.config.user,o=e.config.r_url+"?processSpr",r={user:i,type:"spr_roz"};Object(n.request)(o,r).then(function(e){e=Object(n.checkVal)(e,"a")})}}},{}]}},t.prototype.ready=function(){var e=this.app.config.getButt(this.$$("sideMenu").getTopParentView());Object(n.setButtons)(this.app,e)},t.prototype.init=function(){this.popreport=this.ui(c.default),this.popprop=this.ui(u.default),this.admMenu=this.ui({view:"popup",relative:!0,borderless:!0,autofit:!0,height:132,padding:1,css:{border:"0px !important","background-color":"#f8fafc !important"},body:{view:"toolbar",css:"side_tool_bar",borderless:!0,rows:[{view:"button",type:"htmlbutton",height:40,resizable:!1,label:"<span class='side_icon', style='line-height: 20px'>Справочники</span>",width:120},{view:"button",type:"htmlbutton",height:40,width:120,resizable:!1,label:"<span class='side_icon', style='line-height: 20px'>Пользователи</span>"},{view:"button",type:"htmlbutton",height:40,width:120,resizable:!1,label:"<span class='side_icon', style='line-height: 20px'>Сервис</span>"}]}})},t}(o.c);t.default=h},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(0);var r=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this,t=this.app,i={1:"Табуляция",2:";",3:",",4:".",5:"Свое значение"},o={1:"xlsx",2:"ods",3:"pdf",4:"текст с разделителем"};return{view:"cWindow",modal:!0,on:{onHide:function(){e.$$("_form").reconstruct()},onShow:function(){}},body:{view:"form",localId:"_form",c_view:void 0,margin:0,elements:[{rows:[{cols:[{rows:[{view:"label",label:"КОЛОНКИ",align:"center"},{localId:"_check",view:"form",borderless:!0,elements:[]}]},{width:10},{rows:[{view:"label",label:"ТИП ФАЙЛА",align:"center"},{view:"radio",value:1,localId:"_type",margin:30,align:"center",width:200,vertical:!0,options:[{id:1,value:"<span style='color: #74747d'>"+o[1]+"</span>"},{id:2,value:"<span style='color: #74747d'>"+o[2]+"</span>"},{id:4,value:"<span style='color: #74747d'>"+o[4]+"</span>"}],on:{onChange:function(){4==+this.getValue()?(this.$scope.$$("_separator").show(),5==+this.$scope.$$("_separator").getValue()&&this.$scope.$$("_custom").show()):(this.$scope.$$("_separator").hide(),this.$scope.$$("_custom").hide())}}},{height:10},{view:"radio",value:1,label:"РАЗДЕЛИТЕЛЬ",hidden:!0,localId:"_separator",margin:30,labelWidth:100,labelPosition:"top",labelAlign:"center",align:"center",width:200,vertical:!0,options:[{id:1,value:"<span style='color: #74747d'>"+i[1]+"</span>"},{id:2,value:"<span style='color: #74747d'>"+i[2]+"</span>"},{id:3,value:"<span style='color: #74747d'>"+i[3]+"</span>"},{id:4,value:"<span style='color: #74747d'>"+i[4]+"</span>"},{id:5,value:"<span style='color: #74747d'>"+i[5]+"</span>"}],on:{onChange:function(){5==+this.getValue()?this.$scope.$$("_custom").show():this.$scope.$$("_custom").hide()}}},{view:"text",label:"ЗНАЧЕНИЕ",value:"",hidden:!0,localId:"_custom"}]}]},{height:10},{cols:[{view:"button",type:"base",label:"Отменить",width:120,click:function(){e.hide_w()}},{},{view:"button",type:"base",label:"Создать",width:120,click:function(){var r=e.$$("_form").config.c_view,s=t.config.r_url+"?saveData",a=[];e.$$("_check").getChildViews().forEach(function(e,t,i){var o={};1==+e.getValue()&&(o[e.config.id]=e.config.labelRight,a.push(o))});var l=Object(n.getDtParams)(r);console.log("pa",l);var c={c_filt:l[0],field:l[2],direction:l[3]},u=void 0;try{u=$$(r.getParentView().$scope.$$("__table").config.searchBar).getValue()}catch(e){}var d=o[+e.$$("_type").getValue()],p={headers:a,user:t.config.user,type:d===o[4]?"csv":d,s_params:c,sep:i[+e.$$("_separator").getValue()],c_sep:e.$$("_custom").getValue(),table:e.$$("_form").config.c_view.config.name,search:u||""};Object(n.spinIconEnable)($$("_rep_button")),$$("_rep_button").blockEvent(),webix.ajax().timeout(18e4).headers({"Content-type":"application/json"}).response("blob").post(s,p,function(e,t){webix.html.download(t,"report."+p.type),$$("_rep_button").unblockEvent(),Object(n.spinIconDisable)($$("_rep_button"))}),e.hide_w()}}]}]}]}}},t.prototype.show_w=function(e,t){var i=this;this.getRoot().getHead().getChildViews()[0].setValue(e),this.$$("_form").config.c_view=t,t.eachColumn(function(e){var o={view:"checkbox",labelRight:t.getColumnConfig(e).header[0].text,id:e,value:1,labelWidth:0,width:175};i.$$("_check").addView(o)},!0),this.getRoot().show()},t.prototype.hide_w=function(){this.getRoot().hide()},t}(o.c);t.default=r},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(0);var r=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this,t=this.app;return{view:"cWindow",modal:!0,body:{view:"form",localId:"prop_form",margin:0,elements:[{rows:[{view:"counter",label:"Количество отображаемых строк в таблице:",value:20,labelWidth:270,width:370,step:1,align:"left",min:1,max:50,name:"posPpage",localId:"_ppage"},{height:10},{view:"checkbox",label:"Получать уведомления",value:1,labelWidth:270,width:370,readonly:!1,localId:"notify",name:"notify",on:{onChange:function(){1===e.$$("notify").getValue()?e.$$("nTime").show():0===e.$$("notify").getValue()&&e.$$("nTime").hide()}}},{height:10},{view:"counter",label:"Время вывода уведомлений",value:3,labelWidth:270,width:370,step:1,align:"left",min:0,max:30,readonly:!1,localId:"nTime",name:"nDelay",hidden:!0},{height:10},{view:"checkbox",label:'Вид кнопок "Эксперт"',value:1,labelWidth:270,width:370,readonly:!1,localId:"expert",name:"expert"},{height:10},{view:"checkbox",label:"Запоминать окна и параметры поиска",value:0,labelWidth:270,width:370,readonly:!0,localId:"save",name:"save"},{view:"checkbox",label:"<span>Я </span><span style='color:red; font-weight: bold'>НЕ</span><span> собираюсь сводить</span>",value:0,labelWidth:270,width:370,readonly:!1,localId:"link",name:"link"},{height:15},{view:"label",label:"<span style='color: red'>После сохранения настроек страница будет обновленна</span>"},{height:15},{cols:[{view:"button",type:"base",label:"Отменить",width:120,height:32,click:function(){e.hide_w()}},{},{view:"button",type:"base",label:"Сохранить",width:120,height:32,click:function(){var i=e.$$("prop_form").getValues(),o=t.config.r_url+"?setExpert",r={user:t.config.user,expert:i.expert?"1":"5"};Object(n.request)(o,r),delete i.expert,i.nDelay=1e3*i.nDelay,o=t.config.r_url+"?saveParams",r={user:t.config.user,pars:i},Object(n.request)(o,r),e.hide_w(),location.href="localhost"===location.hostname?"http://localhost:8080":"/linker/"}}]}]}]}}},t.prototype.ready=function(){1===this.$$("notify").getValue()?this.$$("nTime").show():0===this.$$("notify").getValue()&&this.$$("nTime").hide()},t.prototype.show_w=function(e){var t=this.app;this.getRoot().getHead().getChildViews()[0].setValue(e),this.$$("_ppage").setValue(t.config.posPpage),this.$$("notify").setValue(t.config.notify),this.$$("nTime").setValue(t.config.nDelay/1e3),this.$$("expert").setValue(!0===t.config.expert?1:0),this.$$("save").setValue(t.config.save),this.$$("link").setValue(t.config.link),this.getRoot().show()},t.prototype.hide_w=function(){this.getRoot().hide()},t.prototype.init=function(){},t}(o.c);t.default=r},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(0),r=i(52);var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this.app;return{type:"clean",localId:"_prop",rows:[{localId:"_acord",header:"Свойства документа",body:{view:"form",localId:"_dHead",oldData:void 0,bodredless:!0,margin:0,padding:0,elements:[{view:"text",value:"",label:"Нормативный документ",labelWidth:155,name:"n_doc",localId:"tte",on:{onKeyPress:function(){this.$scope.show_b()},onTimedKeyPress:function(){var e=this.getValue();this.$scope.parent.getSelectedItem().n_doc=e,this.$scope.parent.refresh(this.$scope.parent.getSelectedId())}}},{view:"text",value:"",label:"Наименование",labelWidth:155,name:"name",p_disable:!0,on:{onKeyPress:function(){this.$scope.show_b()}}},{view:"text",value:"",label:"Торговое наименование",labelWidth:155,name:"t_name",on:{onKeyPress:function(){this.$scope.show_b()}}},{view:"text",value:"",label:"Серия",labelWidth:155,name:"series",p_disable:!0,on:{onKeyPress:function(){this.$scope.show_b()}}},{view:"text",value:"",label:"Производитель",labelWidth:155,name:"vendor",p_disable:!0,on:{onKeyPress:function(){this.$scope.show_b()}}},{view:"text",value:"",label:"Регион",labelWidth:155,name:"region",on:{onKeyPress:function(){this.$scope.show_b()}}},{view:"text",value:"",label:"№ записи",labelWidth:155,name:"number",on:{onKeyPress:function(){this.$scope.show_b()}}},{view:"text",value:"",label:"Дата изменения",labelWidth:155,name:"ch_dt",disabled:!0,p_disable:!1,on:{onKeyPress:function(){this.$scope.show_b()}}},{view:"text",value:"",label:"ЖВ",labelWidth:155,name:"gv",on:{onKeyPress:function(){this.$scope.show_b()}}},{view:"text",value:"",label:"Описание",labelWidth:155,name:"desc",on:{onKeyPress:function(){this.$scope.show_b()}}},{view:"text",value:"",label:"О",labelWidth:155,name:"f_name",hidden:!0}]}},{view:"tinymce-editor",css:{"margin-top":"-1px !important"},borderless:!0,localId:"_editor",config:{theme:"modern",statusbar:!1,image_advtab:!0,branding:!1,language:"ru",menubar:!1,toolbar:!0,toolbar1:"fontselect fontsizeselect | undo redo | bold italic strikethrough forecolor backcolor | alignleft aligncenter alignright alignjustify | codesample",plugins:["searchreplace visualblocks visualchars codesample","pagebreak nonbreaking anchor insertdatetime advlist lists textcolor","colorpicker textpattern"],content_css:[]}},{view:"toolbar",height:35,css:{"margin-top":"-1px !important"},borderless:!0,cols:[{},{view:"button",value:"Сохранить",width:120,localId:"_save",hidden:!0,on:{onItemClick:function(){var t=this.$scope.$$("_dHead").getValues();t.letter=this.$scope.$$("_editor").getValue();var i=this.$scope.topParent.$scope.$$("_check_w_mails").getValue(),o={user:e.config.user,item:t,check_letter:i},r=e.config.r_url+"?setBrakMail",s=Object(n.request)(r,o,!0).response;(s=Object(n.checkVal)(s,"s"))?(webix.message({type:"success",text:"Сохранено",expire:2e3}),this.$scope.topParent.getSelectedItem().m_count=+s.m_count,this.$scope.reopen(),s.similar&&s.similar.length&&s.similar.length>0&&this.$scope.popmass.show_w(this.$scope.topParent.$scope,t,s.similar)):(webix.message({type:"error",text:"Ошибка сохранения",expire:2e3}),this.$scope.$$("_cancel").callEvent("onItemClick"))}}},{view:"button",value:"Отменить",width:120,localId:"_cancel",hidden:!0,on:{onItemClick:function(){if(this.$scope.parent.config.$new)this.$scope.reopen();else if(this.$scope.$$("_dHead").config.oldData){this.$scope.load_data(this.$scope.$$("_dHead").config.oldData,this.$scope.parent,this.$scope.topParent),this.$scope.hide_b();var e=this.$scope.$$("_dHead").getValues().n_doc;this.$scope.parent.getSelectedItem().n_doc=e,this.$scope.parent.refresh(this.$scope.parent.getSelectedId())}else this.$scope.clear_info()}}}]}]}},t.prototype.ready=function(){this.disable_info()},t.prototype.reopen=function(){var e=this.topParent.$scope.$$("_noMail").getValue(),t=this.topParent.getSelectedItem().id;this.clear_info(),1===e&&this.topParent.getItem(t).m_count>0?this.topParent.remove(t):(this.topParent.closeSub(t),this.topParent.openSub(t,this.topParent)),this.disable_info()},t.prototype.load_data=function(e,t,i){var o=this;this.$$("_acord").define({collapsed:!1}),this.$$("_acord").resize(),this.clear_info(),this.$$("_dHead").parse(e),this.$$("_editor").setValue(e.letter||""),this.parent=t,this.topParent=i,this.$$("_dHead").config.oldData=this.$$("_dHead").getValues(),this.$$("_dHead").config.oldData.letter=this.$$("_editor").getValue(),t.config.$new&&this.show_b(),document.getElementsByTagName("iframe")[0].contentDocument.body.onkeydown=function(){o.show_b()},this.$$("_editor").focus()},t.prototype.clear_info=function(){this.$$("_dHead").clear(),this.$$("_editor").setValue(""),this.hide_b()},t.prototype.show_b=function(){this.$$("_save").show(),this.$$("_cancel").show()},t.prototype.hide_b=function(){this.$$("_save").hide(),this.$$("_cancel").hide()},t.prototype.disable_info=function(){this.$$("_dHead").getChildViews().forEach(function(e,t,i){e.disable()})},t.prototype.enable_info=function(){this.$$("_dHead").getChildViews().forEach(function(e,t,i){e.config.p_disable||e.enable()})},t.prototype.init=function(){this.popmass=this.ui(r.default)},t}(o.c);t.default=s},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(0);var r=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this,t=this.app;return{view:"cWindow",modal:!0,on:{onHide:function(){for(var t=e.$$("_lists").getChildViews(),i=t.length;i>0;i--)e.$$("_lists").removeView(t[i-1].config.id)}},body:{view:"form",margin:0,height:.5*document.documentElement.clientHeight,width:730,scroll:!0,elements:[{cols:[{view:"label",label:"Препарат:",height:32,width:100},{view:"label",label:"",height:32,localId:"_tovar",css:"highlited"}]},{cols:[{view:"label",label:"Письмо:",height:32,width:100},{view:"label",label:"",height:32,localId:"_letter",css:"highlited"}]},{view:"label",label:"Серии:",height:32},{view:"layout",localId:"_lists",rows:[]},{},{cols:[{view:"button",type:"base",label:"Нет",width:120,height:32,click:function(){e.hide_w()}},{},{view:"button",type:"base",label:"Да",width:120,height:32,localId:"_yes",click:function(){var i=[];if(e.$$("_lists").getChildViews().forEach(function(e){"list"===e.config.view&&e.data.each(function(e){1===e.ch&&i.push(e.series)})}),i.length>0){var o=t.config.r_url+"?setMassBrakMail";e.item.id=99999999;var r={user:t.config.user,item:e.item,series_list:i},s=Object(n.request)(o,r,!0).response;(s=Object(n.checkVal)(s,"s"))?(webix.message({type:"success",text:"Сохранено",expire:2500}),e.parent.$$("_ls").callEvent("onKeyPress",[13])):webix.message({type:"error",text:"Ошибка сохранения",expire:2500}),console.log("datas",r)}e.hide_w()}}]}]}}},t.prototype.show_w=function(e,t,i){this.parent=e,this.item=t;var o={view:"list",layout:"x",select:!1,scroll:!1,height:32,template:"{common.checkBox()} #series#",type:{width:140,checkBox:function(e){return"<span class='check webix_icon fa-"+(e.ch?"check-":"")+"square-o'></span>"}},onClick:{check:function(e,t){var i=this.getItem(t);i.ch=i.ch?0:1,this.updateItem(t,i)}}};this.$$("_tovar").setValue(t.name),this.$$("_letter").setValue(t.n_doc);for(var n=Math.ceil(i.length/5),r=0;r<n;r++)this.$$("_lists").addView(o);this.$$("_lists").getChildViews().forEach(function(e){for(var t=[],o=0;o<5;o++)if(i.length>0){var n=i.pop(0);n.ch=0,t.push(n)}"list"===e.config.view&&e.parse(t)}),this.getRoot().getHead().getChildViews()[0].setValue("Есть другие серии с таким препаратом. Привязать?"),this.getRoot().show()},t.prototype.hide_w=function(){this.getRoot().hide()},t.prototype.ready=function(e){},t.prototype.init=function(e){},t}(o.c);t.default=r},function(e,t,i){"use strict";i.r(t);var o=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this;return{view:"cWindow",modal:!1,on:{onHide:function(){e.$$("_uploader").files.clearAll()}},body:{view:"form",rows:[{view:"uploader",localId:"_uploader",type:"iconButton",icon:"plus-circle",multiple:!0,autosend:!1,align:"left",label:"Добавить файл",directory:!1,accept:"application/dbf",urlData:{},link:void 0,upload:this.app.config.r_url+"?uploadBrak",datatype:"json",on:{onUploadComplete:function(t){t.result?webix.message({type:"success",text:"брак сохранен",expire:1500}):webix.message({type:"error",text:t.ret_val,expire:1500}),e.hide_window()}}},{view:"list",localId:"_f_list",type:"uploader",autoheight:!0,borderless:!0},{view:"button",label:"Отправить",type:"iconButton",icon:"upload",click:function(){e.$$("_uploader").files.data.each(function(t){t.urlData={filename:t.name,source:"linker"},e.$$("_uploader").send(t.id)})}}]}}},t.prototype.ready=function(){this.$$("_uploader").define({link:this.$$("_f_list").config.id}),this.$$("_uploader").refresh()},t.prototype.show_window=function(e){this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show(),this.$$("_uploader").fileDialog()},t.prototype.hide_window=function(){this.getRoot().hide()},t.prototype.init=function(){},t}(i(1).c);t.default=o},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(0),r=i(55);var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e,t=this;this.app;return{view:"cWindow",modal:!1,on:{onHide:function(){t.$$("__table").hideOverlay()}},body:{rows:[{view:"toolbar",height:40,cols:[{},{view:"button",type:"htmlbutton",tooltip:"Убрать/показать прошедшие проверку",localId:"_show",resizable:!0,sWidth:175,eWidth:40,label:"",width:40,extLabel:"<span style='line-height: 20px;padding-left: 5px'>Убрать/показать</span>",oldLabel:"<span class='webix_icon fa-eye'></span>",filter:!1,click:function(){this.config.filter?(this.config.filter=!1,this.$scope.$$("__table").filter()):(this.config.filter=!0,this.$scope.$$("__table").filter(function(e){return!e.result}))}},{view:"button",type:"htmlbutton",tooltip:"Загрузить файл забраковки Excel",localId:"_load",resizable:!0,sWidth:155,eWidth:40,label:"",width:40,extLabel:"<span style='line-height: 20px;padding-left: 5px'>Загрузить файл</span>",oldLabel:"<span class='webix_icon fa-upload'></span>",click:function(){t.upload.show_window(t)}}]},{height:3},{view:"datatable",localId:"__table",width:.7*document.documentElement.clientWidth,height:.8*document.documentElement.clientHeight,select:!0,resizeColumn:!0,navigation:"row",editable:!1,fixedRowHeight:!1,rowLineHeight:24,rowHeight:24,autowidth:!0,headermenu:{autowidth:!0},columns:[{id:"result",width:70,hidden:!1,headermenu:!1,header:[{text:"Результат"}],css:"center_p",template:function(e){return!0===e.result?"<span class='webix_icon fa-check-circle', style='color: green'></span>":"<span class='webix_icon fa-times-circle', style='color: red'></span>"}},{id:"file_series",width:140,headermenu:!1,sort:"text",header:[{text:"Серия в файле"}]},{id:"file_rus",width:50,hidden:!0,header:[{text:""}],template:function(e){return"<span class='flag', style='background-image: url(addons/img/"+e.file_rus+".svg) !important;'>"+e.file_rus+"</span>"}},{id:"file_number",width:140,hidden:!1,header:[{text:"Номер письма"}]},{id:"letter_match",width:120,headermenu:!1,header:[{text:"Письмо в базе"}],css:"center_p",template:function(e){return!0===e.letter_match?"<span class='webix_icon fa-check-circle', style='color: green'></span>":"<span class='webix_icon fa-times-circle', style='color: red'></span>"}},(e={id:"title",width:.7*document.documentElement.clientWidth-470,headermenu:!1,sort:"text",header:[{text:"Название письма в базе"}]},e.headermenu=!1,e),{id:"base_lang",width:50,hidden:!0,header:[{text:""}],template:function(e){return e.base_lang?"<span class='flag', style='background-image: url(addons/img/"+e.base_lang+".svg) !important;'>"+e.base_lang+"</span>":""}}],on:{onresize:webix.once(function(){this.adjustRowHeight("title",!0)}),"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onItemDblClick:function(e){}}}]}}},t.prototype.show_w=function(e,t){this.getRoot().getHead().getChildViews()[0].setValue("Сравнение файла с базой"),this.getRoot().show()},t.prototype.ready=function(){var e=[this.$$("_show"),this.$$("_load")];Object(n.setButtons)(this.app,e)},t.prototype.init=function(){this.upload=this.ui(r.default)},t}(o.c);t.default=s},function(e,t,i){"use strict";i.r(t);var o=i(1);i(0);var n=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this;return{view:"uploader",localId:"_uploader",accept:"application/vnd.ms-excel,",apiOnly:!0,urlData:{},link:void 0,upload:this.app.config.r_url+"?checkBrakXls",datatype:"json",on:{onBeforeFileAdd:function(e){if("xls"!=e.type.toLowerCase())return webix.message({type:"error",text:"Поддерживаются только XLS-файлы",delay:800}),!1},onFileUploadError:function(){e.view.$$("__table").hideProgress()},onAfterFileAdd:function(t){e.view.$$("__table").hideOverlay(),e.view.$$("__table").clearAll(),e.view.$$("_show").config.filter=!1,e.view.$$("__table").showProgress({type:"icon",icon:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>'}),e.$$("_uploader").files.data.each(function(t){t.urlData={filename:t.name,source:"linker"},e.$$("_uploader").send(t.id)})},onUploadComplete:function(t){if(e.view.$$("__table").hideProgress(),t.result)(t=t.ret_val)&&(e.view.$$("__table").parse(t),e.view.$$("__table").adjustRowHeight("title"),function(e){e.data.order.forEach(function(t){var i=e.getItem(t);i.$css=i.result?"shadow":""}),e.refresh()}(e.view.$$("__table")));else{var i=t.ret_val;e.view.$$("__table").showOverlay(i||"Ошибка загрузки")}}}}},t.prototype.ready=function(){},t.prototype.show_window=function(e){this.view=e,this.$$("_uploader").fileDialog()},t.prototype.hide_window=function(){this.getRoot().hide()},t.prototype.init=function(){},t}(o.c);t.default=n},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(0);var r=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this.app,t=this,o=i(82);try{e.config.eventS.close()}catch(e){}var r=o.v4()+"::"+e.config.user,s="localhost"===location.hostname?"http://saas.local/events/SSE?":"../events/SSE?";s+=r;setTimeout(function t(){e.config.eventS&&1===e.config.eventS.readyState||(e.config.eventS=new EventSource(s),e.config.notify&&(e.config.eventS.onmessage=function(t){webix.message({type:"info",text:t.data,expire:e.config.nDelay})}),e.config.eventS.addEventListener("update",function(t){webix.message({type:"event",text:t.data,expire:e.config.nDelay})}),e.config.eventS.addEventListener("enablespin",function(e){var t=e.data.split("::"),i=void 0;if("spr"===t[0]&&(i=$$("_spr_button")),"spr_roz"===t[0]&&(i=$$("_spr_roz_button")),i){i.blockEvent(),Object(n.spinIconEnable)(i);var o="\n выгружает: "+t[2];i.define({tooltip:i.config.tooltipTemplate+o}),i.refresh()}}),e.config.eventS.addEventListener("disablespin",function(e){var t=e.data.split("::"),i=void 0;if("spr"===t[0]?i=$$("_spr_button"):"spr_roz"===t[0]&&(i=$$("_spr_roz_button")),i){if(i.config.lastModified!==+t[1]){i.config.lastModified=+t[1],i.config.lastUser=t[2];var o=". Выгружал: "+(i.config.lastUser||"неизвестно"),r=new Date(1e3*i.config.lastModified).toLocaleString("ru"),s=i.config.lastModified>0?r:" неизвестно";i.define({tooltip:i.config.tooltipTemplate+"\nПоследняя выгрузка: "+s+o}),i.refresh()}i.unblockEvent(),Object(n.spinIconDisable)(i)}}),e.config.eventS.addEventListener("close",function(e){eventS.close()})),setTimeout(t,4e3)},50);var a=function(t){var i=Object(n.getCookie)("linker-app");if(i){var o=i.split("::");i=o[0],o[1],o[2];var r=e.config.r_url+"?setExit",s={user:i};Object(n.request)(r,s)}};return window.addEventListener("beforeunload",a,!1),{view:"toolbar",css:"realy_header",cols:[{view:"label",label:"<a href='http://ms71.org'><span class='ms-logo', style='margin-left: -5px !important; background-image: url(addons/img/logo.png);'></span></a>",width:44,align:"center",height:36},{view:"label",label:"МАНУСКРИПТ-СОЛЮШН: Связки и эталоны | "+this.app.config.user,css:"ms-logo-text",height:36,width:550},{},{view:"button",type:"htmlbutton",tooltip:"Выход",resizable:!0,sWidth:106,eWidth:40,label:"",width:40,extLabel:"<span class='side_icon', style='line-height: 20px; padding-left: 5px'>Выйти</span>",oldLabel:"<span class='side_icon webix_icon fa-sign-out'></span>",on:{onItemClick:function(){a(),Object(n.deleteCookie)("linker-app"),t.app.config.user="",t.app.config.role="0",t.app.config.x_api="x_login",location.href="localhost"===location.hostname?"http://localhost:8080":"/linker/"}}}]}},t.prototype.ready=function(){},t}(o.c);t.default=r},function(e,t){webix.i18n.locales["ru-RU"]={groupDelimiter:" ",groupSize:3,decimalDelimiter:",",decimalSize:2,dateFormat:"%d.%m.%Y",timeFormat:"%H:%i",longDateFormat:"%d %F %Y",fullDateFormat:"%d.%m.%Y %H:%i",price:"{obj} руб.",priceSettings:null,calendar:{monthFull:["Январь","Февраль","Март","Апрель","Maй","Июнь","Июль","Август","Сентябрь","Oктябрь","Ноябрь","Декабрь"],monthShort:["Янв","Фев","Maр","Aпр","Maй","Июн","Июл","Aвг","Сен","Окт","Ноя","Дек"],dayFull:["Воскресенье","Понедельник","Вторник","Среда","Четверг","Пятница","Суббота"],dayShort:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],hours:"Часы",minutes:"Минуты",done:"Гoтовo",clear:"Очистить",today:"Сегодня"},controls:{select:"Выбрать",invalidMessage:"Неправильное значение"},dataExport:{page:"Страница",of:"из"},PDFviewer:{of:"из",automaticZoom:"Автоматический зум",actualSize:"Настоящий размер",pageFit:"Размер страницы",pageWidth:"Ширина страницы",pageHeight:"Высота страницы"},aria:{calendar:"Календарь",increaseValue:"Увеличить значение",decreaseValue:"Уменьшить значение",navMonth:["Предыдущий месяц","Следующий месяц"],navYear:["Предыдущий год","Следующий год"],navDecade:["Предыдущие десять лет","Следующие десять лет"],dateFormat:"%d %F %Y",monthFormat:"%F %Y",yearFormat:"%Y",hourFormat:"Часы: %H",minuteFormat:"Минуты: %i",removeItem:"Удалить элемент",pages:["Первая страница","Предыдущая страница","Следующая страница","Последняя страница"],page:"Страница",headermenu:"Меню шапки таблицы",openGroup:"Развернуть группу столбцов",closeGroup:"Свернуть группу столбцов",closeTab:"Закрыть вкладку",showTabs:"Показать больше вкладок",resetTreeMap:"Вернуться к первоначальному представлению",navTreeMap:"Перейти на уровень выше",nextTab:"Следующая вкладка",prevTab:"Предыдущая вкладка",multitextSection:"Добавить элемент",multitextextraSection:"Удалить элемент",showChart:"Показать чарт",hideChart:"Спрятать чарт",resizeChart:"Изменить размер чарта"},richtext:{underline:"Подчеркивание",bold:"Жирный",italic:"Курсив"}}},function(e,t,i){var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};
/*!
 * webix-routie - router for Webix-Jet
 * v0.4.0
 * MIT License
 *
 * based on routie - a tiny hash router
 * http://projects.jga.me/routie
 * copyright Greg Allen 2016
 * MIT License
*/e.exports=function(e,t){var i,n=[],r={},s=e.routie,a=function(e,t){this.name=t,this.path=e,this.keys=[],this.fns=[],this.params={},this.regex=l(this.path,this.keys,!1,!1)};a.prototype.addHandler=function(e){this.fns.push(e)},a.prototype.removeHandler=function(e){for(var t=0,i=this.fns.length;t<i;t++)if(e==this.fns[t])return void this.fns.splice(t,1)},a.prototype.run=function(e){for(var t=0,i=this.fns.length;t<i;t++)if(!1===this.fns[t].apply(this,e))return!1;return!0},a.prototype.match=function(e,t){var i=this.regex.exec(e);if(!i)return!1;for(var o=1,n=i.length;o<n;++o){var r=this.keys[o-1],s="string"==typeof i[o]?decodeURIComponent(i[o]):i[o];r&&(this.params[r.name]=s),t.push(s)}return!0},a.prototype.toURL=function(e){var t=this.path;for(var i in e)t=t.replace("/:"+i,"/"+e[i]);if(-1!=(t=t.replace(/\/:.*\?/g,"/").replace(/\?/g,"")).indexOf(":"))throw new Error("missing parameters for url: "+t);return t};var l=function(e,t,i,o){return e instanceof RegExp?e:(e instanceof Array&&(e="("+e.join("|")+")"),e=e.concat(o?"":"/?").replace(/\/\(/g,"(?:/").replace(/\+/g,"__plus__").replace(/(\/)?(\.)?:(\w+)(?:(\(.*?\)))?(\?)?/g,function(e,i,o,n,r,s){return t.push({name:n,optional:!!s}),i=i||"",(s?"":i)+"(?:"+(s?i:"")+(o||"")+(r||o&&"([^/.]+?)"||"([^/]+?)")+")"+(s||"")}).replace(/([/.])/g,"\\$1").replace(/__plus__/g,"(.+)").replace(/\*/g,"(.*)"),new RegExp("^"+e+"$",i?"":"i"))},c=function(e,t){var i=e.split(" "),o=2==i.length?i[0]:null;e=2==i.length?i[1]:i[0],r[e]||(r[e]=new a(e,o),n.push(r[e])),r[e].addHandler(t)},u=function e(t,i){if("function"==typeof i)c(t,i),e.reload();else if("object"==(void 0===t?"undefined":o(t))){for(var n in t)c(n,t[n]);e.reload()}else void 0===i&&e.navigate(t)};u.lookup=function(e,t){for(var i=0,o=n.length;i<o;i++){var r=n[i];if(r.name==e)return r.toURL(t)}},u.remove=function(e,t){var i=r[e];i&&i.removeHandler(t)},u.removeAll=function(){r={},n=[],i=""},u.navigate=function(e,t){var i=(t=t||{}).silent||!1;i&&_(),setTimeout(function(){window.location.hash=e,i&&setTimeout(function(){f()},1)},1)},u.noConflict=function(){return e.routie=s,u};var d=function(){return window.location.hash.substring(1)},p=function(e,t){var i=[];return t.match(e,i)?!1!==t.run(i)?1:0:-1},h=u.reload=function(){for(var e=d(),t=0,o=n.length;t<o;t++){var r=n[t],s=p(e,r);if(1===s){i=e;break}if(0===s){u.navigate(i,{silent:!0});break}}},f=function(){e.addEventListener?e.addEventListener("hashchange",h,!1):e.attachEvent("onhashchange",h)},_=function(){e.removeEventListener?e.removeEventListener("hashchange",h):e.detachEvent("onhashchange",h)};if(f(),i=d(),t)return u;e.routie=u}(window,!0),e.exports.default=e.exports},function(e,t,i){"use strict";i.r(t);var o=i(1);i(0);var n=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this;this.app;return{rows:[{view:"toolbar",css:{"border-top":"0px !important"},height:40,cols:[{},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-upload'></span><span> Добавить файл на обработку</span>",width:240,click:function(){webix.message({text:"Добавление файла",type:"debug"})}}]},{height:3},{view:"tabview",multiview:!0,cells:[{header:"<span style='line-height: 20px;'>Заявки</span>",width:120,body:{view:"layout",rows:[{height:40,view:"toolbar",cols:[{},{view:"button",type:"htmlbutton",localId:"refresh",label:"<span class='webix_icon fa-refresh'></span>",width:40,tooltip:"Обновить",click:function(){webix.message({text:"обновление",type:"debug"}),e.$$("__table").getHeaderContent("ch1").uncheck(),e.ready()}},{view:"button",type:"htmlbutton",localId:"confirm",hidden:!0,label:"<span class='webix_icon fa-thumbs-up'></span>",width:40,tooltip:"Одобрить выделенные",click:function(){webix.message({text:"одобренно",type:"debug"})}},{view:"button",type:"htmlbutton",localId:"reject",hidden:!0,label:"<span class='webix_icon fa-thumbs-down'></span>",width:40,tooltip:"Отклонить выделенные",click:function(){webix.message({text:"отклоненно",type:"debug"})}}]},{view:"datatable",localId:"__table",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,columns:[{id:"change",hidden:!0,headermenu:!1},{id:"confirm",css:{"text-align":"center !important;"},width:100,header:[{text:"Подтвердить",css:{"text-align":"center !important;"}},{content:"masterCheckbox",css:{"text-align":"center !important;"},contentId:"ch1"}],template:"{common.checkbox()}"},{id:"user",headermenu:!1,fillspace:1,sort:"text",header:[{text:"Логин пользователя"}]},{id:"lastname",width:150,header:[{text:"Фамилия"}]},{id:"firstname",width:150,header:[{text:"Имя"}]},{id:"email",width:250,header:[{text:"email"}]},{id:"dt",width:200,header:[{text:"Дата запроса"}]}],on:{"data->onParse":function(e,t){this.clearAll(),this.$scope.$$("confirm").hide(),this.$scope.$$("reject").hide()},onCheck:function(t,i,o){e.$$("__table").getItem(t).change=1,e.$$("confirm").show(),e.$$("reject").show()},onBeforeRender:function(){this.count||this.showProgress({type:"icon",icon:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>'})},onItemDblClick:function(e){this.getSelectedItem()},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(){},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}}]}},{header:"<span style='line-height: 20px;'>История</span>",width:120,body:{view:"layout",rows:[{height:40,view:"toolbar",cols:[{},{view:"button",type:"htmlbutton",hidden:!0,label:"<span class='webix_icon fa-thumbs-up'></span>",width:40,click:function(){webix.message({text:"одобренно",type:"debug"})}},{view:"button",type:"htmlbutton",hidden:!0,label:"<span class='webix_icon fa-thumbs-down'></span>",width:40,click:function(){webix.message({text:"отклоненно",type:"debug"})}}]},{view:"datatable",localId:"__table1",select:!1,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,columns:[{id:"status",css:{"text-align":"center !important;"},width:100,header:[{text:"Статус",css:{"text-align":"center !important;"}}],template:function(e){return 1===e.status?"<div><span style='color: green;', class='webix_icon fa-check-circle'></span></div>":"<div><span style='color: red;', class='webix_icon fa-times-circle'></span></div>"}},{id:"user",headermenu:!1,fillspace:1,sort:"text",header:[{text:"Логин пользователя"}]},{id:"lastname",width:150,header:[{text:"Фамилия"}]},{id:"firstname",width:150,header:[{text:"Имя"}]},{id:"email",width:250,header:[{text:"email"}]},{id:"dt",width:200,header:[{text:"Дата изменения"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){this.count||this.showProgress({type:"icon",icon:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>'})},onAfterLoad:function(){this.hideProgress()}}}]}}]}]}},t.prototype.ready=function(){this.$$("__table").parse([{id:1,confirm:0,user:"1111",lastname:"sds",firstname:"jjh",email:"112@mam.ee",dt:"08.05.2018 12:00:00.000"},{id:2,confirm:0,user:"11114",lastname:"s2ds",firstname:"jjh5",email:"14412@mam.ee",dt:"08.05.2018 12:00:00.000"},{id:3,confirm:0,user:"11113",lastname:"sd2s",firstname:"jj4h",email:"11255@mam.ee",dt:"08.05.2018 12:00:00.000"},{id:4,confirm:0,user:"11112",lastname:"sds2",firstname:"j1jh",email:"11662@mam.ee",dt:"08.05.2018 12:00:00.000"}]),this.$$("__table1").parse([{id:1,status:1,user:"1111",lastname:"sds",firstname:"jjh",email:"112@mam.ee",dt:"08.05.2018 12:00:00.000"},{id:2,status:1,user:"11114",lastname:"s2ds",firstname:"jjh5",email:"14412@mam.ee",dt:"08.05.2018 12:00:00.000"},{id:3,status:1,user:"11113",lastname:"sd2s",firstname:"jj4h",email:"11255@mam.ee",dt:"08.05.2018 12:00:00.000"},{id:4,status:0,user:"11112",lastname:"sds2",firstname:"j1jh",email:"11662@mam.ee",dt:"08.05.2018 12:00:00.000"}])},t.prototype.init=function(){webix.extend(this.$$("__table"),webix.ProgressBar),webix.extend(this.$$("__table1"),webix.ProgressBar)},t}(o.c);t.default=n},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(0),r=i(9),s=i(2);var a=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this;function t(e){var t,i=e.item.$level,o=e.item,r=e.th,s=r.$scope.app.config.user,a=r.$scope.app.config.r_url+"?delBar";if(1===i)t={user:s,barcode:o.c_tovar,id_spr:void 0};else if(2===i){t={user:s,barcode:r.getItem(o.$parent).c_tovar,id_spr:o.id_spr}}var l=Object(n.request)(a,t,!0).response;(l=Object(n.checkVal)(l,"s"))&&(1===i?r.remove(o.id):2===i&&(r.remove(o.id),0===r.getItem(o.$parent).$count&&r.remove(o.$parent)))}return{view:"layout",type:"clean",css:{"border-left":"1px solid #dddddd !important"},rows:[{view:"treetable",name:"__dtdb",localId:"__table",startPos:1,posPpage:this.app.config.posPpage,totalPos:1250,select:!0,resizeColumn:!0,borderless:!0,navigation:"row",rowHeight:32,fixedRowHeight:!1,rowLineHeight:32,headermenu:{autowidth:!0},editable:!1,old_stri:" ",fi:"c_tovar",di:"asc",searchBar:void 0,searchMethod:"getBarsSpr",columns:[{id:"c_tovar",header:"Товар",fillspace:!0,sort:"server",headermenu:!1,template:"<span>{common.treetable()} #c_tovar#</span>"},{id:"id_spr",width:150,header:[{text:"IDSPR"}]},{id:"id_state",width:150,header:[{text:"Статус"}]},{id:"dt",header:"Дата",width:160},{id:"owner",header:"Создал",width:120}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onBeforeSort:function(t,i){e.$$("__table").config.fi=t,e.$$("__table").config.di=i,function(){var t=e.getRoot().getChildViews()[1].$scope.$$("__page").getValue();e.getRoot().getChildViews()[1].$scope.$$("__page").setValue(0==+t?"1":"0"),e.getRoot().getChildViews()[1].$scope.$$("__page").refresh()}()},onItemDblClick:function(e){var i=(e=this.getSelectedItem()).$level,o={callback:t,params:{item:e,th:this}};2===i?this.$scope.popconfirm.show("Удалить товар из ШК?",o):1===i&&this.$scope.popconfirm.show("Удалить ШК со всеми товарами?",o)},onAfterLoad:function(){},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}},{$subview:s.default}]}},t.prototype.init=function(){this.popconfirm=this.ui(r.default)},t.prototype.ready=function(){this._search=this.getRoot().getParentView().$scope.$$("_sb"),this.$$("__table").config.searchBar=this._search.config.id,this._search.focus()},t}(o.c);t.default=a},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(0),r=i(6),s=i(9),a=i(2);var l=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this,t=this.app,i=function(t){var i=t.item,o=t.th,r=o.$scope.app.config.user,s=o.$scope.app.config.r_url+"?delBar",a={user:r,id_spr:i.$parent,barcode:i.barcode},l=Object(n.request)(s,a,!0).response;if(l=Object(n.checkVal)(l,"s")){o.remove(i.id);var c=e.$$("__table").getItem(i.$parent);c.count=c.$count>0?c.$count:"",e.$$("__table").refresh(i.$parent)}},o=function(i,o){var r=e.$$("__table"),s=t.config.user,a=t.config.r_url+"?setBar",l={user:s,id_spr:i,barcode:o},c=Object(n.request)(a,l,!0).response;if(c=Object(n.checkVal)(c,"s")){var u=r.isBranchOpen(i),d=(o.split(" "),[]);r.data.each(function(e){2===e.$level&&e.$parent===i&&d.push(e.id)}),r.remove(d),a=r.$scope.app.config.r_url+"?getBar",Object(n.checkVal)(Object(n.request)(a,l,!0).response,"s").forEach(function(e,t,o){var n={barcode:e.barcode,id_state:"active",dt:e.dt,owner:"",count:""};r.add(n,0,i)}),u&&r.open(i);var p=e.$$("__table").getItem(i);p.count=p.$count>0?p.$count:"",e.$$("__table").refresh(i)}};return{view:"layout",type:"clean",css:{"border-left":"1px solid #dddddd !important"},rows:[{view:"treetable",localId:"__table",name:"__dtd",startPos:1,posPpage:t.config.posPpage,totalPos:1250,select:!0,resizeColumn:!0,borderless:!0,navigation:"row",rowHeight:32,fixedRowHeight:!1,rowLineHeight:32,headermenu:{autowidth:!0},editable:!1,old_stri:" ",fi:"c_tovar",di:"asc",searchBar:void 0,searchMethod:"getSprBars",columns:[{id:"barcode",header:"Штрих-код",fillspace:!0,headermenu:!1,template:"<span>{common.treetable()} #barcode#</span><span style='color: red'> #count#</span>"},{id:"dt",header:"Дата изменения",width:200,format:n.dt_formating_sec,css:"center_p"},{id:"owner",header:"Изменил",width:120,hidden:!0}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onBeforeSort:function(t,i){e.$$("__table").config.fi=t,e.$$("__table").config.di=i,function(){var t=e.getRoot().getChildViews()[1].$scope.$$("__page").getValue();e.getRoot().getChildViews()[1].$scope.$$("__page").setValue(0==+t?"1":"0"),e.getRoot().getChildViews()[1].$scope.$$("__page").refresh()}()},onItemDblClick:function(){var e=this.getSelectedItem();if(t.config.roles[t.config.role].adm){var n=e.$level;if(1===n)this.$scope.popnewbar.show("Редактирование ШК: "+e.barcode,e.id,void 0,o);else if(2===n){var r={callback:i,params:{item:e,th:this}};this.$scope.popconfirm.show("Удалить ШК?",r)}}else webix.message({type:"error",text:"Редактирование запрещено"})},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}},{$subview:a.default}]}},t.prototype.init=function(){this.popnewbar=this.ui(r.default),this.popconfirm=this.ui(s.default)},t.prototype.ready=function(){this._search=this.getRoot().getParentView().$scope.$$("_sb"),this.$$("__table").config.searchBar=this._search.config.id,this._search.focus()},t}(o.c);t.default=l},function(e,t,i){"use strict";i.r(t);var o=i(1),n=(i(0),i(29)),r=i(30),s=i(32),a=i(34);var l=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){this.app;return{view:"layout",rows:[{height:4},{view:"tabview",multiview:!0,cells:[{header:"<span class='webix_icon fa-code'></span><span style='line-height: 20px;'> Сведение по кодам</span>",width:240,body:{view:"layout",rows:[{$subview:n.default}]}},{header:"<span class='webix_icon fa-star'></span><span style='line-height: 20px;'> Разрешения для поставщиков</span>",width:280,body:{view:"layout",rows:[{$subview:r.default}]}},{header:"<span class='webix_icon fa-exclamation-triangle '></span><span style='line-height: 20px;'> Слова исключения</span>",width:240,body:{view:"layout",rows:[{$subview:s.default}]}},{header:"<span class='webix_icon fa-file'></span><span style='line-height: 20px;'> Задания на сведении</span>",width:240,body:{view:"layout",rows:[{$subview:a.default}]}}]}]}},t}(o.c);t.default=l},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(41),r=i(0),s=i(42);var a=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this,t=this.app,i={view:"datatable",name:"_users",localId:"__table",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,startPos:1,posPpage:20,totalPos:1250,old_stri:"",columns:[{id:"id",hidden:!0,width:75,header:[{text:"ID"}]},{id:"c_user",fillspace:1,sort:"text",header:[{text:"Пользователь"}],headermenu:!1},{id:"id_group",width:170,header:[{text:"Группа"}]},{id:"c_role",width:170,sort:"text",header:[{text:"Роль пользователя"}]},{id:"dt",hidden:!0,width:250,header:[{text:"Дата заведения"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onItemDblClick:function(e){e=this.getSelectedItem();var t=this.$scope.app.config.r_url+"?getUser",i={};i.id=e.id,i.user=this.$scope.app.user,e=Object(r.checkVal)(Object(r.request)(t,i,!0).response,"s"),this.$scope.popnewuser.show("Редактирование пользователя",e,this)},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(){t.config.roles[t.config.role].userdel&&e.$$("_del").show()},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}};return{view:"layout",rows:[{height:4},{height:40,view:"toolbar",cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Строка поиска",keyPressTimeout:900,tooltip:"Поиск по пользователю",on:{onKeyPress:function(e,t){var i=this;clearTimeout(this.config._keytimed),Object(r.checkKey)(e)&&(this.config._keytimed=setTimeout(function(){var e=i.getValue().toString().toLowerCase();i.$scope.$$("__table").filter(function(t){return-1!=t.c_user.toString().toLowerCase().indexOf(e)})},this.$scope.app.config.searchDelay))}}},{view:"button",type:"htmlbutton",hidden:!t.config.roles[t.config.role].useradd,localId:"_add",resizable:!0,sWidth:140,eWidth:40,label:"",width:40,extLabel:"<span style='line-height: 20px;padding-left: 5px'>Добавить</span>",oldLabel:"<span class='webix_icon fa-user-plus'></span>",click:function(){e.popnewuser.show("Добавление пользователя")}},{view:"button",type:"htmlbutton",localId:"_del",hidden:!0,resizable:!0,sWidth:200,eWidth:40,label:"",width:40,extLabel:"<span style='line-height: 20px;padding-left: 5px;'>Удалить</span>",oldLabel:"<span style='color: red', class='webix_icon fa-user-times'></span>",click:function(){webix.message({text:"Удаление пользователя. Позже.",type:"debug"})}},{view:"button",type:"htmlbutton",hidden:!t.config.roles[t.config.role].userdel,localId:"_aroles",resizable:!0,sWidth:140,eWidth:40,label:"",width:40,extLabel:"<span style='line-height: 20px;padding-left: 5px'>Добавить</span>",oldLabel:"<span class='webix_icon fa-user-secret'></span>",click:function(){e.poproles.show("Админка ролей")}}]},i]}},t.prototype.ready=function(){var e=[this.$$("_add"),this.$$("_del"),this.$$("_aroles")];Object(r.setButtons)(this.app,e);var t=this.app,i=t.config.searchDelay,o=this.$$("__table").config.id;setTimeout(r.get_refs,0*i,{app:t,type:"async",method:"getUsersAll",store:o})},t.prototype.init=function(){this.poproles=this.ui(s.default),this.popnewuser=this.ui(n.default)},t}(o.c);t.default=a},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(43);var r=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){return{view:"layout",borderless:!0,css:"margin-zero",rows:[{$subview:n.default,name:"top_menu"}]}},t}(o.c);t.default=r},function(e,t,i){"use strict";i.r(t);var o=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){return{view:"list",layout:"x",select:!1,scroll:!1,height:32,template:"{common.checkBox()} #value#",data:[{id:1,value:"as0as",ch:0},{id:2,value:"asadsf",ch:1},{id:3,value:"sdffwerg",ch:0}],type:{checkBox:function(e){return"<span class='check webix_icon fa-"+(e.ch?"check-":"")+"square-o'></span>"}},onClick:{check:function(e,t){var i=this.getItem(t);i.ch=i.ch?0:1,this.updateItem(t,i)}}}},t}(i(1).c);t.default=o},function(e,t){var i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(i){var o=new Uint8Array(16);e.exports=function(){return i(o),o}}else{var n=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),n[t]=e>>>((3&t)<<3)&255;return n}}},function(e,t){for(var i=[],o=0;o<256;++o)i[o]=(o+256).toString(16).substr(1);e.exports=function(e,t){var o=t||0,n=i;return[n[e[o++]],n[e[o++]],n[e[o++]],n[e[o++]],"-",n[e[o++]],n[e[o++]],"-",n[e[o++]],n[e[o++]],"-",n[e[o++]],n[e[o++]],"-",n[e[o++]],n[e[o++]],n[e[o++]],n[e[o++]],n[e[o++]],n[e[o++]]].join("")}},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(0),r=i(8),s=i(2);var a=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this,t=this.app,i=this,o=t.config.r_url+"?getSupplAll",r={user:t.config.user},a=Object(n.checkVal)(Object(n.request)(o,r,!0).response,"s"),l=[];a&&(l=a);var c=function(){var t=e.$$("__table").getSelectedItem().id;e.$$("__table").remove(t)};return{view:"layout",css:{"border-left":"1px solid #dddddd !important"},rows:[{view:"datatable",name:"__ttl",localId:"__table",startPos:1,posPpage:t.config.posPpage,totalPos:1250,select:!0,borderless:!0,rowHeight:30,fixedRowHeight:!1,headermenu:{autowidth:!0},resizeColumn:!0,fi:"dt",di:"desc",searchBar:void 0,searchMethod:"getLnkSprs",columns:[{id:"id",width:270,hidden:!0,header:[{text:"Хэш"},{content:"cFilt"}]},{id:"id_tovar",width:100,hidden:!0,header:[{text:"Код"},{content:"cFilt"}]},{id:"c_tovar",fillspace:!0,sort:"server",header:[{text:"Наименование"}],headermenu:!1},{id:"c_zavod",width:200,hidden:!0,header:[{text:"Производитель"},{content:"cFilt"}]},{id:"id_spr",width:150,hidden:!0,sort:"server",header:[{text:"id_spr"},{content:"cFilt"}]},{id:"spr",width:350,header:[{text:"Эталон"},{content:"cFilt",placeholder:"!слово - исключить из поиска",inputConfig:{height:30}}]},{id:"e_zavod",width:300,hidden:!0,header:[{text:"Производитель эталона"}]},{id:"c_vnd",width:300,header:[{text:"Поставщик"},{content:"richFilt",compare:n.compareTrue,inputConfig:{inputtype:"multicombo",tagMode:!1,keepText:!0,pager:1,options:{filter:n.mcf_filter,data:l,body:{yCount:10}}}}]},{id:"dt",width:200,sort:"server",format:n.dt_formating_sec,css:"center_p",header:[{text:"Дата изменения"},{content:"dateRangeFilter",compare:n.compareTrue,inputConfig:{format:n.dt_formating,width:180},suggest:{view:"daterangesuggest",body:{timepicker:!1,calendarCount:2}}}]},{id:"owner",width:100,sort:"server",header:[{text:"Создал"},{content:"cFilt"}]},{id:"source",width:150,hidden:!0,header:[{text:"Источник"},{content:"richFilt",compare:n.compareTrue,inputConfig:{pager:1,options:[{id:"0",value:"Без источника"},{id:"1",value:"PLExpert"},{id:"2",value:"Склад"},{id:"3",value:"Агент"},{id:"4",value:"edocs"}]}}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onBeforeSort:function(t,o){e.$$("__table").config.fi=t,e.$$("__table").config.di=o;var n=i.getRoot().getChildViews()[1].$scope.$$("__page").getValue();i.getRoot().getChildViews()[1].$scope.$$("__page").setValue(0==+n?"1":"0"),i.getRoot().getChildViews()[1].$scope.$$("__page").refresh()},onItemDblClick:function(t,i,o){var n=e.$$("__table").getSelectedItem().id,r={command:"?delLnk"};r.sh_prc=n,r.type="async",r.callback=c,r.parent=e,1==+$$("_link_by").getValue()?e.popunlink.show("Причина разрыва связки?",r,e._break):webix.message({text:"Выберите в параметрах сведение по поставщикам",type:"debug"})},onKeyPress:function(e,t){13===e&&this.getSelectedItem()&&this.callEvent("onItemDblClick")},onBeforeSelect:function(e){},onAfterSelect:function(e){this.$scope._break.show()},onAfterLoad:function(){var e=this.getFilter("c_vnd"),t=e.$getValue();$$(e.config.popup).getList().filter("#value#",t)}}},{$subview:s.default}]}},t.prototype.ready=function(){var e=this.app,t=this;$$(this.$$("__table").getColumnConfig("dt").header[1].suggest.body.id).getChildViews()[1].getChildViews()[1].setValue("Применить"),$$(this.$$("__table").getColumnConfig("dt").header[1].suggest.body.id).getChildViews()[1].getChildViews()[1].define("click",function(){this._filter_timer&&window.clearTimeout(this._filter_timer),this._filter_timer=window.setTimeout(function(){var e=t.getRoot().getChildViews()[1].$scope,i=e.$$("__page").getValue();e.$$("__page").setValue(0==+i?"1":"0"),e.$$("__page").setValue("0"),e.$$("__page").refresh()},webix.ui.datafilter.textWaitDelay),this.getParentView().getParentView().hide()}),this.$$("__table").isColumnVisible("dt"),this.$$("__table").isColumnVisible("owner")&&(e.config.roles[e.config.role].lnkdel?this.$$("__table").getFilter("owner").readOnly=!1:(this.$$("__table").getFilter("owner").value=this.app.config.user,this.$$("__table").getFilter("owner").readOnly=!0)),this._break=this.getRoot().getParentView().$scope.$$("_br"),this._search=this.getRoot().getParentView().$scope.$$("_ls"),this.$$("__table").config.searchBar=this._search.config.id,$$(this.$$("__table").config.searchBar).focus(),this._break.hide(),this.$$("__table").markSorting(this.$$("__table").config.fi,this.$$("__table").config.di)},t.prototype.init=function(){this.popunlink=this.ui(r.default)},t}(o.c);t.default=a},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(5),r=i(0),s=i(8),a=i(2);var l=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this,t=this.app,i=this,o=t.config.r_url+"?getSupplAll",n={user:t.config.user},s=Object(r.checkVal)(Object(r.request)(o,n,!0).response,"s"),l=[];s&&(l=s);var c=function(){var e=i.$$("__table").getSelectedItem().id;i.$$("__table").remove(e)};return{view:"layout",css:{"border-left":"1px solid #dddddd !important"},rows:[{view:"treetable",name:"__tt",localId:"__table",startPos:1,posPpage:t.config.posPpage,totalPos:1250,select:!0,borderless:!0,rowHeight:30,fixedRowHeight:!1,headermenu:{autowidth:!0},resizeColumn:!0,fi:"c_tovar",di:"asc",old_stri:" ",searchBar:void 0,searchMethod:"getSprLnks",columns:[{id:"c_tovar",fillspace:!0,template:"<span>{common.treetable()} #c_tovar#</span><span style='color: red'> #count#</span>",header:[{text:"Наименование"}],headermenu:!1},{id:"c_zavod",width:200,header:[{text:"Производитель"},{content:"cFilt"}]},{id:"c_vnd",width:300,sort:"server",header:[{text:"Поставщик"},{content:"richFilt",compare:r.compareTrue,inputConfig:{inputtype:"combo",pager:1,options:{filter:r.mcf_filter,data:l}}}]},{id:"id_tovar",width:100,hidden:!0,sort:"server",header:[{text:"Код"},{content:"cFilt"}]},{id:"dt",width:200,format:r.dt_formating_sec,css:"center_p",header:[{text:"Дата изменения"}]},{id:"owner",width:100,header:[{text:"Создал"},{content:"cFilt"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onBeforeSort:function(t,o){e.$$("__table").config.fi=t,e.$$("__table").config.di=o;var n=i.getRoot().getChildViews()[1].$scope.$$("__page").getValue();i.getRoot().getChildViews()[1].$scope.$$("__page").setValue(0==+n?"1":"0"),i.getRoot().getChildViews()[1].$scope.$$("__page").refresh()},onItemDblClick:function(e,i,o){var n=this.getSelectedItem().$level;if(1===n)t.config.roles[t.config.role].spredit?(e=e.row,(e=Object(r.get_spr)(this.$scope,e)).s_name="Страна: "+e.c_strana,e.t_name="Название товара: "+e.c_tovar,e.v_name="Производитель: "+e.c_zavod,e.dv_name="Д. вещество: "+e.c_dv,this.$scope.popnew.show("Редактирование записи "+e.id_spr,this.$scope._search,e)):webix.message({type:"error",text:"Редактирование запрещено"});else if(2===n){var s=this.$scope.$$("__table").getSelectedItem().id,a={action:"return",command:"?delLnk"};a.sh_prc=s,a.type="async",a.callback=c,a.parent=this.$scope,this.$scope.popunlink.show("Причина разрыва связки?",a,this.$scope._break)}},onKeyPress:function(e,t){13===e&&this.getSelectedItem()&&this.callEvent("onItemDblClick")},onBeforeSelect:function(e){},onAfterSelect:function(e){var t=this.getSelectedItem().$level;1===t?this.$scope._break.hide():2===t&&this.$scope._break.show()}}},{$subview:a.default}]}},t.prototype.init=function(){this.popnew=this.ui(n.default),this.popunlink=this.ui(s.default)},t.prototype.ready=function(){this._break=this.getRoot().getParentView().$scope.$$("_br"),this._search=this.getRoot().getParentView().$scope.$$("_ls"),this.$$("__table").config.searchBar=this._search.config.id,this._break.hide(),this.$$("__table").markSorting(this.$$("__table").config.fi,this.$$("__table").config.di)},t}(o.c);t.default=l},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(0),r=i(14),s=i.n(r);var a=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){var e=this.app;var t={view:"form",css:{border:"None"},localId:"auth_box",label:"Аутентификация",elements:[{view:"text",label:"Пользователь",name:"user",labelWidth:120,width:400,localId:"_user"},{view:"text",type:"password",label:"Пароль",name:"pass",labelWidth:120,width:400},{cols:[{},{},{view:"button",label:"OK",hotkey:"enter",click:function(){!function(t){var i=t.$scope.$$("auth_box").getValues();i.pass=s()(i.pass);var o=!1,r=e.config.r_url+"?login",a=Object(n.request)(r,i,!0).response;(a=Object(n.checkVal)(a,"s"))&&(o=!0,e.config.user=a.user,e.config.role=a.role,e.config.x_api=a.key,Object(n.setCookie)("linker-app",[a.user,a.key,a.role].join("::"),{path:"/"}));return o}(this)?(webix.message({text:"не авторизованно",type:"debug"}),Object(n.deleteCookie)("linker-app"),Object(n.deleteCookie)("linker_user"),Object(n.deleteCookie)("linker_auth_key"),Object(n.deleteCookie)("linker_role")):this.$scope.show("/start/body")}}]}]};return{view:"layout",rows:[{height:document.documentElement.clientHeight/4},{cols:[{},t,{}]},{}]}},t.prototype.ready=function(){this.$$("_user").focus()},t.prototype.init=function(){var e=void 0,t=void 0,i=void 0;try{var o=Object(n.getCookie)("linker-app").split("::");e=o[0],t=o[1],i=o[2]}catch(e){}e&&t&&i?(this.app.config.user=e,this.app.config.role=i,this.app.config.x_api=t,this.show("/start/body")):(Object(n.deleteCookie)("linker-app"),Object(n.deleteCookie)("linker_user"),Object(n.deleteCookie)("linker_auth_key"),Object(n.deleteCookie)("linker_role"))},t}(o.c);t.default=a},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(0),r=i(14),s=i.n(r);var a=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){return{view:"cWindow",modal:!0,on:{onHide:function(){this.$scope.$$("auth_form").clear(),this.$scope.$$("new_user").clear(),this.$scope.$$("new_pwd").clear(),this.$scope.$$("_forgot").setValue(0),this.$scope.$$("auth_form").show()}},body:{view:"multiview",localId:"auth_box",animate:!1,cells:[{view:"form",localId:"auth_form",elements:[{view:"text",label:"Пользователь",name:"user",localId:"_user",placeholder:"Имя пользователя",labelWidth:120,height:32,width:400},{view:"text",type:"password",label:"Пароль",name:"password",localId:"_pass",labelWidth:120,width:400,height:32},{view:"checkbox",labelRight:"Я не помню пароль",value:0,localId:"_forgot",labelWidth:0},{cols:[{},{view:"button",label:"Регистрация",click:function(){this.$scope.$$("new_user").show(),this.$scope.getRoot().getHead().getChildViews()[0].setValue("Заявка на регистрацию пользователя")}},{view:"button",label:"Войти",click:function(){0===this.$scope.$$("_forgot").getValue()?function(e){var t=e.$scope.app,i={},o=e.$scope.$$("auth_form").getValues(),r=!1;i.display_name=o.user,i.hash=s()(o.password),location.hostname,console.log("item",i),(i="121212121212121")&&(r=!0,Object(n.setCookie)("qlks1k8wkgvvlto0",t.config.x_api,{path:"/"}));return r}(this)?(this.$scope.getRoot().hide(),webix.message({text:"авторизованно",type:"debug"}),console.log("переход в кабинет пользователя")):(webix.message({text:"не авторизованно",type:"error"}),Object(n.deleteCookie)("qlks1k8wkgvvlto0")):1===this.$scope.$$("_forgot").getValue()&&(this.$scope.$$("new_pwd").show(),this.$scope.getRoot().getHead().getChildViews()[0].setValue("Заявка на сброс пароля"))}}]}]},{localId:"new_user",view:"form",rule:{login:webix.rules.isNotEmpty,email:webix.rules.isEmail,lastname:webix.rules.isNotEmpty,firstname:webix.rules.isNotEmpty},elements:[{view:"text",label:"Логин (номер зачетки)",labelWidth:160,width:450,name:"login",required:!0},{view:"text",label:"e-mail",labelWidth:160,width:450,name:"email",required:!0},{view:"text",label:"Фамилия",labelWidth:160,width:450,name:"lastname",required:!0},{view:"text",label:"Имя",labelWidth:160,width:450,name:"firstname",required:!0},{cols:[{},{view:"label",label:"Здесь будет reCaptcha"},{}]},{view:"label",label:"  После проверки информации администратором на указанный email",css:{"margin-bottom":"0px !important;"}},{view:"label",label:"будет выслана ссылка для подтверждения регистрации",css:{"margin-top":"-10px !important;"}},{cols:[{},{view:"button",label:"Отмена",click:function(){this.$scope.$$("auth_box").back(),this.$scope.getRoot().getHead().getChildViews()[0].setValue("Вход в систему")}},{view:"button",label:"Запросить",click:function(){if(this.$scope.$$("new_user").validate()){var e=this.$scope.$$("new_user").getValues(),t=(location.hostname,{newUser:e});return console.log("params",t),webix.message("Запрос отправлен"),void this.$scope.getRoot().hide()}}}]}]},{localId:"new_pwd",view:"form",rules:{email:webix.rules.isEmail},elements:[{view:"text",label:"e-mail при регистрации",labelWidth:140,width:400,name:"email",required:!0,labelPosition:"top"},{cols:[{},{view:"label",label:"Здесь будет reCaptcha"},{}]},{view:"label",label:"На указанный email будет выслана ссылка для сброса пароля",width:400},{cols:[{},{view:"button",label:"Отмена",click:function(){this.$scope.$$("auth_box").back(),this.$scope.getRoot().getHead().getChildViews()[0].setValue("Вход в систему")}},{view:"button",label:"Запросить",click:function(){if(this.$scope.$$("new_pwd").validate()){var e=this.$scope.$$("new_pwd").getValues(),t=(location.hostname,{newPwd:e});return console.log("params",t),webix.message("Запрос отправлен"),void this.$scope.getRoot().hide()}}}]}]}]}}},t.prototype.show_w=function(e){this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show()},t.prototype.init=function(){Object(n.getCookie)("qlks1k8wkgvvlto0")},t}(o.c);t.default=a},function(e,t,i){"use strict";i.r(t);var o=i(1),n=i(56),r=i(0);var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.config=function(){return{type:"line",id:"main_ui",rows:[{$subview:n.default},{$subview:!0,borderless:!0}]}},t.prototype.init=function(){var e=this.app,t=e.config.r_url+"?getVersion",i={user:e.config.user},o=Object(r.request)(t,i,!0).response;o=Object(r.checkVal)(o,"s"),e.config.roles=o.cfg,e.config.expert=5!=+o.expert;var n=o.params;n&&(n=JSON.parse(n),e.config.posPpage="posPpage"in n?n.posPpage:e.config.posPpage,e.config.notify="notify"in n?n.notify:e.config.notify,e.config.nDelay="nDelay"in n?n.nDelay:e.config.nDelay,e.config.save="save"in n?n.save:e.config.save,e.config.dtParams="dtParams"in n?n.dtParams:e.config.dtParams,e.config.link="link"in n?n.link:e.config.link),Object(r.init_first)(e)},t}(o.c);t.default=s},function(e,t){},function(e,t,i){"use strict";var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function r(e,t,i){for(var o in e)n(e,o)&&t.call(i||e,e[o],o,e)}function s(e){e="Warning: "+e,"undefined"!=typeof console&&console.error(e);try{throw new Error(e)}catch(e){}}var a=String.prototype.replace,l=String.prototype.split,c="||||",u=function(e){var t=e%10;return 11!==e&&1===t?0:2<=t&&t<=4&&!(e>=12&&e<=14)?1:2},d={arabic:function(e){if(e<3)return e;var t=e%100;return t>=3&&t<=10?3:t>=11?4:5},bosnian_serbian:u,chinese:function(){return 0},croatian:u,french:function(e){return e>1?1:0},german:function(e){return 1!==e?1:0},russian:u,lithuanian:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=9&&(e%100<11||e%100>19)?1:2},czech:function(e){return 1===e?0:e>=2&&e<=4?1:2},polish:function(e){if(1===e)return 0;var t=e%10;return 2<=t&&t<=4&&(e%100<10||e%100>=20)?1:2},icelandic:function(e){return e%10!=1||e%100==11?1:0},slovenian:function(e){var t=e%100;return 1===t?0:2===t?1:3===t||4===t?2:3}},p={arabic:["ar"],bosnian_serbian:["bs-Latn-BA","bs-Cyrl-BA","srl-RS","sr-RS"],chinese:["id","id-ID","ja","ko","ko-KR","lo","ms","th","th-TH","zh"],croatian:["hr","hr-HR"],german:["fa","da","de","en","es","fi","el","he","hi-IN","hu","hu-HU","it","nl","no","pt","sv","tr"],french:["fr","tl","pt-br"],russian:["ru","ru-RU"],lithuanian:["lt"],czech:["cs","cs-CZ","sk"],polish:["pl"],icelandic:["is"],slovenian:["sl-SL"]};function h(e){var t=function(e){var t={};return r(e,function(e,i){r(e,function(e){t[e]=i})}),t}(p);return t[e]||t[l.call(e,/-/,1)[0]]||t.en}function f(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var _=/\$/g,g="$$",b=/%\{(.*?)\}/g;function w(e,t,i,o){if("string"!=typeof e)throw new TypeError("Polyglot.transformPhrase expects argument #1 to be string");if(null==t)return e;var r=e,s=o||b,u="number"==typeof t?{smart_count:t}:t;if(null!=u.smart_count&&r){var p=l.call(r,c);r=function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}(p[function(e,t){return d[h(e)](t)}(i||"en",u.smart_count)]||p[0])}return r=a.call(r,s,function(e,t){return n(u,t)&&null!=u[t]?a.call(u[t],_,g):e})}function v(e){var t=e||{};this.phrases={},this.extend(t.phrases||{}),this.currentLocale=t.locale||"en";var i=t.allowMissing?w:null;this.onMissingKey="function"==typeof t.onMissingKey?t.onMissingKey:i,this.warn=t.warn||s,this.tokenRegex=function(e){var t=e&&e.prefix||"%{",i=e&&e.suffix||"}";if(t===c||i===c)throw new RangeError('"'+c+'" token is reserved for pluralization');return new RegExp(f(t)+"(.*?)"+f(i),"g")}(t.interpolation)}v.prototype.locale=function(e){return e&&(this.currentLocale=e),this.currentLocale},v.prototype.extend=function(e,t){r(e,function(e,i){var n=t?t+"."+i:i;"object"===(void 0===e?"undefined":o(e))?this.extend(e,n):this.phrases[n]=e},this)},v.prototype.unset=function(e,t){"string"==typeof e?delete this.phrases[e]:r(e,function(e,i){var n=t?t+"."+i:i;"object"===(void 0===e?"undefined":o(e))?this.unset(e,n):delete this.phrases[n]},this)},v.prototype.clear=function(){this.phrases={}},v.prototype.replace=function(e){this.clear(),this.extend(e)},v.prototype.t=function(e,t){var i,o,n=null==t?{}:t;if("string"==typeof this.phrases[e])i=this.phrases[e];else if("string"==typeof n._)i=n._;else if(this.onMissingKey){o=(0,this.onMissingKey)(e,n,this.currentLocale,this.tokenRegex)}else this.warn('Missing translation for key: "'+e+'"'),o=e;return"string"==typeof i&&(o=w(i,n,this.currentLocale,this.tokenRegex)),o},v.prototype.has=function(e){return n(this.phrases,e)},v.transformPhrase=function(e,t,i){return w(e,t,i)},e.exports=v},function(e,t,i){"use strict";i.r(t);i(76),i(78);var o=i(1);i(57);webix.ready(function(){var e=new o.b({id:"mainApp",name:"linker",version:"18.353.1500",start:"/login",user:"",role:"0",eventS:void 0,r_url:"localhost"===location.hostname?"http://saas.local/linker_logic":"../linker_logic",router:o.a,x_api:"x_login",debug:!1,searchDelay:1e3,popDelay:800,roles:{},expert:!0,link:!1,getButt:function(e,t){var i=[];return e.getChildViews().forEach(function(e,t,o){e.getChildViews().length>0?e.$scope&&(i=e.$scope.app.config.getButt(e,i)):"button"===e.config.view&&e.config.resizable&&i.push(e)}),t&&(i=i.concat(t)),i},posPpage:20,notify:!0,nDelay:-1,save:!1,dtParams:void 0});webix.attachEvent("onBeforeAjax",function(t,i,o,n,r,s,a){r["x-api-key"]=e.config.x_api}),e.render(),window.onerror=function(e,t,i,o,n){webix.message({text:"Возникла ошибка - мы работаем над ее исправлением. Текст в консоли",type:"error",width:"800px",delay:"5"}),window.console.log("message:",e),window.console.log("source:",t),window.console.log("err:",n);return!0},e.attachEvent("app:error:resolve",function(e,t){window.console.error(t)})})},function(e,t,i){},,function(e,t,i){},,function(e,t){var i=webix,o=webix.version.split(".");10*o[0]+1*o[1]<53&&(i.ui.freeze=function(e){var t=e();return t&&t.then?t.then(function(e){return i.ui.$freeze=!1,i.ui.resize(),e}):(i.ui.$freeze=!1,i.ui.resize()),t});var n=i.ui.baselayout.prototype.addView,r=i.ui.baselayout.prototype.removeView,s={addView:function(e,t){if(this.$scope&&this.$scope.webixJet){var i=this.$scope,o={};e=i.app.copyConfig(e,{},o),n.apply(this,[e,t]);var r=function(e){i._renderFrame(e,o[e],i.getUrl()).then(function(){i._subs[e]=o[e]})};for(var s in o)r(s);return e.id}return n.apply(this,arguments)},removeView:function(){if(r.apply(this,arguments),this.$scope&&this.$scope.webixJet){var e=this.$scope._subs;for(var t in e)webix.$$(e[t].id)||delete e[t]}}};i.extend(i.ui.layout.prototype,s,!0),i.extend(i.ui.baselayout.prototype,s,!0),webix.protoUI({name:"jetapp",$init:function(e){this.$app=new this.app(e);var t=webix.uid().toString();e.body={id:t},this.$ready.push(function(){this.$app.render(webix.$$(t))})}},webix.ui.proxy)},function(e,t,i){var o={"./adm-adm-adm":59,"./adm-adm-adm.js":59,"./adm-bar":15,"./adm-bar.js":15,"./adm-barcodes":22,"./adm-barcodes-b":60,"./adm-barcodes-b.js":60,"./adm-barcodes-s":61,"./adm-barcodes-s.js":61,"./adm-barcodes.js":22,"./adm-country":23,"./adm-country.js":23,"./adm-dv":24,"./adm-dv.js":24,"./adm-groups":26,"./adm-groups.js":26,"./adm-hran":27,"./adm-hran.js":27,"./adm-issues":28,"./adm-issues.js":28,"./adm-linker":62,"./adm-linker-codes":29,"./adm-linker-codes.js":29,"./adm-linker-excludes":32,"./adm-linker-excludes.js":32,"./adm-linker-files":34,"./adm-linker-files.js":34,"./adm-linker-suppliers":30,"./adm-linker-suppliers.js":30,"./adm-linker.js":62,"./adm-nds":36,"./adm-nds.js":36,"./adm-references":16,"./adm-references.js":16,"./adm-seasons":40,"./adm-seasons.js":40,"./adm-spr":37,"./adm-spr.js":37,"./adm-top-menu":21,"./adm-top-menu.js":21,"./adm-users":63,"./adm-users.js":63,"./adm-vendors":39,"./adm-vendors.js":39,"./adm_roles":42,"./adm_roles.js":42,"./bar-yes-no":9,"./bar-yes-no.js":9,"./body":64,"./body.js":64,"./brak-add-list":65,"./brak-add-list.js":65,"./brak-add-mass":52,"./brak-add-mass.js":52,"./brak_bar":20,"./brak_bar.js":20,"./brak_side_info":51,"./brak_side_info.js":51,"./brak_upl":53,"./brak_upl.js":53,"./brak_xls_upl":55,"./brak_xls_upl.js":55,"./excel_check":54,"./excel_check.js":54,"./footer":47,"./footer.js":47,"./globals":0,"./globals.js":0,"./header":56,"./header.js":56,"./history":4,"./history.js":4,"./links_form_bar":19,"./links_form_bar.js":19,"./links_form_lnk":68,"./links_form_lnk.js":68,"./links_form_spr":69,"./links_form_spr.js":69,"./login":70,"./login.js":70,"./login_test":71,"./login_test.js":71,"./md5":14,"./md5.js":14,"./new_bar":6,"./new_bar.js":6,"./new_code":31,"./new_code.js":31,"./new_dv":25,"./new_dv.js":25,"./new_exclude":33,"./new_exclude.js":33,"./new_form":5,"./new_form.js":5,"./new_issue":12,"./new_issue.js":12,"./new_prop":3,"./new_prop.js":3,"./new_report":49,"./new_report.js":49,"./new_stri":10,"./new_stri.js":10,"./new_tg":11,"./new_tg.js":11,"./new_user":41,"./new_user.js":41,"./pager_view":2,"./pager_view.js":2,"./prop_window":50,"./prop_window.js":50,"./relink_form":38,"./relink_form.js":38,"./side_form":46,"./side_form.js":46,"./sidebuttons-bar":48,"./sidebuttons-bar.js":48,"./skipped_bar":17,"./skipped_bar.js":17,"./spr_dt":45,"./spr_dt.js":45,"./start":72,"./start.js":72,"./sub_row":13,"./sub_row.js":13,"./top-menu":43,"./top-menu.js":43,"./unlink":8,"./unlink.js":8,"./unlinked":44,"./unlinked.js":44,"./unlinkedall_bar":18,"./unlinkedall_bar.js":18,"./v_upl":35,"./v_upl.js":35,"./yes-no":7,"./yes-no.js":7};function n(e){var t=r(e);return i(t)}function r(e){var t=o[e];if(!(t+1)){var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}return t}n.keys=function(){return Object.keys(o)},n.resolve=r,e.exports=n,n.id=81},function(e,t,i){var o=i(83),n=i(84),r=n;r.v1=o,r.v4=n,e.exports=r},function(e,t,i){var o,n,r=i(66),s=i(67),a=0,l=0;e.exports=function(e,t,i){var c=t&&i||0,u=t||[],d=(e=e||{}).node||o,p=void 0!==e.clockseq?e.clockseq:n;if(null==d||null==p){var h=r();null==d&&(d=o=[1|h[0],h[1],h[2],h[3],h[4],h[5]]),null==p&&(p=n=16383&(h[6]<<8|h[7]))}var f=void 0!==e.msecs?e.msecs:(new Date).getTime(),_=void 0!==e.nsecs?e.nsecs:l+1,g=f-a+(_-l)/1e4;if(g<0&&void 0===e.clockseq&&(p=p+1&16383),(g<0||f>a)&&void 0===e.nsecs&&(_=0),_>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=f,l=_,n=p;var b=(1e4*(268435455&(f+=122192928e5))+_)%4294967296;u[c++]=b>>>24&255,u[c++]=b>>>16&255,u[c++]=b>>>8&255,u[c++]=255&b;var w=f/4294967296*1e4&268435455;u[c++]=w>>>8&255,u[c++]=255&w,u[c++]=w>>>24&15|16,u[c++]=w>>>16&255,u[c++]=p>>>8|128,u[c++]=255&p;for(var v=0;v<6;++v)u[c+v]=d[v];return t||s(u)}},function(e,t,i){var o=i(66),n=i(67);e.exports=function(e,t,i){var r=t&&i||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var s=(e=e||{}).random||(e.rng||o)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t)for(var a=0;a<16;++a)t[r+a]=s[a];return t||n(s)}},function(e,t,i){var o={"./en":73,"./en.js":73,"./ru":57,"./ru.js":57};function n(e){var t=r(e);return i(t)}function r(e){var t=o[e];if(!(t+1)){var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}return t}n.keys=function(){return Object.keys(o)},n.resolve=r,e.exports=n,n.id=85}]);