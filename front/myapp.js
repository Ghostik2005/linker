!function(e){function t(o){if(i[o])return i[o].exports;var n=i[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var i={};t.m=e,t.c=i,t.d=function(e,i,o){t.o(e,i)||Object.defineProperty(e,i,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/codebase/",t(t.s=57)}([function(e,t,i){"use strict";function o(){return!0}function n(e){var t=!1;return(8===e||13===e||32===e||46===e||e>47&&e<91||e>95&&e<112||e>185&&e<193||e>219&&e<223)&&(t=!0),t}function r(e,t){var i;return"s"===t?i=JSON.parse(e):"a"===t&&(i=e.json()),i.result?i=i.ret_val:(i=void 0,"error"),i}function s(e){pe.add(e)}function a(e){pe.remove(e)}function c(e,t){var i=e.id,o=t.getItem(i);o.usloviya=e.value,t.updateItem(i,o),t.refresh()}function l(e){se.add(e)}function u(e){se.remove(e)}function p(e,t){var i=e.id,o=t.getItem(i);o.c_strana=e.value,t.updateItem(i,o),t.refresh()}function d(e){ce.add(e)}function f(e){ce.remove(e)}function h(e,t){var i=e.id,o=t.getItem(i);o.act_ingr=e.value,o.oa=e.oa,t.updateItem(i,o),t.refresh()}function _(e){le.add(e)}function g(e){le.remove(e)}function b(e,t){var i=e.id,o=t.getItem(i);o.nds=e.value,t.updateItem(i,o),t.refresh()}function w(e){ue.add(e)}function v(e){ue.remove(e)}function $(e,t){var i=e.id,o=t.getItem(i);o.sezon=e.value,t.updateItem(i,o),t.refresh()}function y(e){de.add(e)}function m(e){de.remove(e)}function x(e,t){var i=e.id,o=t.getItem(i);o.group=e.value,t.updateItem(i,o),t.refresh()}function C(e){ae.add(e)}function V(e){ae.remove(e)}function k(e,t){var i=e.id,o=t.getItem(i);o.c_zavod=e.value,t.updateItem(i,o),t.refresh()}function O(e){var t=$$("_suppl").getList(),i=t.data.order,o=void 0,n=$$("main_ui").$scope.app,s=n.config.r_url+"?setWork",a={user:n.config.user,sh_prc:e.sh_prc};r(G(s,a,!0).response,"s");if(i.forEach(function(i,n,r){t.getItem(i).c_vnd===e.c_vnd&&(o=t.getItem(i).id)}),o)t.getItem(o).count+=1,$$("_suppl").setValue(o),setTimeout(function(){if(ne.getItem(e.id))ne.setCursor(e.id),T(this,e);else{ne.add(e,0);var t=ne.data.order[0];ne.setCursor(t),T(this,e)}},400);else{var c=Math.round(1e12-.5+Math.random()*(1e12+1)),l={id:c,count:1,c_vnd:e.c_vnd,id_vnd:e.id_vnd};$$("_suppl").config.manual=!0,t.add(l),$$("_suppl").setValue(c),setTimeout(function(){ne.clearAll(),ne.add(e,0);var t=ne.data.order[0];ne.setCursor(t),T(this,e)},400)}}function j(e,t){var i=e.app.config.user,o=e.app.config.r_url+"?getBar",n={user:i,id_spr:t},s=G(o,n,!0).response;(s=r(s,"s"))&&($$("bars_dc").clearAll(),$$("bars_dc").parse(s))}function P(e,t){var i=e.app.config.user,o=e.app.config.r_url+"?getTg",n={user:i,id_spr:t},s=G(o,n,!0).response;(s=r(s,"s"))&&($$("tg_dc").clearAll(),$$("tg_dc").parse(s))}function R(e){for(var t in e){var i=e[t];"object"===(void 0===i?"undefined":Q(i))?i=R(i):void 0==i&&delete e[t]}return e}function S(e){var t=e.view,i=t.$scope.app,o=e.searchBar,n=e.field?e.field:void 0,r=e.direction?e.direction:void 0,s=o?$$(o).getValue():void 0,a=e.filter?e.filter:void 0,c=i.config.user,l=(i.config.r_url,e.method,{user:c,search:s,start:e.start,count:e.count,field:n,direction:r,c_filter:a,cbars:e.cbars});return l=R(l)}function I(e){var t="";for(var i in e){var o=e[i];"object"===(void 0===o?"undefined":Q(o))?o=I(o):t+=o.toString()}return t}function E(e){var t=e.view,i=t.$scope.app;t&&t.clearAll();var o=e.navBar,n=i.config.r_url+"?"+e.method,s=S(e),a=s.search;""===a&&(a="%%");var c=void 0!==a?a.replace(/\ /g,"").length:2;(void 0!==a?a.length:2)>1&&c>1&&(t.showProgress({type:"icon",icon:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>'}),G(n,s).then(function(i){if(i=r(i,"a")){if(i.params){var n=I(S(e));if(I(i.params)!==n)return}t.parse(i.datas),t.config.startPos=i.start,t.config.totalPos=i.total;var s=Math.ceil(t.config.totalPos/t.config.posPpage),c=0!==s?Math.ceil(t.config.startPos/t.config.posPpage):1,l=o.getChildViews()[2],u=o.getChildViews()[6];u.define("label","Всего записей: "+t.config.totalPos),u.refresh();var p=o.$scope.$$("__page").getValue();try{p=+p}catch(e){}p!==c&&(o.$scope.$$("__page").config.manual=!1);var d=l.getChildViews();d[2].define("label",s),d[2].refresh(),o.$scope.$$("__page").setValue(c),o.$scope.$$("__page").refresh();var f=webix.storage.session.get(t.config.name);f?f.push(a):f=[a],webix.storage.session.put(t.config.name,f)}t.hideProgress()}))}function T(e,t){t=t||$$("prcs_dc").getItem($$("prcs_dc").getCursor());var i={},o="https://www.google.ru/search?newwindow=1&q="+t.c_tovar,n="<a target='_balnk' href='"+o+"'><span>"+t.c_tovar+"</span></a>",r="<span style='color: #666666; text-decoration: underline;'>Осталось свести в текущей сессии:</span><span style='color: red; font-weight: bold;'>  "+$$("prcs_dc").count()+"</span>";i._name=n,i._count=r,i._vendor=t.c_zavod,i.p_name=t.c_tovar;var s=$$("main_ui").$scope.app.config;s.roles[s.role].spradd&&$$("_add").show(),$$("_left").show(),$$("_skip").show(),$$("_right").show(),$$("_names_bar").parse(i);var a=t.c_tovar.split(" "),c=0;a[c].length<4&&(c+=1);for(var l=a[c],u=c;u<a.length;u++)for(var p=a[u],d=0;d<p.length;d++){var f=(parseInt(p[d],10),!isNaN(p[d]));f&&(l+=" "+p[d])}l=l.replace('"'," "),l=l.replace("!"," "),l=l.replace("-"," "),l=l.replace("."," "),l=l.replace(","," "),l=l.replace("*"," "),l=l.replace("+"," "),l=l.replace("/"," "),l=l.replace("\\"," "),$$("_spr_search").setValue(l);var h=$$("app-nav").getChildViews()[3].getChildViews();r=h[0].config.posPpage,E({view:h[0],navBar:h[1],start:1,count:r,searchBar:h[0].config.searchBar,method:h[0].config.searchMethod}),$$("_spr_search").focus()}function L(e,t){var i=e.app.config.user,o=e.app.config.r_url+"?getSpr",n={user:i,id_spr:t},s=G(o,n,!0).response;return s=r(s,"s"),s?s[0]:(webix.message("error"),"error")}function F(e){var t=void 0;return"__ttl"===e.config.name?t={c_vnd:$$(e).isColumnVisible("c_vnd")?$$(e).getFilter("c_vnd").value:void 0,c_zavod:$$(e).isColumnVisible("c_zavod")?$$(e).getFilter("c_zavod").value:void 0,id_tovar:$$(e).isColumnVisible("id_tovar")?$$(e).getFilter("id_tovar").value:void 0,id_spr:$$(e).isColumnVisible("id_spr")?$$(e).getFilter("id_spr").value:void 0,dt:$$(e).isColumnVisible("dt")?$$(e).getFilter("dt").getValue():void 0,spr:$$(e).isColumnVisible("spr")?$$(e).getFilter("spr").value:void 0,owner:$$(e).isColumnVisible("owner")?$$(e).getFilter("owner").value:void 0}:"__tt"===e.config.name?t={c_vnd:$$(e).isColumnVisible("c_vnd")?$$(e).getFilter("c_vnd").value:void 0,c_zavod:$$(e).isColumnVisible("c_zavod")?$$(e).getFilter("c_zavod").value:void 0,id_tovar:$$(e).isColumnVisible("id_tovar")?$$(e).getFilter("id_tovar").value:void 0,owner:$$(e).isColumnVisible("owner")?$$(e).getFilter("owner").value:void 0}:"__dt_a"===e.config.name?t={c_vnd:$$(e).isColumnVisible("c_vnd")?$$(e).getFilter("c_vnd").value:void 0,c_zavod:$$(e).isColumnVisible("c_zavod")?$$(e).getFilter("c_zavod").value:void 0,c_tovar:$$(e).isColumnVisible("c_tovar")?$$(e).getFilter("c_tovar").value:void 0,c_user:$$(e).isColumnVisible("c_user")?$$(e).getFilter("c_user").getText():void 0,dt:$$(e).isColumnVisible("dt")?$$(e).getFilter("dt").getValue():void 0}:"__dt_s"===e.config.name?t={c_tovar:$$(e).isColumnVisible("c_tovar")?$$(e).getFilter("c_tovar").value:void 0,c_vnd:$$(e).isColumnVisible("c_vnd")?$$(e).getFilter("c_vnd").value:void 0,c_zavod:$$(e).isColumnVisible("c_zavod")?$$(e).getFilter("c_zavod").value:void 0,dt:$$(e).isColumnVisible("dt")?$$(e).getFilter("dt").getValue():void 0}:"__dt_as"===e.config.name&&(t={dt:$$(e).isColumnVisible("dt")?$$(e).getFilter("dt").getValue():void 0,id_spr:$$(e).isColumnVisible("id_spr")?$$(e).getFilter("id_spr").value:void 0,id_zavod:$$(e).isColumnVisible("id_zavod")?$$(e).getFilter("id_zavod").value:void 0,id_strana:$$(e).isColumnVisible("id_strana")?$$(e).getFilter("id_strana").value:void 0,c_dv:$$(e).isColumnVisible("c_dv")?$$(e).getFilter("c_dv").value:void 0,c_group:$$(e).isColumnVisible("c_group")?$$(e).getFilter("c_group").value:void 0,c_nds:$$(e).isColumnVisible("c_nds")?$$(e).getFilter("c_nds").getValue():void 0,c_hran:$$(e).isColumnVisible("c_hran")?$$(e).getFilter("c_hran").getValue():void 0,c_sezon:$$(e).isColumnVisible("c_sezon")?$$(e).getFilter("c_sezon").getValue():void 0,mandat:$$(e).isColumnVisible("mandat")?$$(e).getFilter("mandat").getValue():void 0,prescr:$$(e).isColumnVisible("prescr")?$$(e).getFilter("prescr").getValue():void 0}),[t,e.config.posPpage,e.config.fi,e.config.di]}function A(e){return webix.Date.dateToStr("%d-%m-%Y  %G:%i:%s")(e)}function z(e){return webix.Date.dateToStr("%d-%m-%Y")(e)}function B(e){var t=e.config.searchDelay;setTimeout(q,0*t,{app:e,type:"sync",method:"getRoles",store:"roles_dc"}),G(e.config.r_url+"?getRefs",{user:e.config.user}).then(function(e){e=r(e,"a"),e?($$("strana_dc").clearAll(),$$("strana_dc").parse(e.strana),$$("vendor_dc").clearAll(),$$("vendor_dc").parse(e.vendor),$$("dv_dc").clearAll(),$$("dv_dc").parse(e.dv),$$("nds_dc").clearAll(),$$("nds_dc").parse(e.nds),$$("hran_dc").clearAll(),$$("hran_dc").parse(e.hran),$$("sezon_dc").clearAll(),$$("sezon_dc").parse(e.sezon),$$("group_dc").clearAll(),$$("group_dc").parse(e.group),$$("allTg_dc").clearAll(),$$("allTg_dc").parse(e.tg)):webix.message("error")})}function D(e,t){var i=e.app.config.user;G(e.app.config.r_url+"?getPrcs",{user:i,id_vnd:+t}).then(function(e){e=r(e,"a"),e?($$("prcs_dc").clearAll(),$$("prcs_dc").parse(e)):webix.message("error")})}function H(e,t){var i=e.app.config.user;G(e.app.config.r_url+"?getPrcsSou",{user:i,source:+t}).then(function(e){e=r(e,"a"),e?($$("prcs_dc").clearAll(),$$("prcs_dc").parse(e)):webix.message("error")})}function M(e,t){var i=e.app.config.user;G(e.app.config.r_url+"?getPrcsDate",{user:i,date:t}).then(function(e){e=r(e,"a"),e?($$("prcs_dc").clearAll(),$$("prcs_dc").parse(e)):webix.message("error")})}function q(e){var t=e.app,i=e.method,o=e.store,n=t.config.user,s=t.config.r_url+"?"+i,a={user:n};if("sync"!==e.type)G(s,a).then(function(e){e=r(e,"a"),e?($$(o).clearAll(),$$(o).parse(e)):webix.message("error")});else{var c=G(s,a,!0).response;(c=r(c,"s"))&&($$(o).clearAll(),$$(o).parse(c))}}function W(e,t,i){var o=t.app.config.user;G(t.app.config.r_url+i,{user:o}).then(function(t){if(t=r(t,"a")){$$(e).getList().clearAll(),$$(e).getList().parse(t);var i=$$(e).getList().getFirstId();$$(e).setValue(i),$$(e).refresh()}})}function U(e,t){var i=ne.getCursor(),o=$$("prcs_dc").data.order,n=void 0;o.forEach(function(e,t,o){e===i&&(n=t)}),n===$$("prcs_dc").count()-1?n=0:n+=1;var r=$$("prcs_dc").data.order[+n];if(ne.remove(i),ne.count()<1)2==+$$("_link_by").getValue()?W("_suppl",t,"?getDatesUnlnk"):3==+$$("_link_by").getValue()?W("_suppl",t,"?getSourceUnlnk"):W("_suppl",t,"?getSupplUnlnk");else{ne.setCursor(r),T(t);var s=$$("_suppl").getList(),a=$$("_suppl").getValue(),c=s.getItem(a);c.count=c.count-1,s.updateItem(a,c),$$("_suppl").refresh()}}function K(e,t){return t=t.toString().toLowerCase(),t=new RegExp(".*"+t.replace(/ /g,".*")+".*"),-1!=e.c_vnd.toString().toLowerCase().search(t)}function N(e,t,i){Z("linker_user"),Z("linker_auth_key"),Z("linker_role"),location.href="localhost"===location.hostname?"http://localhost:8080":"/linker/"}function G(e,t,i){return!0===i?webix.ajax().sync().headers({"Content-type":"application/json"}).post(e,t,{error:N}):webix.ajax().timeout(9e4).headers({"Content-type":"application/json"}).post(e,t,{error:N})}function Y(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):NaN}function J(e,t,i){i=i||{};var o=i.expires;if("number"==typeof o&&o){var n=new Date;n.setTime(n.getTime()+1e3*o),o=i.expires=n}o&&o.toUTCString&&(i.expires=o.toUTCString()),t=encodeURIComponent(t);var r=e+"="+t;for(var s in i){r+="; "+s;var a=i[s];!0!==a&&(r+="="+a)}document.cookie=r}function Z(e){J(e,"",{expires:-1,path:"/"})}Object.defineProperty(t,"__esModule",{value:!0}),i.d(t,"users",function(){return X}),i.d(t,"adm_roles",function(){return ee}),i.d(t,"u_roles",function(){return te}),i.d(t,"barcodes",function(){return ie}),i.d(t,"tg",function(){return oe}),i.d(t,"prcs",function(){return ne}),i.d(t,"allTg",function(){return re}),i.d(t,"strana",function(){return se}),i.d(t,"vendor",function(){return ae}),i.d(t,"dv",function(){return ce}),i.d(t,"nds",function(){return le}),i.d(t,"sezon",function(){return ue}),i.d(t,"hran",function(){return pe}),i.d(t,"group",function(){return de}),t.compareTrue=o,i.d(t,"cEvent",function(){return fe}),i.d(t,"fRefresh",function(){return he}),i.d(t,"rRefresh",function(){return _e}),i.d(t,"fRender",function(){return ge}),t.checkKey=n,t.checkVal=r,t.addHran=s,t.delHran=a,t.updHran=c,t.addStrana=l,t.delStrana=u,t.updStrana=p,t.addDv=d,t.delDv=f,t.updDv=h,t.addNds=_,t.delNds=g,t.updNds=b,t.addSez=w,t.delSez=v,t.updSez=$,t.addGr=y,t.delGr=m,t.updGr=x,t.addVendor=C,t.delVendor=V,t.updVendor=k,t.parseToLink=O,t.get_bars=j,t.get_tg=P,t.clear_obj=R,t.gen_params=S,t.str_join=I,t.get_data_test=E,t.parse_unlinked_item=T,t.get_spr=L,t.getDtParams=F,t.dt_formating_sec=A,t.dt_formating=z,t.init_first=B,t.get_prcs=D,t.get_prcs_source=H,t.get_prcs_date=M,t.get_refs=q,t.get_suppl=W,t.delPrc=U,t.filter_1=K,t.after_call=N,t.request=G,t.getCookie=Y,t.setCookie=J,t.deleteCookie=Z;var Q=(i(1),"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}),X=new webix.DataCollection({id:"users_dc"}),ee=new webix.DataCollection({id:"admroles_dc"}),te=new webix.DataCollection({id:"roles_dc"}),ie=new webix.DataCollection({id:"bars_dc"}),oe=new webix.DataCollection({id:"tg_dc"}),ne=new webix.DataCollection({id:"prcs_dc",on:{onAfterLoad:function(){console.log("this",this);var e=this.data.order[0];this.setCursor(e);var t=$$("main_ui");$$("_suppl").config.state?$$("_suppl").config.state=!1:T(t)}}}),re=new webix.DataCollection({id:"allTg_dc"}),se=new webix.DataCollection({id:"strana_dc"}),ae=new webix.DataCollection({id:"vendor_dc"}),ce=new webix.DataCollection({id:"dv_dc"}),le=new webix.DataCollection({id:"nds_dc"}),ue=new webix.DataCollection({id:"sezon_dc"}),pe=new webix.DataCollection({id:"hran_dc"}),de=new webix.DataCollection({id:"group_dc"}),fe=function(e,t,i,o){o=o||{},o.inner=!0,webix.event(e,t,i,o)},he=function(e,t,i){t.component=e.config.id,e.registerFilter(t,i,this),t._comp_id=e.config.id,i.value&&this.getValue(t)!=i.value&&this.setValue(t,i.value),t.onclick=webix.html.preventEvent,fe(t,"keydown",this.on_key_down)},_e=function(e,t,i){if(!e.$destructed){var o=webix.$$(i.richselect);t._comp_id=e.config.id,t.$webix=i.richselect,t.style.marginLeft="-10px",i.compare=i.compare||this.compare,i.prepare=i.prepare||this.prepare,e.registerFilter(t,i,this);var n=i.inputConfig.options,r=i.options,s=o.getPopup().getList();webix.$$(r);if(t.firstChild.appendChild(o.$view.parentNode),s.parse&&(s.clearAll(),s.parse(n),!this.$noEmptyOption&&!1!==i.emptyOption||i.emptyOption)){var a={id:"",value:i.emptyOption||"",$empty:!0};s.add(a,0)}i.value&&this.setValue(t,i.value),o.render(),webix.delay(o.resize,o)}},ge=function(e,t){return this.init&&this.init(t),t.css="my_filter","<input "+(t.placeholder?'placeholder="'+t.placeholder+'" ':"")+"type='text'>"}},function(e,t,i){"use strict";var o=i(60);i.d(t,"b",function(){return o.a});var n=i(13);i.d(t,"c",function(){return n.a});var r=(i(45),i(66),i(67),i(68));i.d(t,"a",function(){return r.a});var s=i(69),a=i(70),c=i(73),l=i(74),u=i(75),p=i(76),d=i(77);s.a,a.a,c.a,u.a,d.a,l.a,p.a;window.Promise||(window.Promise=webix.promise)},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=i(0),c=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this;this.app;return{view:"toolbar",height:36,parent:void 0,cols:[{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-angle-double-left'></span>",width:50,click:function(){e.$$("__page").setValue("1"),e.$$("__page").refresh()}},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-angle-left'></span>",width:50,click:function(){var t=e.$$("__page").getValue(),i=+t-1;i>0&&(e.$$("__page").setValue(i),e.$$("__page").refresh())}},{width:250,type:"wide",css:"lay_pg",cols:[{view:"text",label:"Страница",localId:"__page",labelWidth:70,width:150,value:"1",css:"raw_page",manual:!0,on:{onChange:function(t,i){if(e.$$("__page").config.manual){var o=void 0;o=1==+i&&0==+t?1:e.$$("__page").getValue();var n=e.getRoot().config.parent.config.posPpage,r=Math.ceil(e.getRoot().config.parent.config.totalPos/n);try{o=+o}catch(e){}if("number"==typeof o&&o>=0&&(r=o<=(0===r)?1:r)){var s=(o-1)*n+1,c=e.getRoot().config.parent;if(c){var l=Object(a.getDtParams)(c),u=void 0,p=void 0;try{u="__dtd"===e.getRoot().config.parent.$scope.getParentView().getRoot().getChildViews()[1].getChildViews()[0].config.name}catch(e){}u&&(p=1===e.checkbar.getValue()?"0,100":e.bnum.getValue()),Object(a.get_data_test)({view:e.getRoot().config.parent,navBar:e.getRoot(),start:s,count:l[1],searchBar:e.getRoot().config.parent.config.searchBar,method:e.getRoot().config.parent.config.searchMethod,field:l[2],direction:l[3],filter:l[0],cbars:p})}}}else e.$$("__page").config.manual=!0}}},{view:"label",label:"из",width:30},{view:"label",label:"1",width:50,css:"p_center_p"}]},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-angle-right'></span>",width:50,click:function(){var t=e.$$("__page").getValue(),i=+t+1;i<=Math.ceil(e.getRoot().config.parent.config.totalPos/e.getRoot().config.parent.config.posPpage)&&(e.$$("__page").setValue(i),e.$$("__page").refresh())}},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-angle-double-right'></span>",width:50,click:function(){var t=Math.ceil(e.getRoot().config.parent.config.totalPos/e.getRoot().config.parent.config.posPpage);e.$$("__page").setValue(t),e.$$("__page").refresh()}},{},{view:"label",label:"Всего записей: 0",width:180}]}},t.prototype.ready=function(e){var t=e.getParentView().getParentView().$scope.$$("_chbar"),i=e.getParentView().getParentView().$scope.$$("_bnum");t&&(this.checkbar=t),i&&(this.bnum=i)},t.prototype.init=function(e){this.getRoot().config.parent=e.getParentView().$scope.$$("__table")},t}(s.c);t.default=c},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=i(0),c=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){function e(e){var t=this.$scope.app.config.r_url+"?check"+this.config._params.type,i={};i.check=e,i.user=this.$scope.app.config.user;var o=!1,n=Object(a.request)(t,i,!0).response;return n=Object(a.checkVal)(n,"s"),(n||this.config._params.text)&&(o=!0),o}var t=this;return{view:"cWindow",modal:!0,on:{onHide:function(){t.$$("_n_f").clear(),t.$$("_n_f").clearValidation()}},body:{view:"form",localId:"_n_f",_params:{},margin:0,rules:{id:e,text:webix.rules.isNotEmpty},elements:[{view:"text",localId:"_id",label:"ID",value:"",width:320,name:"id",placeholder:"Введите значение",readonly:!0,required:!0,invalidMessage:"Такой ID уже есть"},{view:"text",label:"Название",value:"",width:320,name:"text",placeholder:"Введите значение",required:!0,invalidMessage:"Введите название"},{height:15},{height:30,cols:[{view:"button",type:"base",label:"Отменить",width:120,click:function(){t.hide()}},{},{view:"button",type:"base",label:"Сохранить",width:120,click:function(){if(t.$$("_n_f").validate({hidden:!1,disabled:!1})){var e=t.$$("_n_f").getValues(),i={},o=t.$$("_n_f").config._params;i.value=e.text,i.user=t.app.config.user,i.id=o.text?o.id:e.id;var n="new"===o.mode?t.app.config.r_url+"?set"+o.type:t.app.config.r_url+"?upd"+o.type,r=Object(a.request)(n,i,!0).response;r=Object(a.checkVal)(r,"s"),r&&o.callback(r,o.source),t.hide()}}}]}]}}},t.prototype.show=function(e,t){if(this.$$("_n_f").config._params=t,this.getRoot().getHead().getChildViews()[0].setValue(e),t.text){var i={text:t.text,id:t.id};this.$$("_n_f").parse(i),this.$$("_id").define("readonly",!0)}else this.$$("_id").define("readonly",!1);this.$$("_id").refresh(),this.getRoot().show()},t.prototype.hide=function(){this.getRoot().hide()},t.prototype.getValues=function(){return this.getRoot().getBody().getValues()},t}(s.c);t.default=c},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=i(10),c=i(6),l=i(11),u=i(0),p=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){function e(e,t){return t=t.toString().toLowerCase(),t=new RegExp(".*"+t.replace(/ /g,".*")+".*"),-1!=e.c_strana.toString().toLowerCase().search(t)}function t(e,t){return t=t.toString().toLowerCase(),-1!=e.c_zavod.toString().toLowerCase().search(t)}function i(e,t){return t=t.toString().toLowerCase(),t=new RegExp(".*"+t.replace(/ /g,".*")+".*"),-1!=e.act_ingr.toString().toLowerCase().search(t)}function o(e,t){return t=t.toString().toLowerCase(),t=new RegExp(".*"+t.replace(/ /g,".*")+".*"),-1!=e.group.toString().toLowerCase().search(t)}function n(e,t){return t=t.toString().toLowerCase(),t=new RegExp(".*"+t.replace(/ /g,".*")+".*"),-1!=e.sezon.toString().toLowerCase().search(t)}function r(e,t){return t=t.toString().toLowerCase(),t=new RegExp(".*"+t.replace(/ /g,".*")+".*"),-1!=e.usloviya.toString().toLowerCase().search(t)}function s(e){u.vendor.add(e,0)}function a(e){u.dv.add(e,0)}var c=this,l=this.app;return{view:"cWindow",modal:!0,on:{onHide:function(){u.barcodes.clearAll(),this.$scope.$$("new_form").clear(),this.$scope.$$("new_form").reconstruct()}},body:{view:"form",localId:"new_form",margin:0,spr:!1,search_bar:void 0,rules:{c_tovar:webix.rules.isNotEmpty,id_strana:webix.rules.isNotEmpty,id_zavod:webix.rules.isNotEmpty,id_dv:webix.rules.isNotEmpty},elements:[{rows:[{view:"label",label:"Название товара:",name:"t_name"},{view:"text",label:"",value:"",name:"c_tovar",required:!0,css:"raw_text"},{height:10,width:700},{cols:[{rows:[{view:"label",label:"Страна:",name:"s_name"},{view:"combo",width:400,value:"",name:"id_strana",required:!0,options:{filter:e,body:{template:"#c_strana#",yCount:7}},on:{onAfterRender:function(){this.getList().sync(u.strana)}}},{view:"label",label:"Производитель:",name:"v_name"},{cols:[{view:"combo",label:"",value:"",name:"id_zavod",required:!0,options:{filter:t,body:{template:"#c_zavod#",yCount:7}},on:{onAfterRender:function(){this.getList().sync(u.vendor)}}},{view:"button",type:"base",label:"+",width:30,hidden:!l.config.roles[l.config.role].vendoradd,click:function(){var e={new_name:"c_zavod",url:"Zavod",callback:s};c.popstri.show("Добавление производителя",e)}}]},{view:"label",label:"Действующее вещество:",name:"dv_name"},{cols:[{view:"combo",label:"",value:"",name:"id_dv",required:!0,options:{filter:i,body:{autoheight:!1,view:"list",type:{height:"auto"},template:"<div class='comboList'>#act_ingr#</div>",height:200,yCount:0}},on:{onAfterRender:function(){this.getList().sync(u.dv)}}},{view:"button",type:"base",label:"+",width:30,hidden:!l.config.roles[l.config.role].vendoradd,click:function(){var e={new_name:"act_ingr",url:"Dv1",callback:a};c.popstri.show("Добавление д.вещества",e)}}]},{view:"text",label:"Штрих-код:",value:"",labelPosition:"top",readonly:!0,name:"barcode",localId:"_barc",css:"raw_text",click:function(){var e=c.$$("new_form").getValues().id_spr;c.popbar.show("Редактирование ш.кодов",e,c)}},{view:"text",label:"Товарная группа:",labelPosition:"top",value:"",name:"c_tgroup",localId:"_c_tgroup",css:"raw_text",readonly:!0,click:function(){var e=c.$$("new_form").getValues().id_spr;c.poptg.show("Редактирование товарных групп",e,c)}}]},{width:5},{rows:[{view:"form",css:"borders",localId:"new_f_right",elements:[{height:5},{cols:[{view:"checkbox",labelRight:"Рецептурный",labelWidth:0,align:"left",name:"_prescr"},{view:"checkbox",labelRight:"Обязательный",labelWidth:0,align:"left",name:"_mandat"}]},{view:"combo",label:"Сезон:",labelPosition:"top",value:"",name:"id_sezon",css:"small",options:{filter:n,body:{template:"#sezon#",yCount:5}},on:{onAfterRender:function(){this.getList().sync(u.sezon)}}},{view:"combo",label:"Условия хранения:",labelPosition:"top",value:"",name:"id_usloviya",css:"small",options:{filter:r,body:{template:"#usloviya#",yCount:5}},on:{onAfterRender:function(){this.getList().sync(u.hran)}}},{view:"combo",label:"Группа:",labelPosition:"top",value:"",name:"id_group",css:"small",options:{filter:o,body:{autoheight:!1,view:"list",type:{height:"auto"},template:"<div class='comboList'>#group#</div>",height:200,yCount:0}},on:{onAfterRender:function(){this.getList().sync(u.group)}}},{view:"combo",label:"НДС:",labelPosition:"top",value:"",name:"id_nds",css:"small",options:{body:{template:"#nds#",yCount:5}},on:{onAfterRender:function(){this.getList().sync(u.nds)}}}]}]}]},{cols:[{view:"button",type:"base",label:"Отменить",width:120,height:32,click:function(){c.hide()}},{},l.config.roles[l.config.role].spredit?{view:"button",type:"base",label:"Сохранить",width:120,height:32,hidden:!l.config.roles[l.config.role].spredit,click:function(){if(c.$$("new_form").validate({hidden:!1,disabled:!1})){var e=c.$$("new_form").getValues(),t=c.$$("new_f_right").getValues(),i={};i.id_spr=e.id_spr?e.id_spr:-1,i.barcode=e.barcode,i.c_tovar=e.c_tovar,i.id_strana=e.id_strana,i.id_zavod=e.id_zavod,i.id_dv=e.id_dv,i.c_opisanie=e.c_opisanie,i.prescr=1===t._prescr,i.mandat=1===t._mandat,i.id_sezon=t.id_sezon,i.id_usloviya=t.id_usloviya,i.id_group=t.id_group,i.id_nds=t.id_nds;var o=$$("prcs_dc").getCursor();o&&$$("prcs_dc").getItem(o).sh_prc?i.sh_prc=$$("prcs_dc").getItem(o).sh_prc||void 0:i.sh_prc=void 0,i.c_tgroup=e.c_tgroup,i.user=c.app.config.user;var n=c.app.config.r_url+"?setSpr",r=Object(u.request)(n,i,!0).response;r=Object(u.checkVal)(r,"s"),r&&r.new&&c.$$("new_form").config.spr?Object(u.delPrc)(i,c):c.$$("new_form").config.search_bar.callEvent("onKeyPress",[13]),c.$$("new_form").config.spr=!1,c.hide()}}}:{width:1}]}]}]}}},t.prototype.show=function(e,t,i){this.$$("new_form").config.search_bar=t,i&&(this.$$("new_form").parse(i),this.$$("new_f_right").parse(i),this.$$("new_form").config.spr=!0),this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show()},t.prototype.hide=function(){this.getRoot().hide()},t.prototype.init=function(){this.popstri=this.ui(a.default),this.popbar=this.ui(c.default),this.poptg=this.ui(l.default)},t}(s.c);t.default=p},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this;return{view:"cWindow",modal:!0,height:.8*document.documentElement.clientHeight,on:{onHide:function(){e.$$("_tb").clear(),e.$$("_hist").clearAll(),e.$$("_tb").reconstruct()}},body:{view:"toolbar",localId:"_tb",searchBar:void 0,cols:[{view:"list",localId:"_hist",width:.5*document.documentElement.clientWidth,select:!0,resizeColumn:!0,navigation:"row",editable:!1,on:{onItemDblClick:function(t){var i=e.$$("_tb").config.searchBar;i.setValue(t),i.refresh(),e.getRoot().hide(),i.callEvent("onKeyPress",[13])}}},{}]}}},t.prototype.show=function(e,t){this.getRoot().getHead().getChildViews()[0].setValue("История поиска"),this.getRoot().show(),this.$$("_tb").config.searchBar=t,e&&this.$$("_hist").parse(e)},t.prototype.init=function(){},t}(s.c);t.default=a},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=i(0),c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){function e(e){var t=0;if(isNaN(e)||13!==e.length)return!1;for(var i=0;i<13;i++)t+=Number(e[i])*(i%2*2+1);return!(t%10)}var t=this;return{view:"cWindow",modal:!0,on:{onHide:function(){t.$$("_nbar").setValue(""),t.$$("b_code").setValue("0000000000000"),t.$$("_n_b").reconstruct()},onShow:function(){t.$$("_nbar").setValue(""),t.$$("b_code").setValue("0000000000000");var e=t.$$("_n_b").config.id_spr;Object(a.get_bars)(t,e),t.$$("b_list").clearAll(),t.$$("b_list").parse(a.barcodes)}},body:{view:"form",localId:"_n_b",margin:0,id_spr:void 0,th:void 0,callback:void 0,elements:[{rows:[{cols:[{view:"text",label:"Название",value:"",name:"_new_bar",placeholder:"Введите новый штрихкод",localId:"_nbar",required:!1},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-plus'></span>",width:30,click:function(){if(e(t.$$("_nbar").getValue())){var i={barcode:t.$$("_nbar").getValue()};t.$$("b_list").add(i),t.$$("_nbar").setValue("")}}}]},{cols:[{view:"activeList",activeContent:{deleteBut:{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-minus'></span>",width:30,click:function(e,i){var o=t.$$("b_list").locate(i);t.$$("b_list").callEvent("onItemDblClick",[o])}}},localId:"b_list",width:250,height:350,type:{height:32},template:"<div class ='barcode'>#barcode#</div><div class = 'butt1'>{common.deleteBut()}</div>",select:!0,on:{onAfterSelect:function(){var e=this.getSelectedItem();this.$scope.$$("b_code").setValue(e.barcode)},onItemDblClick:function(e){this.remove(e),this.$scope.$$("b_code").setValue("0000000000000")}}},{width:10},{rows:[{view:"barcode",type:"ean13",value:"0000000000000",width:300,name:"_new_",localId:"b_code",hieght:200},{}]}]},{height:10},{cols:[{view:"button",type:"base",label:"Отменить",width:120,click:function(){t.hide()}},{},{view:"button",type:"base",label:"Применить",width:120,click:function(){t.$$("b_list").selectAll();var e=t.$$("b_list").getSelectedItem(),i="",o=t.$$("_n_b").config.th,n=t.$$("_n_b").config.id_spr,r=t.$$("_n_b").config.callback;if(e){void 0===e||c(e);try{e.forEach(function(e,t,o){i+=e.barcode+" "})}catch(t){i=e.barcode}}o&&o.$$("_barc").setValue(i),r&&r(n,i),t.hide()}}]}]}]}}},t.prototype.show=function(e,t,i,o){this.$$("_n_b").config.id_spr=t,this.$$("_n_b").config.th=i,this.$$("_n_b").config.callback=o,this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show()},t.prototype.hide=function(){this.getRoot().hide()},t}(s.c);t.default=l},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=i(0),c=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this;return{view:"cWindow",modal:!0,body:{view:"form",margin:0,_params:{},elements:[{view:"label",label:"Подтвердите",height:44,align:"center"},{cols:[{view:"button",type:"base",label:"Нет",width:120,height:44,click:function(){e.getRoot().getBody().config._params={},e.hide()}},{},{view:"button",type:"base",label:"Да",width:120,height:44,localId:"_yes"}]}],on:{onShow:function(){e.$$("_yes").focus()}}}}},t.prototype.show=function(e,t){if(this.getRoot().getHead().getChildViews()[0].setValue("Подтвердите действие"),t&&(this.getRoot().getBody().config._params=t,"?setLnk"===t.command))return void this.getRoot().$scope.$$("_yes").callEvent("onItemClick");this.getRoot().getBody().getChildViews()[0].setValue(e),this.getRoot().show()},t.prototype.hide=function(){this.getRoot().hide()},t.prototype.getValues=function(){return this.getRoot().getBody().getValues()},t.prototype.init=function(){var e=this;this.$$("_yes").attachEvent("onItemClick",function(){var t=e.getRoot().getBody().config._params,i=t.sh_prc?t.sh_prc:void 0,o=e.app.config.user,n=e.app.config.r_url+t.command,r=t.type?t.type:void 0,s=t.action?t.action:"no_action",c=t.id_spr?t.id_spr:void 0,l=t.callback?t.callback:void 0,u=t.th?t.th:void 0,p={user:o,sh_prc:i,action:s,id_spr:c};e.hide(),"sync"===r||Object(a.request)(n,p).then(function(e){(e=Object(a.checkVal)(e,"a"))&&l&&l(e,u)})})},t}(s.c);t.default=c},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=i(0),c=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){function e(e,t){var o=e.getRoot().getBody().config._params,n=o.sh_prc,r=e.app.config.user,s=e.app.config.r_url+o.command,c=o.callback,l={user:r,sh_prc:n,action:t};e.hide(),"sync"===o.type?console.log("sync"):Object(a.request)(s,l).then(function(s){if((s=Object(a.checkVal)(s,"a"))&&(c&&c(s),"return"===t)){var l=Object(a.checkVal)(Object(a.request)(e.app.config.r_url+"?getPrcsItem",{user:r,sh_prc:n},!0).response,"s").datas;Object(a.parseToLink)(l),i.config.roles[i.config.role].skipped||o.parent.getRoot().getParentView().$scope.hide()}})}var t=this,i=this.app;return{view:"cWindow",modal:!0,body:{view:"form",margin:0,_params:{},elements:[{view:"label",label:"Причина разрыва связкии",height:44,align:"center"},{cols:[{view:"button",type:"base",label:"Ошибка",width:120,height:44,click:function(){e(t,"return"),t._break.hide()}},{},i.config.roles[i.config.role].lnkdel?{view:"button",type:"base",label:"Устарела",width:120,height:44,hidden:i.config.roles[i.config.role].lnkdel,click:function(){e(t,"delete")}}:{width:1}]}]}}},t.prototype.show=function(e,t,i){this._break=i,this.getRoot().getHead().getChildViews()[0].setValue("Подтвердите действие"),t&&(this.getRoot().getBody().config._params=t),this.getRoot().getBody().getChildViews()[0].setValue(e),this.getRoot().show()},t.prototype.hide=function(){this.getRoot().hide()},t.prototype.getValues=function(){return this.getRoot().getBody().getValues()},t}(s.c);t.default=c},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this;return{view:"cWindow",modal:!0,body:{view:"form",margin:0,_params:{},on:{onShow:function(e){$$("_yes").focus()}},elements:[{view:"label",label:"Подтвердите",height:44,align:"center"},{cols:[{view:"button",type:"base",label:"Нет",width:120,height:44,click:function(){e.getRoot().getBody().config._params={},e.hide()}},{},{view:"button",type:"base",label:"Да",width:120,height:44,localId:"_yes",click:function(){var t=e.getRoot().getBody().config._params,i=t.callback?t.callback:void 0;e.hide(),i&&i(t.params)}}]}]}}},t.prototype.show=function(e,t){this.getRoot().getHead().getChildViews()[0].setValue("Подтвердите действие"),t&&(this.getRoot().getBody().config._params=t),this.getRoot().getBody().getChildViews()[0].setValue(e),this.getRoot().show()},t.prototype.hide=function(){this.getRoot().hide()},t}(s.c);t.default=a},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=i(0),c=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){function e(e){var t=this.config._params,i=this.$scope.app.config.r_url+"?check"+t.url,o={};o[t.new_name]=e,o.user=this.$scope.app.config.user;var n=Object(a.request)(i,o,!0).response;n=Object(a.checkVal)(n,"s");var r=!1;return n&&(r=!0),r}var t=this;return{view:"cWindow",modal:!0,on:{onHide:function(){t.$$("_n_f").clear(),t.$$("_n_f").clearValidation()}},body:{view:"form",localId:"_n_f",_params:{},margin:0,rules:{_new_str:e},elements:[{view:"text",label:"Название",value:"",width:320,name:"_new_str",required:!0,placeholder:"Введите новое значение",invalidMessage:"Такое название уже есть"},{cols:[{view:"button",type:"base",label:"Отменить",width:120,click:function(){t.hide()}},{},{view:"button",type:"base",label:"Сохранить",width:120,click:function(){if(t.$$("_n_f").validate({hidden:!1,disabled:!1})){var e=t.$$("_n_f").getValues(),i={},o=t.$$("_n_f").config._params;i[o.new_name]=e._new_str,i.user=t.app.config.user,i.id_spr=!!o.id_spr&&o.id_spr;var n=t.app.config.r_url+"?set"+o.url,r=Object(a.request)(n,i,!0).response;r=Object(a.checkVal)(r,"s"),r&&o.callback(r),t.hide()}}}]}]}}},t.prototype.show=function(e,t){this.$$("_n_f").config._params=t,this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show()},t.prototype.hide=function(){this.getRoot().hide()},t.prototype.getValues=function(){return this.getRoot().getBody().getValues()},t}(s.c);t.default=c},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=i(0),c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this;return{view:"cWindow",modal:!0,on:{onHide:function(){e.$$("_filt").setValue(""),e.$$("t_list").clearAll(),e.$$("e_list").clearAll(),e.$$("_n_tg").reconstruct()},onShow:function(){e.$$("_filt").setValue("");var t=e.$$("_n_tg").config.id_spr;Object(a.get_tg)(e,t);var i=e.$$("e_list");i.clearAll(!0),e.$$("t_list").clearAll(),e.$$("t_list").parse(a.tg);var o=a.allTg.data.order;o.forEach(function(e,t,o){i.add(a.allTg.getItem(e))}),o=e.$$("t_list").data.order,o.forEach(function(e,t,o){i.remove(e)}),e.$$("_filt").focus()}},body:{view:"form",localId:"_n_tg",margin:0,id_spr:void 0,th:void 0,callback:void 0,elements:[{rows:[{view:"text",label:"Название",value:"",name:"_filter",placeholder:"Введите название группы",localId:"_filt",on:{onTimedKeyPress:function(e,t){var i=this.getValue().toString().toLowerCase();this.$scope.$$("e_list").filter("c_tgroup",i)}}},{cols:[{rows:[{view:"label",label:"Товарные группы"},{view:"list",localId:"t_list",width:350,height:.7*document.documentElement.clientHeight,template:"#c_tgroup#",select:!0,on:{onItemDblClick:function(e){var t=this.getItem(e);this.remove(e),this.$scope.$$("e_list").add(t),this.$scope.$$("e_list").sort("c_tgroup","asc")}}}]},{width:10},{rows:[{view:"label",label:"Все товарные группы"},{view:"list",localId:"e_list",width:350,template:"#c_tgroup#",select:!0,on:{onItemDblClick:function(e){var t=this.getItem(e);this.remove(e),this.$scope.$$("t_list").add(t),this.$scope.$$("t_list").sort("c_tgroup","asc")}}}]}]},{height:10},{cols:[{view:"button",type:"base",label:"Отменить",width:120,click:function(){e.hide()}},{},{view:"button",type:"base",label:"Применить",width:120,click:function(){e.$$("t_list").selectAll();var t=e.$$("t_list").getSelectedItem(),i="",o=e.$$("_n_tg").config.th,n=e.$$("_n_tg").config.id_spr,r=e.$$("_n_tg").config.callback;if(t){void 0===t||c(t);try{t.forEach(function(e,t,o){i+=e.c_tgroup+"; "})}catch(e){i=t.c_tgroup}}o&&(o.$$("_c_tgroup").setValue(i),o.$$("_c_tgroup").refresh()),r&&r(n,i),e.hide()}}]}]}]}}},t.prototype.show=function(e,t,i,o){this.$$("_n_tg").config.id_spr=t,this.$$("_n_tg").config.th=i,this.$$("_n_tg").config.callback=o,this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show()},t.prototype.hide=function(){this.getRoot().hide()},t}(s.c);t.default=l},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=i(10),c=i(6),l=i(11),u=i(0),p=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){function e(e,t){return t=t.toString().toLowerCase(),t=new RegExp(".*"+t.replace(/ /g,".*")+".*"),-1!=e.c_strana.toString().toLowerCase().search(t)}function t(e,t){return t=t.toString().toLowerCase(),-1!=e.c_zavod.toString().toLowerCase().search(t)}function i(e,t){return t=t.toString().toLowerCase(),t=new RegExp(".*"+t.replace(/ /g,".*")+".*"),-1!=e.act_ingr.toString().toLowerCase().search(t)}function o(e,t){return t=t.toString().toLowerCase(),t=new RegExp(".*"+t.replace(/ /g,".*")+".*"),-1!=e.group.toString().toLowerCase().search(t)}function n(e,t){return t=t.toString().toLowerCase(),t=new RegExp(".*"+t.replace(/ /g,".*")+".*"),-1!=e.sezon.toString().toLowerCase().search(t)}function r(e,t){return t=t.toString().toLowerCase(),t=new RegExp(".*"+t.replace(/ /g,".*")+".*"),-1!=e.usloviya.toString().toLowerCase().search(t)}function s(e){u.vendor.add(e,0)}function a(e){u.dv.add(e,0)}var c=this,l=this.app,p={view:"form",localId:"new_form",margin:0,spr:!1,search_bar:void 0,rules:{c_tovar:webix.rules.isNotEmpty,id_strana:webix.rules.isNotEmpty,id_zavod:webix.rules.isNotEmpty,id_dv:webix.rules.isNotEmpty},elements:[{view:"label",label:"",name:"idspr"},{rows:[{view:"label",label:"Название товара:",name:"t_name"},{view:"text",label:"",value:"",name:"c_tovar",required:!0,css:"raw_text"},{height:10,width:700},{cols:[{rows:[{view:"label",label:"Страна:",name:"s_name"},{view:"combo",width:400,value:"",name:"id_strana",required:!0,options:{filter:e,body:{template:"#c_strana#",yCount:7}},on:{onAfterRender:function(){this.getList().sync(u.strana)}}},{view:"label",label:"Производитель:",name:"v_name"},{cols:[{view:"combo",label:"",value:"",name:"id_zavod",required:!0,options:{filter:t,body:{template:"#c_zavod#",yCount:7}},on:{onAfterRender:function(){this.getList().sync(u.vendor)}}},{view:"button",type:"base",label:"+",width:30,hidden:!l.config.roles[l.config.role].vendoradd,click:function(){var e={new_name:"c_zavod",url:"Zavod",callback:s};c.popstri.show("Добавление производителя",e)}}]},{view:"label",label:"Действующее вещество:",name:"dv_name"},{cols:[{view:"combo",label:"",value:"",name:"id_dv",required:!0,options:{filter:i,body:{autoheight:!1,view:"list",type:{height:"auto"},template:"<div class='comboList'>#act_ingr#</div>",height:200,yCount:0}},on:{onAfterRender:function(){this.getList().sync(u.dv)}}},{view:"button",type:"base",label:"+",width:30,hidden:!l.config.roles[l.config.role].vendoradd,click:function(){var e={new_name:"act_ingr",url:"Dv1",callback:a};c.popstri.show("Добавление д.вещества",e)}}]},{view:"text",label:"Штрих-код:",value:"",labelPosition:"top",readonly:!0,name:"barcode",localId:"_barc",css:"raw_text",click:function(){var e=c.$$("new_form").getValues().id_spr;c.popbar.show("Редактирование ш.кодов",e,c)}},{view:"text",label:"Товарная группа:",labelPosition:"top",value:"",name:"c_tgroup",localId:"_c_tgroup",css:"raw_text",readonly:!0,click:function(){var e=c.$$("new_form").getValues().id_spr;c.poptg.show("Редактирование товарных групп",e,c)}}]},{width:5},{rows:[{view:"form",css:"borders",localId:"new_f_right",elements:[{height:5},{cols:[{view:"checkbox",labelRight:"Рецептурный",labelWidth:0,align:"left",name:"_prescr"},{view:"checkbox",labelRight:"Обязательный",labelWidth:0,align:"left",name:"_mandat"}]},{view:"combo",label:"Сезон:",labelPosition:"top",value:"",name:"id_sezon",css:"small",options:{filter:n,body:{template:"#sezon#",yCount:5}},on:{onAfterRender:function(){this.getList().sync(u.sezon)}}},{view:"combo",label:"Условия хранения:",labelPosition:"top",value:"",name:"id_usloviya",css:"small",options:{filter:r,body:{template:"#usloviya#",yCount:5}},on:{onAfterRender:function(){this.getList().sync(u.hran)}}},{view:"combo",label:"Группа:",labelPosition:"top",value:"",name:"id_group",css:"small",options:{filter:o,body:{autoheight:!1,view:"list",type:{height:"auto"},template:"<div class='comboList'>#group#</div>",height:200,yCount:0}},on:{onAfterRender:function(){this.getList().sync(u.group)}}},{view:"combo",label:"НДС:",labelPosition:"top",value:"",name:"id_nds",css:"small",options:{body:{template:"#nds#",yCount:5}},on:{onAfterRender:function(){this.getList().sync(u.nds)}}}]}]}]},{cols:[{view:"button",type:"base",label:"Отменить",width:120,height:32,hidden:!0,click:function(){c.hide()}},{},{view:"button",type:"base",label:"Сохранить",width:120,height:32,hidden:!l.config.roles[l.config.role].spredit,click:function(){if(c.$$("new_form").validate({hidden:!1,disabled:!1})){var e=c.$$("new_form").getValues(),t=c.$$("new_f_right").getValues(),i={};i.id_spr=e.id_spr?e.id_spr:-1,i.barcode=e.barcode,i.c_tovar=e.c_tovar,i.id_strana=e.id_strana,i.id_zavod=e.id_zavod,i.id_dv=e.id_dv,i.c_opisanie=e.c_opisanie,i.prescr=1===t._prescr,i.mandat=1===t._mandat,i.id_sezon=t.id_sezon,i.id_usloviya=t.id_usloviya,i.id_group=t.id_group,i.id_nds=t.id_nds;var o=$$("prcs_dc").getCursor();o&&$$("prcs_dc").getItem(o).sh_prc?i.sh_prc=$$("prcs_dc").getItem(o).sh_prc||void 0:i.sh_prc=void 0,i.c_tgroup=e.c_tgroup,i.user=c.app.config.user;var n=c.app.config.r_url+"?setSpr",r=Object(u.request)(n,i,!0).response;r=Object(u.checkVal)(r,"s"),r&&r.new&&c.$$("new_form").config.spr?Object(u.delPrc)(i,c):(c.$$("new_form").config.search_bar.callEvent("onKeyPress",[13]),u.barcodes.clearAll(),c.$$("new_form").clear(),c.$$("new_form").reconstruct()),c.$$("new_form").config.spr=!1}}}]}]}]};return{view:"cWindow",localId:"sw",animate:!0,head:!1,resize:!1,modal:!1,position:function(e){e.left=innerWidth-724,e.top=226},on:{onHide:function(){u.barcodes.clearAll(),this.$scope.$$("new_form").clear(),this.$scope.$$("new_form").reconstruct()}},body:p}},t.prototype.parse_f=function(e,t,i){this.$$("new_form").config.search_bar=t,i&&(e&&(i.idspr=e),this.$$("new_form").parse(i),this.$$("new_f_right").parse(i),this.$$("new_form").config.spr=!0)},t.prototype.show_f=function(e,t,i){this.$$("new_form").config.search_bar=t,i&&(this.$$("new_form").parse(i),this.$$("new_f_right").parse(i),this.$$("new_form").config.spr=!0),this.getRoot().show()},t.prototype.hide_f=function(){this.getRoot().hide()},t.prototype.init=function(){this.popstri=this.ui(a.default),this.popbar=this.ui(c.default),this.poptg=this.ui(l.default)},t}(s.c);t.default=p},function(e,t,i){"use strict";i.d(t,"a",function(){return a});var o=i(43),n=i(44),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),a=function(e){function t(t,i){var o=e.call(this)||this;return o.app=t,o._name=i,o._children=[],o}return s(t,e),t.prototype.ui=function(e,t){t=t||{};var i=t.container||e.container,n=this.app.createView(e);return this._children.push(n),n.render(i,null,this),"object"!==(void 0===e?"undefined":r(e))||e instanceof o.a?n:n.getRoot()},t.prototype.show=function(e,t){var i=this;if(t=t||{},"string"==typeof e){if("/"===e.substr(0,1))return this.app.show(e);if(0===e.indexOf("../")){var o=this.getParentView();return void(o?o.show("./"+e.substr(3),t):this.app.show("/"+e.substr(3)))}0===e.indexOf("./")&&(e=e.substr(2));var s=this.getSubViewInfo(t.target);if(!s)return this.app.show("/"+e);if(s.parent!==this)return s.parent.show(e,t)}var a=Object(n.a)(this.app.getRouter().get());if("object"===(void 0===e?"undefined":r(e)))if(webix.isArray(e)){var c=this._index+e[0];a[c]||(a[c]={}),a[c].page=e[1],e=""}else{var l=[];for(var u in e)l.push(encodeURIComponent(u)+"="+encodeURIComponent(e[u]));e="?"+l.join("&")}if("string"==typeof e){if("?"===e.substr(0,1)){var p=e.indexOf("/"),d=e;p>-1&&(d=e.substr(0,p));var f=Object(n.a)(d);webix.extend(a[this._index-1].params,f[0].params,!0),e=p>-1?e.substr(p+1):""}var h=""===e?a.slice(this._index):Object(n.a)(e),_=null;if(this._index){_=a.slice(0,this._index).concat(h);for(var g=0;g<_.length;g++)_[g].index=g+1;var b=Object(n.b)(_);return this.app.canNavigate(b,this).then(function(e){return b!==e?i.app.show(e):i._finishShow(_,e)}).catch(function(){return!1})}return this._finishShow(h,"")}},t.prototype.init=function(e,t){},t.prototype.ready=function(e,t){},t.prototype.config=function(){this.app.webix.message("View:Config is not implemented")},t.prototype.urlChange=function(e,t){},t.prototype.destroy=function(){},t.prototype.destructor=function(){this.destroy();for(var t=this._children,i=t.length-1;i>=0;i--)t[i]&&t[i].destructor&&t[i].destructor();this.app=this._children=null,this._root.destructor(),e.prototype.destructor.call(this)},t.prototype.use=function(e,t){e(this.app,this,t)},t.prototype._render=function(e){var t=this,i=this.config();return i.then?i.then(function(i){return t._render_final(i,e)}):this._render_final(i,e)},t.prototype._render_final=function(e,t){var i=this,o=this._container;if(o&&o.$destructed)return Promise.reject("Container destroyed");var n,r={ui:{}};this.app.copyConfig(e,r.ui,this._subs),this.app.callEvent("app:render",[this,t,r]),r.ui.$scope=this;try{if(o&&o.getParentView){var s=o.getParentView();s&&"multiview"===s.name&&!r.ui.id&&(r.ui.id=o.config.id)}this._root=this.app.webix.ui(r.ui,this._container),this._root.getParentView()&&(this._container=this._root),this._init(this._root,t),n=this._urlChange(t).then(function(){return i.ready(i._root,t)})}catch(e){n=Promise.reject(e)}return n.catch(function(e){return i._initError(i,e)})},t.prototype._init=function(e,t){return this.init(e,t)},t.prototype._urlChange=function(e){var t=this;this.app.callEvent("app:urlchange",[this,e,this._index]);var i=[];for(var o in this._subs){var n=this._renderFrame(o,this._subs[o],e);n&&i.push(n)}return Promise.all(i).then(function(){t.urlChange(t._root,e)})},t.prototype._renderFrame=function(e,t,i){if(t.url){if("string"==typeof t.url){var o=Object(n.a)(t.url);return o.map(function(e){e.index=0}),this._createSubView(t,o)}var r=t.view;return"function"!=typeof t.url||r instanceof t.url||(r=new t.url(this.app,"")),r||(r=t.url),this._renderSubView(t,r,i)}if("default"===e&&i&&i.length>1){var s=i.slice(1);return this._createSubView(t,s)}},t.prototype._initError=function(e,t){return this.app.error("app:error:initview",[t,e]),!0},t.prototype._createSubView=function(e,t){var i=this;return this.app.createFromURL(t,e.view).then(function(o){return i._renderSubView(e,o,t)})},t.prototype._renderSubView=function(e,t,i){var o=this.app.webix.$$(e.id);return t.render(o,i,this).then(function(i){return e.view&&e.view!==t&&e.view.destructor(),e.view=t,e.id=i.config.id,i})},t.prototype._finishShow=function(e,t){var i;return this._index?(i=this._renderPartial(e.slice(this._index-1)),this.app.getRouter().set(t,{silent:!0}),this.app.callEvent("app:route",[e])):(e.map(function(e){return e.index=0}),i=this._renderPartial([null].concat(e))),i},t.prototype._renderPartial=function(e){return this._init_url_data(e),this._urlChange(e)},t}(o.a)},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=i(15),c=i(0),l=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{view:"layout",css:"margin-zero",rows:[{$subview:a.default,name:"top_menu"},{$subview:!0}]}},t.prototype.ready=function(e){this.show("adm-references")},t.prototype.init=function(){var e=this.app,t=e.config.searchDelay;setTimeout(c.get_refs,0*t,{app:e,type:"async",method:"getRoles",store:"roles_dc"}),setTimeout(c.get_refs,0*t,{app:e,type:"async",method:"getUsersAll",store:"users_dc"})},t}(s.c);t.default=l},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this;return{view:"toolbar",css:{"border-top":"0px"},height:40,cols:[{view:"combo",localId:"_options",value:1,width:220,options:{body:{yCount:11},data:[{id:1,value:"Справочники"},{id:10,value:"Пользователи"},{id:11,value:"Автоматическое сведение"}]},on:{onChange:function(){var t=e.$$("_options").getValue(),i=10==+t?"adm-users":11==+t?"adm-linker":"adm-references";e.show(i)}}},{}]}},t}(s.c);t.default=a},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=i(5),c=i(0),l=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this;return{view:"layout",rows:[{height:40,view:"toolbar",cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Начните набирать название товара здесь",fillspace:!0,localId:"_sb",keyPressTimeout:900,tooltip:"поиск по ШК",_keytimed:void 0,on:{onKeyPress:function(e,t){var i=this;clearTimeout(this.config._keytimed),Object(c.checkKey)(e)&&(this.config._keytimed=setTimeout(function(){var e=i.$scope.getRoot().getChildViews()[1].getChildViews()[0];if(e){var t=Object(c.getDtParams)(e),o=1===i.$scope.$$("_chbar").getValue()?"0,100":i.$scope.$$("_bnum").getValue();Object(c.get_data_test)({view:e,navBar:i.$scope.getRoot().getChildViews()[1].getChildViews()[1],start:1,count:t[1],searchBar:i.$scope.getRoot().getChildViews()[1].getChildViews()[0].config.searchBar,method:i.$scope.getRoot().getChildViews()[1].getChildViews()[0].config.searchMethod,field:t[2],direction:t[3],filter:t[0],cbars:o})}},this.$scope.app.config.searchDelay))}}},{view:"button",type:"htmlbutton",width:35,label:"<span class='webix_icon fa-history'></span><span style='line-height: 20px;'></span>",click:function(){var t=e.getRoot().getChildViews()[1].getChildViews()[0],i=webix.storage.session.get(t.config.name);e.pophistory.show(i,e.$$("_sb"))}},{view:"rangeslider",label:"Диапазон кол-ва ШК",value:"0,15",width:350,labelWidth:140,hidden:function(){return 1===this.$scope.$$("_chbar").getValue()},localId:"_bnum",title:webix.template("#value#"),stringResult:!0,max:15,min:0,on:{onChange:function(){e.$$("_sb").focus()}}},{view:"checkbox",labelRight:"Все",labelWidth:0,value:1,width:60,localId:"_chbar",on:{onChange:function(){e.$$("_sb").focus(),1===e.$$("_chbar").getValue()?e.$$("_bnum").hide():e.$$("_bnum").show()}}},{view:"checkbox",labelRight:"Поиск по справочнику",labelWidth:0,value:1,width:160,on:{onChange:function(){this.$scope.$$("_sb").setValue(""),1===this.getValue()?(this.$scope.$$("_sb").define("placeholder","Начните набирать название товара"),this.$scope.$$("_bnum").show(),this.$scope.$$("_chbar").show(),this.$scope.show("adm-barcodes-s")):0===this.getValue()&&(this.$scope.$$("_sb").define("placeholder","Начните набирать баркод"),this.$scope.$$("_bnum").hide(),this.$scope.$$("_chbar").hide(),this.$scope.show("adm-barcodes-b")),this.$scope.$$("_sb").refresh()}}}]},{$subview:!0}]}},t.prototype.init=function(){this.pophistory=this.ui(a.default),this.show("adm-barcodes-s")},t}(s.c);t.default=l},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=i(0),c=i(3),l=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this,t={view:"datatable",localId:"__dtc",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,startPos:1,posPpage:20,totalPos:1250,old_stri:"",columns:[{id:"id",width:75,header:[{text:"ID"}]},{id:"c_strana",headermenu:!1,fillspace:1,sort:"text",header:[{text:"Страна"}]},{id:"id_state",width:150,header:[{text:"Статус"}]},{id:"dt",width:250,header:[{text:"Дата заведения"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){this.count||this.showProgress({type:"icon",icon:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>'})},onItemDblClick:function(e){e=this.getSelectedItem();var t={text:e.c_strana,id:e.id,type:"Strana",callback:a.updStrana,mode:"upd",source:this};this.$scope.popnew.show("Редактирование страны",t)},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(){e.$$("_del").show()},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}};return{view:"layout",rows:[{height:40,view:"toolbar",cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Строка поиска",keyPressTimeout:900,tooltip:"поиск по стране",on:{onTimedKeyPress:function(e,t){var i=this.getValue().toString().toLowerCase();this.$scope.$$("__dtc").filter(function(e){return-1!=e.c_strana.toString().toLowerCase().indexOf(i)})}}},{view:"button",type:"htmlbutton",tooltip:"Добавить страну",label:"<span class='webix_icon fa-plus'></span>",width:40,click:function(){var t={type:"Strana",callback:a.addStrana,mode:"new",source:e.$$("__dtc")};e.popnew.show("Добавление страны",t)}},{view:"button",type:"htmlbutton",hidden:!0,localId:"_del",tooltip:"Удалить страну",label:"<span style='color: red', class='webix_icon fa-times'></span>",width:40,click:function(){var t=e.$$("__dtc").getSelectedItem().id,i={};i.user=e.app.config.user,i.id=t;var o=e.app.config.r_url+"?delStrana",n=Object(a.request)(o,i,!0).response;(n=Object(a.checkVal)(n,"s"))&&(Object(a.delStrana)(n.id),e.$$("_del").hide())}}]},t]}},t.prototype.init=function(){this.popnew=this.ui(c.default),webix.extend(this.$$("__dtc"),webix.ProgressBar),this.$$("__dtc").sync(a.strana.data)},t}(s.c);t.default=l},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=i(0),c=i(19),l=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this,t={view:"datatable",localId:"__dtd",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,startPos:1,posPpage:20,totalPos:1250,old_stri:"",columns:[{id:"id",width:75,sort:"text",header:[{text:"ID"},{content:"selectFilter"}]},{id:"act_ingr",fillspace:1,sort:"text",headermenu:!1,header:[{text:"Действующее вещество"},{content:"textFilter"}]},{id:"oa",width:200,sort:"text",header:[{text:"Обязательный ассортимент"},{content:"selectFilter"}]},{id:"id_state",width:150,header:[{text:"Статус"},{content:"selectFilter"}]},{id:"dt",width:250,header:[{text:"Дата заведения"},{content:"selectFilter"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){this.count||this.showProgress({type:"icon",icon:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>'})},onItemDblClick:function(e){e=this.getSelectedItem();var t={text:e.act_ingr,id:e.id,oa:e.oa,type:"Dv",callback:a.updDv,mode:"upd",source:this};console.log(t),this.$scope.popnew.show("Редактирование действующего в-ва",t)},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(){e.$$("_del").show()},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}};return{view:"layout",rows:[{height:40,view:"toolbar",cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Строка поиска",keyPressTimeout:900,tooltip:"поиск по действующему веществу",on:{onTimedKeyPress:function(e,t){var i=this.getValue().toString().toLowerCase();this.$scope.$$("__dtd").filter(function(e){return-1!=e.act_ingr.toString().toLowerCase().indexOf(i)})}}},{view:"button",type:"htmlbutton",tooltip:"Добавить действующее вещество",label:"<span class='webix_icon fa-plus'></span>",width:40,click:function(){var t={type:"Dv",callback:a.addDv,mode:"new",source:e.$$("__dtd")};e.popnew.show("Добавление действующего в-ва",t)}},{view:"button",type:"htmlbutton",hidden:!0,localId:"_del",tooltip:"Удалить дейтсвующее вещество",label:"<span style='color: red', class='webix_icon fa-times'></span>",width:40,click:function(){var t=e.$$("__dtd").getSelectedItem().id,i={};i.user=e.app.config.user,i.id=t;var o=e.app.config.r_url+"?delDv",n=Object(a.request)(o,i,!0).response;(n=Object(a.checkVal)(n,"s"))&&(Object(a.delDv)(n.id),e.$$("_del").hide())}}]},t]}},t.prototype.init=function(){this.popnew=this.ui(c.default),webix.extend(this.$$("__dtd"),webix.ProgressBar),this.$$("__dtd").sync(a.dv.data)},t}(s.c);t.default=l},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=i(0),c=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){function e(e){var t=this.$scope.app.config.r_url+"?check"+this.config._params.type,i={};i.check=e,i.user=this.$scope.app.config.user;var o=!1;if("new"==this.$scope.$$("_n_f").config._params.mode){var n=Object(a.request)(t,i,!0).response;n=Object(a.checkVal)(n,"s"),(n||this.config._params.text)&&(o=!0)}else o=!0;return o}var t=this;return{view:"cWindow",modal:!0,on:{onHide:function(){t.$$("_n_f").clear(),t.$$("_n_f").clearValidation()}},body:{view:"form",localId:"_n_f",_params:{},margin:0,rules:{id:e,text:webix.rules.isNotEmpty},elements:[{view:"text",localId:"_id",label:"ID",value:"",name:"id",placeholder:"Введите значение",readonly:!0,required:!0,invalidMessage:"Такой ID уже есть"},{view:"text",label:"Название",value:"",name:"text",placeholder:"Введите значение",required:!0,invalidMessage:"Введите название"},{view:"select",label:"Обязательный ассортимент",value:3,labelWidth:200,width:450,name:"oa",options:[{id:3,value:"Нет"},{id:1,value:"Для аптек"},{id:2,value:"Для аптек и аптечных пунктов"}],labelAlign:"left"},{height:15},{height:30,cols:[{view:"button",type:"base",label:"Отменить",width:120,click:function(){t.hide()}},{},{view:"button",type:"base",label:"Сохранить",width:120,click:function(){if(t.$$("_n_f").validate({hidden:!1,disabled:!1})){var e=t.$$("_n_f").getValues(),i={},o=t.$$("_n_f").config._params;i.value=e.text,i.user=t.app.config.user,i.id="upd"===o.mode?o.id:e.id,i.oa=e.oa;var n="new"===o.mode?t.app.config.r_url+"?set"+o.type:t.app.config.r_url+"?upd"+o.type,r=Object(a.request)(n,i,!0).response;r=Object(a.checkVal)(r,"s"),r&&o.callback(r,o.source),t.hide()}}}]}]}}},t.prototype.show=function(e,t){if(this.$$("_n_f").config._params=t,this.getRoot().getHead().getChildViews()[0].setValue(e),"upd"===t.mode){var i="Для аптек"===t.oa?1:"Для аптек и аптечных пунктов"===t.oa?2:3,o={text:t.text,id:t.id,oa:i};this.$$("_n_f").parse(o),this.$$("_id").define("readonly",!0)}else this.$$("_id").define("readonly",!1);this.$$("_id").refresh(),this.getRoot().show()},t.prototype.hide=function(){this.getRoot().hide()},t.prototype.getValues=function(){return this.getRoot().getBody().getValues()},t}(s.c);t.default=c},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=i(0),c=i(3),l=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this,t={view:"datatable",localId:"__table",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,startPos:1,posPpage:20,totalPos:1250,old_stri:"",columns:[{id:"id",width:200,header:[{text:"ID"}]},{id:"group",headermenu:!1,fillspace:1,sort:"text",header:[{text:"Группа"}]},{id:"id_state",width:150,header:[{text:"Статус"}]},{id:"dt",width:250,header:[{text:"Дата заведения"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){this.count||this.showProgress({type:"icon",icon:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>'})},onItemDblClick:function(e){e=this.getSelectedItem();var t={text:e.group,id:e.id,type:"Gr",callback:a.updGr,mode:"upd",source:this};this.$scope.popnew.show("Редактирование группы",t)},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(){e.$$("_del").show()},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}};return{view:"layout",rows:[{height:40,view:"toolbar",cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Строка поиска",keyPressTimeout:900,tooltip:"поиск по группе",on:{onTimedKeyPress:function(e,t){var i=this.getValue().toString().toLowerCase();this.$scope.$$("__table").filter(function(e){return-1!=e.group.toString().toLowerCase().indexOf(i)})}}},{view:"button",type:"htmlbutton",tooltip:"Добавить группу",label:"<span class='webix_icon fa-plus'></span>",width:40,click:function(){var t={type:"Gr",callback:a.addGr,mode:"new",source:e.$$("__table")};e.popnew.show("Добавление группы",t)}},{view:"button",type:"htmlbutton",hidden:!0,localId:"_del",tooltip:"Удалить группу",label:"<span style='color: red', class='webix_icon fa-times'></span>",width:40,click:function(){var t=e.$$("__table").getSelectedItem().id,i={};i.user=e.app.config.user,i.id=t;var o=e.app.config.r_url+"?delGr",n=Object(a.request)(o,i,!0).response;(n=Object(a.checkVal)(n,"s"))&&(Object(a.delGr)(n.id),e.$$("_del").hide())}}]},t]}},t.prototype.init=function(){this.popnew=this.ui(c.default),webix.extend(this.$$("__table"),webix.ProgressBar),this.$$("__table").sync(a.group.data)},t}(s.c);t.default=l},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=i(0),c=i(3),l=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this,t={view:"datatable",localId:"__dth",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,startPos:1,posPpage:20,totalPos:1250,old_stri:"",columns:[{id:"id",width:200,header:[{text:"ID"}]},{id:"usloviya",headermenu:!1,fillspace:1,sort:"text",header:[{text:"Условия хранения"}]},{id:"id_state",width:150,header:[{text:"Статус"}]},{id:"dt",width:250,header:[{text:"Дата заведения"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){this.count||this.showProgress({type:"icon",icon:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>'})},onItemDblClick:function(e){e=this.getSelectedItem();var t={text:e.usloviya,id:e.id,type:"Hran",callback:a.updHran,mode:"upd",source:this};this.$scope.popnew.show("Редактирование условия хранения",t)},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(){e.$$("_del").show()},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}};return{view:"layout",rows:[{height:40,view:"toolbar",cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Строка поиска",keyPressTimeout:900,tooltip:"поиск по условиям хранения",on:{onTimedKeyPress:function(e,t){var i=this.getValue().toString().toLowerCase();this.$scope.$$("__dth").filter(function(e){return-1!=e.usloviya.toString().toLowerCase().indexOf(i)})}}},{view:"button",type:"htmlbutton",tooltip:"Добавить условия хранения",label:"<span class='webix_icon fa-plus'></span>",width:40,click:function(){var t={type:"Hran",callback:a.addHran,mode:"new",source:e.$$("__dth")};e.popnew.show("Добавление условия хранения",t)}},{view:"button",type:"htmlbutton",localId:"_del",hidden:!0,tooltip:"Удалить условия хранения",label:"<span style='color: red', class='webix_icon fa-times'></span>",width:40,click:function(){var t=e.$$("__dth").getSelectedItem().id,i={};i.user=e.app.config.user,i.id=t;var o=e.app.config.r_url+"?delHran",n=Object(a.request)(o,i,!0).response;(n=Object(a.checkVal)(n,"s"))&&(Object(a.delHran)(n.id),e.$$("_del").hide())}}]},t]}},t.prototype.init=function(){this.popnew=this.ui(c.default),webix.extend(this.$$("__dth"),webix.ProgressBar),this.$$("__dth").sync(a.hran.data)},t}(s.c);t.default=l},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=i(0),c=i(23),l=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this,t=this.app;return{view:"layout",rows:[{height:40,view:"toolbar",cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Строка поиска",keyPressTimeout:900,tooltip:"Поиск",on:{onKeyPress:function(e,t){}}},{view:"button",type:"htmlbutton",hidden:!t.config.roles[t.config.role].useradd,label:"<span class='webix_icon fa-plus'></span><span style='line-height: 20px;'>  код</span>",width:80,click:function(){e.newcode.show("Добавление нового кода",e.$$("__table"))}},{view:"button",type:"htmlbutton",hidden:!0,localId:"del",label:"<span class='webix_icon fa-minus'></span><span style='line-height: 20px;'> код</span>",width:80,click:function(){e.$$("__table").getSelectedId();e.$$("__table").getSelectedItem().change=1,e.$$("__table").filter(function(e){return 1!=e.change}),e.$$("del").hide(),e.$$("apply").hide(),e.$$("cancel").hide()}},{view:"button",type:"htmlbutton",localId:"apply",hidden:!t.config.roles[t.config.role].useradd,label:"<span class='webix_icon fa-check'></span><span style='line-height: 20px;'> Применить</span>",width:130,click:function(){var i=[];e.$$("__table").eachRow(function(t){var o=e.$$("__table").getItem(t);o.change>0&&i.push(o)},!0),e.$$("del").hide(),e.$$("apply").hide(),e.$$("cancel").hide();var o=t.config.user,n=t.config.r_url+"?setLinkCodes",r={user:o,data:i};Object(a.request)(n,r).then(function(t){(t=Object(a.checkVal)(t,"a"))&&e.$$("__table").parse(t)})}},{view:"button",type:"htmlbutton",localId:"cancel",hidden:!t.config.roles[t.config.role].useradd,label:"<span class='webix_icon fa-times'></span><span style='line-height: 20px;'> Отменить</span>",width:130,click:function(){var i=t.config.user,o=t.config.r_url+"?getLinkCodes",n={user:i};e.$$("del").hide(),e.$$("apply").hide(),e.$$("cancel").hide(),Object(a.request)(o,n).then(function(t){(t=Object(a.checkVal)(t,"a"))&&e.$$("__table").parse(t)})}}]},{view:"datatable",localId:"__table",select:!0,resizeColumn:!0,borderless:!0,navigation:"row",rowHeight:32,fixedRowHeight:!1,rowLineHeight:32,editable:!0,editaction:"dblclick",columns:[{id:"change",hidden:!0,headermenu:!1},{id:"process",css:"center_p",width:150,header:[{text:"Обрабатывать",css:"center_p"},{content:"masterCheckbox",css:"center_p"}],template:"{common.checkbox()}"},{id:"code",header:"Код поставщика"},{id:"name",fillspace:!0,editor:"text",width:150,header:[{text:"Наименование поставщика"}]},{id:"inn",editor:"text",width:150,header:[{text:"Непонятное поле"}]},{id:"owner",width:150,header:[{text:"Кто добавил"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onCheck:function(t,i,o){e.$$("__table").getItem(t).change=2,e.$$("apply").show(),e.$$("cancel").show()},onAfterAdd:function(){e.$$("apply").show(),e.$$("cancel").show()},onEditorChange:function(t,i){e.$$("__table").getItem(row).change=2,e.$$("apply").show(),e.$$("cancel").show()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onAfterSelect:function(){e.$$("del").show()}}}]}},t.prototype.init=function(){var e=this,t=this.app.config.user,i=this.app.config.r_url+"?getLinkCodes",o={user:t};Object(a.request)(i,o).then(function(t){(t=Object(a.checkVal)(t,"a"))&&e.$$("__table").parse(t)}),this.newcode=this.ui(c.default)},t.prototype.ready=function(){},t}(s.c);t.default=l},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){function e(e){var t=!0;if(parseFloat(e)==e){var i=o.$$("_n_f").config.parent;i&&i.eachRow(function(o){+i.getItem(o).code==+e&&(t=!1)},!0)}else t=!1;return t}var t=this,i=this.app,o=this,n={view:"form",localId:"_n_f",parent:void 0,margin:0,rules:{code:e,name:webix.rules.isNotEmpty,inn:webix.rules.isNotEmpty},elements:[{cols:[{view:"text",localId:"code",label:"Код",value:"",width:120,name:"code",labelPosition:"top",labelAlign:"center",required:!0,invalidMessage:"Ошибочный код"},{view:"text",label:"Название",value:"",width:220,name:"name",labelPosition:"top",labelAlign:"center",required:!0,invalidMessage:"Введите значение"},{view:"text",label:"Непонятное поле",value:"",width:150,name:"inn",labelPosition:"top",labelAlign:"center",required:!0,invalidMessage:"Введите значение"}]},{height:15},{height:30,cols:[{view:"button",type:"base",label:"Отменить",width:120,click:function(){t.hide()}},{},{view:"button",type:"base",label:"Сохранить",width:120,click:function(){if(t.$$("_n_f").validate({hidden:!1,disabled:!1})){var e=t.$$("_n_f").getValues();e.change=2,e.process=1,e.owner=i.config.suser,t.$$("_n_f").config.parent.add(e,0),t.hide()}}}]}]};return{view:"cWindow",modal:!0,on:{onShow:function(){t.$$("code").focus()},onHide:function(){t.$$("_n_f").clear(),t.$$("_n_f").clearValidation()}},body:n}},t.prototype.show=function(e,t){this.$$("_n_f").config.parent=t,this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show()},t.prototype.hide=function(){this.getRoot().hide()},t}(s.c);t.default=a},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=i(0),c=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this,t=this.app;return{view:"layout",rows:[{height:40,view:"toolbar",cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Строка поиска",tooltip:"Поиск",on:{onKeyPress:function(e,t){}}},{view:"button",type:"htmlbutton",hidden:!t.config.roles[t.config.role].useradd,label:"<span class='webix_icon fa-plus'></span><span style='line-height: 20px;'> исключение</span>",width:130,click:function(){webix.message({text:"Добавление исключения",type:"debug",width:"400px",delay:"5"})}},{view:"button",type:"htmlbutton",hidden:!0,localId:"del",label:"<span class='webix_icon fa-minus'></span><span style='line-height: 20px;'> исключение</span>",width:130,click:function(){webix.message({text:"Удаление исключения",type:"debug",width:"400px",delay:"5"})}},{view:"button",type:"htmlbutton",hidden:!t.config.roles[t.config.role].useradd,label:"<span class='webix_icon fa-check'></span><span style='line-height: 20px;'> Применить</span>",width:130,click:function(){webix.message({text:"Применение изменений",type:"debug",width:"400px",delay:"5"})}},{view:"button",type:"htmlbutton",hidden:!t.config.roles[t.config.role].useradd,label:"<span class='webix_icon fa-times'></span><span style='line-height: 20px;'> Отменить</span>",width:130,click:function(){webix.message({text:"Отменение изменений",type:"debug",width:"400px",delay:"5"})}}]},{view:"datatable",localId:"__table",select:!0,resizeColumn:!0,borderless:!0,navigation:"row",rowHeight:32,fixedRowHeight:!1,rowLineHeight:32,editable:!1,columns:[{id:"process",width:150,css:"center_p",header:[{text:"Обрабатывать"},{content:"masterCheckbox",css:"center_p"}],template:"<span class='center_p'>{common.checkbox()}</span>"},{id:"name",fillspace:!0,header:[{text:"Наименование исключения"}]},{id:"options_st",header:[{text:"Параметры исключения",colspan:2,css:{"text-align":"center"}},{text:"Начинается",css:{"text-align":"center"}}],template:"<span class='center_p'>{common.checkbox()}</span>",width:100,css:"center_p"},{id:"options_in",header:["",{text:"Содержит",css:{"text-align":"center"}}],template:"<span class='center_p'>{common.checkbox()}</span>",width:100,css:"center_p"},{id:"owner",width:150,header:[{text:"Кто добавил"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onAfterSelect:function(){e.$$("del").show()}}}]}},t.prototype.init=function(){},t.prototype.ready=function(e){var t=this,i=this.app.config.user,o=this.app.config.r_url+"?getLinkExcludes",n={user:i};Object(a.request)(o,n).then(function(e){e=Object(a.checkVal)(e,"a"),e.length>0&&t.$$("__table").parse(e)})},t}(s.c);t.default=c},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=i(0),c=i(26),l=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this;this.app;return{view:"layout",rows:[{height:40,view:"toolbar",cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Строка поиска",tooltip:"Поиск",on:{onKeyPress:function(e,t){}}},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-plus'></span><span style='line-height: 20px;'> файл</span>",width:130,click:function(){e.pop_upl.show_window("Загрузка файла")}},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-refresh'></span>",width:40,click:function(){var t=e.app.config.user,i=e.app.config.r_url+"?getTasks",o={user:t};Object(a.request)(i,o).then(function(t){t=Object(a.checkVal)(t,"a"),t.length>0?e.$$("__table").parse(t):e.$$("__table").clearAll()})}}]},{view:"datatable",localId:"__table",select:!0,resizeColumn:!0,borderless:!0,navigation:"row",rowHeight:32,fixedRowHeight:!1,rowLineHeight:32,editable:!1,columns:[{id:"uin",width:260,header:[{text:"Идентификатор задания"}]},{id:"vendor",fillspace:1,header:[{text:"Поставщик"}]},{id:"customer",width:150,header:[{text:"Клиент"}]},{id:"source",width:130,header:[{text:"Источник"}]},{id:"count",width:130,header:[{text:"Осталось позиций"}]},{id:"dt",width:200,format:a.dt_formating_sec,header:[{text:"Время добавления"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)}}}]}},t.prototype.init=function(){this.pop_upl=this.ui(c.default)},t.prototype.ready=function(e){var t=this,i=this.app.config.user,o=this.app.config.r_url+"?getTasks",n={user:i};Object(a.request)(o,n).then(function(e){e=Object(a.checkVal)(e,"a"),e.length>0&&t.$$("__table").parse(e)})},t}(s.c);t.default=l},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this;this.app;return{view:"cWindow",modal:!1,on:{onHide:function(){e.$$("__upl_1").files.clearAll()}},body:{view:"form",rows:[{view:"uploader",localId:"__upl_1",type:"iconButton",icon:"plus-circle",multiple:!1,autosend:!1,align:"left",label:"Добавить файл",directory:!1,accept:"application/nolink",urlData:{},link:void 0,upload:"http://saas.local/linker_upl",datatype:"json",on:{onUploadComplete:function(t){console.log("ok",t),e.hide_window()}}},{view:"list",localId:"_f_list",type:"uploader",autoheight:!0,borderless:!0},{view:"button",label:"Отправить",type:"iconButton",icon:"upload",click:function(){e.$$("__upl_1").files.data.each(function(t){t.urlData={filename:t.name,source:"linker"},e.$$("__upl_1").send(t.id)})}}]}}},t.prototype.ready=function(){this.$$("__upl_1").define({link:this.$$("_f_list").config.id}),this.$$("__upl_1").refresh()},t.prototype.show_window=function(e){this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show()},t.prototype.hide_window=function(){this.getRoot().hide()},t.prototype.init=function(){},t}(s.c);t.default=a},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=i(0),c=i(3),l=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this,t={view:"datatable",localId:"__dts",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,startPos:1,posPpage:20,totalPos:1250,old_stri:"",columns:[{id:"id",width:200,header:[{text:"ID"}]},{id:"nds",headermenu:!1,fillspace:1,sort:"text",header:[{text:"НДС"}]},{id:"id_state",width:150,header:[{text:"Статус"}]},{id:"dt",width:250,header:[{text:"Дата заведения"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){this.count||this.showProgress({type:"icon",icon:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>'})},onItemDblClick:function(e){e=this.getSelectedItem();var t={text:e.nds,id:e.id,type:"Nds",callback:a.updNds,mode:"upd",source:this};this.$scope.popnew.show("Редактирование НДС",t)},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(){e.$$("_del").show()},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}};return{view:"layout",rows:[{height:40,view:"toolbar",cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Строка поиска",keyPressTimeout:900,tooltip:"поиск по НДС",on:{onTimedKeyPress:function(e,t){var i=this.getValue().toString().toLowerCase();this.$scope.$$("__dts").filter(function(e){return-1!=e.nds.toString().toLowerCase().indexOf(i)})}}},{view:"button",type:"htmlbutton",tooltip:"Добавить НДС",label:"<span class='webix_icon fa-plus'></span>",width:40,click:function(){var t={type:"Nds",callback:a.addNds,mode:"new",source:e.$$("__dts")};e.popnew.show("Добавление НДС",t)}},{view:"button",type:"htmlbutton",hidden:!0,localId:"_del",tooltip:"Удалить НДС",label:"<span style='color: red', class='webix_icon fa-times'></span>",width:40,click:function(){var t=e.$$("__dts").getSelectedItem().id,i={};i.user=e.app.config.user,i.id=t;var o=e.app.config.r_url+"?delNds",n=Object(a.request)(o,i,!0).response;(n=Object(a.checkVal)(n,"s"))&&(Object(a.delNds)(n.id),e.$$("_del").hide())}}]},t]}},t.prototype.init=function(){this.popnew=this.ui(c.default),webix.extend(this.$$("__dts"),webix.ProgressBar),this.$$("__dts").sync(a.nds.data)},t}(s.c);t.default=l},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=i(4),c=i(5),l=i(0),u=i(2),p=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){function e(e){return 0!=+e.id_dv?"<div> <span class='green'>есть</span></div>":"<div> <span class='red'>нет</span></div>"}function t(e){return e.c_mandat?"<div><span class='webix_icon fa-check-circle'></span></div>":"<div><span class='webix_icon fa-times'></span></div>"}function i(e){return e.c_prescr?"<div><span class='webix_icon fa-check-circle'></span></div>":"<div><span class='webix_icon fa-times'></span></div>"}var o=this,n=this.app,r=this;webix.ui.datafilter.richFilt=Object.create(webix.ui.datafilter.richSelectFilter),webix.ui.datafilter.richFilt.refresh=l.rRefresh,webix.ui.datafilter.richFilt.render=function(e,t){if(!t.richselect){var i=webix.html.create("div",{class:"webix_richfilter"}),o={container:i,view:this.inputtype,options:[]},r=webix.extend(this.inputConfig||{},t.inputConfig||{},!0);webix.extend(o,r,!0),t.separator&&(o.separator=t.separator),t.suggest&&(o.suggest=t.suggest);var s=webix.ui(o);s.attachEvent("onChange",function(){var t=e.config.id,i=webix.$$(t);this._filter_timer&&window.clearTimeout(this._filter_timer),this._filter_timer=window.setTimeout(function(){var e=i.getParentView().getChildViews()[2].$scope.$$("__page").getValue();i.getParentView().getChildViews()[2].$scope.$$("__page").setValue(0==+e?"1":"0"),i.getParentView().getChildViews()[2].$scope.$$("__page").refresh()},n.config.searchDelay)}),t.richselect=s.config.id}return t.css="webix_div_filter"," "},webix.ui.datafilter.txtFilt=Object.create(webix.ui.datafilter.textFilter),webix.ui.datafilter.txtFilt.on_key_down=function(e,t,i){var o=this._comp_id,r=webix.$$(o);9!=(e.which||e.keyCode)&&Object(l.checkKey)(e.keyCode)&&(this._filter_timer&&window.clearTimeout(this._filter_timer),this._filter_timer=window.setTimeout(function(){var e=r.getParentView().getChildViews()[2].$scope.$$("__page").getValue();r.getParentView().getChildViews()[2].$scope.$$("__page").setValue(0==+e?"1":"0"),r.getParentView().getChildViews()[2].$scope.$$("__page").refresh()},n.config.searchDelay))},webix.ui.datafilter.txtFilt.refresh=l.fRefresh,webix.ui.datafilter.txtFilt.render=l.fRender;var s=$$("sezon_dc").data.getRange($$("sezon_dc").data.getFirstId(),$$("sezon_dc").data.getLastId()),a=[],c=[],p=[],d=[];s.forEach(function(e,t,i){var o={id:e.id,value:e.sezon};a.push(o)}),s=$$("hran_dc").data.getRange($$("hran_dc").data.getFirstId(),$$("hran_dc").data.getLastId()),s.forEach(function(e,t,i){var o={id:e.id,value:e.usloviya};d.push(o)}),s=$$("nds_dc").data.getRange($$("nds_dc").data.getFirstId(),$$("nds_dc").data.getLastId()),s.forEach(function(e,t,i){var o={id:e.id,value:e.nds};p.push(o)}),s=$$("allTg_dc").data.getRange($$("allTg_dc").data.getFirstId(),$$("allTg_dc").data.getLastId()),s.forEach(function(e,t,i){var o={id:e.id,value:e.c_tgroup};c.push(o)});var f={view:"datatable",name:"__dt_as",localId:"__table",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:{autowidth:!0},startPos:1,posPpage:20,totalPos:1250,fi:"c_tovar",di:"asc",searchBar:void 0,searchMethod:"getSprSearchAdm",old_stri:"",css:"dt_css",columns:[{id:"id_mnn",width:75,template:e,header:[{text:"МНН"}]},{id:"id_spr",width:80,sort:"server",header:[{text:"IDSPR"},{content:"txtFilt"}],headermenu:!1},{id:"c_tovar",fillspace:1,sort:"server",header:[{text:"Наименование"}],headermenu:!1},{id:"id_zavod",sort:"server",width:300,header:[{text:"Производитель"},{content:"txtFilt"}]},{id:"id_strana",sort:"server",width:200,header:[{text:"Страна"},{content:"txtFilt"}]},{id:"c_dv",hidden:!0,sort:"server",width:150,header:[{text:"Д. в-во"},{content:"txtFilt"}]},{id:"c_group",hidden:!0,width:150,header:[{text:"Группа"},{content:"richFilt",compare:l.compareTrue,inputConfig:{options:c}}]},{id:"c_nds",hidden:!0,width:150,header:[{text:"НДС"},{content:"richFilt",compare:l.compareTrue,inputConfig:{options:p}}]},{id:"c_hran",hidden:!0,width:150,header:[{text:"Условия хранения"},{content:"richFilt",compare:l.compareTrue,inputConfig:{options:d}}]},{id:"c_sezon",hidden:!0,width:180,header:[{text:"Сезонность"},{content:"richFilt",compare:l.compareTrue,inputConfig:{options:a}}]},{id:"mandat",width:100,template:t,hidden:!0,css:"center_p",header:[{text:"Обязательный"},{content:"richFilt",compare:l.compareTrue,inputConfig:{options:[{id:1,value:"Да"},{id:2,value:"Нет"}]}}]},{id:"prescr",width:100,hidden:!0,css:"center_p",template:i,header:[{text:"Рецептурный"},{content:"richFilt",compare:l.compareTrue,inputConfig:{options:[{id:1,value:"Да"},{id:2,value:"Нет"}]}}]},{id:"dt",width:200,sort:"server",format:l.dt_formating_sec,css:"center_p",header:[{text:"Дата изменения"},{content:"dateRangeFilter",compare:l.compareTrue,inputConfig:{format:l.dt_formating,width:180},suggest:{view:"daterangesuggest",body:{timepicker:!1,calendarCount:2}}}]}],on:{"data->onParse":function(e,t){this.clearAll(),this.$scope.$$("_del").hide()},onBeforeSort:function(e,t){o.$$("__table").config.fi=e,o.$$("__table").config.di=t;var i=r.getRoot().getChildViews()[2].$scope.$$("__page").getValue();r.getRoot().getChildViews()[2].$scope.$$("__page").setValue(0==+i?"1":"0"),r.getRoot().getChildViews()[2].$scope.$$("__page").refresh()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onItemDblClick:function(e){e=this.getSelectedItem(),e=e.id_spr,e=Object(l.get_spr)(this.$scope,e),e.s_name="Страна: "+e.c_strana,e.t_name="Название товара: "+e.c_tovar,e.v_name="Производитель: "+e.c_zavod,e.dv_name="Действующее вещество: "+e.c_dv,this.$scope.popnew.show("Редактирование записи "+e.id_spr,this.$scope.$$("_sb"),e)},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(){o.$$("_del").show()},onKeyPress:function(e,t){13===e&&this.getSelectedItem()&&this.callEvent("onItemDblClick")}}};return{view:"layout",rows:[{view:"toolbar",height:40,cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Введите наименование",localId:"_sb",tooltip:"поиск от двух символов, !слово - исключить из поиска",on:{onKeyPress:function(e,t){clearTimeout(this.config._keytimed),Object(l.checkKey)(e)&&(this.config._keytimed=setTimeout(function(){var e=r.getRoot().getChildViews()[2].$scope.$$("__page").getValue();r.getRoot().getChildViews()[2].$scope.$$("__page").setValue(0==+e?"1":"0"),r.getRoot().getChildViews()[2].$scope.$$("__page").refresh()},this.$scope.app.config.searchDelay))}}},{view:"button",type:"htmlbutton",width:35,label:"<span class='webix_icon fa-history'></span><span style='line-height: 20px;'></span>",click:function(){var e=webix.storage.session.get(o.$$("__table").config.name);o.pophistory.show(e,o.$$("_sb"))}},{view:"button",tooltip:"Сбросить фильтры",type:"imageButton",image:"./addons/img/unfilter.svg",width:40,click:function(){var e=o.$$("__table");e.config.columns.forEach(function(t){e.isColumnVisible(t.id)&&t.header[1]&&("function"==typeof e.getFilter(t.id).setValue?e.getFilter(t.id).setValue(""):e.getFilter(t.id).value="")}),o.$$("_sb").callEvent("onKeyPress",[13])}},{view:"button",type:"htmlbutton",tooltip:"Добавить эталон",label:"<span class='webix_icon fa-plus'></span>",width:40,click:function(){o.popnew.show("Новый эталон",o.$$("_sb"))}},{view:"button",type:"htmlbutton",hidden:!0,localId:"_del",tooltip:"Удалить эталон",label:"<span style='color: red', class='webix_icon fa-times'>",width:40,click:function(){webix.message({text:"Удаление из SPR. Пока недоступно.",type:"error"}),o.$$("__table").unselectAll(),o.$$("_del").hide()}}]},f,{$subview:u.default}]}},t.prototype.ready=function(){this.$$("__table").config.searchBar=this.$$("_sb"),this.$$("_sb").callEvent("onKeyPress",[13])},t.prototype.init=function(){this.popnew=this.ui(a.default),this.pophistory=this.ui(c.default);var e=this;$$(this.$$("__table").getColumnConfig("dt").header[1].suggest.body.id).getChildViews()[1].getChildViews()[1].setValue("Применить"),$$(this.$$("__table").getColumnConfig("dt").header[1].suggest.body.id).getChildViews()[1].getChildViews()[1].define("click",function(){this._filter_timer&&window.clearTimeout(this._filter_timer),this._filter_timer=window.setTimeout(function(){var t=e.getRoot().getChildViews()[2].$scope,i=t.$$("__page").getValue();t.$$("__page").setValue(0==+i?"1":"0"),t.$$("__page").refresh()},webix.ui.datafilter.textWaitDelay),this.getParentView().getParentView().hide()})},t}(s.c);t.default=p},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=i(0),c=i(3),l=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this,t={view:"datatable",localId:"__dtv",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,startPos:1,posPpage:20,totalPos:1250,old_stri:"",columns:[{id:"id",width:75,header:[{text:"ID"}]},{id:"c_zavod",headermenu:!1,fillspace:1,sort:"text",header:[{text:"Производитель"}]},{id:"id_state",width:150,header:[{text:"Статус"}]},{id:"dt",width:250,header:[{text:"Дата заведения"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){this.count||this.showProgress({type:"icon",icon:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>'})},onItemDblClick:function(e){e=this.getSelectedItem();var t={text:e.c_zavod,id:e.id,type:"Vendor",callback:a.updVendor,mode:"upd",source:this};this.$scope.popnew.show("Редактирование поставщика",t)},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(){e.$$("_del").show()},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}};return{view:"layout",rows:[{view:"toolbar",height:40,cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Строка поиска",keyPressTimeout:900,tooltip:"поиск по поставщику",on:{onTimedKeyPress:function(e,t){var i=this.getValue().toString().toLowerCase();this.$scope.$$("__dtv").filter(function(e){return-1!=e.c_zavod.toString().toLowerCase().indexOf(i)})}}},{view:"button",type:"htmlbutton",tooltip:"Добавить поставщика",label:"<span class='webix_icon fa-plus'></span>",width:40,click:function(){var t={type:"Vendor",callback:a.addVendor,mode:"new",source:e.$$("__dtv")};e.popnew.show("Добавление производителя",t)}},{view:"button",type:"htmlbutton",hidden:!0,localId:"_del",tooltip:"Удалить поставщика",label:"<span style='color: red', class='webix_icon fa-times'></span>",width:40,click:function(){var t=e.$$("__dtv").getSelectedItem().id,i={};i.user=e.app.config.user,i.id=t;var o=e.app.config.r_url+"?delVendor",n=Object(a.request)(o,i,!0).response;(n=Object(a.checkVal)(n,"s"))&&(Object(a.delVendor)(n.id),e.$$("_del").hide())}}]},t]}},t.prototype.init=function(){this.popnew=this.ui(c.default),webix.extend(this.$$("__dtv"),webix.ProgressBar),this.$$("__dtv").sync(a.vendor.data)},t}(s.c);t.default=l},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=i(0),c=i(3),l=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this,t={view:"datatable",localId:"__dts",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,startPos:1,posPpage:20,totalPos:1250,old_stri:"",columns:[{id:"id",width:200,header:[{text:"ID"}]},{id:"sezon",headermenu:!1,fillspace:1,sort:"text",header:[{text:"Сезон"}]},{id:"id_state",width:150,header:[{text:"Статус"}]},{id:"dt",width:250,header:[{text:"Дата заведения"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){this.count||this.showProgress({type:"icon",icon:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>'})},onItemDblClick:function(e){e=this.getSelectedItem();var t={text:e.sezon,id:e.id,type:"Sez",callback:a.updSez,mode:"upd",source:this};this.$scope.popnew.show("Редактирование сезонности",t)},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(){e.$$("_del").show()},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}};return{view:"layout",rows:[{view:"toolbar",height:40,cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Строка поиска",keyPressTimeout:900,tooltip:"поиск по сезону",on:{onTimedKeyPress:function(e,t){var i=this.getValue().toString().toLowerCase();this.$scope.$$("__dts").filter(function(e){return-1!=e.sezon.toString().toLowerCase().indexOf(i)})}}},{view:"button",type:"htmlbutton",tooltip:"Добавить сезон",label:"<span class='webix_icon fa-plus'></span>",width:40,click:function(){var t={type:"Sez",callback:a.addSez,mode:"new",source:e.$$("__dts")};e.popnew.show("Добавление сезонности",t)}},{view:"button",type:"htmlbutton",hidden:!0,localId:"_del",tooltip:"Удалить сезон",label:"<span style='color: red', class='webix_icon fa-times'></span>",width:40,click:function(){var t=e.$$("__dts").getSelectedItem().id,i={};i.user=e.app.config.user,i.id=t;var o=e.app.config.r_url+"?delSez",n=Object(a.request)(o,i,!0).response;(n=Object(a.checkVal)(n,"s"))&&(Object(a.delSez)(n.id),e.$$("_del").hide())}}]},t]}},t.prototype.init=function(){this.popnew=this.ui(c.default),webix.extend(this.$$("__dts"),webix.ProgressBar),this.$$("__dts").sync(a.sezon.data)},t}(s.c);t.default=l},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=i(0),c=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){function e(e){var t=this.$scope.app.config.r_url+"?check"+this.config._params.type,i={};i.check=e,i.user=this.$scope.app.config.user;var o=!1,n=Object(a.request)(t,i,!0).response;return n=Object(a.checkVal)(n,"s"),(n||this.config._params.id)&&(o=!0),o}var t=this,i=this.app;return{view:"cWindow",modal:!0,on:{onHide:function(){t.$$("new_user").clear(),t.$$("new_user").clearValidation()},onShow:function(){t.$$("_pwrd").define({type:"password"}),t.$$("_eye").define({label:"<span class='webix_icon fa-eye'></span><span style='line-height: 20px;'></span>"}),t.$$("_pwrd").refresh(),t.$$("_eye").refresh()}},body:{view:"form",localId:"new_user",margin:0,_params:{},rules:{c_user:e,c_pwrd:webix.rules.isNotEmpty,id_role:webix.rules.isNotEmpty},elements:[{rows:[{view:"text",labelPosition:"top",label:"Пользователь:",value:"",name:"c_user",required:!0,invalidMessage:"Укажите коректное имя"},{height:10,width:600},{view:"label",label:"Пароль:"},{cols:[{view:"text",label:"",value:"",name:"c_pwrd",type:"password",localId:"_pwrd",required:!0,invalidMessage:"Пароль обязателен"},{view:"button",type:"htmlbutton",localId:"_eye",label:"<span class='webix_icon fa-eye'></span><span style='line-height: 20px;'></span>",width:30,hidden:!i.config.roles[i.config.role].userdel,_vis:!1,click:function(){t.$$("_eye").config._vis?(t.$$("_pwrd").define({type:"password"}),t.$$("_eye").define({label:"<span class='webix_icon fa-eye'></span><span style='line-height: 20px;'></span>"}),t.$$("_pwrd").refresh(),t.$$("_eye").refresh(),t.$$("_eye").config._vis=!1):t.$$("_eye").config._vis||(t.$$("_pwrd").define({type:"text"}),t.$$("_eye").define({label:"<span class='webix_icon fa-eye-slash'></span><span style='line-height: 20px;'></span>"}),t.$$("_pwrd").refresh(),t.$$("_eye").refresh(),t.$$("_eye").config._vis=!0)}}]},{view:"text",labelPosition:"top",label:"Группа:",name:"id_group"},{view:"text",labelPosition:"top",label:"Список ИНН:",value:"",name:"c_inn"},{view:"label",label:"Роль пользователя:"},{cols:[{view:"combo",label:"",value:"",name:"id_role",localId:"_rolesC",required:!0,invalidMessage:"Роль пользователя должна быть указана",options:{body:{template:"#r_name#",yCount:5}}},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-plus'></span><span style='line-height: 20px;'></span>",width:30,hidden:!i.config.roles[i.config.role].userdel,click:function(){webix.message({type:"debug",text:"Пока не реализованно"})}}]},{height:10,width:600},{cols:[{view:"button",type:"base",label:"Отменить",width:120,height:32,click:function(){t.hide()}},{},{view:"button",type:"base",label:"Сохранить",width:120,height:32,hidden:!i.config.roles[i.config.role].useradd,click:function(){if(t.$$("new_user").validate({hidden:!1,disabled:!1})){var e=t.$$("new_user").getValues();e.user=t.app.user;var i=e.id?t.app.config.r_url+"?updUser":t.app.config.r_url+"?setUser";Object(a.checkVal)(Object(a.request)(i,e,!0).response,"s")&&(i=t.app.config.r_url+"?getUsersAll",Object(a.request)(i,e).then(function(e){(e=Object(a.checkVal)(e,"a"))&&($$("users_dc").clearAll(),$$("users_dc").parse(e),this.$scope.users_dt.clearAll(),this.$scope.users_dt.parse($$("users_dc")))}),t.hide())}}}]}]}]}}},t.prototype.show=function(e,t,i){i&&(this.users_dt=i),t?(this.$$("new_user").parse(t),this.$$("new_user").config._params.id=t.id):(this.$$("new_user").clear(),this.$$("new_user").config._params={}),this.$$("new_user").config._params.type="User",this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show()},t.prototype.init=function(){var e=this.$$("_rolesC");e.getList().clearAll(),e.getList().parse(a.u_roles)},t.prototype.hide=function(){this.getRoot().hide()},t}(s.c);t.default=c},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=i(0),c=i(7),l=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this,t={view:"datatable",localId:"__table",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,css:"dt_css",columns:[{id:"act_name",width:375,header:[{text:"Тип действия"}]},{id:"user",fillspace:1,css:"col_center",template:"{common.checkbox()}",header:[{text:"Имя роли",colspan:5,css:"col_center"},{text:$$("roles_dc").getItem(1).r_name}]},{id:"linker",fillspace:1,css:"col_center",template:"{common.checkbox()}",header:[{},{text:$$("roles_dc").getItem(9).r_name}]},{id:"admin",css:"col_center",template:"{common.checkbox()}",fillspace:1,header:[{},{text:$$("roles_dc").getItem(10).r_name}]},{id:"superadmin",css:"col_center",template:"{common.checkbox()}",fillspace:1,header:[{},{text:$$("roles_dc").getItem(34).r_name}]},{id:"qqq",css:"col_center",template:"{common.checkbox()}",fillspace:1,header:[{},{text:$$("roles_dc").getItem(35).r_name}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onAfterLoad:function(){this.hideProgress()}}},i={height:40,view:"toolbar",cols:[{},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-times'></span><span style='line-height: 20px;'> Отменить</span>",width:140,click:function(){e.hide()}},{view:"button",type:"htmlbutton",hidden:!this.app.config.roles[this.app.config.role].userdel,label:"<span class='webix_icon fa-save'></span><span style='line-height: 20px;'> Сохранить</span>",width:140,click:function(){var t=e.$$("__table").serialize(),i=e.app.config.r_url+"?setAdmRoles",o={user:e.app.config.user,values:t},n=Object(a.checkVal)(Object(a.request)(i,o,!0).response,"s");if(n){var r={};r.command="?killAll",r.type="async",r.action=n,e.popconfirm.show("Отключить всех пользователей?",r),e.hide()}}}]};return{view:"cWindow",width:.8*document.documentElement.clientWidth,height:.8*document.documentElement.clientHeight,modal:!0,on:{onHide:function(){e.$$("__table").clearAll()},onShow:function(){var t=e.app.config.r_url+"?getAdmRoles",i={user:e.app.config.user};Object(a.request)(t,i).then(function(e){e=Object(a.checkVal)(e,"a"),e?this.$scope.$$("__table").parse(e):this.$scope.$$("__table").clearAll(),this.$scope.$$("__table").hideProgress()})}},body:{view:"layout",rows:[i,t]}}},t.prototype.show=function(e){this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show()},t.prototype.init=function(){this.popconfirm=this.ui(c.default)},t.prototype.hide=function(){this.getRoot().hide()},t}(s.c);t.default=l},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=i(5),c=i(4),l=i(7),u=i(0),p=i(34),d=i(35),f=i(36),h=i(37),_=i(38),g=i(14),b=i(12),w=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){function e(e,t){var i=e.$scope.getRoot().getTopParentView().getChildViews()[1].getChildViews()[0].getChildViews()[1],o=t===f.default?"<span class='webix_icon fa-archive'></span><span style='line-height: 20px;'>Пропущенные</span>":t===h.default?"<span class='webix_icon fa-unlink'></span><span style='line-height: 20px;'>Несвязанные</span>":t===_.default?"<span class='webix_icon fa-stumbleupon'></span><span style='line-height: 20px;'>Связки</span>":t===g.default?"<span class='webix_icon fa-blind'></span><span style='line-height: 20px;'>Админка</span>":"",n=webix.uid(),r={id:n,value:o,width:172,close:!0},s={id:n,$subview:t};e.config.b_id=n,i.getChildViews()[2].addView(s),i.getChildViews()[1].addOption(r,!0)}var t,i=this,o=this.app,n={view:"layout",id:"app-nav",rows:[{view:"toolbar",css:{"border-top":"0px !important"},height:40,cols:[{view:"combo",name:"suppliers",id:"_suppl",manual:!1,state:!1,width:300,options:{filter:u.filter_1,body:{template:"#c_vnd# - #count#",yCount:10}},on:{onChange:function(){if($$("_suppl").config.manual)$$("_suppl").config.manual=!1;else{var e=$$("_suppl").getList();if(e.count()>0){var t=$$("_link_by").getValue(),o=e.getItem($$("_suppl").getValue()).id_vnd;1==+t?Object(u.get_prcs)(i,o):2==+t?Object(u.get_prcs_date)(i,o):3==+t&&Object(u.get_prcs_source)(i,o)}else{var n=i.getRoot().getChildViews()[1].getChildViews()[2].getChildViews()[0].getChildViews()[3].getChildViews();n[0].clearAll(),i.getRoot().getChildViews()[1].getChildViews()[2].getChildViews()[0].getChildViews()[0].getChildViews()[0].setValue("");var r={_name:"",_count:"",_vendor:"",p_name:""};$$("_add")&&$$("_add").hide(),$$("_left").hide(),$$("_skip").hide(),$$("_right").hide(),$$("_link").hide(),i.getRoot().getChildViews()[1].getChildViews()[2].getChildViews()[0].getChildViews()[1].parse(r),$$("_spr_search").setValue("");var s=n[1];s.getChildViews()[6].define("label","Всего записей: 0"),s.getChildViews()[6].refresh(),s.$scope.$$("__page").config.manual=!1,s.$scope.$$("__page").setValue("1"),s.$scope.$$("__page").refresh(),s.getChildViews()[2].getChildViews()[2].define("label","1"),s.getChildViews()[2].getChildViews()[2].refresh()}}}}},{view:"radio",label:"СВОДИТЬ ПО",value:1,css:"c-radio",id:"_link_by",labelWidth:90,width:385,options:[{id:1,value:"поставщикам"},{id:2,value:"дате"},{id:3,value:"источнику"}],on:{onChange:function(){var e=this.getValue();$$("_suppl").getList().clearAll(),$$("_suppl").setValue(""),1==+e?Object(u.get_suppl)("_suppl",this.$scope,"?getSupplUnlnk"):2==+e?Object(u.get_suppl)("_suppl",this.$scope,"?getDatesUnlnk"):3==+e?Object(u.get_suppl)("_suppl",this.$scope,"?getSourceUnlnk"):webix.message({type:"error",text:"не сводим"})}}},{},{view:"button",type:"htmlbutton",tooltip:"Обновить",label:"<span class='webix_icon fa-refresh'></span>",width:40,click:function(){2==+$$("_link_by").getValue()?Object(u.get_suppl)("_suppl",i,"?getDatesUnlnk"):3==+$$("_link_by").getValue()?Object(u.get_suppl)("_suppl",i,"?getSourceUnlnk"):Object(u.get_suppl)("_suppl",i,"?getSupplUnlnk")}}]},{view:"toolbar",id:"_names_bar",css:"header",rows:[{cols:[{view:"label",label:"",name:"_name",fillspace:1}]},{cols:[{view:"label",label:"",css:"header",name:"_vendor"},{},{view:"label",label:"",css:"right",name:"_count",width:320,click:function(){var e=$$("_suppl").getValue();e=$$("_suppl").getList().getItem(e).c_vnd,i.popunlink.show("Осталось связать в этой сессии по поставщику "+e)}},{width:10},{view:"button",type:"htmlbutton",label:"<span class='butt'>Обновить сессию</span>",width:200,height:32,click:function(){if($$("_suppl").getList().getItem($$("_suppl").getValue())){var e=$$("_suppl").getList().getItem($$("_suppl").getValue()).id_vnd;Object(u.get_prcs)(i,e)}}}]}]},{view:"toolbar",height:40,cols:[{view:"text",label:"",labelWidth:1,placeholder:"Строка поиска",id:"_spr_search",_keytimed:void 0,on:{onKeyPress:function(e,t){var i=this;clearTimeout(this.config._keytimed),Object(u.checkKey)(e)&&(this.config._keytimed=setTimeout(function(){var e=i.$scope.getParentView().getRoot().getChildViews()[0].getChildViews()[1].getChildViews()[2].getChildViews()[0].getChildViews()[3],t=e.getChildViews()[0];t&&Object(u.get_data_test)({view:t,navBar:e.getChildViews()[1],start:1,count:t.config.posPpage,searchBar:t.config.searchBar,method:t.config.searchMethod})},this.$scope.app.config.searchDelay))}}},{view:"button",type:"htmlbutton",width:35,hidden:!0,label:"<span class='webix_icon fa-history'></span><span style='line-height: 20px;'></span>",click:function(){var e=i.getRoot().getChildViews()[1].getChildViews()[2].getChildViews()[0].getChildViews()[3].getChildViews()[0].config.name,t=webix.storage.session.get(e);i.pophistory.show(t,$$("_spr_search"))}},{view:"button",type:"htmlbutton",id:"_add",width:140,hidden:!0,label:"Добавить (Ins)",hotkey:"insert",on:{onItemClick:function(){var e={},t=$$("_names_bar").getValues().p_name;e.t_name="Название товара:   "+t,e.c_tovar=t.toUpperCase(),i.popnew.show("Добавление в справочник",$$("_spr_search"),e)}}},{view:"button",type:"htmlbutton",id:"_link",label:"<span class='webix_icon fa-link'></span><span style='line-height: 20px;'>  Связать (Ctrl+Home)</span>",hidden:!0,width:200,hotkey:"home+ctrl",click:function(){$$("_link").hide();var e=u.prcs.getItem(u.prcs.getCursor()).sh_prc,t=i.getRoot().getChildViews()[1].getChildViews()[2].getChildViews()[0].getChildViews()[3].getChildViews()[0],o=t.getSelectedItem().id_spr,n={};n.th=i,n.command="?setLnk",n.sh_prc=e,n.id_spr=o,n.type="async",n.callback=u.delPrc,i.popconfirm.show("Связать?",n)}},{view:"button",type:"htmlbutton",id:"_left",hidden:!0,label:"<span class='webix_icon fa-angle-left'></span><span style='line-height: 20px;'>Ctrl+</span><span class='webix_icon fa-arrow-down'></span>",width:90,hotkey:"down+ctrl",click:function(){var e=$$("prcs_dc").getCursor(),t=$$("prcs_dc").data.order,o=void 0;t.forEach(function(t,i,n){t===e&&(o=i)}),o-=1,o<0&&(o=$$("prcs_dc").count()-1),e=$$("prcs_dc").data.order[+o],$$("prcs_dc").setCursor(e),Object(u.parse_unlinked_item)(i)}},{view:"button",type:"htmlbutton",id:"_skip",hidden:!0,label:"Пропустить (Ctrl+M)",width:160,hotkey:"m+ctrl",click:function(){var e=u.prcs.getItem(u.prcs.getCursor()).sh_prc,t={};t.th=i,t.command="?skipLnk",t.sh_prc=e,t.type="async",t.callback=u.delPrc,i.popconfirm.show("Пропустить?",t)}},{view:"button",type:"htmlbutton",id:"_right",hidden:!0,label:"<span style='line-height: 20px;'>Ctrl+</span><span class='webix_icon fa-arrow-up'></span><span class='webix_icon fa-angle-right'></span>",width:90,hotkey:"up+ctrl",click:function(){var e=$$("prcs_dc").getCursor(),t=$$("prcs_dc").data.order,o=void 0;t.forEach(function(t,i,n){t===e&&(o=i)}),o+=1,o===$$("prcs_dc").count()-1&&(o=0),e=$$("prcs_dc").data.order[+o],$$("prcs_dc").setCursor(e),Object(u.parse_unlinked_item)(i)}},(t={view:"button",type:"htmlbutton",hidden:!1,localId:"sideButton",label:document.documentElement.clientWidth>1200?"<span class='webix_icon fa-caret-left'></span>":"<span class='webix_icon fa-caret-down'></span>",width:40,formOpen:!1},t.hidden=!1,t.on={onItemClick:function(){var e=this.$scope.getParentView().getRoot().getChildViews()[0].getChildViews()[1].getChildViews()[2].getChildViews()[0].getChildViews()[3],t=e.getChildViews()[0];if(this.config.formOpen)this.define({label:document.documentElement.clientWidth>1200?"<span class='webix_icon fa-caret-left'></span>":"<span class='webix_icon fa-caret-down'></span>",formOpen:!1}),this.$scope.sideForm.hide_f();else{this.define({label:document.documentElement.clientWidth>1200?"<span class='webix_icon fa-caret-right'></span>":"<span class='webix_icon fa-caret-up'></span>",formOpen:!0}),this.$scope.sideForm.show_f();var i=t?t.getSelectedItem():void 0;i&&(i=i.id_spr,i=Object(u.get_spr)(t.$scope,i),i.s_name="Страна: "+i.c_strana,i.t_name="Название товара: "+i.c_tovar,i.v_name="Производитель: "+i.c_zavod,i.dv_name="Действующее вещество: "+i.c_dv,this.$scope.sideForm.parse_f("Редактирование записи "+i.id_spr,$$("_spr_search"),i))}this.refresh()}},t)]},{$subview:d.default,name:"spr_dt"}]},r={view:"tabbar",popupWidth:170,tabMinWidth:170,tabMoreWidth:70,animate:!1,multiview:!0,on:{onOptionRemove:function(e){$$(e).destructor()}},options:[{value:"<span style='line-height: 20px;'> Линкер</span>",id:"app-nav",close:!1,width:172}]},s={view:"multiview",animate:!1,cells:[n]};return{cols:[{view:"toolbar",localId:"sideMenu",css:"header",width:o.config.expert?44:140,rows:[{view:"button",css:"butt",type:"htmlbutton",tooltip:"Широкая/узкая панель",height:30,align:"left",label:"<span class='webix_icon fa-bars', style='color: #3498db'></span>",width:40,on:{onItemClick:function(){o.config.expert?(o.config.expert=!1,this.$scope.$$("sideMenu").define({width:140}),this.$scope.$$("sideMenu").resize(),this.$scope.$$("_settings").define({width:136,label:"<span class='webix_icon fa-cogs', style='color: #3498db'></span><span style='line-height: 20px; color: #3498db'>       Настройки</span>"}),this.$scope.$$("_settings").refresh(),this.$scope.$$("_settings").resize(),this.$scope.$$("_adm").define({width:136,label:"<span class='webix_icon fa-blind', style='color: #3498db'></span><span style='line-height: 20px; color: #3498db'>  Админка</span>"}),this.$scope.$$("_adm").refresh(),this.$scope.$$("_adm").resize(),this.$scope.$$("_skipped").define({width:136,label:"<span class='webix_icon fa-archive', style='color: #3498db'></span><span style='line-height: 20px; color: #3498db'> Пропущенные</span>"}),this.$scope.$$("_skipped").refresh(),this.$scope.$$("_skipped").resize(),this.$scope.$$("_unlinked").define({width:136,label:"<span class='webix_icon fa-unlink', style='color: #3498db'></span><span style='line-height: 20px; color: #3498db'> Несвязанные</span>"}),this.$scope.$$("_unlinked").refresh(),this.$scope.$$("_unlinked").resize(),this.$scope.$$("_links").define({width:136,label:"<span class='webix_icon fa-stumbleupon', style='color: #3498db'></span><span style='line-height: 20px; color: #3498db'> Связки</span>"}),this.$scope.$$("_links").refresh(),this.$scope.$$("_links").resize()):(o.config.expert=!0,this.$scope.$$("sideMenu").define({width:44}),this.$scope.$$("sideMenu").resize(),this.$scope.$$("_settings").define({width:40,label:"<span class='webix_icon fa-cogs', style='color: #3498db'>"}),this.$scope.$$("_settings").refresh(),this.$scope.$$("_settings").resize(),this.$scope.$$("_adm").define({width:40,label:"<span class='webix_icon fa-blind', style='color: #3498db'></span>"}),this.$scope.$$("_adm").refresh(),this.$scope.$$("_adm").resize(),this.$scope.$$("_skipped").define({width:40,label:"<span class='webix_icon fa-archive', style='color: #3498db'></span>"}),this.$scope.$$("_skipped").refresh(),this.$scope.$$("_skipped").resize(),this.$scope.$$("_unlinked").define({width:40,label:"<span class='webix_icon fa-unlink', style='color: #3498db'></span>"}),this.$scope.$$("_unlinked").refresh(),this.$scope.$$("_unlinked").resize(),this.$scope.$$("_links").define({width:40,label:"<span class='webix_icon fa-stumbleupon', style='color: #3498db'></span>"}),this.$scope.$$("_links").refresh(),this.$scope.$$("_links").resize())}}},{view:"button",css:"butt",type:"htmlbutton",tooltip:"Персональные настройки",height:40,localId:"_settings",longPress:!1,label:"<span class='webix_icon fa-cogs', style='color: #3498db'></span>",width:40,on:{onAfterRender:function(){var e=this,t=this.getNode();t.onmousedown=function(){e.interval=setInterval(function(){e.config.longPress=!0},o.config.popDelay),t.onmouseup=function(){clearInterval(e.interval)}}},onItemClick:function(e,t){var i=this;webix.html.addCss(this.$view,"bounceIn animated"),setTimeout(function(){webix.html.removeCss(i.$view,"bounceIn animated")},900);this.$scope.getRoot().getTopParentView().getChildViews()[1].getChildViews()[0].getChildViews()[1];webix.message({type:"debug",text:"Будут персональные настройки пользователя"}),this.config.longPress?webix.message({type:"error",text:"LongPress"}):webix.message({type:"info",text:"ShortPress"}),this.config.longTouch=!1}}},{view:"button",css:"butt",type:"htmlbutton",tooltip:"Админка",height:40,maxWidth:40,b_id:void 0,longPress:!1,label:"<span class='webix_icon fa-blind', style='color: #3498db'></span>",width:40,localId:"_adm",hidden:!o.config.roles[o.config.role].adm,on:{onAfterRender:function(){var t=this,i=this.getNode();i.onmousedown=function(){t.interval=setInterval(function(){t.config.longPress=!0,e(t,g.default),clearInterval(t.interval)},o.config.popDelay),i.onmouseup=function(){clearInterval(t.interval)}}},onItemClick:function(){var t=this,i=this.$scope.getRoot().getTopParentView().getChildViews()[1].getChildViews()[0].getChildViews()[1],o=$$(this.config.b_id);this.config.longPress||(o?(webix.html.addCss(this.$view,"bounceIn animated"),setTimeout(function(){webix.html.removeCss(t.$view,"bounceIn animated")},900),i.getChildViews()[1].setValue(this.config.b_id)):e(this,g.default)),this.config.longPress=!1}}},{view:"button",type:"htmlbutton",tooltip:"Пропущенные",height:40,localId:"_skipped",b_id:void 0,longPress:!1,label:"<span class='webix_icon fa-archive', style='color: #3498db'></span>",width:40,hidden:!o.config.roles[o.config.role].skipped,on:{onAfterRender:function(){var t=this,i=this.getNode();i.onmousedown=function(){t.interval=setInterval(function(){t.config.longPress=!0,e(t,f.default),clearInterval(t.interval)},o.config.popDelay),i.onmouseup=function(){clearInterval(t.interval)}}},onItemClick:function(){var t=this,i=this.$scope.getRoot().getTopParentView().getChildViews()[1].getChildViews()[0].getChildViews()[1],o=$$(this.config.b_id);this.config.longPress||(o?(webix.html.addCss(this.$view,"bounceIn animated"),setTimeout(function(){webix.html.removeCss(t.$view,"bounceIn animated")},900),i.getChildViews()[1].setValue(this.config.b_id)):e(this,f.default)),this.config.longPress=!1}}},{view:"button",type:"htmlbutton",tooltip:"Несвязанные",height:40,localId:"_unlinked",b_id:void 0,longPress:!1,label:"<span class='webix_icon fa-unlink', style='color: #3498db'></span>",width:40,on:{onAfterRender:function(){var t=this,i=this.getNode();i.onmousedown=function(){t.interval=setInterval(function(){t.config.longPress=!0,e(t,h.default),clearInterval(t.interval)},o.config.popDelay),i.onmouseup=function(){clearInterval(t.interval)}}},onItemClick:function(){var t=this,i=this.$scope.getRoot().getTopParentView().getChildViews()[1].getChildViews()[0].getChildViews()[1],o=$$(this.config.b_id);this.config.longPress||(o?(webix.html.addCss(this.$view,"bounceIn animated"),setTimeout(function(){webix.html.removeCss(t.$view,"bounceIn animated")},900),i.getChildViews()[1].setValue(this.config.b_id)):e(this,h.default)),this.config.longPress=!1}}},{view:"button",type:"htmlbutton",tooltip:"Связки",height:40,localId:"_links",b_id:void 0,longPress:!1,label:"<span class='webix_icon fa-stumbleupon', style='color: #3498db'></span>",width:40,on:{onAfterRender:function(){var t=this,i=this.getNode();i.onmousedown=function(){t.interval=setInterval(function(){t.config.longPress=!0,e(t,_.default),clearInterval(t.interval)},o.config.popDelay),i.onmouseup=function(){clearInterval(t.interval)}}},onItemClick:function(){var t=this,i=this.$scope.getRoot().getTopParentView().getChildViews()[1].getChildViews()[0].getChildViews()[1],o=$$(this.config.b_id);this.config.longPress||(o?(webix.html.addCss(this.$view,"bounceIn animated"),setTimeout(function(){webix.html.removeCss(t.$view,"bounceIn animated")},900),i.getChildViews()[1].setValue(this.config.b_id)):e(this,_.default)),this.config.longPress=!1}}},{}]},{rows:[{height:1},r,s]}]}},t.prototype.init=function(){2==+$$("_link_by").getValue()?Object(u.get_suppl)("_suppl",this,"?getDatesUnlnk"):3==+$$("_link_by").getValue()?Object(u.get_suppl)("_suppl",this,"?getSourceUnlnk"):Object(u.get_suppl)("_suppl",this,"?getSupplUnlnk"),this.sideForm=this.ui(b.default),this.popconfirm=this.ui(l.default),this.popnew=this.ui(c.default),this.popunlink=this.ui(p.default),this.pophistory=this.ui(a.default)},t}(s.c);t.default=w},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=i(0),c=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this,t={view:"datatable",localId:"__table",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,old_stri:"",columns:[{id:"id_tovar",width:120,sort:"int",header:[{text:"ID поставщика"}]},{id:"c_tovar",fillspace:1,sort:"text",header:[{text:"Название"}]},{id:"c_zavod",sort:"text",width:300,header:[{text:"Производитель"}]}],on:{onItemDblClick:function(t){$$("prcs_dc").setCursor(t.row),Object(a.parse_unlinked_item)(e),e.getRoot().hide()},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")},onBeforeSelect:function(){}}};return{view:"cWindow",width:.8*document.documentElement.clientWidth,height:.8*document.documentElement.clientHeight,modal:!0,on:{onShow:function(){this.$scope.$$("__table").clearAll(),this.$scope.$$("__table").parse($$("prcs_dc"))}},body:t}},t.prototype.show=function(e){this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show()},t.prototype.hide=function(){this.getRoot().hide()},t}(s.c);t.default=c},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=i(4),c=i(0),l=i(2),u=(i(12),function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){function e(e){return 0!=+e.id_dv?"<div> <span class='green'>есть</span></div>":"<div> <span class='red'>нет</span></div>"}function t(e){return e.c_mandat?"<div><span class='webix_icon fa-check-circle'></span></div>":"<div><span></span></div>"}function i(e){return e.c_prescr?"<div><span class='webix_icon fa-check-circle'></span></div>":"<div><span></span></div>"}var o=this,n=(this.app,function(){var e=o.getRoot().getChildViews()[1].$scope.$$("__page").getValue();o.getRoot().getChildViews()[1].$scope.$$("__page").setValue(0==+e?"1":"0"),o.getRoot().getChildViews()[1].$scope.$$("__page").refresh()});return{view:"layout",rows:[{view:"datatable",subview:{template:"возможно здесь будет карточка товара для редактирования",height:40},name:"__dt",localId:"__table",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:{autowidth:!0},startPos:1,posPpage:20,totalPos:0,fi:"c_tovar",di:"asc",old_stri:"",searchBar:"_spr_search",searchMethod:"getSprSearch",columns:[{id:"id_mnn",width:75,template:e,header:[{text:"МНН"}]},{id:"id_spr",width:80,sort:"server",header:[{text:"IDSPR"}],headermenu:!1},{id:"c_tovar",fillspace:1,sort:"server",header:[{text:"Название"}],headermenu:!1},{id:"id_zavod",sort:"server",width:300,header:[{text:"Производитель"}]},{id:"id_strana",width:200,header:[{text:"Страна"}]},{id:"c_dv",hidden:!0,width:150,header:[{text:"Д. в-во"}]},{id:"c_group",hidden:!0,width:150,header:[{text:"Группа"}]},{id:"c_nds",hidden:!0,width:150,header:[{text:"НДС"}]},{id:"c_hran",hidden:!0,width:150,header:[{text:"Условия хранения"}]},{id:"c_sezon",hidden:!0,width:150,header:[{text:"Сезонность"}]},{id:"mandat",width:100,template:t,hidden:!0,css:"col_center",header:[{text:"Обязательный"}]},{id:"prescr",width:100,template:i,hidden:!0,css:"col_center",header:[{text:"Рецептурный"}]}],on:{"data->onParse":function(e,t){this.clearAll(),$$("_link").hide()},onBeforeSort:function(e,t){o.$$("__table").config.fi=e,o.$$("__table").config.di=t,n()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onItemDblClick:function(e){this.$scope.getRoot().getParentView().$scope.$$("sideButton").config.formOpen||(e=this.getSelectedItem(),e=e.id_spr,e=Object(c.get_spr)(this.$scope,e),e.s_name="Страна: "+e.c_strana,e.t_name="Название товара: "+e.c_tovar,e.v_name="Производитель: "+e.c_zavod,e.dv_name="Действующее вещество: "+e.c_dv,this.$scope.popnew.show("Редактирование записи "+e.id_spr,$$("_spr_search"),e))},onAfterLoad:function(){this.hideProgress()},onAfterSelect:function(){if(this.$scope.getRoot().getParentView().$scope.$$("sideButton").config.formOpen){var e=this.$scope.$$("__table").getSelectedItem();e=e.id_spr,e=Object(c.get_spr)(this.$scope,e),e.s_name="Страна: "+e.c_strana,e.t_name="Название товара: "+e.c_tovar,e.v_name="Производитель: "+e.c_zavod,e.dv_name="Действующее вещество: "+e.c_dv,this.$scope.getParentView().sideForm.parse_f("Редактирование записи "+e.id_spr,$$("_spr_search"),e)}$$("prcs_dc").count()>0&&$$("_link").show()},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}},{$subview:l.default}]}},t.prototype.init=function(){this.popnew=this.ui(a.default)},t}(s.c));t.default=u},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=i(0),c=i(7),l=i(2),u=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this,t=this.app,i=this,o=function(){var t=e.$$("__table").getSelectedId();e.$$("__table").remove(t)};webix.ui.datafilter.customFilterSkip=Object.create(webix.ui.datafilter.textFilter),webix.ui.datafilter.customFilterSkip.on_key_down=function(e,i,o){var n=this._comp_id,r=webix.$$(n);9!=(e.which||e.keyCode)&&Object(a.checkKey)(e.keyCode)&&(this._filter_timer&&window.clearTimeout(this._filter_timer),this._filter_timer=window.setTimeout(function(){var e=r.getParentView().getChildViews()[2].$scope.$$("__page").getValue();r.getParentView().getChildViews()[2].$scope.$$("__page").setValue(0==+e?"1":"0"),r.getParentView().getChildViews()[2].$scope.$$("__page").refresh()},t.config.searchDelay))},webix.ui.datafilter.customFilterSkip.refresh=a.fRefresh,webix.ui.datafilter.customFilterSkip.render=a.fRender;var n={view:"datatable",name:"__dt_s",localId:"__table",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:{autowidth:!0},startPos:1,posPpage:20,totalPos:1250,old_stri:" ",searchBar:void 0,searchMethod:"getPrcsSkip",fi:"c_tovar",di:"asc",columns:[{id:"id_tovar",width:80,hidden:!0,header:[{text:"ID товара"}]},{id:"c_tovar",fillspace:1,sort:"server",headermenu:!1,header:[{text:"Название"},{content:"customFilterSkip"}]},{id:"c_vnd",sort:"server",width:200,header:[{text:"Поставщик"},{content:"customFilterSkip"}]},{id:"c_zavod",sort:"server",width:200,header:[{text:"Производитель"},{content:"customFilterSkip"}]},{id:"dt",width:200,sort:"server",format:a.dt_formating_sec,css:"center_p",header:[{text:"Дата изменения"},{content:"dateRangeFilter",compare:a.compareTrue,inputConfig:{format:a.dt_formating,width:180},suggest:{view:"daterangesuggest",body:{timepicker:!1,calendarCount:2}}}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onBeforeSort:function(t,o){e.$$("__table").config.fi=t,e.$$("__table").config.di=o;var n=i.getRoot().getChildViews()[2].$scope.$$("__page").getValue();i.getRoot().getChildViews()[2].$scope.$$("__page").setValue(0==+n?"1":"0"),i.getRoot().getChildViews()[2].$scope.$$("__page").refresh()},onItemDblClick:function(e){var t=(this.$scope.app.config.user,this.$scope.app);if(t.config.roles[t.config.role].adm){var i=this.getSelectedItem().sh_prc,n={};n.command="?returnLnk",n.sh_prc=i,n.type="async",n.callback=o,this.$scope.popconfirm.show("Вернуть на сведение?",n)}},onKeyPress:function(e,t){13===e&&this.getSelectedItem()&&this.callEvent("onItemDblClick")},onAfterLoad:function(){this.hideProgress()}}};return{view:"layout",type:"clean",rows:[{view:"toolbar",css:{"border-top":"0px"},height:40,cols:[{},{view:"button",type:"htmlbutton",tooltip:"Обновить",label:"<span class='webix_icon fa-refresh'></span>",width:40,click:function(){e.$$("__table").callEvent("onBeforeSort")}},{view:"button",tooltip:"Сбросить фильтры",type:"imageButton",image:"./addons/img/unfilter.svg",width:40,click:function(){var t=e.$$("__table");t.config.columns.forEach(function(e){if(t.isColumnVisible(e.id)&&e.header[1])if("function"==typeof t.getFilter(e.id).setValue)t.getFilter(e.id).setValue("");else{var i=t.getFilter(e.id);i.readOnly||(i.value="")}}),e.$$("__table").callEvent("onBeforeSort")}}]},n,{$subview:l.default}]}},t.prototype.ready=function(){var e=this.getRoot().getChildViews()[2].$scope.$$("__page").getValue();this.getRoot().getChildViews()[2].$scope.$$("__page").setValue(0==+e?"1":"0"),this.getRoot().getChildViews()[2].$scope.$$("__page").refresh();var t=this,i=webix.$$(this.$$("__table").getColumnConfig("dt").header[1].suggest.body.id);i.getChildViews()[1].getChildViews()[1].setValue("Применить"),i.getChildViews()[1].getChildViews()[1].define("click",function(){this._filter_timer&&window.clearTimeout(this._filter_timer),this._filter_timer=window.setTimeout(function(){var e=t.getRoot().getChildViews()[2].$scope,i=e.$$("__page").getValue();e.$$("__page").setValue(0==+i?"1":"0"),e.$$("__page").refresh()},webix.ui.datafilter.textWaitDelay),this.getParentView().getParentView().hide()})},t.prototype.init=function(){this.popconfirm=this.ui(c.default)},t}(s.c);t.default=u},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=i(0),c=i(2),l=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this,t=this.app,i=this;webix.ui.datafilter.customFilterUnlnk=Object.create(webix.ui.datafilter.textFilter),webix.ui.datafilter.customFilterUnlnk.on_key_down=function(e,i,o){var n=this._comp_id,r=webix.$$(n);9!=(e.which||e.keyCode)&&Object(a.checkKey)(e.keyCode)&&(this._filter_ti&&window.clearTimeout(this._filter_ti),this._filter_ti=window.setTimeout(function(){var e=r.getParentView().getChildViews()[2].$scope.$$("__page").getValue();r.getParentView().getChildViews()[2].$scope.$$("__page").setValue(0==+e?"1":"0"),r.getParentView().getChildViews()[2].$scope.$$("__page").refresh()},t.config.searchDelay))},webix.ui.datafilter.customFilterUnlnk.refresh=a.fRefresh,webix.ui.datafilter.customFilterUnlnk.render=a.fRender,webix.ui.datafilter.richFilt=Object.create(webix.ui.datafilter.richSelectFilter),webix.ui.datafilter.richFilt.refresh=a.rRefresh,webix.ui.datafilter.richFilt.render=function(e,i){if(!i.richselect){var o=webix.html.create("div",{class:"webix_richfilter"}),n={container:o,view:this.inputtype,options:[]},r=webix.extend(this.inputConfig||{},i.inputConfig||{},!0);webix.extend(n,r,!0),i.separator&&(n.separator=i.separator),i.suggest&&(n.suggest=i.suggest);var s=webix.ui(n);s.attachEvent("onChange",function(){var i=e.config.id,o=webix.$$(i);this._filter_timer&&window.clearTimeout(this._filter_timer),this._filter_timer=window.setTimeout(function(){var e=o.getParentView().getChildViews()[2].$scope.$$("__page").getValue();o.getParentView().getChildViews()[2].$scope.$$("__page").setValue(0==+e?"1":"0"),o.getParentView().getChildViews()[2].$scope.$$("__page").refresh()},t.config.searchDelay)}),i.richselect=s.config.id}return i.css="webix_div_filter"," "};var o=[{id:0,value:"Пользователь"},{id:9,value:"Сводильщик"},{id:10,value:"Админ"},{id:34,value:"Суперадмин"},{id:100,value:"?"}],n={view:"datatable",name:"__dt_a",localId:"__table",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:{autowidth:!0},startPos:1,posPpage:20,totalPos:0,fi:"c_tovar",di:"asc",searchBar:void 0,searchMethod:"getPrcsAll",old_stri:" ",columns:[{id:"id_tovar",width:80,hidden:!0,header:[{text:"ID товара"}]},{id:"c_tovar",fillspace:1,sort:"server",headermenu:!1,header:[{text:"Название"},{content:"customFilterUnlnk"}]},{id:"c_vnd",sort:"server",width:200,header:[{text:"Поставщик"},{content:"customFilterUnlnk"}]},{id:"c_zavod",sort:"server",width:200,header:[{text:"Производитель"},{content:"customFilterUnlnk"}]},{id:"c_user",sort:"server",width:160,header:[{text:"Группа пользователей"},{content:"richFilt",compare:a.compareTrue,inputConfig:{options:o}}]},{id:"dt",width:200,sort:"server",format:a.dt_formating_sec,css:"center_p",header:[{text:"Дата добавления"},{content:"dateRangeFilter",compare:a.compareTrue,inputConfig:{format:a.dt_formating,width:180},suggest:{view:"daterangesuggest",body:{timepicker:!1,calendarCount:2}}}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onBeforeSort:function(t,o){e.$$("__table").config.fi=t,e.$$("__table").config.di=o;var n=i.getRoot().getChildViews()[2].$scope.$$("__page").getValue();i.getRoot().getChildViews()[2].$scope.$$("__page").setValue(0==+n?"1":"0"),i.getRoot().getChildViews()[2].$scope.$$("__page").refresh()},onItemDblClick:function(){var i=e.$$("__table").getSelectedItem();1==+$$("_link_by").getValue()?t.config.roles[t.config.role].lnkdel||i.c_user===e.app.config.user?($$("_suppl").config.state=!0,Object(a.parseToLink)(i),setTimeout(function(){e.getRoot().getTopParentView().getChildViews()[1].getChildViews()[0].getChildViews()[1].getChildViews()[1].setValue("app-nav")},300)):webix.message({text:"Упс. Нет доступа.",type:"debug"}):webix.message({text:"Выберите в параметрах сведение по поставщикам",type:"debug"})},onKeyPress:function(e,t){13===e&&this.getSelectedItem()&&this.callEvent("onItemDblClick")},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(){}}};return{view:"layout",type:"clean",rows:[{view:"toolbar",css:{"border-top":"0px"},height:40,cols:[{view:"label",template:"Для ускорения ограничивайте поиск названием"},{view:"button",type:"htmlbutton",tooltip:"Обновить",label:"<span class='webix_icon fa-refresh'></span>",width:40,click:function(){e.$$("__table").callEvent("onBeforeSort")}},{view:"button",tooltip:"Сбросить фильтры",type:"imageButton",image:"./addons/img/unfilter.svg",width:40,click:function(){var t=e.$$("__table");t.config.columns.forEach(function(e){if(t.isColumnVisible(e.id)&&e.header[1])if("function"==typeof t.getFilter(e.id).setValue)t.getFilter(e.id).setValue("");else{var i=t.getFilter(e.id);i.readOnly||(i.value="")}}),e.$$("__table").callEvent("onBeforeSort")}}]},n,{$subview:c.default}]}},t.prototype.ready=function(){var e=this.getRoot().getChildViews()[2].$scope.$$("__page").getValue();this.getRoot().getChildViews()[2].$scope.$$("__page").setValue(0==+e?"1":"0"),this.getRoot().getChildViews()[2].$scope.$$("__page").refresh();var t=this.app,i=this;this.$$("__table").isColumnVisible("c_user")&&(t.config.roles[t.config.role].lnkdel?this.$$("__table").getFilter("c_user").readOnly=!1:(this.$$("__table").getFilter("c_user").value=this.app.config.role,this.$$("__table").getFilter("c_user").readOnly=!0)),$$(this.$$("__table").getColumnConfig("dt").header[1].suggest.body.id).getChildViews()[1].getChildViews()[1].setValue("Применить"),$$(this.$$("__table").getColumnConfig("dt").header[1].suggest.body.id).getChildViews()[1].getChildViews()[1].define("click",function(){this._filter_timer&&window.clearTimeout(this._filter_timer),this._filter_timer=window.setTimeout(function(){var e=i.getRoot().getChildViews()[2].$scope,t=e.$$("__page").getValue();e.$$("__page").setValue(0==+t?"1":"0"),e.$$("__page").refresh()},webix.ui.datafilter.textWaitDelay),this.getParentView().getParentView().hide()})},t}(s.c);t.default=l},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=i(5),c=i(4),l=i(0),u=i(8),p=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this,t=function(){return e.getRoot().getChildViews()[2].getChildViews()[0]},i=function(){return e.getRoot().getChildViews()[2].getChildViews()[1]},o=function(){return e.getRoot().getChildViews()[2].getChildViews()[0].config.searchMethod};return{view:"layout",type:"clean",css:{"border-left":"1px solid #dddddd !important"},rows:[{view:"toolbar",css:{"border-top":"0px"},cols:[{view:"text",label:"",placeholder:"Строка поиска",height:40,fillspace:!0,localId:"_ls",on:{onKeyPress:function(e,n){var r=this;clearTimeout(this.config._keytimed),Object(l.checkKey)(e)&&(this.config._keytimed=setTimeout(function(){var e=t();if(e){var n=Object(l.getDtParams)(e);Object(l.get_data_test)({view:e,navBar:i(),start:1,count:n[1],searchBar:r.$scope.$$("_ls").config.id,method:o(),field:n[2],direction:n[3],filter:n[0]})}},this.$scope.app.config.searchDelay))}}},{view:"button",type:"htmlbutton",width:40,label:"<span class='webix_icon fa-history'></span><span style='line-height: 20px;'></span>",click:function(){var i=webix.storage.session.get(t().config.name);e.pophistory.show(i,e.$$("_ls"))}},{view:"checkbox",labelRight:"<span style='color: white'>Поиск по справочнику</span>",labelWidth:0,value:this.app.config.lch,width:150,localId:"_spr_ch",on:{onChange:function(){e.$$("_ls").setValue("");var t=e.$$("_spr_ch").getValue();e.getRoot().getParentView().getParentView().getChildViews()[1].config.options;0===t?e.app.config.lch=0:1===t&&(e.app.config.lch=1),e.show(1===e.app.config.lch?"links_form_spr":"links_form_lnk"),e.$$("_ls").callEvent("onKeyPress",[13])}}},{view:"button",width:40,tooltip:"Сбросить фильтры",type:"imageButton",image:"./addons/img/unfilter.svg",click:function(){var i=t();$$(i).config.columns.forEach(function(e){if(i.isColumnVisible(e.id)&&e.header[1])if("function"==typeof i.getFilter(e.id).setValue)i.getFilter(e.id).setValue("");else{var t=i.getFilter(e.id);t.readOnly||(t.value="")}}),e.$$("_ls").callEvent("onKeyPress",[13])}},{view:"button",type:"htmlbutton",hidden:!1,localId:"_br",label:"<span style='color: red', class='webix_icon fa-unlink'></span><span style='line-height: 20px;'>  Разорвать</span>",width:140,click:function(){t().callEvent("onItemDblClick")}}]},{height:1},{$subview:!0}]}},t.prototype.ready=function(){var e=(this.getRoot().getParentView().getParentView().getChildViews()[1].config.options,1===this.app.config.lch?"links_form_spr":"links_form_lnk");this.show(e),this.$$("_ls").callEvent("onKeyPress",[13])},t.prototype.init=function(){this.popnew=this.ui(c.default),this.popunlink=this.ui(u.default),this.pophistory=this.ui(a.default)},t}(s.c);t.default=p},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=i(0),c=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this.app.config.r_url+"?getVersion",t={user:this.app.config.user},i=Object(a.request)(e,t,!0).response;i=Object(a.checkVal)(i,"s");var o=i.info.prod?"Production":"test";return{view:"toolbar",css:"header",cols:[{view:"label",label:"Вы находитесь на сервере:  "+location.hostname+" | fv. "+this.app.config.version+" | bv. "+i.info.version+" | "+o,css:"ms-logo-text",height:36},{},{view:"button",type:"htmlbutton",width:32,label:"<span class='webix_icon fa-info', style='color: #666666;'></span>"}]}},t}(s.c);t.default=c},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=i(0),c=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this;this.app;return{view:"toolbar",css:"header",cols:[{view:"label",label:"<a href='http://ms71.org'><span class='ms-logo', style='background-image: url(addons/img/ms_logo.jpg);'></span></a>",width:44,align:"center",height:36},{view:"label",label:"Манускрипт солюшн: Линкер | "+this.app.config.user,css:"ms-logo-text",height:36,width:550},{},{view:"button",css:"butt",type:"htmlbutton",tooltip:"Выход",label:"<span class='webix_icon fa-sign-out', style='color: #3498db'></span>",width:40,on:{onItemClick:function(){Object(a.deleteCookie)("linker_user"),Object(a.deleteCookie)("linker_auth_key"),Object(a.deleteCookie)("linker_role"),e.app.config.user="",e.app.config.role="0",e.app.config.x_api="x_login",e.show("/login")}}}]}},t}(s.c);t.default=c},function(e,t,i){var o;"function"==typeof Symbol&&Symbol.iterator;!function(n){"use strict";function r(e,t){var i=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(i>>16)<<16|65535&i}function s(e,t){return e<<t|e>>>32-t}function a(e,t,i,o,n,a){return r(s(r(r(t,e),r(o,a)),n),i)}function c(e,t,i,o,n,r,s){return a(t&i|~t&o,e,t,n,r,s)}function l(e,t,i,o,n,r,s){return a(t&o|i&~o,e,t,n,r,s)}function u(e,t,i,o,n,r,s){return a(t^i^o,e,t,n,r,s)}function p(e,t,i,o,n,r,s){return a(i^(t|~o),e,t,n,r,s)}function d(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;var i,o,n,s,a,d=1732584193,f=-271733879,h=-1732584194,_=271733878;for(i=0;i<e.length;i+=16)o=d,n=f,s=h,a=_,d=c(d,f,h,_,e[i],7,-680876936),_=c(_,d,f,h,e[i+1],12,-389564586),h=c(h,_,d,f,e[i+2],17,606105819),f=c(f,h,_,d,e[i+3],22,-1044525330),d=c(d,f,h,_,e[i+4],7,-176418897),_=c(_,d,f,h,e[i+5],12,1200080426),h=c(h,_,d,f,e[i+6],17,-1473231341),f=c(f,h,_,d,e[i+7],22,-45705983),d=c(d,f,h,_,e[i+8],7,1770035416),_=c(_,d,f,h,e[i+9],12,-1958414417),h=c(h,_,d,f,e[i+10],17,-42063),f=c(f,h,_,d,e[i+11],22,-1990404162),d=c(d,f,h,_,e[i+12],7,1804603682),_=c(_,d,f,h,e[i+13],12,-40341101),h=c(h,_,d,f,e[i+14],17,-1502002290),f=c(f,h,_,d,e[i+15],22,1236535329),d=l(d,f,h,_,e[i+1],5,-165796510),_=l(_,d,f,h,e[i+6],9,-1069501632),h=l(h,_,d,f,e[i+11],14,643717713),f=l(f,h,_,d,e[i],20,-373897302),d=l(d,f,h,_,e[i+5],5,-701558691),_=l(_,d,f,h,e[i+10],9,38016083),h=l(h,_,d,f,e[i+15],14,-660478335),f=l(f,h,_,d,e[i+4],20,-405537848),d=l(d,f,h,_,e[i+9],5,568446438),_=l(_,d,f,h,e[i+14],9,-1019803690),h=l(h,_,d,f,e[i+3],14,-187363961),f=l(f,h,_,d,e[i+8],20,1163531501),d=l(d,f,h,_,e[i+13],5,-1444681467),_=l(_,d,f,h,e[i+2],9,-51403784),h=l(h,_,d,f,e[i+7],14,1735328473),f=l(f,h,_,d,e[i+12],20,-1926607734),d=u(d,f,h,_,e[i+5],4,-378558),_=u(_,d,f,h,e[i+8],11,-2022574463),h=u(h,_,d,f,e[i+11],16,1839030562),f=u(f,h,_,d,e[i+14],23,-35309556),d=u(d,f,h,_,e[i+1],4,-1530992060),_=u(_,d,f,h,e[i+4],11,1272893353),h=u(h,_,d,f,e[i+7],16,-155497632),f=u(f,h,_,d,e[i+10],23,-1094730640),d=u(d,f,h,_,e[i+13],4,681279174),_=u(_,d,f,h,e[i],11,-358537222),h=u(h,_,d,f,e[i+3],16,-722521979),f=u(f,h,_,d,e[i+6],23,76029189),d=u(d,f,h,_,e[i+9],4,-640364487),_=u(_,d,f,h,e[i+12],11,-421815835),h=u(h,_,d,f,e[i+15],16,530742520),f=u(f,h,_,d,e[i+2],23,-995338651),d=p(d,f,h,_,e[i],6,-198630844),_=p(_,d,f,h,e[i+7],10,1126891415),h=p(h,_,d,f,e[i+14],15,-1416354905),f=p(f,h,_,d,e[i+5],21,-57434055),d=p(d,f,h,_,e[i+12],6,1700485571),_=p(_,d,f,h,e[i+3],10,-1894986606),h=p(h,_,d,f,e[i+10],15,-1051523),f=p(f,h,_,d,e[i+1],21,-2054922799),d=p(d,f,h,_,e[i+8],6,1873313359),_=p(_,d,f,h,e[i+15],10,-30611744),h=p(h,_,d,f,e[i+6],15,-1560198380),f=p(f,h,_,d,e[i+13],21,1309151649),d=p(d,f,h,_,e[i+4],6,-145523070),_=p(_,d,f,h,e[i+11],10,-1120210379),h=p(h,_,d,f,e[i+2],15,718787259),f=p(f,h,_,d,e[i+9],21,-343485551),d=r(d,o),f=r(f,n),h=r(h,s),_=r(_,a);return[d,f,h,_]}function f(e){var t,i="",o=32*e.length;for(t=0;t<o;t+=8)i+=String.fromCharCode(e[t>>5]>>>t%32&255);return i}function h(e){var t,i=[];for(i[(e.length>>2)-1]=void 0,t=0;t<i.length;t+=1)i[t]=0;var o=8*e.length;for(t=0;t<o;t+=8)i[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return i}function _(e){return f(d(h(e),8*e.length))}function g(e,t){var i,o,n=h(e),r=[],s=[];for(r[15]=s[15]=void 0,n.length>16&&(n=d(n,8*e.length)),i=0;i<16;i+=1)r[i]=909522486^n[i],s[i]=1549556828^n[i];return o=d(r.concat(h(t)),512+8*t.length),f(d(s.concat(o),640))}function b(e){var t,i,o="0123456789abcdef",n="";for(i=0;i<e.length;i+=1)t=e.charCodeAt(i),n+=o.charAt(t>>>4&15)+o.charAt(15&t);return n}function w(e){return unescape(encodeURIComponent(e))}function v(e){return _(w(e))}function $(e){return b(v(e))}function y(e,t){return g(w(e),w(t))}function m(e,t){return b(y(e,t))}function x(e,t,i){return t?i?y(t,e):m(t,e):i?v(e):$(e)}void 0!==(o=function(){return x}.call(t,i,t,e))&&(e.exports=o)}()},function(e,t){webix.i18n.locales["ru-RU"]={groupDelimiter:" ",groupSize:3,decimalDelimiter:",",decimalSize:2,dateFormat:"%d.%m.%Y",timeFormat:"%H:%i",longDateFormat:"%d %F %Y",fullDateFormat:"%d.%m.%Y %H:%i",price:"{obj} руб.",priceSettings:null,calendar:{monthFull:["Январь","Февраль","Март","Апрель","Maй","Июнь","Июль","Август","Сентябрь","Oктябрь","Ноябрь","Декабрь"],monthShort:["Янв","Фев","Maр","Aпр","Maй","Июн","Июл","Aвг","Сен","Окт","Ноя","Дек"],dayFull:["Воскресенье","Понедельник","Вторник","Среда","Четверг","Пятница","Суббота"],dayShort:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],hours:"Часы",minutes:"Минуты",done:"Гoтовo",clear:"Очистить",today:"Сегодня"},controls:{select:"Выбрать",invalidMessage:"Неправильное значение"},dataExport:{page:"Страница",of:"из"},PDFviewer:{of:"из",automaticZoom:"Автоматический зум",actualSize:"Настоящий размер",pageFit:"Размер страницы",pageWidth:"Ширина страницы",pageHeight:"Высота страницы"},aria:{calendar:"Календарь",increaseValue:"Увеличить значение",decreaseValue:"Уменьшить значение",navMonth:["Предыдущий месяц","Следующий месяц"],navYear:["Предыдущий год","Следующий год"],navDecade:["Предыдущие десять лет","Следующие десять лет"],dateFormat:"%d %F %Y",monthFormat:"%F %Y",yearFormat:"%Y",hourFormat:"Часы: %H",minuteFormat:"Минуты: %i",removeItem:"Удалить элемент",pages:["Первая страница","Предыдущая страница","Следующая страница","Последняя страница"],page:"Страница",headermenu:"Меню шапки таблицы",openGroup:"Развернуть группу столбцов",closeGroup:"Свернуть группу столбцов",closeTab:"Закрыть вкладку",showTabs:"Показать больше вкладок",resetTreeMap:"Вернуться к первоначальному представлению",navTreeMap:"Перейти на уровень выше",nextTab:"Следующая вкладка",prevTab:"Предыдущая вкладка",multitextSection:"Добавить элемент",multitextextraSection:"Удалить элемент",showChart:"Показать чарт",hideChart:"Спрятать чарт",resizeChart:"Изменить размер чарта"},richtext:{underline:"Подчеркивание",bold:"Жирный",italic:"Курсив"}}},function(e,t,i){"use strict";i.d(t,"a",function(){return o});var o=function(){function e(){this.webixJet=!0,this._id=webix.uid(),this._events=[],this._subs={},this._data={}}return e.prototype.getRoot=function(){return this._root},e.prototype.destructor=function(){for(var e=this._events,t=e.length-1;t>=0;t--)e[t].obj.detachEvent(e[t].id);for(var i in this._subs){var o=this._subs[i].view;o&&o.destructor()}this._events=this._container=this.app=this._parent=null},e.prototype.setParam=function(e,t,i){this._data[e]!==t&&(this._data[e]=t,this.app.callEvent("app:paramchange",[this,e,t,i])&&i&&this.show((o={},o[e]=t,o)));var o},e.prototype.getParam=function(e,t){var i=this._data[e];if(void 0!==i||!t)return i;var o=this.getParentView();return o?o.getParam(e,t):void 0},e.prototype.getUrl=function(){return this._url},e.prototype.render=function(e,t,i){var o=this;this._parent=i,t&&(this._index=t[0].index),this._init_url_data(t),e=e||document.body;var n="string"==typeof e?webix.toNode(e):e;return this._container!==n?(this._container=n,this._render(t).then(function(){return o.getRoot()})):this._urlChange(t).then(function(){return o.getRoot()})},e.prototype.getIndex=function(){return this._index},e.prototype.getId=function(){return this._id},e.prototype.getParentView=function(){return this._parent},e.prototype.$$=function(e){if("string"==typeof e){var t=this.getRoot();return t.queryView(function(i){return(i.config.id===e||i.config.localId===e)&&i.$scope===t.$scope},"self")}return e},e.prototype.on=function(e,t,i){var o=e.attachEvent(t,i);return this._events.push({obj:e,id:o}),o},e.prototype.contains=function(e){for(var t in this._subs){var i=this._subs[t].view;if(i===e||i.contains(e))return!0}return!1},e.prototype.getSubView=function(e){var t=this.getSubViewInfo(e);if(t)return t.subview.view},e.prototype.getSubViewInfo=function(e){var t=this._subs[e||"default"];return t?{subview:t,parent:this}:this._parent?this._parent.getSubViewInfo(e):null},e.prototype.getName=function(){return this._name},e.prototype._init_url_data=function(e){e&&e[0]&&(this._data={},webix.extend(this._data,e[0].params,!0)),this._url=e},e}()},function(e,t,i){"use strict";function o(e){"/"===e[0]&&(e=e.substr(1));for(var t=e.split("/"),i=[],o=0;o<t.length;o++){var n=t[o],r={},s=n.indexOf(":");if(-1===s&&(s=n.indexOf("?")),-1!==s)for(var a=n.substr(s+1).split(/[\:\?\&]/g),c=0,l=a;c<l.length;c++){var u=l[c],p=u.split("=");r[p[0]]=decodeURIComponent(p[1])}i[o]={page:s>-1?n.substr(0,s):n,params:r,index:o+1}}return i}function n(e){for(var t=[],i=0,o=e;i<o.length;i++){var n=o[i];t.push("/"+n.page);var s=r(n.params);s&&t.push("?"+s)}return t.join("")}function r(e){var t=[];for(var i in e)t.length&&t.push("&"),t.push(i+"="+encodeURIComponent(e[i]));return t.join("")}t.a=o,t.b=n},function(e,t,i){"use strict";i.d(t,"a",function(){return r});var o=i(63),n=i.n(o),r=function(){function e(e,t){var i=this;this.config=t||{},this._prefix=this.config.routerPrefix,void 0===this._prefix&&(this._prefix="!");var o=function(e){};n()(this._prefix+"*",function(){return i._lastUrl="",o(i.get())}),o=e}return e.prototype.set=function(e,t){if(this.config.routes){var i=e.split("?",2);for(var o in this.config.routes)if(this.config.routes[o]===i[0]){e=o+(i.length>1?"?"+i[1]:"");break}}this._lastUrl=e,n.a.navigate(this._prefix+e,t)},e.prototype.get=function(){var e=this._lastUrl||(window.location.hash||"").replace("#"+this._prefix,"");if(this.config.routes){var t=e.split("?",2),i=this.config.routes[t[0]];i&&(e=i+(t.length>1?"?"+t[1]:""))}return e},e}()},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=i(0),c=i(9),l=i(2),u=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){function e(e){var t,i=e.item.$level,o=e.item,n=e.th,r=n.$scope.app.config.user,s=n.$scope.app.config.r_url+"?delBar";if(1===i)t={user:r,barcode:o.c_tovar,id_spr:void 0};else if(2===i){var c=n.getItem(o.$parent).c_tovar;t={user:r,barcode:c,id_spr:o.id_spr}}var l=Object(a.request)(s,t,!0).response;(l=Object(a.checkVal)(l,"s"))&&(1===i?n.remove(o.id):2===i&&(n.remove(o.id),0===n.getItem(o.$parent).$count&&n.remove(o.$parent)))}var t=this,i=(this.app,function(){var e=t.getRoot().getChildViews()[1].$scope.$$("__page").getValue();t.getRoot().getChildViews()[1].$scope.$$("__page").setValue(0==+e?"1":"0"),t.getRoot().getChildViews()[1].$scope.$$("__page").refresh()});return{view:"layout",type:"clean",css:{"border-left":"1px solid #dddddd !important"},rows:[{view:"treetable",name:"__dtdb",localId:"__table",startPos:1,posPpage:20,totalPos:1250,select:!0,resizeColumn:!0,borderless:!0,navigation:"row",rowHeight:32,fixedRowHeight:!1,rowLineHeight:32,headermenu:{autowidth:!0},editable:!1,old_stri:" ",fi:"c_tovar",di:"asc",searchBar:void 0,searchMethod:"getBarsSpr",columns:[{id:"c_tovar",header:"Товар",fillspace:!0,sort:"server",headermenu:!1,template:"<span>{common.treetable()} #c_tovar#</span>"},{id:"id_spr",width:150,header:[{text:"IDSPR"}]},{id:"id_state",width:150,header:[{text:"Статус"}]},{id:"dt",header:"Дата",width:160},{id:"owner",header:"Создал",width:120}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onBeforeSort:function(e,o){t.$$("__table").config.fi=e,t.$$("__table").config.di=o,i()},onItemDblClick:function(t){t=this.getSelectedItem();var i=t.$level,o={item:t,th:this},n={callback:e,params:o};2===i?this.$scope.popconfirm.show("Удалить товар из ШК?",n):1===i&&this.$scope.popconfirm.show("Удалить ШК со всеми товарами?",n)},onAfterLoad:function(){},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}},{$subview:l.default}]}},t.prototype.init=function(){this.popconfirm=this.ui(c.default)},t.prototype.ready=function(){this._search=this.getRoot().getParentView().$scope.$$("_sb"),this.$$("__table").config.searchBar=this._search.config.id,this._search.focus()},t}(s.c);t.default=u},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=i(0),c=i(6),l=i(9),u=i(2),p=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this,t=this.app,i=function(){var t=e.getRoot().getChildViews()[1].$scope.$$("__page").getValue();e.getRoot().getChildViews()[1].$scope.$$("__page").setValue(0==+t?"1":"0"),e.getRoot().getChildViews()[1].$scope.$$("__page").refresh()},o=function(t){var i=t.item,o=t.th,n=o.$scope.app.config.user,r=o.$scope.app.config.r_url+"?delBar",s={user:n,id_spr:i.$parent,barcode:i.barcode},c=Object(a.request)(r,s,!0).response;if(c=Object(a.checkVal)(c,"s")){o.remove(i.id);var l=e.$$("__table").getItem(i.$parent);l.count=l.$count>0?l.$count:"",e.$$("__table").refresh(i.$parent)}},n=function(i,o){var n=e.$$("__table"),r=t.config.user,s=t.config.r_url+"?setBar",c={user:r,id_spr:i,barcode:o},l=Object(a.request)(s,c,!0).response;if(l=Object(a.checkVal)(l,"s")){var u=n.isBranchOpen(i),p=(o.split(" "),n.data),d=[];p.each(function(e){2===e.$level&&e.$parent===i&&d.push(e.id)}),n.remove(d),s=n.$scope.app.config.r_url+"?getBar";Object(a.checkVal)(Object(a.request)(s,c,!0).response,"s").forEach(function(e,t,o){var r={barcode:e.barcode,id_state:"active",dt:e.dt,owner:"",count:""};n.add(r,0,i)}),u&&n.open(i);var f=e.$$("__table").getItem(i);f.count=f.$count>0?f.$count:"",e.$$("__table").refresh(i)}};return{view:"layout",type:"clean",css:{"border-left":"1px solid #dddddd !important"},rows:[{view:"treetable",localId:"__table",name:"__dtd",startPos:1,posPpage:20,totalPos:1250,select:!0,resizeColumn:!0,borderless:!0,navigation:"row",rowHeight:32,fixedRowHeight:!1,rowLineHeight:32,headermenu:{autowidth:!0},editable:!1,old_stri:" ",fi:"c_tovar",di:"asc",searchBar:void 0,searchMethod:"getSprBars",columns:[{id:"barcode",header:"Штрих-код",fillspace:!0,headermenu:!1,template:"<span>{common.treetable()} #barcode#</span><span style='color: red'> #count#</span>"},{id:"dt",header:"Дата изменения",width:200,format:a.dt_formating_sec,css:"center_p"},{id:"owner",header:"Изменил",width:120,hidden:!0}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onBeforeSort:function(t,o){e.$$("__table").config.fi=t,e.$$("__table").config.di=o,i()},onItemDblClick:function(){var e=this.getSelectedItem();if(t.config.roles[t.config.role].adm){var i=e.$level;if(1===i)this.$scope.popnewbar.show("Редактирование ШК: "+e.barcode,e.id,void 0,n);else if(2===i){var r={item:e,th:this},s={callback:o,params:r};this.$scope.popconfirm.show("Удалить ШК?",s)}}else webix.message({type:"error",text:"Редактирование запрещено"})},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}},{$subview:u.default}]}},t.prototype.init=function(){this.popnewbar=this.ui(c.default),this.popconfirm=this.ui(l.default)},t.prototype.ready=function(){this._search=this.getRoot().getParentView().$scope.$$("_sb"),this.$$("__table").config.searchBar=this._search.config.id,this._search.focus()},t}(s.c);t.default=p},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=(i(0),i(22)),c=i(24),l=i(25),u=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){this.app;return{view:"layout",css:{"border-left":"1px solid #dddddd !important"},rows:[{height:3},{view:"tabview",multiview:!0,cells:[{header:"<span class='webix_icon fa-code'></span><span style='line-height: 20px;'> Коды для сведения</span>",width:240,body:{view:"layout",rows:[{$subview:a.default}]}},{header:"<span class='webix_icon fa-exclamation-triangle '></span><span style='line-height: 20px;'> Слова исключения</span>",width:240,body:{view:"layout",rows:[{$subview:c.default}]}},{header:"<span class='webix_icon fa-file'></span><span style='line-height: 20px;'> Задания на сведении</span>",width:240,body:{view:"layout",rows:[{$subview:l.default}]}}]}]}},t}(s.c);t.default=u},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=(i(0),i(28)),c=i(17),l=i(29),u=i(18),p=i(16),d=i(20),f=i(21),h=i(27),_=i(30),g=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){this.app;return{view:"layout",type:"clean",rows:[{height:3},{view:"tabview",multiview:!0,cells:[{header:"<span style='line-height: 20px;'>Эталоны</span>",width:120,body:{view:"layout",rows:[{$subview:a.default}]}},{header:"<span style='line-height: 20px;'>Страны</span>",width:120,body:{view:"layout",rows:[{$subview:c.default}]}},{header:"<span style='line-height: 20px;'>Производители</span>",width:120,body:{view:"layout",rows:[{$subview:l.default}]}},{header:"<span style='line-height: 20px;'>ДВ</span>",width:120,body:{view:"layout",rows:[{$subview:u.default}]}},{header:"<span style='line-height: 20px;'>Штрихкоды</span>",width:120,body:{view:"layout",rows:[{$subview:p.default}]}},{header:"<span style='line-height: 20px;'>Группы</span>",width:120,body:{view:"layout",rows:[{$subview:d.default}]}},{header:"<span style='line-height: 20px;'>Условия хранения</span>",width:140,body:{view:"layout",rows:[{$subview:f.default}]}},{header:"<span style='line-height: 20px;'>НДС</span>",width:120,body:{view:"layout",rows:[{$subview:h.default}]}},{header:"<span style='line-height: 20px;'>Сезоны</span>",width:120,body:{view:"layout",rows:[{$subview:_.default}]}}]}]}},t}(s.c);t.default=g},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=i(31),c=i(0),l=i(32),u=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this,t=this.app,i={view:"datatable",localId:"__dtu",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,startPos:1,posPpage:20,totalPos:1250,old_stri:"",columns:[{id:"id",hidden:!0,width:75,header:[{text:"ID"}]},{id:"c_user",fillspace:1,sort:"text",header:[{text:"Пользователь"}],headermenu:!1},{id:"id_group",width:170,header:[{text:"Группа"}]},{id:"c_role",width:170,sort:"text",header:[{text:"Роль пользователя"}]},{id:"dt",hidden:!0,width:250,header:[{text:"Дата заведения"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onItemDblClick:function(e){e=this.getSelectedItem();var t=this.$scope.app.config.r_url+"?getUser",i={};i.id=e.id,i.user=this.$scope.app.user,e=Object(c.checkVal)(Object(c.request)(t,i,!0).response,"s"),this.$scope.popnewuser.show("Редактирование пользователя",e,this)},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(){t.config.roles[t.config.role].userdel&&e.$$("_del").show()},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}};return{view:"layout",css:{"border-left":"1px solid #dddddd !important"},rows:[{height:40,view:"toolbar",cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Строка поиска",keyPressTimeout:900,tooltip:"Поиск по пользователю",on:{onKeyPress:function(e,t){var i=this;clearTimeout(this.config._keytimed),Object(c.checkKey)(e)&&(this.config._keytimed=setTimeout(function(){var e=i.getValue().toString().toLowerCase();i.$scope.$$("__dtu").filter(function(t){return-1!=t.c_user.toString().toLowerCase().indexOf(e)})},this.$scope.app.config.searchDelay))}}},{view:"button",type:"htmlbutton",hidden:!t.config.roles[t.config.role].useradd,label:"<span class='webix_icon fa-user-plus'></span><span style='line-height: 20px;'> Добавить</span>",width:140,click:function(){e.popnewuser.show("Добавление пользователя")}},{view:"button",type:"htmlbutton",localId:"_del",hidden:!0,label:"<span class='webix_icon fa-user-times'></span><span style='line-height: 20px;'> Удалить</span>",width:140,click:function(){webix.message({text:"Удаление пользователя. Позже.",type:"debug"})}},{view:"button",type:"htmlbutton",hidden:!t.config.roles[t.config.role].userdel,localId:"_aroles",label:"<span class='webix_icon fa-user-secret'></span><span style='line-height: 20px;'> Роли</span>",width:140,click:function(){e.poproles.show("Админка ролей")}}]},i]}},t.prototype.init=function(){this.poproles=this.ui(l.default),this.popnewuser=this.ui(a.default);var e=this.$$("__dtu");e.clearAll(),e.parse(c.users)},t}(s.c);t.default=u},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=i(33),c=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{view:"layout",css:"margin-zero",rows:[{$subview:a.default,name:"top_menu"}]}},t}(s.c);t.default=c},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=i(0),c=i(8),l=i(2),u=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this,t=this.app,i=this;webix.ui.datafilter.cFilt=Object.create(webix.ui.datafilter.textFilter),webix.ui.datafilter.cFilt.on_key_down=function(e,i,o){var n=this._comp_id,r=webix.$$(n);9!=(e.which||e.keyCode)&&Object(a.checkKey)(e.keyCode)&&(this._filter_timer&&window.clearTimeout(this._filter_timer),this._filter_timer=window.setTimeout(function(){var e=r.getParentView().getChildViews()[1].$scope.$$("__page").getValue();r.getParentView().getChildViews()[1].$scope.$$("__page").setValue(0==+e?"1":"0"),r.getParentView().getChildViews()[1].$scope.$$("__page").refresh()},t.config.searchDelay))},webix.ui.datafilter.cFilt.refresh=a.fRefresh,webix.ui.datafilter.cFilt.render=a.fRender;var o=function(){var t=e.$$("__table").getSelectedItem().id;e.$$("__table").remove(t)};return{view:"layout",rows:[{view:"datatable",name:"__ttl",localId:"__table",startPos:1,posPpage:20,totalPos:1250,select:!0,borderless:!0,rowHeight:30,fixedRowHeight:!1,headermenu:{autowidth:!0},resizeColumn:!0,fi:"c_tovar",di:"asc",old_stri:" ",searchBar:void 0,searchMethod:"getLnkSprs",columns:[{id:"id_tovar",width:100,hidden:!0,header:[{text:"Код"},{content:"cFilt"}]},{id:"c_tovar",fillspace:!0,sort:"server",header:[{text:"Наименование"}],headermenu:!1},{id:"c_zavod",width:200,hidden:!0,header:[{text:"Производитель"},{content:"cFilt"}]},{id:"id_spr",width:150,hidden:!0,sort:"server",header:[{text:"id_spr"},{content:"cFilt"}]},{id:"spr",width:350,header:[{text:"Эталон"},{content:"cFilt",placeholder:"!слово - исключить из поиска"}]},{id:"e_zavod",width:300,hidden:!0,header:[{text:"Производитель эталона"}]},{id:"c_vnd",width:300,header:[{text:"Поставщик"},{content:"cFilt"}]},{id:"dt",width:200,sort:"server",format:a.dt_formating_sec,css:"center_p",header:[{text:"Дата изменения"},{content:"dateRangeFilter",compare:a.compareTrue,inputConfig:{format:a.dt_formating,width:180},suggest:{view:"daterangesuggest",body:{timepicker:!1,calendarCount:2}}}]},{id:"owner",width:100,sort:"server",header:[{text:"Создал"},{content:"cFilt"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onBeforeSort:function(t,o){e.$$("__table").config.fi=t,e.$$("__table").config.di=o;var n=i.getRoot().getChildViews()[1].$scope.$$("__page").getValue();i.getRoot().getChildViews()[1].$scope.$$("__page").setValue(0==+n?"1":"0"),i.getRoot().getChildViews()[1].$scope.$$("__page").refresh()},onItemDblClick:function(t,i,n){var r=e.$$("__table").getSelectedItem().id,s={};s.command="?delLnk",s.sh_prc=r,s.type="async",s.callback=o,s.parent=e,1==+$$("_link_by").getValue()?e.popunlink.show("Причина разрыва связки?",s,e._break):webix.message({text:"Выберите в параметрах сведение по поставщикам",type:"debug"})},onKeyPress:function(e,t){13===e&&this.getSelectedItem()&&this.callEvent("onItemDblClick")},onBeforeSelect:function(e){},onAfterSelect:function(e){this.$scope._break.show()}}},{$subview:l.default}]}},t.prototype.ready=function(){var e=this.app,t=this;$$(this.$$("__table").getColumnConfig("dt").header[1].suggest.body.id).getChildViews()[1].getChildViews()[1].setValue("Применить"),$$(this.$$("__table").getColumnConfig("dt").header[1].suggest.body.id).getChildViews()[1].getChildViews()[1].define("click",function(){this._filter_timer&&window.clearTimeout(this._filter_timer),this._filter_timer=window.setTimeout(function(){var e=t.getRoot().getChildViews()[1].$scope,i=e.$$("__page").getValue();e.$$("__page").setValue(0==+i?"1":"0"),e.$$("__page").setValue("0"),e.$$("__page").refresh()},webix.ui.datafilter.textWaitDelay),this.getParentView().getParentView().hide()}),this.$$("__table").isColumnVisible("dt")&&this.$$("__table").getFilter("dt").setValue({start:new Date}),this.$$("__table").isColumnVisible("owner")&&(e.config.roles[e.config.role].lnkdel?this.$$("__table").getFilter("owner").readOnly=!1:(this.$$("__table").getFilter("owner").value=this.app.config.user,this.$$("__table").getFilter("owner").readOnly=!0))},t.prototype.init=function(){this.popunlink=this.ui(c.default)},t.prototype.ready=function(){this._break=this.getRoot().getParentView().$scope.$$("_br"),this._search=this.getRoot().getParentView().$scope.$$("_ls"),this.$$("__table").config.searchBar=this._search.config.id,this._break.hide()},t}(s.c);t.default=u},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=i(4),c=i(0),l=i(8),u=i(2),p=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this,t=this.app,i=this;webix.ui.datafilter.customFilterLnkSpr=Object.create(webix.ui.datafilter.textFilter),webix.ui.datafilter.customFilterLnkSpr.on_key_down=function(e,i,o){var n=this._comp_id,r=webix.$$(n);9!=(e.which||e.keyCode)&&Object(c.checkKey)(e.keyCode)&&(this._filter_timer&&window.clearTimeout(this._filter_timer),this._filter_timer=window.setTimeout(function(){var e=r.getParentView().getChildViews()[1].$scope.$$("__page").getValue();r.getParentView().getChildViews()[1].$scope.$$("__page").setValue(0==+e?"1":"0"),r.getParentView().getChildViews()[1].$scope.$$("__page").refresh()},t.config.searchDelay))},webix.ui.datafilter.customFilterLnkSpr.refresh=c.fRefresh,webix.ui.datafilter.customFilterLnkSpr.render=c.fRender;var o=function(){var t=e.$$("__table").getSelectedItem().id;e.$$("__table").remove(t)};return{view:"layout",rows:[{view:"treetable",name:"__tt",localId:"__table",startPos:1,posPpage:20,totalPos:1250,select:!0,borderless:!0,rowHeight:30,fixedRowHeight:!1,headermenu:{autowidth:!0},resizeColumn:!0,fi:"c_tovar",di:"asc",old_stri:" ",searchBar:void 0,searchMethod:"getSprLnks",columns:[{id:"c_tovar",fillspace:!0,template:"<span>{common.treetable()} #c_tovar#</span><span style='color: red'> #count#</span>",header:[{text:"Наименование"}],headermenu:!1},{id:"c_zavod",width:200,header:[{text:"Производитель"},{content:"customFilterLnkSpr"}]},{id:"c_vnd",width:160,sort:"server",header:[{text:"Поставщик"},{content:"customFilterLnkSpr"}]},{id:"id_tovar",width:100,hidden:!0,sort:"server",header:[{text:"Код"},{content:"customFilterLnkSpr"}]},{id:"dt",width:200,format:c.dt_formating_sec,css:"center_p",header:[{text:"Дата изменения"}]},{id:"owner",width:100,header:[{text:"Создал"},{content:"customFilterLnkSpr"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onBeforeSort:function(t,o){e.$$("__table").config.fi=t,e.$$("__table").config.di=o;var n=i.getRoot().getChildViews()[1].$scope.$$("__page").getValue();i.getRoot().getChildViews()[1].$scope.$$("__page").setValue(0==+n?"1":"0"),i.getRoot().getChildViews()[1].$scope.$$("__page").refresh()},onItemDblClick:function(e,i,n){var r=this.getSelectedItem().$level;if(1===r)t.config.roles[t.config.role].spredit?(e=e.row,e=Object(c.get_spr)(this.$scope,e),e.s_name="Страна: "+e.c_strana,e.t_name="Название товара: "+e.c_tovar,e.v_name="Производитель: "+e.c_zavod,e.dv_name="Действующее вещество: "+e.c_dv,this.$scope.popnew.show("Редактирование записи "+e.id_spr,this.$scope._search,e)):webix.message({type:"error",text:"Редактирование запрещено"});else if(2===r){var s=this.$scope.$$("__table").getSelectedItem().id,a={};a.action="return",a.command="?delLnk",a.sh_prc=s,a.type="async",a.callback=o,a.parent=this.$scope,this.$scope.popunlink.show("Причина разрыва связки?",a,this.$scope._break)}},onKeyPress:function(e,t){13===e&&this.getSelectedItem()&&this.callEvent("onItemDblClick")},onBeforeSelect:function(e){},onAfterSelect:function(e){var t=this.getSelectedItem().$level;1===t?this.$scope._break.hide():2===t&&this.$scope._break.show()}}},{$subview:u.default}]}},t.prototype.init=function(){this.popnew=this.ui(a.default),this.popunlink=this.ui(l.default)},t.prototype.ready=function(){this._break=this.getRoot().getParentView().$scope.$$("_br"),this._search=this.getRoot().getParentView().$scope.$$("_ls"),this.$$("__table").config.searchBar=this._search.config.id,this._break.hide()},t}(s.c);t.default=p},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=i(0),c=i(41),l=i.n(c),u=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){function e(e){var i=e.$scope.$$("auth_box").getValues();i.pass=l()(i.pass);var o=!1,n=t.config.r_url+"?login",r=Object(a.request)(n,i,!0).response;if(r=Object(a.checkVal)(r,"s")){o=!0,t.config.user=i.user,t.config.role=r.role,t.config.x_api=r.key;var s={path:"/"};Object(a.setCookie)("linker_user",i.user,s),Object(a.setCookie)("linker_auth_key",r.key,s),Object(a.setCookie)("linker_role",r.role,s)}return o}var t=this.app,i={view:"form",localId:"auth_box",label:"Аутентификация",elements:[{view:"text",label:"Пользователь",name:"user",labelWidth:120,width:400},{view:"text",type:"password",label:"Пароль",name:"pass",labelWidth:120,width:400},{cols:[{},{},{view:"button",label:"OK",hotkey:"enter",click:function(){e(this)?(this.$scope.show("/start/body"),webix.message("авторизованно")):(webix.message({text:"не авторизованно",type:"debug"}),Object(a.deleteCookie)("linker_user"),Object(a.deleteCookie)("linker_auth_key"),Object(a.deleteCookie)("linker_role"))}}]}]};return{view:"layout",rows:[{height:document.documentElement.clientHeight/4},{cols:[{},i,{}]},{}]}},t.prototype.init=function(){var e=Object(a.getCookie)("linker_user"),t=Object(a.getCookie)("linker_auth_key"),i=Object(a.getCookie)("linker_role");e&&t&&i?(this.app.config.user=e,this.app.config.role=i,this.app.config.x_api=t,Object(a.init_first)(this.app),this.show("/start/body")):(Object(a.deleteCookie)("linker_user"),Object(a.deleteCookie)("linker_auth_key"),Object(a.deleteCookie)("linker_role"))},t}(s.c);t.default=u},function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=i(40),c=i(39),l=i(0),u=function(e){function t(){return o(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{type:"line",id:"main_ui",rows:[{$subview:a.default},{$subview:!0},{$subview:c.default}]}},t.prototype.init=function(){var e=this.app,t=e.config.r_url+"?getVersion",i={user:e.config.user},o=Object(l.request)(t,i,!0).response;o=Object(l.checkVal)(o,"s"),e.config.roles=o.cfg,Object(l.init_first)(e)},t}(s.c);t.default=u},function(e,t){},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i(58),n=(i.n(o),i(59)),r=(i.n(n),i(1)),s=(i(0),i(42));i.n(s);webix.ready(function(){webix.i18n.setLocale("ru-RU"),webix.protoUI({name:"activeList"},webix.ui.list,webix.ActiveContent),webix.protoUI({name:"cWindow",defaults:{resize:!0,modal:!1,move:!0,position:"center"},$init:function(e){webix.extend(e,{head:{view:"toolbar",cols:[{view:"label",label:"Название окна"},{view:"button",type:"icon",icon:"times",css:"times",height:26,width:26,click:function(){this.getTopParentView().hide()}}]}})}},webix.ui.window);var e=new r.b({id:"mainApp",name:"linker",version:"18.118.1550",start:"/login",user:"",role:"0",r_url:"localhost"===location.hostname?"http://saas.local/linker_logic":"../linker_logic",router:r.a,x_api:"x_login",searchDelay:1e3,popDelay:800,lch:0,roles:{},expert:!0});webix.attachEvent("onBeforeAjax",function(t,i,o,n,r,s,a){r["x-api-key"]=e.config.x_api}),e.render(),console.log("search",location.search),window.onerror=function(e,t,i,o,n){webix.message({text:"Возникла ошибка. Мы работаем над ее исправлением. Текст в консоли",type:"error",width:"800px",delay:"5"}),window.console.log("message:",e),window.console.log("source:",t),window.console.log("err:",n);return!0}})},function(e,t){},function(e,t){},function(e,t,i){"use strict";i.d(t,"a",function(){return p});var o=i(43),n=i(61),r=i(62),s=i(45),a=i(44),c=i(64),l=(i.n(c),"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}),u=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),p=function(e){function t(t){var i=e.call(this)||this;return i.webix=t.webix||webix,i.config=i.webix.extend({name:"App",version:"1.0",start:"/home"},t,!0),i._name=i.config.name,i._services={},webix.extend(i,webix.EventSystem),i}return u(t,e),t.prototype.getService=function(e){var t=this._services[e];return"function"==typeof t&&(t=this._services[e]=t(this)),t},t.prototype.setService=function(e,t){this._services[e]=t},t.prototype.copyConfig=function(e,t,i){if(e.$ui?e={$subview:new n.a(this,"",e)}:(e instanceof o.a||"function"==typeof e&&e.prototype instanceof o.a)&&(e={$subview:e}),e.$subview)return this.addSubView(e,t,i);t=t||(e instanceof Array?[]:{});for(var r in e){var s=e[r];"function"==typeof s&&s.prototype instanceof o.a&&(s={$subview:s}),!s||"object"!==(void 0===s?"undefined":l(s))||s instanceof webix.DataCollection?t[r]=s:s instanceof Date?t[r]=new Date(s):t[r]=this.copyConfig(s,s instanceof Array?[]:{},i)}return t},t.prototype.getRouter=function(){return this.$router},t.prototype.clickHandler=function(e){if(e){var t=e.target||e.srcElement;if(t&&t.getAttribute){var i=t.getAttribute("trigger");i&&this.trigger(i);var o=t.getAttribute("route");o&&this.show(o)}}},t.prototype.refresh=function(){var e=this._container;this._view.destructor(),this._view=this._container=null,this.render(e,Object(a.a)(this.getRouter().get()),this._parent)},t.prototype.loadView=function(e){var t=this,o=this.config.views,n=null;if(""===e)return Promise.resolve(this._loadError("",new Error("Webix Jet: Empty url segment")));try{if(o&&"string"==typeof(n="function"==typeof o?o(e):o[e])&&(e=n,n=null),!n){e=e.replace(/\./g,"/");var r=i(65)("./"+e);r.__esModule&&(r=r.default),n=r}}catch(t){n=this._loadError(e,t)}return n.then||(n=Promise.resolve(n)),n=n.catch(function(i){return t._loadError(e,i)})},t.prototype.createFromURL=function(e,t){var i=this,o=e[0],n=o.page;return t&&t.getName()===n?Promise.resolve(t):this.loadView(o.page).then(function(e){return i.createView(e,n)})},t.prototype.createView=function(e,t){if("function"==typeof e){if(e.prototype instanceof o.a)return new e(this,t);e=e()}return e instanceof o.a?e:e.$ui?new n.a(this,t,e):new r.a(this,t,e)},t.prototype.show=function(e){if(this.$router.get()===e)return Promise.resolve(!0);this._render(e)},t.prototype.canNavigate=function(e,t){var i={url:Object(a.a)(e),redirect:e,confirm:Promise.resolve(!0)};return this.callEvent("app:guard",[e,t||this._view,i])?i.confirm.then(function(){return i.redirect}):Promise.reject("")},t.prototype.destructor=function(){this._view.destructor()},t.prototype.trigger=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];this.apply(e,t)},t.prototype.apply=function(e,t){this.callEvent(e,t)},t.prototype.action=function(e){return this.webix.bind(function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];this.apply(e,t)},this)},t.prototype.on=function(e,t){this.attachEvent(e,t)},t.prototype.use=function(e,t){e(this,null,t)},t.prototype.error=function(e,t){if(this.callEvent(e,t),this.callEvent("app:error",t),this.config.debug)for(var i=0;i<t.length;i++)if(console.error(t[i]),t[i]instanceof Error){var o=t[i].message;0===o.indexOf("Module build failed")?(o=o.replace(/\x1b\[[0-9;]*m/g,""),document.body.innerHTML="<pre style='font-size:16px; background-color: #ec6873; color: #000; padding:10px;'>"+o+"</pre>"):(o+="<br><br>Check console for more details",webix.message({type:"error",text:o,expire:-1}))}},t.prototype._render=function(e){var t=this;!this.$router&&(webix.attachEvent("onClick",function(e){return t.clickHandler(e)}),e=this._first_start(e));var i="string"==typeof e?e:Object(a.b)(e);return this.canNavigate(i).then(function(e){return t.$router.set(e,{silent:!0}),t._render_stage(e)}).catch(function(){return null})},t.prototype._render_stage=function(e){var t=this,i="string"==typeof e?Object(a.a)(e):e;return webix.ui.freeze(function(){return t.createFromURL(i,t._view).then(function(e){var o=t._view;return t._view=e,e.render(t._container,i,t._parent).then(function(n){return o&&o!==t._view&&o.destructor(),t._view.getRoot().getParentView()&&(t._container=n),t._root=n,t.callEvent("app:route",[i]),e})}).catch(function(e){t.error("app:error:render",[e])})})},t.prototype._urlChange=function(e){return alert("Not implemented"),Promise.resolve(!0)},t.prototype._first_start=function(e){var t=this,i=function(e){return setTimeout(function(){t._render(e)},1)};if(this.$router=new(this.config.router||s.a)(i,this.config),this._container===document.body&&!1!==this.config.animation){var o=this._container;webix.html.addCss(o,"webixappstart"),setTimeout(function(){webix.html.removeCss(o,"webixappstart"),webix.html.addCss(o,"webixapp")},10)}return e&&1!==e.length||(e=this.$router.get()||this.config.start,this.$router.set(e,{silent:!0})),e},t.prototype._loadError=function(e,t){return this.error("app:error:resolve",[t,e]),{template:" "}},t.prototype.addSubView=function(e,t,i){var n=!0!==e.$subview?e.$subview:null,r=e.name||(n?this.webix.uid():"default");t.id=e.id||"s"+this.webix.uid();var s=i[r]={id:t.id,url:n};return s.url instanceof o.a&&(s.view=s.url),t},t}(o.a)},function(e,t,i){"use strict";i.d(t,"a",function(){return r});var o=i(13),n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),r=function(e){function t(t,i,o){var n=e.call(this,t,i)||this;return n._ui=o,n._windows=[],n}return n(t,e),t.prototype.getRoot=function(){if(this.app.config.jet1xMode){var e=this.getParentView();if(e)return e.getRoot()}return this._root},t.prototype.config=function(){return this._ui.$ui||this._ui},t.prototype.destructor=function(){var t=this._ui.$ondestroy;t&&t();for(var i=0,o=this._windows;i<o.length;i++){o[i].destructor()}e.prototype.destructor.call(this)},t.prototype.show=function(t,i){if(0===t.indexOf("/")||0===t.indexOf("./"))return e.prototype.show.call(this,t,i);e.prototype.show.call(this,"../"+t,i)},t.prototype.init=function(){this.app.config.legacyEarlyInit&&this._realInitHandler()},t.prototype.ready=function(){this.app.config.legacyEarlyInit||this._realInitHandler()},t.prototype._realInitHandler=function(){var e=this._ui.$oninit;if(e){var i=this.getRoot();e(i,i.$scope)}var o=this._ui.$onevent;if(o)for(var n in o)this.on(this.app,n,o[n]);var r=this._ui.$windows;if(r)for(var s=0,a=r;s<a.length;s++){var c=a[s];if(c.$ui){var l=new t(this.app,this.getName(),c);l.render(document.body),this._windows.push(l)}else this.ui(c)}},t.prototype._urlChange=function(t){var i=this;return e.prototype._urlChange.call(this,t).then(function(){var e=i._ui.$onurlchange;if(e){var o=i.getRoot();e(t[0].params,t.slice(1),o.$scope)}})},t}(o.a)},function(e,t,i){"use strict";i.d(t,"a",function(){return r});var o=i(13),n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),r=function(e){function t(t,i,o){var n=e.call(this,t,i)||this;return n._ui=o,n}return n(t,e),t.prototype.config=function(){return this._ui},t}(o.a)},function(e,t,i){var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=function(e,t){var i,n=[],r={},s=e.routie,a=function(e,t){this.name=t,this.path=e,this.keys=[],this.fns=[],this.params={},this.regex=c(this.path,this.keys,!1,!1)};a.prototype.addHandler=function(e){this.fns.push(e)},a.prototype.removeHandler=function(e){for(var t=0,i=this.fns.length;t<i;t++){if(e==this.fns[t])return void this.fns.splice(t,1)}},a.prototype.run=function(e){for(var t=0,i=this.fns.length;t<i;t++)if(!1===this.fns[t].apply(this,e))return!1;return!0},a.prototype.match=function(e,t){var i=this.regex.exec(e);if(!i)return!1;for(var o=1,n=i.length;o<n;++o){var r=this.keys[o-1],s="string"==typeof i[o]?decodeURIComponent(i[o]):i[o];r&&(this.params[r.name]=s),t.push(s)}return!0},a.prototype.toURL=function(e){var t=this.path;for(var i in e)t=t.replace("/:"+i,"/"+e[i]);if(t=t.replace(/\/:.*\?/g,"/").replace(/\?/g,""),-1!=t.indexOf(":"))throw new Error("missing parameters for url: "+t);return t};var c=function(e,t,i,o){return e instanceof RegExp?e:(e instanceof Array&&(e="("+e.join("|")+")"),e=e.concat(o?"":"/?").replace(/\/\(/g,"(?:/").replace(/\+/g,"__plus__").replace(/(\/)?(\.)?:(\w+)(?:(\(.*?\)))?(\?)?/g,function(e,i,o,n,r,s){return t.push({name:n,optional:!!s}),i=i||"",(s?"":i)+"(?:"+(s?i:"")+(o||"")+(r||o&&"([^/.]+?)"||"([^/]+?)")+")"+(s||"")}).replace(/([\/.])/g,"\\$1").replace(/__plus__/g,"(.+)").replace(/\*/g,"(.*)"),new RegExp("^"+e+"$",i?"":"i"))},l=function(e,t){var i=e.split(" "),o=2==i.length?i[0]:null;e=2==i.length?i[1]:i[0],r[e]||(r[e]=new a(e,o),n.push(r[e])),r[e].addHandler(t)},u=function e(t,i){if("function"==typeof i)l(t,i),e.reload();else if("object"==(void 0===t?"undefined":o(t))){for(var n in t)l(n,t[n]);e.reload()}else void 0===i&&e.navigate(t)};u.lookup=function(e,t){for(var i=0,o=n.length;i<o;i++){var r=n[i];if(r.name==e)return r.toURL(t)}},u.remove=function(e,t){var i=r[e];i&&i.removeHandler(t)},u.removeAll=function(){r={},n=[],i=""},u.navigate=function(e,t){t=t||{};var i=t.silent||!1;i&&_(),setTimeout(function(){window.location.hash=e,i&&setTimeout(function(){h()},1)},1)},u.noConflict=function(){return e.routie=s,u};var p=function(){return window.location.hash.substring(1)},d=function(e,t){var i=[];return t.match(e,i)?!1!==t.run(i)?1:0:-1},f=u.reload=function(){for(var e=p(),t=0,o=n.length;t<o;t++){var r=n[t],s=d(e,r);if(1===s){i=e;break}if(0===s){u.navigate(i,{silent:!0});break}}},h=function(){e.addEventListener?e.addEventListener("hashchange",f,!1):e.attachEvent("onhashchange",f)},_=function(){e.removeEventListener?e.removeEventListener("hashchange",f):e.detachEvent("onhashchange",f)};if(h(),i=p(),t)return u;e.routie=u};e.exports=n(window,!0),e.exports.default=e.exports},function(e,t){var i=webix,o=webix.version.split(".");10*o[0]+1*o[1]<53&&(i.ui.freeze=function(e){var t=e();return t&&t.then?t.then(function(e){return i.ui.$freeze=!1,i.ui.resize(),e}):(i.ui.$freeze=!1,i.ui.resize()),t});var n=i.ui.baselayout.prototype.addView,r=i.ui.baselayout.prototype.removeView,s={addView:function(e,t){if(this.$scope&&this.$scope.webixJet){var i=this.$scope,o={};e=i.app.copyConfig(e,{},o),n.apply(this,[e,t]);for(var r in o)!function(e){i._renderFrame(e,o[e],i.getUrl()).then(function(){i._subs[e]=o[e]})}(r);return e.id}return n.apply(this,arguments)},removeView:function(){if(r.apply(this,arguments),this.$scope&&this.$scope.webixJet){var e=this.$scope._subs;for(var t in e)webix.$$(e[t].id)||delete e[t]}}};i.extend(i.ui.layout.prototype,s,!0),i.extend(i.ui.baselayout.prototype,s,!0),webix.protoUI({name:"jetapp",$init:function(e){this.$app=new this.app(e);var t=webix.uid().toString();e.body={id:t},this.$ready.push(function(){this.$app.render(webix.$$(t))})}},webix.ui.proxy)},function(e,t,i){function o(e){return i(n(e))}function n(e){var t=r[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var r={"./adm-bar":14,"./adm-bar.js":14,"./adm-barcodes":16,"./adm-barcodes-b":46,"./adm-barcodes-b.js":46,"./adm-barcodes-s":47,"./adm-barcodes-s.js":47,"./adm-barcodes.js":16,"./adm-country":17,"./adm-country.js":17,"./adm-dv":18,"./adm-dv.js":18,"./adm-groups":20,"./adm-groups.js":20,"./adm-hran":21,"./adm-hran.js":21,"./adm-linker":48,"./adm-linker-codes":22,"./adm-linker-codes.js":22,"./adm-linker-excludes":24,"./adm-linker-excludes.js":24,"./adm-linker-files":25,"./adm-linker-files.js":25,"./adm-linker.js":48,"./adm-nds":27,"./adm-nds.js":27,"./adm-references":49,"./adm-references.js":49,"./adm-seasons":30,"./adm-seasons.js":30,"./adm-spr":28,"./adm-spr.js":28,"./adm-top-menu":15,"./adm-top-menu.js":15,"./adm-users":50,"./adm-users.js":50,"./adm-vendors":29,"./adm-vendors.js":29,"./adm_roles":32,"./adm_roles.js":32,"./bar-yes-no":9,"./bar-yes-no.js":9,"./body":51,"./body.js":51,"./footer":39,"./footer.js":39,"./globals":0,"./globals.js":0,"./header":40,"./header.js":40,"./history":5,"./history.js":5,"./links_form_bar":38,"./links_form_bar.js":38,"./links_form_lnk":52,"./links_form_lnk.js":52,"./links_form_spr":53,"./links_form_spr.js":53,"./login":54,"./login.js":54,"./md5":41,"./md5.js":41,"./new_bar":6,"./new_bar.js":6,"./new_code":23,"./new_code.js":23,"./new_dv":19,"./new_dv.js":19,"./new_form":4,"./new_form.js":4,"./new_prop":3,"./new_prop.js":3,"./new_stri":10,"./new_stri.js":10,"./new_tg":11,"./new_tg.js":11,"./new_user":31,"./new_user.js":31,"./pager_view":2,"./pager_view.js":2,"./side_form":12,"./side_form.js":12,"./skipped_bar":36,"./skipped_bar.js":36,"./spr_dt":35,"./spr_dt.js":35,"./start":55,"./start.js":55,"./top-menu":33,"./top-menu.js":33,"./unlink":8,"./unlink.js":8,"./unlinked":34,"./unlinked.js":34,"./unlinkedall_bar":37,"./unlinkedall_bar.js":37,"./v_upl":26,"./v_upl.js":26,"./yes-no":7,"./yes-no.js":7};o.keys=function(){return Object.keys(r)},o.resolve=n,e.exports=o,o.id=65},function(e,t,i){"use strict";!function(){function e(e,t){this.name=t.storeName||t.id+":route",this.cb=e}e.prototype.set=function(e,t){var i=this;webix.storage.session.put(this.name,e),t&&t.silent||setTimeout(function(){return i.cb(e)},1)},e.prototype.get=function(){return webix.storage.session.get(this.name)}}()},function(e,t,i){"use strict";!function(){function e(e,t){var i=this;this.cb=e,window.onpopstate=function(){return i.cb(i.get())},this.prefix=t.routerPrefix||""}e.prototype.set=function(e,t){var i=this;this.get()!==e&&window.history.pushState(null,null,this.prefix+e),t&&t.silent||setTimeout(function(){return i.cb(e)},1)},e.prototype.get=function(){var e=window.location.pathname.replace(this.prefix,"");return"/"!==e?e:""}}()},function(e,t,i){"use strict";i.d(t,"a",function(){return o});var o=function(){function e(e,t){this.path="",this.cb=e}return e.prototype.set=function(e,t){var i=this;this.path=e,t&&t.silent||setTimeout(function(){return i.cb(e)},1)},e.prototype.get=function(){return this.path},e}()},function(e,t,i){"use strict";function o(e,t,i){t.on(e,"app:guard",function(e,o,n){if(o===t||o.contains(t)){var r=i();n.confirm=!1===r?Promise.reject(r):n.confirm.then(function(){return r})}})}t.a=o},function(e,t,i){"use strict";function o(e,t,o){o=o||{};var n=o.storage,s=n?n.get("lang")||"en":o.lang||"en",a={_:null,polyglot:null,getLang:function(){return s},setLang:function(t,c){var l=(o.path?o.path+"/":"")+t,u=i(72)("./"+l);u.__esModule&&(u=u.default);var p=a.polyglot=new r.a({phrases:u});p.locale(t),a._=webix.bind(p.t,p),s=t,n&&n.put("lang",s),c||e.refresh()}};e.setService("locale",a),a.setLang(s,!0)}t.a=o;var n=i(71),r=i.n(n)},function(e,t,i){var o,n,r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(i,r){o=[],void 0!==(n=function(){return r(i)}.apply(t,o))&&(e.exports=n)}(this,function(e){"use strict";function t(e){e=e||{},this.phrases={},this.extend(e.phrases||{}),this.currentLocale=e.locale||"en",this.allowMissing=!!e.allowMissing,this.warn=e.warn||l}function i(e){var t,i,o,n={};for(t in e)if(e.hasOwnProperty(t)){i=e[t];for(o in i)n[i[o]]=t}return n}function o(e){var t=/^\s+|\s+$/g;return e.replace(t,"")}function n(e,t,i){var n,r,s;return null!=i&&e?(r=e.split(p),s=r[a(t,i)]||r[0],n=o(s)):n=e,n}function s(e){var t=i(f);return t[e]||t.en}function a(e,t){return d[s(e)](t)}function c(e,t){for(var i in t)"_"!==i&&t.hasOwnProperty(i)&&(e=e.replace(new RegExp("%\\{"+i+"\\}","g"),t[i]));return e}function l(t){e.console&&e.console.warn&&e.console.warn("WARNING: "+t)}function u(e){var t={};for(var i in e)t[i]=e[i];return t}t.VERSION="0.4.3",t.prototype.locale=function(e){return e&&(this.currentLocale=e),this.currentLocale},t.prototype.extend=function(e,t){var i;for(var o in e)e.hasOwnProperty(o)&&(i=e[o],t&&(o=t+"."+o),"object"===(void 0===i?"undefined":r(i))?this.extend(i,o):this.phrases[o]=i)},t.prototype.clear=function(){this.phrases={}},t.prototype.replace=function(e){this.clear(),this.extend(e)},t.prototype.t=function(e,t){var i,o;return t=null==t?{}:t,"number"==typeof t&&(t={smart_count:t}),"string"==typeof this.phrases[e]?i=this.phrases[e]:"string"==typeof t._?i=t._:this.allowMissing?i=e:(this.warn('Missing translation for key: "'+e+'"'),o=e),"string"==typeof i&&(t=u(t),o=n(i,this.currentLocale,t.smart_count),o=c(o,t)),o},t.prototype.has=function(e){return e in this.phrases};var p="||||",d={chinese:function(e){return 0},german:function(e){return 1!==e?1:0},french:function(e){return e>1?1:0},russian:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2},czech:function(e){return 1===e?0:e>=2&&e<=4?1:2},polish:function(e){return 1===e?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2},icelandic:function(e){return e%10!=1||e%100==11?1:0}},f={chinese:["fa","id","ja","ko","lo","ms","th","tr","zh"],german:["da","de","en","es","fi","el","he","hu","it","nl","no","pt","sv"],french:["fr","tl","pt-br"],russian:["hr","ru"],czech:["cs"],polish:["pl"],icelandic:["is"]};return t})},function(e,t,i){function o(e){return i(n(e))}function n(e){var t=r[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var r={"./en":56,"./en.js":56,"./ru":42,"./ru.js":42};o.keys=function(){return Object.keys(r)},o.resolve=n,e.exports=o,o.id=72},function(e,t,i){"use strict";function o(e,t,i){t.urls&&(i=t.urls[i]||i),e.show("./"+i)}function n(e,t,i){var n=t.$$(i.id||i),r=!1;n.attachEvent("onchange",function(){r||o(t,i,this.getValue())}),n.attachEvent("onafterselect",function(){if(!r){var e=null;n.setValue?e=this.getValue():n.getSelectedId&&(e=n.getSelectedId()),o(t,i,e)}}),t.on(e,"app:route",function(e){var i=e[t.getIndex()];if(i){r=!0;var o=i.page;n.setValue&&n.getValue()!==o?n.setValue(o):n.select&&n.exists(o)&&n.getSelectedId()!==o&&n.select(o),r=!1}})}t.a=n},function(e,t,i){"use strict";function o(e,t,i){function o(e){var o=t.$$(i.target);o&&(e||(e="<div class='status_"+f+"'><span class='webix_icon fa-"+w[f]+"'></span> "+b[f]+"</div>"),o.setHTML(e))}function s(){h--,p("good")}function a(e){h--,p("error",e)}function c(e){h++,p("saving"),e&&e.then&&e.then(s,a)}function l(){return f}function u(){0===h&&o(" ")}function p(t,i){h<0&&(h=0),"saving"===t?(f="saving",o()):(_="error"===t,0===h&&(f=_?"error":"good",_?e.error("app:error:server",[i.responseText||i]):g&&setTimeout(u,g),o()))}function d(e){var i=webix.dp(e);i&&(t.on(i,"onAfterDataSend",c),t.on(i,"onAfterSaveError",function(e,t,i){return a(i)}),t.on(i,"onAfterSave",s))}var f="good",h=0,_=!1,g=i.expire;g||!1===g||(g=2e3);var b=i.texts||r,w=i.icons||n;"string"==typeof i&&(i={target:i}),e.setService("status",{getStatus:l,setStatus:p,track:d}),i.remote&&t.on(webix,"onRemoteCall",c),i.ajax&&t.on(webix,"onBeforeAjax",function(e,t,i,o,n,r,s){c(s)}),i.data&&d(i.data)}t.a=o;var n={good:"check",error:"warning",saving:"refresh fa-spin"},r={good:"Ok",error:"Error",saving:"Connecting..."}},function(e,t,i){"use strict";function o(e,t,i){i=i||{};var o=i.storage,n=o?o.get("theme")||"flat-default":i.theme||"flat-default",r={getTheme:function(){return n},setTheme:function(t,i){for(var r=t.split("-"),s=document.getElementsByTagName("link"),a=0;a<s.length;a++){var c=s[a].getAttribute("title");c&&(c===t||c===r[0]?s[a].disabled=!1:s[a].disabled=!0)}webix.skin.set(r[0]),webix.html.removeCss(document.body,"theme-"+n),webix.html.addCss(document.body,"theme-"+t),n=t,o&&o.put("theme",t),i||e.refresh()}};e.setService("theme",r),r.setTheme(n,!0)}t.a=o},function(e,t,i){"use strict";function o(e,t,i){for(var o=0;o<i.length;o++)e.setParam(i[o],t[o+1]?t[o+1].page:"")}function n(e,t,i){var n=i.route||i;t.on(e,"app:urlchange",function(e,i){t===e&&(o(t,i,n),i.splice(1,n.length))}),t.on(e,"app:paramchange",function(e,i,o,r){if(t===e&&r)for(var s=0;s<n.length;s++)if(n[s]===i)return t.show([s,o]),!1}),o(t,t.getUrl(),n)}t.a=n},function(e,t,i){"use strict";function o(e,t,i){function o(e,t){e===r?(p.logout(),t.redirect=a):e===n||p.getStatus()||(t.redirect=n)}i=i||{};var n=i.login||"/login",r=i.logout||"/logout",s=i.afterLogin||e.config.start,a=i.afterLogout||"/login",c=i.ping||3e5,l=i.model,u=i.user,p={getUser:function(){return u},getStatus:function(e){return e?l.status().catch(function(){return null}).then(function(e){u=e}):null!==u},login:function(t,i){return l.login(t,i).then(function(t){if(u=t,!t)throw new Error("Access denied");e.callEvent("app:user:login",[u]),e.show(s)})},logout:function(){return u=null,l.logout.then(function(t){return e.callEvent("app:user:logout",[]),t})}};e.setService("user",p),e.attachEvent("app:guard",function(e,t,i){return void 0===u&&(i.confirm=p.getStatus(!0).then(function(){return o(e,i)})),o(e,i)}),c&&setInterval(function(){return p.getStatus(!0)},c)}t.a=o}]);