(()=>{var e={279:(e,t,i)=>{var o=i(3602),n=i(7148),s=n;s.v1=o,s.v4=n,e.exports=s},2821:e=>{for(var t=[],i=0;i<256;++i)t[i]=(i+256).toString(16).substr(1);e.exports=function(e,i){var o=i||0,n=t;return[n[e[o++]],n[e[o++]],n[e[o++]],n[e[o++]],"-",n[e[o++]],n[e[o++]],"-",n[e[o++]],n[e[o++]],"-",n[e[o++]],n[e[o++]],"-",n[e[o++]],n[e[o++]],n[e[o++]],n[e[o++]],n[e[o++]],n[e[o++]]].join("")}},8524:e=>{var t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(t){var i=new Uint8Array(16);e.exports=function(){return t(i),i}}else{var o=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}},3602:(e,t,i)=>{var o,n,s=i(8524),a=i(2821),r=0,l=0;e.exports=function(e,t,i){var c=t&&i||0,d=t||[],h=(e=e||{}).node||o,u=void 0!==e.clockseq?e.clockseq:n;if(null==h||null==u){var p=s();null==h&&(h=o=[1|p[0],p[1],p[2],p[3],p[4],p[5]]),null==u&&(u=n=16383&(p[6]<<8|p[7]))}var f=void 0!==e.msecs?e.msecs:(new Date).getTime(),g=void 0!==e.nsecs?e.nsecs:l+1,_=f-r+(g-l)/1e4;if(_<0&&void 0===e.clockseq&&(u=u+1&16383),(_<0||f>r)&&void 0===e.nsecs&&(g=0),g>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");r=f,l=g,n=u;var b=(1e4*(268435455&(f+=122192928e5))+g)%4294967296;d[c++]=b>>>24&255,d[c++]=b>>>16&255,d[c++]=b>>>8&255,d[c++]=255&b;var w=f/4294967296*1e4&268435455;d[c++]=w>>>8&255,d[c++]=255&w,d[c++]=w>>>24&15|16,d[c++]=w>>>16&255,d[c++]=u>>>8|128,d[c++]=255&u;for(var v=0;v<6;++v)d[c+v]=h[v];return t||a(d)}},7148:(e,t,i)=>{var o=i(8524),n=i(2821);e.exports=function(e,t,i){var s=t&&i||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||o)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var r=0;r<16;++r)t[s+r]=a[r];return t||n(a)}},280:(e,t,i)=>{"use strict";i.d(t,{cD:()=>m,Dd:()=>$,iC:()=>u});var o=i(1583);function n(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(i)return(i=i.call(e)).next.bind(i);if(Array.isArray(e)||(i=function(e,t){if(e){if("string"==typeof e)return s(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?s(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var o=0;return function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,o=new Array(t);i<t;i++)o[i]=e[i];return o}var a=function(){},r=function(){function e(e){this.webixJet=!0,this.webix=e,this._events=[],this._subs={},this._data={}}var t=e.prototype;return t.getRoot=function(){return this._root},t.destructor=function(){this._detachEvents(),this._destroySubs(),this._events=this._container=this.app=this._parent=this._root=null},t.setParam=function(e,t,i){if(this._data[e]!==t&&(this._data[e]=t,this._segment.update(e,t,0),i))return this.show(null)},t.getParam=function(e,t){var i=this._data[e];if(void 0!==i||!t)return i;var o=this.getParentView();return o?o.getParam(e,t):void 0},t.getUrl=function(){return this._segment.suburl()},t.getUrlString=function(){return this._segment.toString()},t.getParentView=function(){return this._parent},t.$$=function(e){if("string"==typeof e){var t=this.getRoot();return t.queryView((function(i){return(i.config.id===e||i.config.localId===e)&&i.$scope===t.$scope}),"self")}return e},t.on=function(e,t,i){var o=e.attachEvent(t,i);return this._events.push({obj:e,id:o}),o},t.contains=function(e){for(var t in this._subs){var i=this._subs[t].view;if(i===e||i.contains(e))return!0}return!1},t.getSubView=function(e){var t=this.getSubViewInfo(e);if(t)return t.subview.view},t.getSubViewInfo=function(e){var t=this._subs[e||"default"];return t?{subview:t,parent:this}:"_top"===e?(this._subs[e]={url:"",id:null,popup:!0},this.getSubViewInfo(e)):this._parent?this._parent.getSubViewInfo(e):null},t._detachEvents=function(){for(var e=this._events,t=e.length-1;t>=0;t--)e[t].obj.detachEvent(e[t].id)},t._destroySubs=function(){for(var e in this._subs){var t=this._subs[e].view;t&&t.destructor()}this._subs={}},t._init_url_data=function(){var e=this._segment.current();this._data={},this.webix.extend(this._data,e.params,!0)},t._getDefaultSub=function(){if(this._subs.default)return this._subs.default;for(var e in this._subs){var t=this._subs[e];if(!t.branch&&t.view&&"_top"!==e){var i=t.view._getDefaultSub();if(i)return i}}},t._routed_view=function(){var e=this.getParentView();if(!e)return!0;var t=e._getDefaultSub();return!(!t&&t!==this)&&e._routed_view()},e}();function l(e){"/"===e[0]&&(e=e.substr(1));for(var t=e.split("/"),i=[],o=0;o<t.length;o++){var s=t[o],a={},r=s.indexOf(":");if(-1===r&&(r=s.indexOf("?")),-1!==r)for(var l,c=n(s.substr(r+1).split(/[\:\?\&]/g));!(l=c()).done;){var d=l.value.split("=");a[d[0]]=decodeURIComponent(d[1])}i[o]={page:r>-1?s.substr(0,r):s,params:a,isNew:!0}}return i}function c(e){for(var t,i=[],o=n(e);!(t=o()).done;){var s=t.value;i.push("/"+s.page);var a=d(s.params);a&&i.push("?"+a)}return i.join("")}function d(e){var t=[];for(var i in e)t.length&&t.push("&"),t.push(i+"="+encodeURIComponent(e[i]));return t.join("")}var h=function(){function e(e,t){this._next=1,this.route="string"==typeof e?{url:l(e),path:e}:e,this.index=t}var t=e.prototype;return t.current=function(){return this.route.url[this.index]},t.next=function(){return this.route.url[this.index+this._next]},t.suburl=function(){return this.route.url.slice(this.index)},t.shift=function(){return new e(this.route,this.index+this._next)},t.refresh=function(){for(var e=this.route.url,t=this.index+1;t<e.length;t++)e[t].isNew=!0},t.toString=function(){var e=c(this.suburl());return e?e.substr(1):""},t._join=function(e,t){var i=this.route.url;if(null===e)return i;var o=this.route.url;if(i=o.slice(0,this.index+(t?this._next:0)),e){i=i.concat(l(e));for(var n=0;n<i.length;n++)o[n]&&(i[n].view=o[n].view),o[n]&&i[n].page===o[n].page&&(i[n].isNew=!1)}return i},t.append=function(e){var t=this._join(e,!0);return this.route.path=c(t),this.route.url=t,this.route.path},t.show=function(e,t,i){var o=this,n=this._join(e,i);return new Promise((function(e,i){var s=c(n),r={url:n,redirect:s,confirm:Promise.resolve()},l=t?t.app:null;!l||l.callEvent("app:guard",[r.redirect,t,r])?r.confirm.catch((function(e){return i(e)})).then((function(){if(null!==r.redirect){if(r.redirect!==s)return l.show(r.redirect),void i(new a);o.route.path=s,o.route.url=n,e()}else i(new a)})):i(new a)}))},t.size=function(e){this._next=e},t.split=function(){var t={url:this.route.url.slice(this.index+1),path:""};return t.url.length&&(t.path=c(t.url)),new e(t,0)},t.update=function(e,t,i){var o=this.route.url[this.index+(i||0)];if(!o)return this.route.url.push({page:"",params:{}}),this.update(e,t,i);""===e?o.page=t:o.params[e]=t,this.route.path=c(this.route.url)},e}(),u=function(e){function t(t,i){var o;return(o=e.call(this,t.webix)||this).app=t,o._children=[],o}(0,o.Z)(t,e);var i=t.prototype;return i.ui=function(e,t){var i=(t=t||{}).container||e.container,o=this.app.createView(e);return this._children.push(o),o.render(i,this._segment,this),"object"!=typeof e||e instanceof r?o:o.getRoot()},i.show=function(e,t){if(t=t||{},"object"==typeof e){for(var i in e)this.setParam(i,e[i]);e=null}else{if("/"===e.substr(0,1))return this.app.show(e);if(0===e.indexOf("./")&&(e=e.substr(2)),0===e.indexOf("../")){var o=this.getParentView();return o?o.show(e.substr(3),t):this.app.show("/"+e.substr(3))}var n=this.getSubViewInfo(t.target);if(n){if(n.parent!==this)return n.parent.show(e,t);if(t.target&&"default"!==t.target)return this._renderFrameLock(t.target,n.subview,e)}else if(e)return this.app.show("/"+e)}return this._show(this._segment,e,this)},i._show=function(e,t,i){var o=this;return e.show(t,i,!0).then((function(){return o._init_url_data(),o._urlChange()})).then((function(){e.route.linkRouter&&(o.app.getRouter().set(e.route.path,{silent:!0}),o.app.callEvent("app:route",[e.route.path]))}))},i.init=function(e,t){},i.ready=function(e,t){},i.config=function(){this.app.webix.message("View:Config is not implemented")},i.urlChange=function(e,t){},i.destroy=function(){},i.destructor=function(){this.destroy(),this._destroyKids(),this._root.destructor(),e.prototype.destructor.call(this)},i.use=function(e,t){e(this.app,this,t)},i.refresh=function(){return this.getUrl(),this.destroy(),this._destroyKids(),this._destroySubs(),this._detachEvents(),this._container.tagName&&this._root.destructor(),this._segment.refresh(),this._render(this._segment)},i.render=function(e,t,i){var o=this;"string"==typeof t&&(t=new h(t,0)),this._segment=t,this._parent=i,this._init_url_data();var n="string"==typeof(e=e||document.body)?this.webix.toNode(e):e;return this._container!==n?(this._container=n,this._render(t)):this._urlChange().then((function(){return o.getRoot()}))},i._render=function(e){var t=this,i=this.config();return i.then?i.then((function(i){return t._render_final(i,e)})):this._render_final(i,e)},i._render_final=function(e,t){var i,o=this,n=null,s=null,a=!1;if(this._container.tagName?s=this._container:(n=this._container).popup?(s=document.body,a=!0):s=this.webix.$$(n.id),!this.app||!s)return Promise.reject(null);var r=this._segment.current(),l={ui:{}};this.app.copyConfig(e,l.ui,this._subs),this.app.callEvent("app:render",[this,t,l]),l.ui.$scope=this,!n&&r.isNew&&r.view&&r.view.destructor();try{if(n&&!a){var c=s,d=c.getParentView();d&&"multiview"===d.name&&!l.ui.id&&(l.ui.id=c.config.id)}this._root=this.app.webix.ui(l.ui,s);var h=this._root;a&&h.setPosition&&!h.isVisible()&&h.show(),n&&(n.view&&n.view!==this&&n.view!==this.app&&n.view.destructor(),n.id=this._root.config.id,this.getParentView()||!this.app.app?n.view=this:n.view=this.app),r.isNew&&(r.view=this,r.isNew=!1),i=Promise.resolve(this._init(this._root,t)).then((function(){return o._urlChange().then((function(){return o._initUrl=null,o.ready(o._root,t.suburl())}))}))}catch(e){i=Promise.reject(e)}return i.catch((function(e){return o._initError(o,e)}))},i._init=function(e,t){return this.init(e,t.suburl())},i._urlChange=function(){var e=this;this.app.callEvent("app:urlchange",[this,this._segment]);var t=[];for(var i in this._subs){var o=this._subs[i],n=this._renderFrameLock(i,o,null);n&&t.push(n)}return Promise.all(t).then((function(){return e.urlChange(e._root,e._segment.suburl())}))},i._renderFrameLock=function(e,t,i){if(!t.lock){var o=this._renderFrame(e,t,i);o&&(t.lock=o.then((function(){return t.lock=null}),(function(){return t.lock=null})))}return t.lock},i._renderFrame=function(e,t,i){var o=this;if("default"===e){if(this._segment.next())return this._createSubView(t,this._segment.shift());t.view&&t.popup&&(t.view.destructor(),t.view=null)}if(null!==i&&(t.url=i),t.route){if(null!==i)return t.route.show(i,t.view).then((function(){return o._createSubView(t,t.route)}));if(t.branch)return}var n=t.view;if(!n&&t.url){if("string"==typeof t.url)return t.route=new h(t.url,0),this._createSubView(t,t.route);"function"!=typeof t.url||n instanceof t.url||(n=new t.url(this.app,"")),n||(n=t.url)}if(n)return n.render(t,t.route||this._segment,this)},i._initError=function(e,t){return this.app&&this.app.error("app:error:initview",[t,e]),!0},i._createSubView=function(e,t){var i=this;return this.app.createFromURL(t.current()).then((function(o){return o.render(e,t,i)}))},i._destroyKids=function(){for(var e=this._children,t=e.length-1;t>=0;t--)e[t]&&e[t].destructor&&e[t].destructor();this._children=[]},t}(r),p=function(e){function t(t,i){var o;return(o=e.call(this,t,i)||this)._ui=i.ui,o}return(0,o.Z)(t,e),t.prototype.config=function(){return this._ui},t}(u),f=function(){function e(e,t,i){this.path="",this.app=i}var t=e.prototype;return t.set=function(e,t){this.path=e;var i=this.app;i.app.getRouter().set(i._segment.append(this.path),{silent:!0})},t.get=function(){return this.path},e}(),g=!0,_=function(e){function t(t){var i,o=(t||{}).webix||window.webix;return(i=e.call(this,o)||this).config=i.webix.extend({name:"App",version:"1.0",start:"/home"},t,!0),i.app=i.config.app,i.ready=Promise.resolve(),i._services={},i.webix.extend(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(i),i.webix.EventSystem),i}(0,o.Z)(t,e);var i=t.prototype;return i.getUrl=function(){return this._subSegment.suburl()},i.getUrlString=function(){return this._subSegment.toString()},i.getService=function(e){var t=this._services[e];return"function"==typeof t&&(t=this._services[e]=t(this)),t},i.setService=function(e,t){this._services[e]=t},i.destructor=function(){this.getSubView().destructor(),e.prototype.destructor.call(this)},i.copyConfig=function(e,t,i){if((e instanceof r||"function"==typeof e&&e.prototype instanceof r)&&(e={$subview:e}),void 0!==e.$subview)return this.addSubView(e,t,i);for(var o in t=t||(e instanceof Array?[]:{}),e){var n=e[o];if("function"==typeof n&&n.prototype instanceof r&&(n={$subview:n}),!n||"object"!=typeof n||n instanceof this.webix.DataCollection||n instanceof RegExp||n instanceof Map)t[o]=n;else if(n instanceof Date)t[o]=new Date(n);else{var s=this.copyConfig(n,n instanceof Array?[]:{},i);null!==s&&(t[o]=s)}}return t},i.getRouter=function(){return this.$router},i.clickHandler=function(e,t){if(e&&(t=t||e.target||e.srcElement)&&t.getAttribute){var i=t.getAttribute("trigger");if(i)return this._forView(t,(function(e){return e.app.trigger(i)})),e.cancelBubble=!0,e.preventDefault();var o=t.getAttribute("route");if(o)return this._forView(t,(function(e){return e.show(o)})),e.cancelBubble=!0,e.preventDefault()}var n=t.parentNode;n&&this.clickHandler(e,n)},i.getRoot=function(){return this.getSubView().getRoot()},i.refresh=function(){var e=this;return this._subSegment?this.getSubView().refresh().then((function(t){return e.callEvent("app:route",[e.getUrl()]),t})):Promise.resolve(null)},i.loadView=function(e){var t=this,i=this.config.views,o=null;if(""===e)return Promise.resolve(this._loadError("",new Error("Webix Jet: Empty url segment")));try{i&&"string"==typeof(o="function"==typeof i?i(e):i[e])&&(e=o,o=null),o||(o="_blank"===e?{}:this._loadViewDynamic(e))}catch(t){o=this._loadError(e,t)}return o.then||(o=Promise.resolve(o)),o.then((function(e){return e.__esModule?e.default:e})).catch((function(i){return t._loadError(e,i)}))},i._forView=function(e,t){var i=this.webix.$$(e);i&&t(i.$scope)},i._loadViewDynamic=function(e){return null},i.createFromURL=function(e){var t=this;return e.isNew||!e.view?this.loadView(e.page).then((function(e){return t.createView(e,name)})):Promise.resolve(e.view)},i.createView=function(e,i){if("function"==typeof e){if(e.prototype instanceof t)return new e({app:this,name:i,router:f});if(e.prototype instanceof r)return new e(this,{name:i});e=e(this)}return e instanceof r?e:new p(this,{name:i,ui:e})},i.show=function(e){return this.render(this._container,e||this.config.start)},i.trigger=function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];this.apply(e,i)},i.apply=function(e,t){this.callEvent(e,t)},i.action=function(e){return this.webix.bind((function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];this.apply(e,i)}),this)},i.on=function(e,t){this.attachEvent(e,t)},i.use=function(e,t){e(this,null,t)},i.error=function(e,t){if(this.callEvent(e,t),this.callEvent("app:error",t),this.config.debug)for(var i=0;i<t.length;i++)if(console.error(t[i]),t[i]instanceof Error){var o=t[i].message;0===o.indexOf("Module build failed")?(o=o.replace(/\x1b\[[0-9;]*m/g,""),document.body.innerHTML="<pre style='font-size:16px; background-color: #ec6873; color: #000; padding:10px;'>"+o+"</pre>"):(o+="<br><br>Check console for more details",this.webix.message({type:"error",text:o,expire:-1}))}},i.render=function(e,t,i){var o=this;this._container="string"==typeof e?this.webix.toNode(e):e||document.body;var n=null;this.$router?n="string"==typeof t?t:this.app?t.split().route.path||this.config.start:t.toString():(g&&"tagName"in this._container&&(this.webix.event(document.body,"click",(function(e){return o.clickHandler(e)})),g=!1),"string"==typeof t&&(t=new h(t,0)),this._subSegment=this._first_start(t),this._subSegment.route.linkRouter=!0);var s=this.getSubView(),a=this._subSegment,r=a.show(n,s).then((function(){return o.createFromURL(a.current())})).then((function(t){return t.render(e,a)})).then((function(e){return o.$router.set(a.route.path,{silent:!0}),o.callEvent("app:route",[o.getUrl()]),e}));return this.ready=this.ready.then((function(){return r})),r},i.getSubView=function(){if(this._subSegment){var e=this._subSegment.current().view;if(e)return e}return new u(this,{})},i._first_start=function(e){var t=this;if(this._segment=e,this.$router=new this.config.router((function(e){return setTimeout((function(){t.show(e).catch((function(e){if(!(e instanceof a))throw e}))}),1)}),this.config,this),this._container===document.body&&!1!==this.config.animation){var i=this._container;this.webix.html.addCss(i,"webixappstart"),setTimeout((function(){t.webix.html.removeCss(i,"webixappstart"),t.webix.html.addCss(i,"webixapp")}),10)}if(e)this.app&&(e.current().view=this,e.next()?(e.refresh(),e=e.split()):e=new h(this.config.start,0));else{var o=this.$router.get();o||(o=this.config.start,this.$router.set(o,{silent:!0})),e=new h(o,0)}return e},i._loadError=function(e,t){return this.error("app:error:resolve",[t,e]),{template:" "}},i.addSubView=function(e,t,i){var o=!0!==e.$subview?e.$subview:null,n=e.name||(o?this.webix.uid():"default");return t.id=e.id||"s"+this.webix.uid(),(i[n]={id:t.id,url:o,branch:e.branch,popup:e.popup}).popup?null:t},t}(r),b=function(){function e(e,t){var i=this;this.config=t||{},this._detectPrefix(),this.cb=e,window.onpopstate=function(){return i.cb(i.get())}}var t=e.prototype;return t.set=function(e,t){var i=this;if(this.config.routes){var o=e.split("?",2);for(var n in this.config.routes)if(this.config.routes[n]===o[0]){e=n+(o.length>1?"?"+o[1]:"");break}}this.get()!==e&&window.history.pushState(null,null,this.prefix+this.sufix+e),t&&t.silent||setTimeout((function(){return i.cb(e)}),1)},t.get=function(){var e=this._getRaw().replace(this.prefix,"").replace(this.sufix,"");if(e="/"!==e&&"#"!==e?e:"",this.config.routes){var t=e.split("?",2),i=this.config.routes[t[0]];i&&(e=i+(t.length>1?"?"+t[1]:""))}return e},t._detectPrefix=function(){var e=this.config.routerPrefix;this.sufix="#"+(void 0===e?"!":e),this.prefix=document.location.href.split("#",2)[0]},t._getRaw=function(){return document.location.href},e}(),w=!1;function v(e){if(!w&&e){w=!0;var t=window;t.Promise||(t.Promise=e.promise);var i=e.version.split(".");10*i[0]+1*i[1]<53&&(e.ui.freeze=function(t){var i=t();return i&&i.then?i.then((function(t){return e.ui.$freeze=!1,e.ui.resize(),t})):(e.ui.$freeze=!1,e.ui.resize()),i});var o=e.ui.baselayout.prototype.addView,n=e.ui.baselayout.prototype.removeView,s={addView:function(e,t){var i=this;if(!this.$scope||!this.$scope.webixJet||e.queryView)return o.apply(this,arguments);var n=function(){var n=i.$scope,s={};e=n.app.copyConfig(e,{},s),o.apply(i,[e,t]);var a=function(e){n._renderFrame(e,s[e],null).then((function(){n._subs[e]=s[e]}))};for(var r in s)a(r);return{v:e.id}}();return"object"==typeof n?n.v:void 0},removeView:function(){if(n.apply(this,arguments),this.$scope&&this.$scope.webixJet){var t=this.$scope._subs;for(var i in t){var o=t[i];e.$$(o.id)||(o.view.destructor(),delete t[i])}}}};e.extend(e.ui.layout.prototype,s,!0),e.extend(e.ui.baselayout.prototype,s,!0),e.protoUI({name:"jetapp",$init:function(t){this.$app=new this.app(t);var i=e.uid().toString();for(var o in t.body={id:i},this.$ready.push((function(){this.$app.render({id:i})})),this.$app){var n=this.$app[o];"function"!=typeof n||this[o]||(this[o]=n.bind(this.$app))}}},e.ui.proxy)}}var $=function(e){function t(t){var i;return t.router=t.router||b,v((i=e.call(this,t)||this).webix),i}return(0,o.Z)(t,e),t.prototype._loadViewDynamic=function(e){return e=e.replace(/\./g,"/"),i(2403)("./"+e)},t}(_),m=function(){function e(e,t){this.path="",this.cb=e}var t=e.prototype;return t.set=function(e,t){var i=this;this.path=e,t&&t.silent||setTimeout((function(){return i.cb(e)}),1)},t.get=function(){return this.path},e}();function y(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function x(e,t,i){for(var o in e)y(e,o)&&t.call(i||e,e[o],o,e)}function k(e){e="Warning: "+e,"undefined"!=typeof console&&console.error(e);try{throw new Error(e)}catch(e){}}var C=String.prototype.replace,V=String.prototype.split,I="||||",S=function(e){var t=e%10;return 11!==e&&1===t?0:2<=t&&t<=4&&!(e>=12&&e<=14)?1:2},P={arabic:function(e){if(e<3)return e;var t=e%100;return t>=3&&t<=10?3:t>=11?4:5},bosnian_serbian:S,chinese:function(){return 0},croatian:S,french:function(e){return e>1?1:0},german:function(e){return 1!==e?1:0},russian:S,lithuanian:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=9&&(e%100<11||e%100>19)?1:2},czech:function(e){return 1===e?0:e>=2&&e<=4?1:2},polish:function(e){if(1===e)return 0;var t=e%10;return 2<=t&&t<=4&&(e%100<10||e%100>=20)?1:2},icelandic:function(e){return e%10!=1||e%100==11?1:0},slovenian:function(e){var t=e%100;return 1===t?0:2===t?1:3===t||4===t?2:3}},R={arabic:["ar"],bosnian_serbian:["bs-Latn-BA","bs-Cyrl-BA","srl-RS","sr-RS"],chinese:["id","id-ID","ja","ko","ko-KR","lo","ms","th","th-TH","zh"],croatian:["hr","hr-HR"],german:["fa","da","de","en","es","fi","el","he","hi-IN","hu","hu-HU","it","nl","no","pt","sv","tr"],french:["fr","tl","pt-br"],russian:["ru","ru-RU"],lithuanian:["lt"],czech:["cs","cs-CZ","sk"],polish:["pl"],icelandic:["is"],slovenian:["sl-SL"]};function L(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var E=/\$/g,T=/%\{(.*?)\}/g;function z(e,t,i,o){if("string"!=typeof e)throw new TypeError("Polyglot.transformPhrase expects argument #1 to be string");if(null==t)return e;var n,s=e,a=o||T,r="number"==typeof t?{smart_count:t}:t;if(null!=r.smart_count&&s){var l=V.call(s,I);n=l[function(e,t){return P[function(e){var t,i=(t={},x(R,(function(e,i){x(e,(function(e){t[e]=i}))})),t);return i[e]||i[V.call(e,/-/,1)[0]]||i.en}(e)](t)}(i||"en",r.smart_count)]||l[0],s=n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}return C.call(s,a,(function(e,t){return y(r,t)&&null!=r[t]?C.call(r[t],E,"$$"):e}))}function B(e){var t=e||{};this.phrases={},this.extend(t.phrases||{}),this.currentLocale=t.locale||"en";var i=t.allowMissing?z:null;this.onMissingKey="function"==typeof t.onMissingKey?t.onMissingKey:i,this.warn=t.warn||k,this.tokenRegex=function(e){var t=e&&e.prefix||"%{",i=e&&e.suffix||"}";if(t===I||i===I)throw new RangeError('"||||" token is reserved for pluralization');return new RegExp(L(t)+"(.*?)"+L(i),"g")}(t.interpolation)}B.prototype.locale=function(e){return e&&(this.currentLocale=e),this.currentLocale},B.prototype.extend=function(e,t){x(e,(function(e,i){var o=t?t+"."+i:i;"object"==typeof e?this.extend(e,o):this.phrases[o]=e}),this)},B.prototype.unset=function(e,t){"string"==typeof e?delete this.phrases[e]:x(e,(function(e,i){var o=t?t+"."+i:i;"object"==typeof e?this.unset(e,o):delete this.phrases[o]}),this)},B.prototype.clear=function(){this.phrases={}},B.prototype.replace=function(e){this.clear(),this.extend(e)},B.prototype.t=function(e,t){var i,o,n=null==t?{}:t;return"string"==typeof this.phrases[e]?i=this.phrases[e]:"string"==typeof n._?i=n._:this.onMissingKey?o=(0,this.onMissingKey)(e,n,this.currentLocale,this.tokenRegex):(this.warn('Missing translation for key: "'+e+'"'),o=e),"string"==typeof i&&(o=z(i,n,this.currentLocale,this.tokenRegex)),o},B.prototype.has=function(e){return y(this.phrases,e)},B.transformPhrase=function(e,t,i){return z(e,t,i)};var A=window.webix;A&&v(A);var F=window;F.Promise||(F.Promise=F.webix.promise)},8251:()=>{},7359:()=>{webix.i18n.locales["ru-RU"]={groupDelimiter:" ",groupSize:3,decimalDelimiter:",",decimalSize:2,dateFormat:"%d.%m.%Y",timeFormat:"%H:%i",longDateFormat:"%d %F %Y",fullDateFormat:"%d.%m.%Y %H:%i",price:"{obj} руб.",priceSettings:null,calendar:{monthFull:["Январь","Февраль","Март","Апрель","Maй","Июнь","Июль","Август","Сентябрь","Oктябрь","Ноябрь","Декабрь"],monthShort:["Янв","Фев","Maр","Aпр","Maй","Июн","Июл","Aвг","Сен","Окт","Ноя","Дек"],dayFull:["Воскресенье","Понедельник","Вторник","Среда","Четверг","Пятница","Суббота"],dayShort:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],hours:"Часы",minutes:"Минуты",done:"Гoтовo",clear:"Очистить",today:"Сегодня"},controls:{select:"Выбрать",invalidMessage:"Неправильное значение"},dataExport:{page:"Страница",of:"из"},PDFviewer:{of:"из",automaticZoom:"Автоматический зум",actualSize:"Настоящий размер",pageFit:"Размер страницы",pageWidth:"Ширина страницы",pageHeight:"Высота страницы"},aria:{calendar:"Календарь",increaseValue:"Увеличить значение",decreaseValue:"Уменьшить значение",navMonth:["Предыдущий месяц","Следующий месяц"],navYear:["Предыдущий год","Следующий год"],navDecade:["Предыдущие десять лет","Следующие десять лет"],dateFormat:"%d %F %Y",monthFormat:"%F %Y",yearFormat:"%Y",hourFormat:"Часы: %H",minuteFormat:"Минуты: %i",removeItem:"Удалить элемент",pages:["Первая страница","Предыдущая страница","Следующая страница","Последняя страница"],page:"Страница",headermenu:"Меню шапки таблицы",openGroup:"Развернуть группу столбцов",closeGroup:"Свернуть группу столбцов",closeTab:"Закрыть вкладку",showTabs:"Показать больше вкладок",resetTreeMap:"Вернуться к первоначальному представлению",navTreeMap:"Перейти на уровень выше",nextTab:"Следующая вкладка",prevTab:"Предыдущая вкладка",multitextSection:"Добавить элемент",multitextextraSection:"Удалить элемент",showChart:"Показать чарт",hideChart:"Спрятать чарт",resizeChart:"Изменить размер чарта"},richtext:{underline:"Подчеркивание",bold:"Жирный",italic:"Курсив"}}},8274:(e,t,i)=>{"use strict";i.d(t,{Xd:()=>o,FB:()=>n,ZY:()=>s,YM:()=>a,WM:()=>r});var o={users:["antey","antey1","antey2","antey3","antey4"],id_vnds:[45835,51066]},n={LinkerView:"<span class='webix_icon fa-link'></span><span class='multiview-header'>Линкер</span>",SkippedBarView:"<span class='webix_icon fa-archive'></span><span class='multiview-header'>Пропущенные</span>",AllUnlinkedBarView:"<span class='webix_icon fa-unlink'></span><span class='multiview-header'>Несвязанные</span>",LinksBarView:"<span class='webix_icon fa-stumbleupon'></span><span class='multiview-header'>Связки</span>",LinksSprBarView:"<span class='webix_icon fa-stumbleupon'></span><span style='line-height: 16px; font-size: 80%'>Связки:Эталоны</span>",AdmBarView:"<span class='webix_icon fa-magic'></span><span class='multiview-header'>Админка</span>",BrakBarView:"<span class='webix_icon fa-ban'></span><span class='multiview-header'>Забраковка</span>",RefView:"<span class='webix_icon fa-stream'></span><span class='multiview-header'>Справочники</span>",SeasonsView:"<span class='webix_icon fa-archive'></span><span class='multiview-header'>Сезоны</span>",SprView:"<span class='webix_icon fa-list-alt'></span><span class='multiview-header'>Эталоны</span>",CountryView:"<span class='webix_icon fa-list-alt'></span><span class='multiview-header'>Страны</span>",VendorsView:"<span class='webix_icon fa-list-alt'></span><span class='multiview-header'>Производители</span>",DvView:"<span class='webix_icon fa-list-alt'></span><span class='multiview-header'>ДВ</span>",BarcodesView:"<span class='webix_icon fa-list-alt'></span><span class='multiview-header'>Штрих-коды</span>",GroupsView:"<span class='webix_icon fa-list-alt'></span><span class='multiview-header'>Группы</span>",HranView:"<span class='webix_icon fa-list-alt'></span><span class='multiview-header'>Условия хранения</span>",NdsView:"<span class='webix_icon fa-list-alt'></span><span class='multiview-header'>НДС</span>",IssueView:"<span class='webix_icon fa-list-alt'></span><span class='multiview-header'>Формы выпуска</span>",TGroupsView:"<span class='webix_icon fa-list-alt'></span><span class='multiview-header'>Товарные группы</span>",SkladUnlinked:"<span class='webix_icon fa-unlink'></span><span class='multiview-header'>Из склада</span>"},s={unFilter:{icon:"./addons/img/unfilter.svg",label:"<span class='button_label', style='line-height: 34px'>Сбросить фильтры</span>"}},a={sources:[{id:"0",value:"Без источника"},{id:"1",value:"PLExpert"},{id:"2",value:"Склад"},{id:"3",value:"Агент"},{id:"4",value:"edocs"}],users:[{id:0,value:"Пользователь"},{id:9,value:"Сводильщик"},{id:10,value:"Админ"},{id:34,value:"Суперадмин"},{id:100,value:"Не назначен"}],sklad_err_lnk_status:[{id:10,value:"Удалено"},{id:1,value:"Принято"},{id:2,value:"Исправлено"},{id:3,value:"Отклонено"}]},r=[{id:1,value1:"LinkerView",value:"Линкер"},{id:2,value1:"SkippedBarView",value:"Пропущенные"},{id:3,value1:"AllUnlinkedBarView",value:"Несвязанные"},{id:4,value1:"LinksBarView",value:"Связки"},{id:5,value1:"BrakBarView",value:"Забраковка"},{id:6,value1:"SprView",value:"Эталоны"}]},9870:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var o=i(1583),n=i(280),s=i(2478),a=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this,t=this.app;return{view:"cWindow",modal:!0,on:{onHide:function(){e.$$("_filt").setValue(""),e.$$("e_list").clearAll(),e.$$("_n_tg").reconstruct()},onShow:function(){e.$$("_filt").setValue("");var i=e.$$("e_list");i.clearAll(!0),i.parse((0,s.refLoad)(t,e.type)),e.$$("_filt").focus()}},body:{view:"form",localId:"_n_tg",height:.75*document.documentElement.clientHeight,margin:0,elements:[{rows:[{view:"text",label:"Название",value:"",name:"_filter",placeholder:"Введите название группы",localId:"_filt",on:{onTimedKeyPress:function(e,t){var i=this.getValue().toString().toLowerCase();this.$scope.$$("e_list").filter("value",i)}}},{rows:[{view:"label",label:"Свойства"},{view:"list",localId:"e_list",width:550,template:"#value#",select:!0,multiselect:!1,on:{onItemDblClick:function(e){this.$scope.$$("_apply").callEvent("onItemClick")}}}]},{cols:[{view:"button",type:"base",label:"Отменить",width:120,click:function(){e.hideW()}},{},{view:"button",type:"base",label:"Применить",width:120,localId:"_apply",on:{onItemClick:function(){var t=e.$$("e_list").getSelectedItem();e.hideW(),e.callback&&e.callback(e.type,t)}}}]}]}]}}},i.showW=function(e,t,i){this.type=t,this.callback=i,this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show()},i.hideW=function(){this.getRoot().hide()},t}(n.iC)},5072:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>s});var o=i(1583),n=i(280),s=(i(2478),function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this;return this.app,{rows:[{view:"toolbar",css:{"border-top":"0px !important"},height:40,cols:[{},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-upload'></span><span> Добавить файл на обработку</span>",width:240,click:function(){webix.message({text:"Добавление файла",type:"debug"})}}]},{height:3},{view:"tabview",multiview:!0,cells:[{header:"<span style='line-height: 20px;'>Заявки</span>",width:120,body:{view:"layout",rows:[{height:40,view:"toolbar",cols:[{},{view:"button",type:"htmlbutton",localId:"refresh",label:"<span class='webix_icon fa-refresh'></span>",width:40,tooltip:"Обновить",click:function(){webix.message({text:"обновление",type:"debug"}),e.$$("__table").getHeaderContent("ch1").uncheck(),e.ready()}},{view:"button",type:"htmlbutton",localId:"confirm",hidden:!0,label:"<span class='webix_icon fa-thumbs-up'></span>",width:40,tooltip:"Одобрить выделенные",click:function(){webix.message({text:"одобренно",type:"debug"})}},{view:"button",type:"htmlbutton",localId:"reject",hidden:!0,label:"<span class='webix_icon fa-thumbs-down'></span>",width:40,tooltip:"Отклонить выделенные",click:function(){webix.message({text:"отклоненно",type:"debug"})}}]},{view:"datatable",localId:"__table",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,columns:[{id:"change",hidden:!0,headermenu:!1},{id:"confirm",css:{"text-align":"center !important;"},width:100,header:[{text:"Подтвердить",css:{"text-align":"center !important;"}},{content:"masterCheckbox",css:{"text-align":"center !important;"},contentId:"ch1"}],template:"{common.checkbox()}"},{id:"user",headermenu:!1,fillspace:1,sort:"text",header:[{text:"Логин пользователя"}]},{id:"lastname",width:150,header:[{text:"Фамилия"}]},{id:"firstname",width:150,header:[{text:"Имя"}]},{id:"email",width:250,header:[{text:"email"}]},{id:"dt",width:200,header:[{text:"Дата запроса"}]}],on:{"data->onParse":function(e,t){this.clearAll(),this.$scope.$$("confirm").hide(),this.$scope.$$("reject").hide()},onCheck:function(t,i,o){e.$$("__table").getItem(t).change=1,e.$$("confirm").show(),e.$$("reject").show()},onBeforeRender:function(){this.count||this.showProgress({type:"icon",icon:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>'})},onItemDblClick:function(e){this.getSelectedItem()},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(){},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}}]}},{header:"<span style='line-height: 20px;'>История</span>",width:120,body:{view:"layout",rows:[{height:40,view:"toolbar",cols:[{},{view:"button",type:"htmlbutton",hidden:!0,label:"<span class='webix_icon fa-thumbs-up'></span>",width:40,click:function(){webix.message({text:"одобренно",type:"debug"})}},{view:"button",type:"htmlbutton",hidden:!0,label:"<span class='webix_icon fa-thumbs-down'></span>",width:40,click:function(){webix.message({text:"отклоненно",type:"debug"})}}]},{view:"datatable",localId:"__table1",select:!1,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,columns:[{id:"status",css:{"text-align":"center !important;"},width:100,header:[{text:"Статус",css:{"text-align":"center !important;"}}],template:function(e){return 1===e.status?"<div><span style='color: green;', class='webix_icon fa-check-circle'></span></div>":"<div><span style='color: red;', class='webix_icon fa-times-circle'></span></div>"}},{id:"user",headermenu:!1,fillspace:1,sort:"text",header:[{text:"Логин пользователя"}]},{id:"lastname",width:150,header:[{text:"Фамилия"}]},{id:"firstname",width:150,header:[{text:"Имя"}]},{id:"email",width:250,header:[{text:"email"}]},{id:"dt",width:200,header:[{text:"Дата изменения"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){this.count||this.showProgress({type:"icon",icon:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>'})},onAfterLoad:function(){this.hideProgress()}}}]}}]}]}},i.ready=function(){this.$$("__table").parse([{id:1,confirm:0,user:"1111",lastname:"sds",firstname:"jjh",email:"112@mam.ee",dt:"08.05.2018 12:00:00.000"},{id:2,confirm:0,user:"11114",lastname:"s2ds",firstname:"jjh5",email:"14412@mam.ee",dt:"08.05.2018 12:00:00.000"},{id:3,confirm:0,user:"11113",lastname:"sd2s",firstname:"jj4h",email:"11255@mam.ee",dt:"08.05.2018 12:00:00.000"},{id:4,confirm:0,user:"11112",lastname:"sds2",firstname:"j1jh",email:"11662@mam.ee",dt:"08.05.2018 12:00:00.000"}]),this.$$("__table1").parse([{id:1,status:1,user:"1111",lastname:"sds",firstname:"jjh",email:"112@mam.ee",dt:"08.05.2018 12:00:00.000"},{id:2,status:1,user:"11114",lastname:"s2ds",firstname:"jjh5",email:"14412@mam.ee",dt:"08.05.2018 12:00:00.000"},{id:3,status:1,user:"11113",lastname:"sd2s",firstname:"jj4h",email:"11255@mam.ee",dt:"08.05.2018 12:00:00.000"},{id:4,status:0,user:"11112",lastname:"sds2",firstname:"j1jh",email:"11662@mam.ee",dt:"08.05.2018 12:00:00.000"}])},i.init=function(){webix.extend(this.$$("__table"),webix.ProgressBar),webix.extend(this.$$("__table1"),webix.ProgressBar)},t}(n.iC))},5631:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r});var o=i(1583),n=i(280),s=i(3220),a=i(2478),r=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){return{view:"layout",css:"margin-zero",rows:[{$subview:s.default,name:"top_menu"},{$subview:!0}]}},i.ready=function(e){this.show("adm-linker")},i.init=function(){var e=this.app,t=e.config.searchDelay;setTimeout(a.get_refs,0*t,{app:e,type:"async",method:"getRoles",store:"roles_dc"})},t}(n.iC)},3926:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>l});var o=i(1583),n=i(280),s=i(2478),a=i(6144),r=i(1118),l=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this;function t(e){var t,i=e.item.$level,o=e.item,n=e.th,a=n.$scope.app.config.user;1===i?t={user:a,barcode:o.c_tovar,id_spr:void 0}:2===i&&(t={user:a,barcode:n.getItem(o.$parent).c_tovar,id_spr:o.id_spr});var r=(0,s.request)("delBar",t,!0,n.$scope.app).response;(r=(0,s.checkVal)(r,"s"))&&(1===i?n.remove(o.id):2===i&&(n.remove(o.id),0===n.getItem(o.$parent).$count&&n.remove(o.$parent)))}return{view:"layout",type:"clean",css:{"border-left":"1px solid #dddddd !important"},rows:[{view:"treetable",name:"__dtdb",localId:"__table",startPos:1,posPpage:this.app.config.posPpage,totalPos:1250,select:!0,resizeColumn:!0,borderless:!0,navigation:"row",rowHeight:32,fixedRowHeight:!1,rowLineHeight:32,headermenu:{autowidth:!0},editable:!1,old_stri:" ",fi:"c_tovar",di:"asc",searchBar:void 0,searchMethod:"getBarsSpr",columns:[{id:"c_tovar",header:"Товар",fillspace:!0,sort:"server",headermenu:!1,template:"<span>{common.treetable()} #c_tovar#</span>"},{id:"c_zavod",width:300,header:[{text:"Завод-изготовитель"}]},{id:"c_strana",width:200,header:[{text:"Страна"}]},{id:"id_spr",width:150,header:[{text:"IDSPR"}]},{id:"dt",header:"Дата",width:160,hidden:!0},{id:"owner",header:"Создал",width:120,hidden:!0},{id:"id_state",hidden:!0,width:150,header:[{text:"Статус"}]}],on:{onresize:function(){var e=this;clearTimeout(this.delayResize);var t=(0,s.recalcRowsRet)(this);t&&(this.delayResize=setTimeout((function(){e.config.posPpage=t,e.$scope.startSearch()}),250))},"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onBeforeSort:function(t,i){e.$$("__table").config.fi=t,e.$$("__table").config.di=i,e.startSearch()},onItemDblClick:function(e){var i=(e=this.getSelectedItem()).$level,o={callback:t,params:{item:e,th:this}};2===i?this.$scope.popconfirm.show("Удалить товар из ШК?",o):1===i&&this.$scope.popconfirm.show("Удалить ШК со всеми товарами?",o)},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}},{$subview:r.default}]}},i.startSearch=function(){var e=this.getRoot().getChildViews()[1].$scope.$$("__page");e.setValue(0==+e.getValue()?"1":"0")},i.init=function(){this.$$("__table").blockEvent(),this.popconfirm=this.ui(a.default)},i.ready=function(){this._search=this.getRoot().getParentView().$scope.$$("_sb"),this.$$("__table").config.searchBar=this._search.config.id,this.$$("__table").unblockEvent(),this.$$("__table").callEvent("onresize"),this._search.focus()},t}(n.iC)},4493:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>c});var o=i(1583),n=i(280),s=i(2478),a=i(6028),r=i(6144),l=i(1118),c=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this,t=this.app,i=function(t){var i=t.item,o=t.th,n={user:o.$scope.app.config.user,id_spr:i.$parent,barcode:i.barcode},a=(0,s.request)("delBar",n,!0,h.$scope.app).response;if(a=(0,s.checkVal)(a,"s")){o.remove(i.id);var r=e.$$("__table").getItem(i.$parent);r.count=r.$count>0?r.$count:"",e.$$("__table").refresh(i.$parent)}},o=function(i,o){var n=e.$$("__table"),a="setBar",r={user:t.config.user,id_spr:i,barcode:o},l=(0,s.request)(a,r,!0,t).response;if(l=(0,s.checkVal)(l,"s")){var c=n.isBranchOpen(i),d=(o.split(" "),n.data),h=[];d.each((function(e){2===e.$level&&e.$parent===i&&h.push(e.id)})),n.remove(h),a="getBar",(0,s.checkVal)((0,s.request)(a,r,!0,n.$scope.app).response,"s").forEach((function(e,t,o){var s={barcode:e.barcode,id_state:"active",dt:e.dt,owner:"",count:""};n.add(s,0,i)})),c&&n.open(i);var u=e.$$("__table").getItem(i);u.count=u.$count>0?u.$count:"",e.$$("__table").refresh(i)}};return{view:"layout",type:"clean",css:{"border-left":"1px solid #dddddd !important"},rows:[{view:"treetable",localId:"__table",name:"__dtd",startPos:1,posPpage:t.config.posPpage,totalPos:1250,select:!0,resizeColumn:!0,borderless:!0,navigation:"row",rowHeight:32,fixedRowHeight:!1,rowLineHeight:32,headermenu:{autowidth:!0},editable:!1,old_stri:" ",fi:"c_tovar",di:"asc",searchBar:void 0,searchMethod:"getSprBars",columns:[{id:"barcode",header:"Штрих-код",fillspace:!0,headermenu:!1,template:"<span>{common.treetable()} #barcode#</span><span style='color: red'> #count#</span>"},{id:"dt",header:"Дата изменения",width:200,format:s.dt_formating_sec,css:"center_p"},{id:"owner",header:"Изменил",width:120,hidden:!0}],on:{onresize:function(){var e=this;clearTimeout(this.delayResize);var t=(0,s.recalcRowsRet)(this);t&&(this.delayResize=setTimeout((function(){e.config.posPpage=t,e.$scope.startSearch()}),250))},"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onBeforeSort:function(t,i){e.$$("__table").config.fi=t,e.$$("__table").config.di=i,e.startSearch()},onItemDblClick:function(){var e=this.getSelectedItem();if(t.config.roles[t.config.role].adm){var n=e.$level;if(1===n)this.$scope.popnewbar.show("Редактирование ШК: "+e.barcode,e.id,void 0,o);else if(2===n){var s={callback:i,params:{item:e,th:this}};this.$scope.popconfirm.show("Удалить ШК?",s)}}else webix.message({type:"error",text:"Редактирование запрещено"})},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}},{$subview:l.default}]}},i.startSearch=function(){var e=this.getRoot().getChildViews()[1].$scope.$$("__page");e.setValue(0==+e.getValue()?"1":"0")},i.init=function(){this.$$("__table").blockEvent(),this.popnewbar=this.ui(a.default),this.popconfirm=this.ui(r.default)},i.ready=function(){this._search=this.getRoot().getParentView().$scope.$$("_sb"),this.$$("__table").config.searchBar=this._search.config.id,this.$$("__table").unblockEvent(),this.$$("__table").callEvent("onresize"),this._search.focus()},t}(n.iC)},3636:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r});var o=i(1583),n=i(280),s=i(9968),a=i(2478),r=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e,t,i=this,o=this.app;return{view:"layout",rows:[{height:40,view:"toolbar",cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Начните набирать название товара здесь",fillspace:!0,localId:"_sb",keyPressTimeout:900,tooltip:"поиск по ШК",_keytimed:void 0,on:{onKeyPress:function(e,t){var i=this;clearTimeout(this.config._keytimed),(0,a.checkKey)(e)&&(this.config._keytimed=setTimeout((function(){var e=i.$scope.getRoot().getChildViews()[1].getChildViews()[0];if(e){var t=(0,a.getDtParams)(e),o=1===i.$scope.$$("_chbar").getValue()?"0,100":i.$scope.$$("_bnum").getValue();(0,a.get_data_test)({view:e,navBar:i.$scope.getRoot().getChildViews()[1].getChildViews()[1],start:1,count:t[1],searchBar:i.$scope.getRoot().getChildViews()[1].getChildViews()[0].config.searchBar,method:i.$scope.getRoot().getChildViews()[1].getChildViews()[0].config.searchMethod,field:t[2],direction:t[3],filter:t[0],cbars:o})}}),this.$scope.app.config.searchDelay))}}},(e={view:"button",type:"htmlbutton",width:35,localId:"_history",resizable:!0,sWidth:126,eWidth:40,label:""},e.width=40,e.extLabel="<span class='button_label'>История</span>",e.oldLabel="<span class='webix_icon fa-history'></span>",e.click=function(){var e=i.getRoot().getChildViews()[1].getChildViews()[0],t=webix.storage.session.get(e.config.name);i.pophistory.show(t,i.$$("_sb"))},e),{view:"rangeslider",label:"Диапазон кол-ва ШК",value:"0,15",width:350,labelWidth:140,hidden:function(){return 1===this.$scope.$$("_chbar").getValue()},localId:"_bnum",title:webix.template("#value#"),stringResult:!0,max:15,min:0,on:{onChange:function(){i.$$("_sb").focus()}}},{view:"checkbox",labelRight:"<span style='color: white'>Все</span>",labelWidth:0,value:1,width:60,localId:"_chbar",on:{onChange:function(){i.$$("_sb").focus(),1===i.$$("_chbar").getValue()?i.$$("_bnum").hide():i.$$("_bnum").show()}}},{view:"checkbox",labelRight:"<span style='color: white'>Поиск по справочнику</span>",labelWidth:0,value:1,width:160,on:{onChange:function(){this.$scope.$$("_sb").setValue(""),1===this.getValue()?(this.$scope.$$("_sb").define("placeholder","Начните набирать название товара"),0===this.$scope.$$("_chbar").getValue()&&this.$scope.$$("_bnum").show(),this.$scope.$$("_chbar").show(),this.$scope.show("adm-barcodes-s")):0===this.getValue()&&(this.$scope.$$("_bnum").hide(),this.$scope.$$("_chbar").hide(),this.$scope.show("adm-barcodes-b"))}}},(t={view:"button",type:"htmlbutton",width:35,localId:"_rep",resizable:!0,sWidth:180,eWidth:40,label:""},t.width=40,t.tooltip="Отчет по дублирующимся штрихкодам",t.extLabel="<span class='button_label'>Отчет по дублям</span>",t.oldLabel="<span class='webix_icon fa-file'></span>",t.on={onItemClick:function(){var e=o.config.r_url+"?barcodeReport";webix.ajax().timeout(18e4).headers({"Content-type":"application/json"}).response("blob").post(e,{},(function(e,t,i){var o=i.getResponseHeader("content-disposition").split("filename=")[1].replace(/^\s+|\s+$/g,"");webix.html.download(t,o)}))}},t)]},{$subview:!0}]}},i.ready=function(){var e=[this.$$("_history"),this.$$("_rep")];(0,a.setButtons)(this.app,e)},i.init=function(){this.pophistory=this.ui(s.default),this.show("adm-barcodes-s")},t}(n.iC)},8243:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r});var o=i(1583),n=i(280),s=i(2478),a=i(4402),r=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this,t=this.app;return{view:"layout",rows:[{height:40,view:"toolbar",cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Строка поиска",keyPressTimeout:900,tooltip:"поиск по стране",on:{onTimedKeyPress:function(e,t){var i=this.getValue().toString().toLowerCase();this.$scope.$$("__table").filter((function(e){return-1!=e.c_strana.toString().toLowerCase().indexOf(i)}))}}},{view:"button",type:"htmlbutton",tooltip:"Добавить страну",localId:"_add",resizable:!0,sWidth:180,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>Добавить страну</span>",oldLabel:"<span class='webix_icon fa-plus'></span>",click:function(){var t={type:"Strana",callback:s.addItem,mode:"new",source:e.$$("__table")};e.popnew.show("Добавление страны",t)}},{view:"button",type:"htmlbutton",hidden:!0,localId:"_del",tooltip:"Удалить страну",resizable:!0,sWidth:180,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>Удалить страну</span>",oldLabel:"<span style='color: red', class='webix_icon fa-times'></span>",on:{onItemClick:function(){var t=e.$$("__table").getSelectedItem().id,i={};i.user=e.app.config.user,i.id=t;var o=(0,s.request)("delStrana",i,!0,e.app).response;(o=(0,s.checkVal)(o,"s"))&&((0,s.delItem)("Strana",o.id,e.$$("__table")),e.$$("_del").hide())}}}]},{view:"datatable",name:"_country",localId:"__table",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,startPos:1,posPpage:20,totalPos:1250,old_stri:"",type:{itemIcon:s.DelEdIcons},onClick:{delete_button:function(e,t,i){var o=this,n=this.getItem(t);!1!==n.delete?setTimeout((function(){o.select(n.id,!1),o.$scope.$$("_del").callEvent("onItemClick")}),50):webix.message({type:"debug",text:"Удаление группы "+n.c_issue+" невозможно",expire:5e3})},edit_button:function(e,t,i){this.select(t,!1),this.callEvent("onItemDblClick",t)}},columns:[{id:"c_strana",headermenu:!1,fillspace:1,sort:"text",header:[{text:"Страна"}],template:s.refTemplate},{id:"id",sort:"text",width:150,header:[{text:"ID"}]},{id:"id_state",hidden:!0,width:150,header:[{text:"Статус"}]},{id:"dt",hidden:!0,width:250,header:[{text:"Дата заведения"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){this.count||this.showProgress({type:"icon",icon:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>'})},onAfterRender:function(e){var i=this;Array.prototype.slice.call(document.getElementsByClassName("delete_button")).forEach((function(e){e.onmousedown=function(o){i.$scope.$$("_del").blockEvent(),e.onmouseup=function(){clearInterval(i.interval)},i.interval=setTimeout((function(){i.$scope.$$("_del").unblockEvent()}),t.config.popDelay)}}))},onItemDblClick:function(e){var t={text:(e=this.getSelectedItem()).c_strana,id:e.id,type:"Strana",callback:s.updItem,mode:"upd",source:this};this.$scope.popnew.show("Редактирование страны",t)},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(){},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}}]}},i.ready=function(){var e=[this.$$("_add"),this.$$("_del")];(0,s.setButtons)(this.app,e),(0,s.singleRefReload)(this.app,"getStranaAll",this.$$("__table"))},i.init=function(){this.popnew=this.ui(a.default),webix.extend(this.$$("__table"),webix.ProgressBar)},t}(n.iC)},3335:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r});var o=i(1583),n=i(280),s=i(2478),a=i(5141),r=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this,t=this.app;return{view:"layout",rows:[{height:40,view:"toolbar",cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Строка поиска",keyPressTimeout:900,tooltip:"поиск по действующему веществу",on:{onTimedKeyPress:function(e,t){var i=this.getValue().toString().toLowerCase();this.$scope.$$("__table").filter((function(e){return-1!=e.act_ingr.toString().toLowerCase().indexOf(i)}))}}},{view:"button",type:"htmlbutton",tooltip:"Добавить действующее вещество",localId:"_add",resizable:!0,sWidth:160,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>Добавить ДВ</span>",oldLabel:"<span class='webix_icon fa-plus'></span>",click:function(){var t={type:"Dv",callback:s.addItem,mode:"new",source:e.$$("__table")};e.popnew.show("Добавление действующего в-ва",t)}},{view:"button",type:"htmlbutton",hidden:!0,localId:"_del",tooltip:"Удалить дейтсвующее вещество",resizable:!0,sWidth:160,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>Удалить ДВ</span>",oldLabel:"<span style='color: red', class='webix_icon fa-times'></span>",on:{onItemClick:function(){var t=e.$$("__table").getSelectedItem().id,i={};i.user=e.app.config.user,i.id=t;var o=(0,s.request)("delDv",i,!0,e.app).response;(o=(0,s.checkVal)(o,"s"))&&((0,s.delItem)("Dv",o.id,e.$$("__table")),e.$$("_del").hide())}}}]},{view:"datatable",name:"_dv",localId:"__table",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,startPos:1,posPpage:20,totalPos:1250,old_stri:"",type:{itemIcon:s.DelEdIcons},onClick:{delete_button:function(e,t,i){var o=this,n=this.getItem(t);!1!==n.delete?setTimeout((function(){o.select(n.id,!1),o.$scope.$$("_del").callEvent("onItemClick")}),50):webix.message({type:"debug",text:"Удаление группы "+n.c_issue+" невозможно",expire:5e3})},edit_button:function(e,t,i){this.select(t,!1),this.callEvent("onItemDblClick",t)}},columns:[{id:"act_ingr",fillspace:1,sort:"text",headermenu:!1,header:[{text:"Действующее вещество"}],template:s.refTemplate},{id:"oa",width:200,sort:"text",header:[{text:"Обязательный ассортимент"},{content:"selectFilter"}]},{id:"id",width:75,sort:"text",header:[{text:"ID"}]},{id:"id_state",width:150,hidden:!0,header:[{text:"Статус"}]},{id:"dt",width:250,hidden:!0,header:[{text:"Дата заведения"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){this.count||this.showProgress({type:"icon",icon:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>'})},onAfterRender:function(e){var i=this;Array.prototype.slice.call(document.getElementsByClassName("delete_button")).forEach((function(e){e.onmousedown=function(o){i.$scope.$$("_del").blockEvent(),e.onmouseup=function(){clearInterval(i.interval)},i.interval=setTimeout((function(){i.$scope.$$("_del").unblockEvent()}),t.config.popDelay)}}))},onItemDblClick:function(e){var t={text:(e=this.getSelectedItem()).act_ingr,id:e.id,oa:e.oa,type:"Dv",callback:s.updItem,mode:"upd",source:this};this.$scope.popnew.show("Редактирование действующего в-ва",t)},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(){},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}}]}},i.ready=function(){var e=[this.$$("_add"),this.$$("_del")];(0,s.setButtons)(this.app,e),(0,s.singleRefReload)(this.app,"getDvAll",this.$$("__table"))},i.init=function(){this.popnew=this.ui(a.default),webix.extend(this.$$("__table"),webix.ProgressBar)},t}(n.iC)},1456:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r});var o=i(1583),n=i(280),s=i(2478),a=i(4402),r=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this,t=this.app;return{view:"layout",rows:[{height:40,view:"toolbar",cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Строка поиска",keyPressTimeout:900,tooltip:"поиск по группе",on:{onTimedKeyPress:function(e,t){var i=this.getValue().toString().toLowerCase();this.$scope.$$("__table").filter((function(e){return-1!=e.group.toString().toLowerCase().indexOf(i)}))}}},{view:"button",type:"htmlbutton",tooltip:"Добавить группу",localId:"_add",resizable:!0,sWidth:180,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>Добавить группу</span>",oldLabel:"<span class='webix_icon fa-plus'></span>",click:function(){var t={type:"Gr",callback:s.addItem,mode:"new",source:e.$$("__table"),index:1};e.popnew.show("Добавление группы",t,!0)}},{view:"button",type:"htmlbutton",hidden:!0,localId:"_del",tooltip:"Удалить группу",resizable:!0,sWidth:180,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>Удалить гпуппу</span>",oldLabel:"<span style='color: red', class='webix_icon fa-times'></span>",on:{onItemClick:function(){var t=e.$$("__table").getSelectedItem().id,i={};i.user=e.app.config.user,i.id=t;var o=(0,s.request)("delGr",i,!0,e.app).response;(o=(0,s.checkVal)(o,"s"))&&((0,s.delItem)("Group",o.id,e.$$("__table")),e.$$("_del").hide())}}}]},{view:"datatable",name:"_groups",localId:"__table",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,startPos:1,posPpage:20,totalPos:1250,old_stri:"",type:{itemIcon:s.DelEdIcons},onClick:{delete_button:function(e,t,i){var o=this,n=this.getItem(t);!1!==n.delete?setTimeout((function(){o.select(n.id,!1),o.$scope.$$("_del").callEvent("onItemClick")}),50):webix.message({type:"debug",text:"Удаление группы "+n.c_issue+" невозможно",expire:5e3})},edit_button:function(e,t,i){this.select(t,!1),this.callEvent("onItemDblClick",t)}},columns:[{id:"group",headermenu:!1,fillspace:1,sort:"text",header:[{text:"Группа"}],template:s.refTemplate},{id:"id",width:300,sort:"text",header:[{text:"ID"}]},{id:"id_state",hidden:!0,width:150,header:[{text:"Статус"}]},{id:"dt",hidden:!0,width:250,header:[{text:"Дата заведения"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){this.count||this.showProgress({type:"icon",icon:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>'})},onAfterRender:function(e){var i=this;Array.prototype.slice.call(document.getElementsByClassName("delete_button")).forEach((function(e){e.onmousedown=function(o){i.$scope.$$("_del").blockEvent(),e.onmouseup=function(){clearInterval(i.interval)},i.interval=setTimeout((function(){i.$scope.$$("_del").unblockEvent()}),t.config.popDelay)}}))},onItemDblClick:function(e){var t={text:(e=this.getSelectedItem()).group,id:e.id,type:"Gr",callback:s.updItem,mode:"upd",source:this};this.$scope.popnew.show("Редактирование группы",t)},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(){e.$$("_del").show()},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}}]}},i.ready=function(){var e=[this.$$("_add"),this.$$("_del")];(0,s.setButtons)(this.app,e),(0,s.singleRefReload)(this.app,"getGroupAll",this.$$("__table"))},i.init=function(){this.popnew=this.ui(a.default),webix.extend(this.$$("__table"),webix.ProgressBar)},t}(n.iC)},4376:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r});var o=i(1583),n=i(280),s=i(2478),a=i(4402),r=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this,t=this.app;return{view:"layout",rows:[{height:40,view:"toolbar",cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Строка поиска",keyPressTimeout:900,tooltip:"поиск по условиям хранения",on:{onTimedKeyPress:function(e,t){var i=this.getValue().toString().toLowerCase();this.$scope.$$("__table").filter((function(e){return-1!=e.usloviya.toString().toLowerCase().indexOf(i)}))}}},{view:"button",type:"htmlbutton",tooltip:"Добавить условия хранения",localId:"_add",resizable:!0,sWidth:180,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>Добавить условия</span>",oldLabel:"<span class='webix_icon fa-plus'></span>",click:function(){var t={type:"Hran",callback:s.addItem,mode:"new",source:e.$$("__table")};e.popnew.show("Добавление условия хранения",t)}},{view:"button",type:"htmlbutton",localId:"_del",hidden:!0,tooltip:"Удалить условия хранения",resizable:!0,sWidth:180,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>Удалить условия</span>",oldLabel:"<span style='color: red', class='webix_icon fa-times'></span>",on:{onItemClick:function(){var t=e.$$("__table").getSelectedItem().id,i={};i.user=e.app.config.user,i.id=t;var o=(0,s.request)("delHran",i,!0,e.app).response;(o=(0,s.checkVal)(o,"s"))&&((0,s.delItem)("hran",o.id,e.$$("__table")),e.$$("_del").hide())}}}]},{view:"datatable",name:"_hran",localId:"__table",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,startPos:1,posPpage:20,totalPos:1250,old_stri:"",type:{itemIcon:s.DelEdIcons},onClick:{delete_button:function(e,t,i){var o=this,n=this.getItem(t);!1!==n.delete?setTimeout((function(){o.select(n.id,!1),o.$scope.$$("_del").callEvent("onItemClick")}),50):webix.message({type:"debug",text:"Удаление группы "+n.c_issue+" невозможно",expire:5e3})},edit_button:function(e,t,i){this.select(t,!1),this.callEvent("onItemDblClick",t)}},columns:[{id:"usloviya",headermenu:!1,fillspace:1,sort:"text",header:[{text:"Условия хранения"}],template:s.refTemplate},{id:"id",width:300,sort:"text",header:[{text:"ID"}]},{id:"id_state",hidden:!0,width:150,header:[{text:"Статус"}]},{id:"dt",hidden:!0,width:250,header:[{text:"Дата заведения"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){this.count||this.showProgress({type:"icon",icon:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>'})},onAfterRender:function(e){var i=this;Array.prototype.slice.call(document.getElementsByClassName("delete_button")).forEach((function(e){e.onmousedown=function(o){i.$scope.$$("_del").blockEvent(),e.onmouseup=function(){clearInterval(i.interval)},i.interval=setTimeout((function(){i.$scope.$$("_del").unblockEvent()}),t.config.popDelay)}}))},onItemDblClick:function(e){var t={text:(e=this.getSelectedItem()).usloviya,id:e.id,type:"Hran",callback:s.updItem,mode:"upd",source:this};this.$scope.popnew.show("Редактирование условия хранения",t)},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(){},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}}]}},i.ready=function(){var e=[this.$$("_add"),this.$$("_del")];(0,s.setButtons)(this.app,e),(0,s.singleRefReload)(this.app,"getHranAll",this.$$("__table"))},i.init=function(){this.popnew=this.ui(a.default),webix.extend(this.$$("__table"),webix.ProgressBar)},t}(n.iC)},7504:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r});var o=i(1583),n=i(280),s=i(2478),a=i(4402),r=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this,t=this.app;return{view:"layout",rows:[{height:40,view:"toolbar",cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Строка поиска",keyPressTimeout:900,tooltip:"поиск по форме выпуска",on:{onTimedKeyPress:function(e,t){var i=this.getValue().toString().toLowerCase();this.$scope.$$("__table").filter((function(e){return-1!=e.c_issue.toString().toLowerCase().indexOf(i)}))}}},{view:"button",type:"htmlbutton",tooltip:"Добавить форму выпуска",localId:"_add",resizable:!0,sWidth:180,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>Добавить форму</span>",oldLabel:"<span class='webix_icon fa-plus'></span>",click:function(){var t={type:"Issue",callback:s.addItem,mode:"new",source:e.$$("__table")};e.popnew.show("Добавление формы выпуска",t)}},{view:"button",type:"htmlbutton",hidden:!0,localId:"_del",tooltip:"Удалить форму выпуска",resizable:!0,sWidth:180,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>Удалить форму</span>",oldLabel:"<span style='color: red', class='webix_icon fa-times'></span>",on:{onItemClick:function(){var t=e.$$("__table").getSelectedItem().id,i={};i.user=e.app.config.user,i.id=t;var o=JSON.parse((0,s.request)("delIssue",i,!0,e.app).response);o.result?((0,s.delItem)("AllIs",o.ret_val.id,e.$$("__table")),e.$$("_del").hide()):webix.message({type:"error",text:o.ret_val})}}}]},{view:"datatable",name:"_issues",localId:"__table",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,startPos:1,posPpage:20,totalPos:1250,old_stri:"",type:{itemIcon:s.DelEdIcons},onClick:{delete_button:function(e,t,i){var o=this,n=this.getItem(t);!1!==n.delete?setTimeout((function(){o.select(n.id,!1),o.$scope.$$("_del").callEvent("onItemClick")}),50):webix.message({type:"debug",text:"Удаление группы "+n.c_issue+" невозможно",expire:5e3})},edit_button:function(e,t,i){this.select(t,!1),this.callEvent("onItemDblClick",t)}},columns:[{id:"c_issue",headermenu:!1,fillspace:1,sort:"text",header:[{text:"Форма выпуска"}],template:s.refTemplate},{id:"id",sort:"text",width:300,header:[{text:"ID"}]},{id:"id_state",hidden:!0,width:150,header:[{text:"Статус"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){this.count||this.showProgress({type:"icon",icon:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>'})},onAfterRender:function(e){var i=this;Array.prototype.slice.call(document.getElementsByClassName("delete_button")).forEach((function(e){e.onmousedown=function(o){i.$scope.$$("_del").blockEvent(),e.onmouseup=function(){clearInterval(i.interval)},i.interval=setTimeout((function(){i.$scope.$$("_del").unblockEvent()}),t.config.popDelay)}}))},onItemDblClick:function(e){var t={text:(e=this.getSelectedItem()).c_issue,id:e.id,type:"Issue",callback:s.updItem,mode:"upd",source:this};this.$scope.popnew.show("Редактирование формы выпуска",t)},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(){},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}}]}},i.ready=function(){var e=[this.$$("_add"),this.$$("_del")];(0,s.setButtons)(this.app,e),(0,s.singleRefReload)(this.app,"getIssueAll",this.$$("__table"))},i.init=function(){this.popnew=this.ui(a.default),webix.extend(this.$$("__table"),webix.ProgressBar)},t}(n.iC)},9890:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r});var o=i(1583),n=i(280),s=i(2478),a=i(8274),r=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this,t=this.app;return{view:"layout",css:{"border-left":"1px solid #dddddd !important"},rows:[{height:40,view:"toolbar",borderless:!0,cols:[{},{view:"button",type:"htmlbutton",localId:"_renew",resizable:!0,sWidth:136,eWidth:40,label:"",width:40,tooltip:"Обновить таблицу",extLabel:"<span class='button_label'>Обновить</span>",oldLabel:"<span class='webix_icon fa-refresh'></span>",click:function(){e.ready()}},{view:"button",type:"htmlbutton",localId:"_apply",hidden:!0,resizable:!0,sWidth:130,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>Применить</span>",oldLabel:"<span class='webix_icon fa-check'></span>",click:function(){var i={};i.p=e.$$("_lTable").serialize(),i.r=e.$$("_rTable").serialize(),e.hide_b();var o={user:t.config.user,data:i};(0,s.request)("setLinkCodes",o,0,t).then((function(e){e=(0,s.checkVal)(e,"a")}))}},{view:"button",type:"htmlbutton",localId:"_cancel",hidden:!0,resizable:!0,sWidth:130,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>Отменить</span>",oldLabel:"<span class='webix_icon fa-times'></span>",click:function(){e.ready()}}]},{cols:[{rows:[{cols:[{view:"label",label:"Сводить по кодам автоматически",css:"c-label",height:40,fillspace:!0},{view:"button",tooltip:"Перенести все",type:"htmlbutton",label:"<span class='webix_icon fa-angle-double-right'></span>",localId:"_to_r",resizable:!1,width:40,click:function(){var t=e.$$("_lTable").serialize();e.$$("_lTable").clearAll(),t.forEach((function(t){delete t.id,e.$$("_rTable").add(t)})),e.show_b()}},{view:"button",tooltip:"Сбросить фильтры",type:"imageButton",image:a.ZY.unFilter.icon,localId:"_unfilt_p",resizable:!1,label:"",width:40,click:function(){var t=e.$$("_lTable");(0,s.unFilter)(t),e.$$("_lTable").filterByAll()}}]},{view:"datatable",name:"_pTable",localId:"_lTable",select:!0,borderless:!0,rowHeight:30,fixedRowHeight:!1,headermenu:!1,resizeColumn:!0,fi:"c_vnd",di:"asc",searchBar:void 0,searchMethod:"getLinkCodes",old_stri:"",columns:[{id:"id_vnd",width:270,hidden:!1,sort:"int",header:[{text:"Код поставщика"},{content:"textFilter"}]},{id:"c_vnd",hidden:!1,sort:"string",fillspace:!0,header:[{text:"Название поставщика"},{content:"textFilter"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onItemDblClick:function(e){var t=this.getItem(e);this.$scope.show_b(),this.remove(e),delete t.id,this.$scope.$$("_rTable").add(t,0)},onKeyPress:function(e,t){13===e&&this.getSelectedItem()&&this.callEvent("onItemDblClick")},onAfterLoad:function(){this.hideProgress()}}}]},{width:10},{rows:[{cols:[{view:"label",label:"Не сводить по кодам автоматически",css:"c-label",height:40,fillspace:!0},{view:"button",tooltip:"Перенести все",type:"htmlbutton",label:"<span class='webix_icon fa-angle-double-left'></span>",localId:"_to_l",resizable:!1,width:40,click:function(){var t=e.$$("_rTable").serialize();e.$$("_rTable").clearAll(),t.forEach((function(t){delete t.id,e.$$("_lTable").add(t)})),e.show_b()}},{view:"button",tooltip:"Сбросить фильтры",type:"imageButton",image:a.ZY.unFilter.icon,localId:"_unfilt_r",resizable:!1,label:"",width:40,click:function(){var t=e.$$("_rTable");(0,s.unFilter)(t),e.$$("_rTable").filterByAll()}}]},{view:"datatable",name:"_nrTable",localId:"_rTable",select:!0,borderless:!0,rowHeight:30,fixedRowHeight:!1,headermenu:!1,resizeColumn:!0,fi:"c_vnd",di:"asc",searchBar:void 0,searchMethod:"getLinkCodes",old_stri:"",columns:[{id:"id_vnd",width:270,hidden:!1,sort:"int",header:[{text:"Код поставщика"},{content:"textFilter"}]},{id:"c_vnd",hidden:!1,sort:"string",fillspace:!0,header:[{text:"Название поставщика"},{content:"textFilter"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onItemDblClick:function(e){var t=this.getItem(e);this.$scope.show_b(),this.remove(e),delete t.id,this.$scope.$$("_lTable").add(t,0)},onKeyPress:function(e,t){13===e&&this.getSelectedItem()&&this.callEvent("onItemDblClick")},onAfterLoad:function(){this.hideProgress()}}}]}]}]}},i.init=function(){},i.show_b=function(){this.$$("_apply").show(),this.$$("_cancel").show()},i.hide_b=function(){this.$$("_apply").hide(),this.$$("_cancel").hide()},i.ready=function(){var e=this;this.hide_b(),this.$$("_lTable").clearAll(),this.$$("_rTable").clearAll();var t=[this.$$("_renew"),this.$$("_apply"),this.$$("_cancel")];(0,s.setButtons)(this.app,t);var i={user:this.app.config.user};(0,s.request)("getLinkCodes",i,0,this.app).then((function(t){(t=(0,s.checkVal)(t,"a"))&&(t.p.forEach((function(t){e.$$("_lTable").add(t)})),t.r.forEach((function(t){e.$$("_rTable").add(t)})))}))},t}(n.iC)},8160:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>l});var o=i(1583),n=i(280),s=i(2478),a=i(8881),r=i(8274),l=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e,t=this,i=this.app;return{view:"layout",css:{"border-left":"1px solid #dddddd !important"},rows:[{height:40,view:"toolbar",borderless:!0,cols:[{},{view:"button",type:"htmlbutton",localId:"_renew",resizable:!0,sWidth:136,eWidth:40,label:"",width:40,tooltip:"Обновить таблицу",extLabel:"<span class='button_label'>Обновить</span>",oldLabel:"<span class='webix_icon fa-refresh'></span>",click:function(){t.ready()}},{view:"button",type:"htmlbutton",localId:"_apply",hidden:!0,resizable:!0,sWidth:130,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>Применить</span>",oldLabel:"<span class='webix_icon fa-check'></span>",click:function(){var e={};e.l=t.$$("_lTable").serialize(),e.r=t.$$("_rTable").serialize();var o={user:i.config.user,data:e};(0,s.request)("setLinkExcludes",o,0,i).then((function(e){(e=(0,s.checkVal)(e,"a"))&&t.hide_b()}))}},{view:"button",type:"htmlbutton",localId:"_cancel",hidden:!0,resizable:!0,sWidth:130,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>Отменить</span>",oldLabel:"<span class='webix_icon fa-times'></span>",click:function(){t.ready()}}]},{cols:[{rows:[{cols:[{view:"label",label:"Слова исключения из сведения",css:"c-label",height:40,fillspace:!0},{view:"button",tooltip:"Перенести все",type:"htmlbutton",label:"<span class='webix_icon fa-angle-double-right'></span>",localId:"_to_r",resizable:!1,width:40,click:function(){var e=t.$$("_lTable").serialize();t.$$("_lTable").clearAll(),e.forEach((function(e){delete e.id,t.$$("_rTable").add(e),t.show_b()}))}},{view:"button",tooltip:"Перенести выделенные",type:"htmlbutton",hidden:!0,label:"<span class='webix_icon fa-angle-right'></span>",localId:"_to_r_s",resizable:!1,width:40,click:function(){var e=t.$$("_lTable").getSelectedId();e.length||(e=[e]),e.forEach((function(e){var i=t.$$("_lTable").getItem(e);delete i.id,t.$$("_rTable").add(i,0),t.$$("_lTable").remove(e),t.show_b()}))}},{view:"button",tooltip:"Сбросить фильтры",type:"imageButton",image:r.ZY.unFilter.icon,localId:"_unfilt_p",resizable:!1,label:"",width:40,click:function(){var e=t.$$("_lTable");(0,s.unFilter)(e),t.$$("_lTable").filterByAll()}}]},{view:"datatable",name:"_lTable",localId:"_lTable",select:!0,multiselect:!0,borderless:!0,rowHeight:30,fixedRowHeight:!1,headermenu:!1,resizeColumn:!0,onMouseMove:!0,columns:[{id:"name",fillspace:!0,header:[{text:"Наименование исключения"},{content:"textFilter"}]},{id:"options_st",header:[{text:"Параметры исключения",colspan:2,css:{"text-align":"center"}},{text:"Начинается",css:{"text-align":"center"}}],template:function(e,t,i){return i?"<span class='webix_icon fa-check'></span>":"<span></span>"},width:100,css:"center_p"},{id:"options_in",header:["",{text:"Содержит",css:{"text-align":"center"}}],template:function(e,t,i){return i?"<span class='webix_icon fa-check'></span>":"<span></span>"},width:100,css:"center_p"},{id:"owner",width:150,header:[{text:"Кто добавил"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onMouseMoving:function(e){if("webix_ss_center_scroll"===e.target.parentElement.parentElement.className&&1===e.buttons){var t=e.target.getAttribute("aria-rowindex"),i=this.data.order[t];this.getItem(i),this.isSelected(i)||(this.select(i,!0),this.$scope.$$("_to_r_s").show())}return!0},onAfterSelect:function(e){this.$scope.$$("_to_r_s").show()},onAfterUnSelect:function(){var e=this,t=this.data.order,i=!1;t.forEach((function(t){e.isSelected(t)&&(i=!0)})),i||this.$scope.$$("_to_r_s").hide()},onItemDblClick:function(e){var t=this.getItem(e);this.$scope.newexclude.show("Редактирование исключения",this.$scope.$$("_lTable"),t)},onKeyPress:function(e,t){13===e&&this.getSelectedItem()&&this.callEvent("onItemDblClick")},onAfterLoad:function(){this.hideProgress()}}}]},{width:10},{rows:[{cols:[{view:"label",label:"Общий список слов исключений",css:"c-label",height:40,fillspace:!0},{view:"button",type:"htmlbutton",hidden:!i.config.roles[i.config.role].useradd,tooltip:"Добавить исключение",localId:"_add",resizable:!0,sWidth:140,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>исключение</span>",oldLabel:"<span class='webix_icon fa-plus'></span>",click:function(){t.newexclude.show("Добавление нового исключения",t.$$("_rTable"))}},(e={view:"button",type:"htmlbutton",hidden:!i.config.roles[i.config.role].useradd},e.hidden=!0,e.tooltip="Удалить исключение",e.localId="_del",e.resizable=!0,e.sWidth=140,e.eWidth=40,e.label="",e.width=40,e.extLabel="<span class='button_label'>исключение</span>",e.oldLabel="<span class='webix_icon fa-minus', style='color: red'></span>",e.click=function(){webix.message({text:"Удаление исключения",type:"debug",width:"400px",delay:"5"})},e),{view:"button",tooltip:"Перенести выделенные",type:"htmlbutton",hidden:!0,label:"<span class='webix_icon fa-angle-left'></span>",localId:"_to_l_s",resizable:!1,width:40,click:function(){var e=t.$$("_rTable").getSelectedId();e.length||(e=[e]),e.forEach((function(e){var i=t.$$("_rTable").getItem(e);delete i.id,t.$$("_lTable").add(i,0),t.$$("_rTable").remove(e),t.show_b()}))}},{view:"button",tooltip:"Перенести все",type:"htmlbutton",label:"<span class='webix_icon fa-angle-double-left'></span>",localId:"_to_l",resizable:!1,width:40,click:function(){var e=t.$$("_rTable").serialize();t.$$("_rTable").clearAll(),e.forEach((function(e){delete e.id,t.$$("_lTable").add(e),t.show_b()}))}},{view:"button",tooltip:"Сбросить фильтры",type:"imageButton",image:r.ZY.unFilter.icon,localId:"_unfilt_r",resizable:!1,label:"",width:40,click:function(){var e=t.$$("_rTable");(0,s.unFilter)(e),t.$$("_rTable").filterByAll()}}]},{view:"datatable",name:"_rTable",localId:"_rTable",select:!0,multiselect:!0,borderless:!0,rowHeight:30,fixedRowHeight:!1,headermenu:!1,resizeColumn:!0,onMouseMove:!0,columns:[{id:"name",fillspace:!0,header:[{text:"Наименование исключения"},{content:"textFilter"}]},{id:"options_st",header:[{text:"Параметры исключения",colspan:2,css:{"text-align":"center"}},{text:"Начинается",css:{"text-align":"center"}}],template:function(e,t,i){return i?"<span class='webix_icon fa-check'></span>":"<span></span>"},width:100,css:"center_p"},{id:"options_in",header:["",{text:"Содержит",css:{"text-align":"center"}}],template:function(e,t,i){return i?"<span class='webix_icon fa-check'></span>":"<span></span>"},width:100,css:"center_p"},{id:"owner",width:150,header:[{text:"Кто добавил"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onMouseMoving:function(e){if("webix_ss_center_scroll"===e.target.parentElement.parentElement.className&&1===e.buttons){var t=e.target.getAttribute("aria-rowindex"),i=this.data.order[t];this.getItem(i),this.isSelected(i)||(this.select(i,!0),this.$scope.$$("_to_l_s").show(),this.$scope.$$("_del").show())}return!0},onAfterSelect:function(e){this.$scope.$$("_to_l_s").show(),this.$scope.$$("_del").show()},onAfterUnSelect:function(){var e=this,t=this.data.order,i=!1;t.forEach((function(t){e.isSelected(t)&&(i=!0)})),i||(this.$scope.$$("_to_l_s").hide(),this.$scope.$$("_del").hide())},onItemDblClick:function(e){var t=this.getItem(e);this.$scope.newexclude.show("Редактирование исключения",this.$scope.$$("_rTable"),t)},onKeyPress:function(e,t){13===e&&this.getSelectedItem()&&this.callEvent("onItemDblClick")},onAfterLoad:function(){this.hideProgress()}}}]}]}]}},i.init=function(){this.newexclude=this.ui(a.default)},i.show_b=function(){this.$$("_apply").show(),this.$$("_cancel").show()},i.hide_b=function(){this.$$("_apply").hide(),this.$$("_cancel").hide()},i.ready=function(e){var t=this;this.$$("_lTable").clearAll(),this.$$("_rTable").clearAll();var i=[this.$$("_renew"),this.$$("_apply"),this.$$("_cancel"),this.$$("_add"),this.$$("_del")];(0,s.setButtons)(this.app,i);var o={user:this.app.config.user};(0,s.request)("getLinkExcludes",o,0,this.app).then((function(e){(e=(0,s.checkVal)(e,"a"))&&(e.l.forEach((function(e){t.$$("_lTable").add(e)})),e.r.forEach((function(e){t.$$("_rTable").add(e)})))})),this.hide_b()},t}(n.iC)},1574:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r});var o=i(1583),n=i(280),s=i(2478),a=i(8755),r=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this;return this.app,{view:"layout",css:{"border-left":"1px solid #dddddd !important"},rows:[{height:40,view:"toolbar",borderless:!0,cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Строка поиска",tooltip:"Поиск"},{view:"button",type:"htmlbutton",localId:"_add",resizable:!0,sWidth:83,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>файл</span>",oldLabel:"<span class='webix_icon fa-plus'></span>",click:function(){e.pop_upl.show_window("Загрузка файла")}},{view:"button",type:"htmlbutton",localId:"_renew",resizable:!0,sWidth:136,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>Обновить</span>",oldLabel:"<span class='webix_icon fa-refresh'></span>",click:function(){var t={user:e.app.config.user};(0,s.request)("getTasks",t,0,e.app).then((function(t){(t=(0,s.checkVal)(t,"a")).length>0?e.$$("__table").parse(t):e.$$("__table").clearAll()}))}}]},{view:"datatable",name:"_files",localId:"__table",select:!0,resizeColumn:!0,borderless:!0,navigation:"row",rowHeight:32,fixedRowHeight:!1,rowLineHeight:32,editable:!1,columns:[{id:"uin",width:260,header:[{text:"Идентификатор задания"}]},{id:"vendor",fillspace:1,header:[{text:"Поставщик"}]},{id:"customer",width:150,header:[{text:"Клиент"}]},{id:"source",width:130,header:[{text:"Источник"}]},{id:"count",width:130,header:[{text:"Осталось позиций"}]},{id:"dt",width:200,format:s.dt_formating_sec,header:[{text:"Время добавления"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)}}}]}},i.init=function(){this.pop_upl=this.ui(a.default)},i.ready=function(e){var t=this,i=[this.$$("_renew"),this.$$("_add")];(0,s.setButtons)(this.app,i);var o={user:this.app.config.user};(0,s.request)("getTasks",o,0,this.app).then((function(e){(e=(0,s.checkVal)(e,"a")).length>0&&t.$$("__table").parse(e)}))},t}(n.iC)},78:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>l});var o=i(1583),n=i(280),s=i(2478),a=i(1181),r=i(8274),l=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e,t=this,i=this.app,o={rows:[{cols:[{view:"label",label:"Постащики, запрещенные к сведению",css:"c-label",height:40,fillspace:!0},{view:"button",tooltip:"Перенести все",type:"htmlbutton",label:"<span class='webix_icon fa-angle-double-right'></span>",localId:"_to_r",resizable:!1,width:40,click:function(){var e=t.$$("_lTable").serialize();t.$$("_lTable").clearAll(),e.forEach((function(e){delete e.id,t.$$("_rTable").add(e),t.show_b()}))}},{view:"button",tooltip:"Перенести выделенные",type:"htmlbutton",hidden:!0,label:"<span class='webix_icon fa-angle-right'></span>",localId:"_to_r_s",resizable:!1,width:40,click:function(){var e=t.$$("_lTable").getSelectedId();e.length||(e=[e]),e.forEach((function(e){var i=t.$$("_lTable").getItem(e);delete i.id,t.$$("_rTable").add(i,0),t.$$("_lTable").remove(e),t.show_b()}))}},{view:"button",tooltip:"Сбросить фильтры",type:"imageButton",image:r.ZY.unFilter.icon,localId:"_unfilt_p",resizable:!1,label:"",width:40,click:function(){var e=t.$$("_lTable");unFilter(e),t.$$("_lTable").filterByAll()}}]},{view:"datatable",name:"_lTable",localId:"_lTable",select:!0,multiselect:!0,borderless:!0,rowHeight:30,fixedRowHeight:!1,headermenu:!1,resizeColumn:!0,onMouseMove:!0,columns:[{id:"code",header:[{text:"Код поставщика"},{content:"textFilter"}]},{id:"name",fillspace:!0,header:[{text:"Наименование поставщика"},{content:"textFilter"}]},{id:"owner",width:150,header:[{text:"Кто добавил"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onMouseMoving:function(e){if("webix_ss_center_scroll"===e.target.parentElement.parentElement.className&&1===e.buttons){var t=e.target.getAttribute("aria-rowindex"),i=this.data.order[t];this.getItem(i),this.isSelected(i)||(this.select(i,!0),this.$scope.$$("_to_r_s").show())}return!0},onAfterSelect:function(e){this.$scope.$$("_to_r_s").show()},onAfterUnSelect:function(){var e=this,t=this.data.order,i=!1;t.forEach((function(t){e.isSelected(t)&&(i=!0)})),i||this.$scope.$$("_to_r_s").hide()},onItemDblClick:function(e){var t=this.getItem(e);this.$scope.newcode.show("Редактирование поставщика",this.$scope.$$("_lTable"),t)},onKeyPress:function(e,t){13===e&&this.getSelectedItem()&&this.callEvent("onItemDblClick")},onAfterLoad:function(){this.hideProgress()}}}]},n={rows:[{cols:[{view:"label",label:"Поставщики",css:"c-label",height:40,fillspace:!0},{view:"button",type:"htmlbutton",hidden:!i.config.roles[i.config.role].useradd,tooltip:"Добавить исключение",localId:"_add",resizable:!0,sWidth:140,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>исключение</span>",oldLabel:"<span class='webix_icon fa-plus'></span>",click:function(){t.newcode.show("Добавление нового поставщика",t.$$("_rTable"))}},(e={view:"button",type:"htmlbutton",hidden:!i.config.roles[i.config.role].useradd},e.hidden=!0,e.tooltip="Удалить исключение",e.localId="_del",e.resizable=!0,e.sWidth=140,e.eWidth=40,e.label="",e.width=40,e.extLabel="<span class='button_label'>исключение</span>",e.oldLabel="<span class='webix_icon fa-minus', style='color: red'></span>",e.click=function(){webix.message({text:"Удаление поставщика",type:"debug",width:"400px",delay:"5"})},e),{view:"button",tooltip:"Перенести выделенные",type:"htmlbutton",hidden:!0,label:"<span class='webix_icon fa-angle-left'></span>",localId:"_to_l_s",resizable:!1,width:40,click:function(){var e=t.$$("_rTable").getSelectedId();e.length||(e=[e]),e.forEach((function(e){var i=t.$$("_rTable").getItem(e);delete i.id,t.$$("_lTable").add(i,0),t.$$("_rTable").remove(e),t.show_b()}))}},{view:"button",tooltip:"Перенести все",type:"htmlbutton",label:"<span class='webix_icon fa-angle-double-left'></span>",localId:"_to_l",resizable:!1,width:40,click:function(){var e=t.$$("_rTable").serialize();t.$$("_rTable").clearAll(),e.forEach((function(e){delete e.id,t.$$("_lTable").add(e),t.show_b()}))}},{view:"button",tooltip:"Сбросить фильтры",type:"imageButton",image:r.ZY.unFilter.icon,localId:"_unfilt_r",resizable:!1,label:"",width:40,click:function(){var e=t.$$("_rTable");unFilter(e),t.$$("_rTable").filterByAll()}}]},{view:"datatable",name:"_rTable",localId:"_rTable",select:!0,multiselect:!0,borderless:!0,rowHeight:30,fixedRowHeight:!1,headermenu:!1,resizeColumn:!0,onMouseMove:!0,columns:[{id:"code",header:[{text:"Код поставщика"},{content:"textFilter"}]},{id:"name",fillspace:!0,header:[{text:"Наименование поставщика"},{content:"textFilter"}]},{id:"owner",width:150,header:[{text:"Кто добавил"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onMouseMoving:function(e){if("webix_ss_center_scroll"===e.target.parentElement.parentElement.className&&1===e.buttons){var t=e.target.getAttribute("aria-rowindex"),i=this.data.order[t];this.getItem(i),this.isSelected(i)||(this.select(i,!0),this.$scope.$$("_to_l_s").show(),this.$scope.$$("_del").show())}return!0},onAfterSelect:function(e){this.$scope.$$("_to_l_s").show(),this.$scope.$$("_del").show()},onAfterUnSelect:function(){var e=this,t=this.data.order,i=!1;t.forEach((function(t){e.isSelected(t)&&(i=!0)})),i||(this.$scope.$$("_to_l_s").hide(),this.$scope.$$("_del").hide())},onItemDblClick:function(e){var t=this.getItem(e);this.$scope.newcode.show("Редактирование поставщика",this.$scope.$$("_rTable"),t)},onKeyPress:function(e,t){13===e&&this.getSelectedItem()&&this.callEvent("onItemDblClick")},onAfterLoad:function(){this.hideProgress()}}}]},a={height:40,view:"toolbar",borderless:!0,cols:[{},{view:"button",type:"htmlbutton",localId:"_renew",resizable:!0,sWidth:136,eWidth:40,label:"",width:40,tooltip:"Обновить таблицу",extLabel:"<span class='button_label'>Обновить</span>",oldLabel:"<span class='webix_icon fa-refresh'></span>",click:function(){t.ready()}},{view:"button",type:"htmlbutton",localId:"_apply",hidden:!0,resizable:!0,sWidth:130,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>Применить</span>",oldLabel:"<span class='webix_icon fa-check'></span>",click:function(){var e={};e.l=t.$$("_lTable").serialize(),e.r=t.$$("_rTable").serialize();var o={user:i.config.user,data:e};(0,s.request)("setLinkSuppl",o,0,i).then((function(e){(e=(0,s.checkVal)(e,"a"))&&t.hide_b()}))}},{view:"button",type:"htmlbutton",localId:"_cancel",hidden:!0,resizable:!0,sWidth:130,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>Отменить</span>",oldLabel:"<span class='webix_icon fa-times'></span>",click:function(){t.ready()}}]};return i.config.roles[i.config.role].useradd,{view:"layout",css:{"border-left":"1px solid #dddddd !important"},rows:[a,{cols:[o,{width:10},n]}]}},i.show_b=function(){this.$$("_apply").show(),this.$$("_cancel").show()},i.hide_b=function(){this.$$("_apply").hide(),this.$$("_cancel").hide()},i.init=function(){this.newcode=this.ui(a.default)},i.ready=function(){var e=this;this.$$("_lTable").clearAll(),this.$$("_rTable").clearAll();var t=[this.$$("_renew"),this.$$("_apply"),this.$$("_cancel"),this.$$("_add"),this.$$("_del")];(0,s.setButtons)(this.app,t);var i={user:this.app.config.user};(0,s.request)("getLinkSuppl",i,0,this.app).then((function(t){(t=(0,s.checkVal)(t,"a"))&&(t.r.forEach((function(t){e.$$("_lTable").add(t)})),t.p.forEach((function(t){e.$$("_rTable").add(t)})))})),this.hide_b()},t}(n.iC)},8191:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var o=i(1583),n=i(280),s=i(2478),a=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this,t=this;t.options=t.getUGroups();var i=this.app;return{view:"layout",css:{"border-left":"1px solid #dddddd !important"},rows:[{height:40,view:"toolbar",borderless:!0,cols:[{},{view:"combo",label:"Назначить помеченные на:",labelWidth:"auto",localId:"__group_selection",hidden:!0,width:350,options:t.options,on:{onChange:function(e,o){var n=this,a=[];this.$scope.$$("__table").serialize(!0).forEach((function(e){1==e._check&&a.push(e)})),t.confirmSelection({ok:function(){var o={user:i.config.user,group:e,rows:a};(0,s.checkVal)((0,s.request)("setVndsUsers",o,!0,i).response,"s")&&(t.$$("__renew").callEvent("onItemClick"),n.blockEvent(),n.setValue(),n.unblockEvent(),t.setGroupImmediately(t,e))},error:function(){n.blockEvent(),n.setValue(),n.unblockEvent()}},e)}}},{view:"button",type:"htmlbutton",localId:"__renew",resizable:!0,sWidth:136,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>Обновить</span>",oldLabel:"<span class='webix_icon fa-refresh'></span>",on:{onItemClick:function(){t.$$("__group_selection").hide();var i={user:e.app.config.user};(0,s.request)("getVndsUsers",i,0,e.app).then((function(t){(t=(0,s.checkVal)(t,"a")).length>0?e.$$("__table").parse(t):e.$$("__table").clearAll()}))}}}]},{view:"datatable",name:"_vendors",localId:"__table",select:!0,resizeColumn:!0,borderless:!0,navigation:"row",rowHeight:32,fixedRowHeight:!1,rowLineHeight:32,editable:!0,editaction:"dblclick",columns:[{id:"_check",header:{content:"masterCheckbox",css:"center_p"},css:"center_p",width:80,template:"{common.checkbox()}"},{id:"id_vnd",width:260,sort:"int",header:[{text:"id поставщика"},{content:"textFilter"}]},{id:"c_vnd",fillspace:1,sort:"text",header:[{text:"Поставщик"},{content:"textFilter"}]},{id:"users_group",hidden:!0},{id:"c_group",width:130,sort:"text",editor:"combo",options:t.options,header:[{text:"Группа пользователей"},{content:"selectFilter"}]},{id:"c_description",width:170,header:[{text:"Описание"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onAfterLoad:function(){this.sort("id_vnd","asc"),this.markSorting("id_vnd","asc")},onDataUpdate:function(e,i,o,n){var a=this;if(i._check!=o._check)return!1;t.confirmSelection({ok:function(){var n={user:t.app.config.user,group:i.c_group,rows:[i]};(0,s.checkVal)((0,s.request)("setVndsUsers",n,!0,t.app).response,"s")?t.setGroupImmediately(t,i):(a.blockEvent(),a.updateItem(e,o),a.unblockEvent())},error:function(){a.blockEvent(),a.updateItem(e,o),a.unblockEvent()}},i),this.filterByAll()},onCheck:function(e,i,o){var n=this.$scope.$$("__table").serialize(!0),s=[];n.forEach((function(e){1!=e._check&&s.push(e)})),n.length===s.length?t.$$("__group_selection").hide():(t.$$("__group_selection").show(),t.$$("__group_selection").blockEvent(),t.$$("__group_selection").setValue(),t.$$("__group_selection").unblockEvent())}}}]}},i.confirmSelection=function(e,t){var i=t.c_vnd?"у постащика "+t.c_vnd:"у выбранных поставщиков",o=t.c_group?t.c_group:t;webix.confirm({type:"confirm-error",ok:"Да",cancel:"Нет",text:"<span style='font-size: 14px; line-height: 20px'>Сменить "+i+" группу на "+o+"?</span>",callback:function(t){t?e.ok():e.error()}})},i.setGroupImmediately=function(e,t){var i=t.c_vnd?t.c_vnd:"",o=t.c_group?t.c_group:t;webix.confirm({width:300,type:"confirm-warning",ok:"Да",cancel:"Нет",text:"<span style='font-size: 14px; line-height: 20px'>Позиции"+i+" за последние три дня будут АВТОМАТИЧЕСКИ назначенны на группу "+o+".Переназначить ВСЕ СТАРЫЕ позиции на "+o+"?</span>",callback:function(i){if(i){var n={user:e.app.config.user,group:o,rows:t.c_group?[t]:t};(0,s.request)("updatePrcNewUsers",n,0,app).then((function(e){}))}}})},i.getUGroups=function(){var e={user:this.app.config.user};return(0,s.checkVal)((0,s.request)("getUsersGroups",e,!0,this.app).response,"s")},i.ready=function(e){var t=this,i=[this.$$("__renew")];(0,s.setButtons)(this.app,i);var o={user:this.app.config.user};(0,s.request)("getVndsUsers",o,0,this.app).then((function(e){(e=(0,s.checkVal)(e,"a")).length>0&&t.$$("__table").parse(e)}))},t}(n.iC)},1695:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>c});var o=i(1583),n=i(280),s=(i(2478),i(9890)),a=i(78),r=i(8160),l=(i(1574),i(8191)),c=function(e){function t(){return e.apply(this,arguments)||this}return(0,o.Z)(t,e),t.prototype.config=function(){return this.app,{view:"layout",rows:[{height:4},{view:"tabview",multiview:!0,cells:[{header:"<span class='webix_icon fa-code'></span><span style='line-height: 20px;'> Сведение по кодам</span>",width:240,body:{view:"layout",rows:[{$subview:s.default}]}},{header:"<span class='webix_icon fa-star'></span><span style='line-height: 20px;'> Разрешения для поставщиков</span>",width:280,body:{view:"layout",rows:[{$subview:a.default}]}},{header:"<span class='webix_icon fa-exclamation-triangle '></span><span style='line-height: 20px;'> Слова исключения</span>",width:240,body:{view:"layout",rows:[{$subview:r.default}]}},{header:"<span class='webix_icon fa-file'></span><span style='line-height: 20px;padding-right: 5px'>Поставщики->пользователи  </span>",width:"0",body:{view:"layout",rows:[{$subview:l.default}]}}]}]}},t}(n.iC)},6874:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r});var o=i(1583),n=i(280),s=i(2478),a=i(4402),r=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this,t=this.app;return{view:"layout",rows:[{height:40,view:"toolbar",cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Строка поиска",keyPressTimeout:900,tooltip:"поиск по НДС",on:{onTimedKeyPress:function(e,t){var i=this.getValue().toString().toLowerCase();this.$scope.$$("__table").filter((function(e){return-1!=e.nds.toString().toLowerCase().indexOf(i)}))}}},{view:"button",type:"htmlbutton",tooltip:"Добавить НДС",localId:"_add",resizable:!0,sWidth:160,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>Добавить НДС</span>",oldLabel:"<span class='webix_icon fa-plus'></span>",click:function(){var t={type:"Nds",callback:s.addItem,mode:"new",source:e.$$("__table")};e.popnew.show("Добавление НДС",t)}},{view:"button",type:"htmlbutton",hidden:!0,localId:"_del",tooltip:"Удалить НДС",resizable:!0,sWidth:180,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>Удалить НДС</span>",oldLabel:"<span style='color: red', class='webix_icon fa-times'></span>",on:{onItemClick:function(){var t=e.$$("__table").getSelectedItem().id,i={};i.user=e.app.config.user,i.id=t;var o=(0,s.request)("delNds",i,!0,e.app).response;(o=(0,s.checkVal)(o,"s"))&&((0,s.delItem)("Nds",o.id,e.$$("__table")),e.$$("_del").hide())}}}]},{view:"datatable",name:"_nds",localId:"__table",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,startPos:1,posPpage:20,totalPos:1250,old_stri:"",type:{itemIcon:s.DelEdIcons},onClick:{delete_button:function(e,t,i){var o=this,n=this.getItem(t);!1!==n.delete?setTimeout((function(){o.select(n.id,!1),o.$scope.$$("_del").callEvent("onItemClick")}),50):webix.message({type:"debug",text:"Удаление группы "+n.c_issue+" невозможно",expire:5e3})},edit_button:function(e,t,i){this.select(t,!1),this.callEvent("onItemDblClick",t)}},columns:[{id:"nds",headermenu:!1,fillspace:1,sort:"text",header:[{text:"НДС"}],template:s.refTemplate},{id:"id",width:200,sort:"text",header:[{text:"ID"}]},{id:"id_state",width:150,hidden:!0,header:[{text:"Статус"}]},{id:"dt",width:250,hidden:!0,header:[{text:"Дата заведения"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){this.count||this.showProgress({type:"icon",icon:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>'})},onAfterRender:function(e){var i=this;Array.prototype.slice.call(document.getElementsByClassName("delete_button")).forEach((function(e){e.onmousedown=function(o){i.$scope.$$("_del").blockEvent(),e.onmouseup=function(){clearInterval(i.interval)},i.interval=setTimeout((function(){i.$scope.$$("_del").unblockEvent()}),t.config.popDelay)}}))},onItemDblClick:function(e){var t={text:(e=this.getSelectedItem()).nds,id:e.id,type:"Nds",callback:s.updItem,mode:"upd",source:this};this.$scope.popnew.show("Редактирование НДС",t)},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(){},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}}]}},i.ready=function(){var e=[this.$$("_add"),this.$$("_del")];(0,s.setButtons)(this.app,e),(0,s.singleRefReload)(this.app,"getNdsAll",this.$$("__table"))},i.init=function(){this.popnew=this.ui(a.default),webix.extend(this.$$("__table"),webix.ProgressBar)},t}(n.iC)},5007:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>b});var o=i(1583),n=i(280),s=i(2478),a=i(5501),r=i(8243),l=i(6274),c=i(3335),d=i(3636),h=i(1456),u=i(4376),p=i(6874),f=i(8442),g=i(7504),_=i(7204),b=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){return this.app,{view:"layout",type:"clean",rows:[{view:"toolbar",height:40,css:{"border-top":"0px"},cols:[{},{}]},{height:3},{view:"tabview",multiview:!0,cells:[{header:"<span style='line-height: 20px;'>Эталоны</span>",width:120,body:{view:"layout",rows:[{$subview:a.default}]}},{header:"<span style='line-height: 20px;'>Товарные группы</span>",width:140,body:{view:"layout",rows:[{$subview:_.default}]}},{header:"<span style='line-height: 20px;'>Формы выпуска</span>",width:120,body:{view:"layout",rows:[{$subview:g.default}]}},{header:"<span style='line-height: 20px;'>Страны</span>",width:120,body:{view:"layout",rows:[{$subview:r.default}]}},{header:"<span style='line-height: 20px;'>Производители</span>",width:120,body:{view:"layout",rows:[{$subview:l.default}]}},{header:"<span style='line-height: 20px;'>ДВ</span>",width:120,body:{view:"layout",rows:[{$subview:c.default}]}},{header:"<span style='line-height: 20px;'>Штрихкоды</span>",width:120,body:{view:"layout",rows:[{$subview:d.default}]}},{header:"<span style='line-height: 20px;'>Группы</span>",width:120,body:{view:"layout",rows:[{$subview:h.default}]}},{header:"<span style='line-height: 20px;'>Условия хранения</span>",width:140,body:{view:"layout",rows:[{$subview:u.default}]}},{header:"<span style='line-height: 20px;'>НДС</span>",width:120,body:{view:"layout",rows:[{$subview:p.default}]}},{header:"<span style='line-height: 20px;'>Сезоны</span>",width:120,body:{view:"layout",rows:[{$subview:f.default}]}}]}]}},i.ready=function(){(0,s.getRefs)(this.app)},t}(n.iC)},8442:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r});var o=i(1583),n=i(280),s=i(2478),a=i(4402),r=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this,t=this.app;return{view:"layout",rows:[{view:"toolbar",height:40,cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Строка поиска",keyPressTimeout:900,tooltip:"поиск по сезону",on:{onTimedKeyPress:function(e,t){var i=this.getValue().toString().toLowerCase();this.$scope.$$("__table").filter((function(e){return-1!=e.sezon.toString().toLowerCase().indexOf(i)}))}}},{view:"button",type:"htmlbutton",tooltip:"Добавить сезон",localId:"_add",resizable:!0,sWidth:180,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>Добавить сезон</span>",oldLabel:"<span class='webix_icon fa-plus'></span>",click:function(){var t={type:"Sez",callback:s.addItem,mode:"new",source:e.$$("__table")};e.popnew.show("Добавление сезонности",t)}},{view:"button",type:"htmlbutton",hidden:!0,localId:"_del",tooltip:"Удалить сезон",resizable:!0,sWidth:180,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>Удалить сезон</span>",oldLabel:"<span style='color: red', class='webix_icon fa-times'></span>",on:{onItemClick:function(){var t=e.$$("__table").getSelectedItem().id,i={};i.user=e.app.config.user,i.id=t;var o=(0,s.request)("delSez",i,!0,e.app).response;(o=(0,s.checkVal)(o,"s"))&&((0,s.delItem)("Sezon",o.id,e.$$("__table")),e.$$("_del").hide())}}}]},{view:"datatable",name:"_seasons",localId:"__table",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,startPos:1,posPpage:20,totalPos:1250,old_stri:"",type:{itemIcon:s.DelEdIcons},onClick:{delete_button:function(e,t,i){var o=this,n=this.getItem(t);!1!==n.delete?setTimeout((function(){o.select(n.id,!1),o.$scope.$$("_del").callEvent("onItemClick")}),50):webix.message({type:"debug",text:"Удаление группы "+n.c_issue+" невозможно",expire:5e3})},edit_button:function(e,t,i){this.select(t,!1),this.callEvent("onItemDblClick",t)}},columns:[{id:"sezon",headermenu:!1,fillspace:1,sort:"text",header:[{text:"Сезон"}],template:s.refTemplate},{id:"id",width:200,sort:"text",header:[{text:"ID"}]},{id:"id_state",width:150,hidden:!0,header:[{text:"Статус"}]},{id:"dt",width:250,hidden:!0,header:[{text:"Дата заведения"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){this.count||this.showProgress({type:"icon",icon:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>'})},onAfterRender:function(e){var i=this;Array.prototype.slice.call(document.getElementsByClassName("delete_button")).forEach((function(e){e.onmousedown=function(o){i.$scope.$$("_del").blockEvent(),e.onmouseup=function(){clearInterval(i.interval)},i.interval=setTimeout((function(){i.$scope.$$("_del").unblockEvent()}),t.config.popDelay)}}))},onItemDblClick:function(e){var t={text:(e=this.getSelectedItem()).sezon,id:e.id,type:"Sez",callback:s.updItem,mode:"upd",source:this};this.$scope.popnew.show("Редактирование сезонности",t)},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(){},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}}]}},i.ready=function(){var e=[this.$$("_add"),this.$$("_del")];(0,s.setButtons)(this.app,e),(0,s.singleRefReload)(this.app,"getSezonAll",this.$$("__table"))},i.init=function(){this.popnew=this.ui(a.default),webix.extend(this.$$("__table"),webix.ProgressBar)},t}(n.iC)},5501:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>f});var o=i(1583),n=i(280),s=i(6891),a=i(9968),r=i(2478),l=i(1118),c=i(14),d=i(3291),h=i(4472),u=i(9534),p=i(8274),f=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this,t=this.app,i=this;this.options=(0,r.fillFilterOptions)(t);var o={view:"datatable",name:"__dt_as",localId:"__table",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:{autowidth:!0},scroll:"xy",type:{itemIcon:r.DelEdIcons},onClick:{delete_button:function(e,t,i){var o=this,n=this.getItem(t);!1!==n.delete?setTimeout((function(){o.select(n.id,!1),o.$scope.$$("_del").callEvent("onItemClick")}),50):webix.message({type:"debug",text:"Удаление  "+n.c_item+" невозможно",expire:5e3})},edit_button:function(e,t,i){this.select(t,!1),this.callEvent("onItemDblClick",t)}},subview:function(t,i){var o=e.$$("__table").getItem(t.id);o=o.id_spr,(o=(0,r.get_spr)(e,o)).id=t.id,o.s_name="Страна: "+o.c_strana,o.t_name="Название товара: "+o.c_tovar,o.v_name="Производитель: "+o.c_zavod,o.dv_name="Д. вещество: "+o.c_dv;var n=new c.default(e.app,{pager:e.$$("__table").getParentView().getParentView().getChildViews()[2].$scope.$$("__page"),dt:e.$$("__table"),item:o,header:"<span style='color: red; text-transform: uppercase;'>Редактирование записи </span>"+o.id_spr,search_bar:e.$$("_sb")});return e.ui(n,{container:i}),n.getRoot()},startPos:1,posPpage:t.config.posPpage,totalPos:1250,fi:"c_tovar",di:"asc",searchBar:void 0,searchMethod:"getSprSearchAdm",old_stri:"",css:"adm-spr",tooltip:!0,columns:[{id:"checkbox",css:"center_p",width:75,tooltip:!1,header:[{text:"",css:"counter-dt"},{content:"threeStCh",css:"center_p",contentId:"ch1",inputConfig:{counter:"checkbox",buttonIcon:"check-circle",maxCount:5e3,getIdMethod:"getIdSprSearchAdm"}}],template:"{common.checkbox()}",headermenu:!1},{id:"price",width:100,hidden:!0,template:function(e){return 1==+e.price?"<span class='webix_icon fa-check-circle', style='color: green'></span>":"<span class='webix_icon fa-times-circle', style='color: red'></span>"},css:"center_p",tooltip:!1,header:[{text:"В прайсе",css:"center_p"},{content:"richFilt",compare:r.compareTrue,inputConfig:{options:[{id:1,value:"Да"},{id:2,value:"Нет"}],scrollView:!0}}]},{id:"id_mnn",width:75,tooltip:!1,template:function(e){return 0!=+e.id_dv?"<span class='webix_icon fa-check-circle', style='color: green'></span>":"<span class='webix_icon fa-times-circle', style='color: red'></span>"},css:"center_p",header:[{text:"МНН",css:"center_p"}]},{id:"id_jv",width:100,tooltip:!1,template:function(e){return 0!=+e.id_jv?"<span class='webix_icon fa-check-circle', style='color: green'></span>":""},css:"center_p",header:[{text:"ЖВ",css:"center_p"},{content:"richFilt",compare:r.compareTrue,inputConfig:{options:[{id:1,value:"Да"},{id:2,value:"Нет"}],scrollView:!0}}]},{id:"id_spr",width:80,sort:"server",tooltip:!1,header:[{text:"IDSPR"},{content:"cFilt",inputConfig:{scrollView:!0,pager:2}}],headermenu:!1},{id:"c_tovar",fillspace:1,sort:"server",css:"overflow",minWidth:600,tooltip:"#c_tovar#",header:[{text:"Наименование"}],headermenu:!1,template:r.refTemplate},{id:"id_521",width:160,css:"overflow",tooltip:"#id_521#",header:[{text:"Код ном."}],headermenu:!0,hidden:!1},{id:"id_zavod",sort:"server",css:"overflow",width:300,header:[{text:"Производитель"},{content:"richFilt",compare:r.compareTrue,inputConfig:{scrollView:!0,inputtype:"combo",options:{data:i.options.vList}}}]},{id:"id_strana",sort:"server",css:"overflow",width:200,header:[{text:"Страна"},{content:"richFilt",compare:r.compareTrue,inputConfig:{scrollView:!0,inputtype:"combo",options:{data:i.options.stranaList}}}]},{id:"c_dv",hidden:!0,sort:"server",css:"overflow",width:300,header:[{text:"Д. в-во"},{content:"richFilt",compare:r.compareTrue,inputConfig:{scrollView:!0,inputtype:"combo",emptyRow:"Не назначенно",options:{data:i.options.dvList}}}]},{id:"c_group",hidden:!0,sort:"server",css:"overflow",width:300,header:[{text:"Группа"},{content:"richFilt",compare:r.compareTrue,inputConfig:{scrollView:!0,inputtype:"combo",emptyRow:"Не назначенно",options:{data:i.options.tgList}}}]},{id:"t_group",hidden:!0,width:300,css:"overflow",header:[{text:"T. группа"},{content:"richFilt",compare:r.compareTrue,inputConfig:{scrollView:!0,inputtype:"combo",options:{data:i.options.tovGList}}}]},{id:"c_nds",hidden:!0,tooltip:!1,width:150,header:[{text:"НДС"},{content:"richFilt",compare:r.compareTrue,inputConfig:{scrollView:!0,emptyRow:"Не назначенно",options:i.options.ndsList}}]},{id:"c_hran",hidden:!0,tooltip:!1,width:150,header:[{text:"Условия хранения"},{content:"richFilt",compare:r.compareTrue,inputConfig:{scrollView:!0,emptyRow:"Не назначенно",options:i.options.hranList}}]},{id:"c_sezon",hidden:!0,tooltip:!1,width:180,header:[{text:"Сезонность"},{content:"richFilt",compare:r.compareTrue,inputConfig:{scrollView:!0,emptyRow:"Не назначенно",options:i.options.sezonList}}]},{id:"mandat",width:100,tooltip:!1,template:function(e){return e.c_mandat?"<div><span class='webix_icon fa-check-circle'></span></div>":"<div><span class='webix_icon fa-times'></span></div>"},hidden:!0,css:"center_p",header:[{text:"Обязательный"},{content:"richFilt",compare:r.compareTrue,inputConfig:{options:[{id:1,value:"Да"},{id:2,value:"Нет"}],scrollView:!0}}]},{id:"prescr",width:100,hidden:!0,css:"center_p",tooltip:!1,template:function(e){return e.c_prescr?"<div><span class='webix_icon fa-check-circle'></span></div>":"<div><span class='webix_icon fa-times'></span></div>"},header:[{text:"Рецептурный"},{content:"richFilt",compare:r.compareTrue,inputConfig:{options:[{id:1,value:"Да"},{id:2,value:"Нет"}],scrollView:!0}}]},{id:"dt",width:200,sort:"server",tooltip:!1,format:r.dt_formating_sec,css:"center_p",hidden:!1,header:[{text:"Дата изменения"},{content:"dateRangeFilter",compare:r.compareTrue,inputConfig:{format:r.dt_formating,width:180},suggest:{view:"daterangesuggest",body:{timepicker:!1,calendarCount:2}}}]},{id:"dt_ins",width:200,tooltip:!1,format:r.dt_formating_sec,css:"center_p",hidden:!0,header:[{text:"Дата добавления"}]},{id:"owner",width:200,tooltip:!1,hidden:!0,header:[{text:"Кто изменил"}]}],on:{onresize:function(){var e=this;clearTimeout(this.delayResize);var t=(0,r.recalcRowsRet)(this);t&&(this.config.posPpage=t,this.delayResize=setTimeout((function(){e.$scope.startSearch()}),150))},"data->onParse":function(e,i){this.clearAll();var o=webix.storage.session.get(this.config.name+"sel");o=Object.keys(o),this.$scope.$$("_del").hide(),o.length>1?(t.config.roles[t.config.role].skipped||["antey1","antey2"].includes(this.$scope.app.config.user))&&this.$scope.$$("_prop").show():(this.$scope.$$("_prop").hide(),this.getHeaderContent("ch1").uncheck())},onCheck:function(e,t,i,o){var n=this.getItem(e);n&&(1===i?(0,r.save_storage)(this,n.id_spr):(0,r.del_storage)(this,n.id_spr)),(0,r.toolTipAssign)(this.$scope,this.$scope.$$("_prop")),o||this.getHeaderContent("ch1").checkInder();var s=webix.storage.session.get(this.config.name+"sel"),a=Object.keys(s).length-1;this.getHeaderContent("ch1").recount(a),0===a?this.getHeaderContent("ch1").uncheck():a===this.config.totalPos&&this.getHeaderContent("ch1").check(),this.bState&&1===this.bState&&this.remove(e)},onBeforeSort:function(e,t){this.config.fi=e,this.config.di=t,this.$scope.startSearch()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onSubViewClose:function(e){delete this.getItem(e).$subContent,delete this.getItem(e).$subHeight,delete this.getItem(e).$subOpen},onItemDblClick:function(e){var i=this.getSelectedId(),o=this.getItem(i);if(console.log("gr",o),1===this.$scope.$$("_rlscheck").getValue()){var n=this.getSelectedItem();this.$scope.popRls.show_w("Связка с РЛС. Выберите несвязанную позицию из справочника РЛС",n,this.$scope)}else t.config.roles[t.config.role].skipped||"Изделия медицинского назначения"===o.c_group||"Ортопедия и средства реабилитации"===o.c_group||"Парфюмерия/косметика/средства личной гигиены"===o.c_group||"Медицинские приборы и оборудование"===o.c_group||"Товары для животных/Ветеринария"===o.c_group||!o.c_group?this.openSub(i):webix.message({type:"error",text:"Вам запрещено редактировать",expire:3e3})},onAfterLoad:function(){var e=this;this.hideProgress();var t=webix.storage.session.get(this.config.name+"sel");this.data.serialize(!0).forEach((function(i){if(t[i.id_spr]){var o=JSON.parse(JSON.stringify(i));o.checkbox=1,e.updateItem(i.id,o)}})),(0,r.toolTipAssign)(this.$scope,this.$scope.$$("_prop")),"first"===this.setRow?(this.select(this.data.getFirstId()),this.getNode().focus()):"last"===this.setRow&&(this.select(this.data.getLastId()),this.getNode().focus()),this.setRow=void 0},onAfterRender:function(e){var i=this;Array.prototype.slice.call(document.getElementsByClassName("delete_button")).forEach((function(e){e.onmousedown=function(o){i.$scope.$$("_del").blockEvent(),e.onmouseup=function(){clearInterval(i.interval)},i.interval=setTimeout((function(){i.$scope.$$("_del").unblockEvent()}),t.config.popDelay)}}))},onKeyPress:function(e,t){(0,r.onKeyPressAction)(this,e,t)}}};return{view:"layout",rows:[{view:"toolbar",height:40,cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Введите наименование",localId:"_sb",on:{onKeyPress:function(e,t){clearTimeout(this.config._keytimed),(0,r.checkKey)(e)&&(this.config._keytimed=setTimeout((function(){i.startSearch()}),this.$scope.app.config.searchDelay))}}},{view:"checkbox",labelRight:"<span style='color: white'>Связываем с РЛС</span>",labelWidth:0,value:0,width:150,localId:"_rlscheck",on:{onChange:function(){1===this.getValue()?this.$scope.$$("__table").config.searchMethod="getSprSearchAdmRls":this.$scope.$$("__table").config.searchMethod="getSprSearchAdm",this.$scope.$$("_unfilt").callEvent("onItemClick")}}},{view:"button",type:"htmlbutton",localId:"_history",resizable:!0,sWidth:126,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>История</span>",oldLabel:"<span class='webix_icon fa-history'></span>",click:function(){var t=webix.storage.session.get(e.$$("__table").config.name);e.pophistory.show(t,e.$$("_sb"))}},{view:"button",tooltip:"Сбросить фильтры",type:"imageButton",image:p.ZY.unFilter.icon,localId:"_unfilt",resizable:!0,sWidth:180,eWidth:40,label:"",width:40,extLabel:p.ZY.unFilter.label,oldLabel:"",on:{onItemClick:function(){var t=e.$$("__table");(0,r.unFilter)(t),e.startSearch()}}},{view:"button",type:"htmlbutton",tooltip:"Добавить эталон",localId:"_add",resizable:!0,sWidth:180,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>Добавить эталон</span>",oldLabel:"<span class='webix_icon fa-plus'></span>",click:function(){e.popnew.show("Новый эталон",e.$$("_sb"))}},{view:"button",type:"htmlbutton",hidden:!0,localId:"_del",tooltip:"Удалить эталон",resizable:!0,sWidth:180,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>Удалить эталон</span>",oldLabel:"<span style='color: red', class='webix_icon fa-times'></span>",on:{onItemClick:function(){if(t.config.roles[t.config.role].skipped){var i=e.$$("__table").getSelectedItem();e.poprelink.show("Удаление эталона. Выберите товар, к которому будут привязаны связки и штрихкоды удаляемого",i,e)}else webix.message({type:"error",text:"Вам запрещено удалять",expire:3e3})}}},{view:"button",type:"htmlbutton",hidden:!0,localId:"_prop",tooltip:"Назначить свойства эталону",resizable:!0,sWidth:200,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>Назначить свойства</span>",oldLabel:"<span class='webix_icon fa-copy'></span>",on:{onItemClick:function(){this.$scope.propMenu.isVisible()?this.$scope.propMenu.hideM():this.$scope.propMenu.showM(this.getNode(),this.$scope.$$("__table"))}}}]},{cols:[o,{localId:"scroll_view",width:18}]},{$subview:l.default}]}},i.setScroll=function(){var e=+this.pager.$scope.$$("__page").getValue(),t=this.scroll,i=t.config.scrollHeight;t.blockEvent();for(var o=0,n=i;n>0;n--)if(t.config.scrollPos=n,(0,r.getPNumber)(t.config)===e){o=n;break}t.scrollTo(Math.ceil(o*t.config.zoom)+t.config.scrollSize/(2*t.config.zoom)),t.pageNumber=e,setTimeout((function(){t.unblockEvent()}),250)},i.startSearch=function(){var e=this.getRoot().getChildViews()[2].$scope.$$("__page");e.setValue(0==+e.getValue()?"1":"0")},i.ready=function(){var e=this,t=this.app,i=this;i.pager=i.getRoot().getChildViews()[2],i.pager.hide();var o=this.$$("__table");o.config.searchBar=this.$$("_sb"),this.scroll=new webix.ui.vscroll({container:this.$$("scroll_view").$view,scroll:"y",scrollStep:1,zoom:1,on:{onScroll:function(e){var o=this,n=i.getRoot().getChildViews()[2].$scope.$$("__page"),s=(0,r.getPNumber)(i.scroll.config);this.pageNumber===s||!1===i.scroll.mouseIsDown&&(this.pageNumber=s,clearTimeout(this.delayed),this.delayed=setTimeout((function(){n.setValue(o.pageNumber)}),t.config.searchDelay))}}}),this.scroll.config.container.classList.add("vscroll"),(0,r.addScrollTooltip)(this),(0,r.setApplyButton)(this,2),(0,r.setButtons)(this.app,this.app.config.getButt(this.getRoot())),(0,r.setMouseEvents)(o),setTimeout((function(){var t=(0,r.recalcRowsRet)(o);t&&(o.config.posPpage=t),e.startSearch()}),10),o.markSorting(o.config.fi,o.config.di),setTimeout((function(){e.$$("_sb").focus()}),50)},i.init=function(){(0,r.setRows)(this),this.popnew=this.ui(s.default),this.pophistory=this.ui(a.default),this.poprelink=this.ui(d.default),this.propMenu=this.ui(h.default),this.popRls=this.ui(u.default),webix.storage.session.put("__dt_assel",{s_pars:void 0})},t}(n.iC)},7204:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r});var o=i(1583),n=i(280),s=i(2478),a=i(4402),r=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this,t=this,i=t.app,o=function(){if(t.$$("__table").getSelectedItem().delete){var e=t.$$("__table").getSelectedId().id,o={};o.user=i.config.user,o.id=e;var n=(0,s.request)("delGr",o,!0,i).response;(n=(0,s.checkVal)(n,"s"))&&((0,s.delTGr)(e,t.$$("__table")),t.$$("_del").hide())}else webix.message({type:"debug",text:"Удаление невозможно",expire:5e3})},n={view:"datatable",name:"_tgroups",localId:"__table",navigation:"row",select:"row",resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,startPos:1,posPpage:20,totalPos:1250,old_stri:"",type:{itemIcon:s.DelEdIcons},onClick:{delete_button:function(e,t,i){var n=this,s=this.getItem(t);!1!==s.delete?setTimeout((function(){n.select(s.id,!1),o()}),50):webix.message({type:"debug",text:"Удаление группы "+s.c_tgroup+" невозможно",expire:5e3})},edit_button:function(e,t,i){this.getItem(t),this.select(t,!1),this.callEvent("onItemDblClick",t)}},columns:[{id:"c_tgroup",headermenu:!1,fillspace:1,sort:"text",header:[{text:"Группа"}],template:s.refTemplate},{id:"id",width:300,header:[{text:"ID"}]},{id:"id_state",hidden:!0,width:150,header:[{text:"Статус"}]},{id:"dt",hidden:!0,width:250,header:[{text:"Дата заведения"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){this.count||this.showProgress({type:"icon",icon:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>'})},onAfterRender:function(e){var t=this;Array.prototype.slice.call(document.getElementsByClassName("delete_button")).forEach((function(e){e.onmousedown=function(o){t.$scope.$$("_del").blockEvent(),e.onmouseup=function(){clearInterval(t.interval)},t.interval=setTimeout((function(){t.$scope.$$("_del").unblockEvent()}),i.config.popDelay)}}))},onItemDblClick:function(e){var t={text:(e=this.getSelectedItem()).c_tgroup,id:e.id,type:"Gr",callback:s.updTGr,mode:"upd",source:this};this.$scope.popnew.show("Редактирование группы",t)},onAfterLoad:function(){this.hideProgress()},onAfterSelect:function(e){},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}};return{view:"layout",rows:[{height:40,view:"toolbar",cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Строка поиска",keyPressTimeout:900,tooltip:"поиск по группе",on:{onTimedKeyPress:function(e,t){var i=this.getValue().toString().toLowerCase();this.$scope.$$("__table").filter((function(e){return-1!=e.c_tgroup.toString().toLowerCase().indexOf(i)}))}}},{view:"button",type:"htmlbutton",tooltip:"Добавить группу",localId:"_add",resizable:!0,sWidth:180,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>Добавить группу</span>",oldLabel:"<span class='webix_icon fa-plus'></span>",click:function(){var t={type:"Gr",callback:s.addTGr,mode:"new",source:e.$$("__table"),index:7};e.popnew.show("Добавление группы",t,!0)}},{view:"button",type:"htmlbutton",hidden:!0,localId:"_del",tooltip:"Удалить группу",resizable:!0,sWidth:180,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>Удалить гпуппу</span>",oldLabel:"<span style='color: red', class='webix_icon fa-times'></span>",on:{onItemClick:o}}]},n]}},i.ready=function(){var e=[this.$$("_add"),this.$$("_del")];(0,s.setButtons)(this.app,e),(0,s.singleRefReload)(this.app,"getTgAll",this.$$("__table"))},i.init=function(){this.popnew=this.ui(a.default),webix.extend(this.$$("__table"),webix.ProgressBar)},t}(n.iC)},3220:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>n});var o=i(1583),n=function(e){function t(){return e.apply(this,arguments)||this}return(0,o.Z)(t,e),t.prototype.config=function(){var e=this;return{view:"toolbar",css:{"border-top":"0px"},height:40,cols:[{view:"combo",localId:"_options",value:11,width:220,options:{body:{yCount:11},data:[{id:11,value:"Сервис"},{id:10,value:"Пользователи"}]},on:{onChange:function(){var t=10==+e.$$("_options").getValue()?"adm-users":"adm-linker";e.show(t)}}},{}]}},t}(i(280).iC)},9169:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>l});var o=i(1583),n=i(280),s=i(2917),a=i(2478),r=i(8838),l=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this,t=this.app,i={view:"datatable",name:"_users",localId:"__table",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,startPos:1,posPpage:20,totalPos:1250,old_stri:"",columns:[{id:"id",hidden:!0,width:75,header:[{text:"ID"}]},{id:"c_user",fillspace:1,sort:"text",header:[{text:"Пользователь"}],headermenu:!1},{id:"id_group",width:170,header:[{text:"Группа"}]},{id:"c_role",width:170,sort:"text",header:[{text:"Роль пользователя"}]},{id:"dt",hidden:!0,width:250,header:[{text:"Дата заведения"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onItemDblClick:function(e){e=this.getSelectedItem();var t={};t.id=e.id,t.user=this.$scope.app.user,e=(0,a.checkVal)((0,a.request)("getUser",t,!0,this.$scope.app).response,"s"),this.$scope.popnewuser.show("Редактирование пользователя",e,this)},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(){t.config.roles[t.config.role].userdel&&e.$$("_del").show()},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}};return{view:"layout",rows:[{height:4},{height:40,view:"toolbar",cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Строка поиска",keyPressTimeout:900,tooltip:"Поиск по пользователю",on:{onKeyPress:function(e,t){var i=this;clearTimeout(this.config._keytimed),(0,a.checkKey)(e)&&(this.config._keytimed=setTimeout((function(){var e=i.getValue().toString().toLowerCase();i.$scope.$$("__table").filter((function(t){return-1!=t.c_user.toString().toLowerCase().indexOf(e)}))}),this.$scope.app.config.searchDelay))}}},{view:"button",type:"htmlbutton",hidden:!t.config.roles[t.config.role].useradd,localId:"_add",resizable:!0,sWidth:132,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>Добавить</span>",oldLabel:"<span class='webix_icon fa-user-plus'></span>",click:function(){e.popnewuser.show("Добавление пользователя")}},{view:"button",type:"htmlbutton",localId:"_del",hidden:!0,resizable:!0,sWidth:132,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>Удалить</span>",oldLabel:"<span style='color: red', class='webix_icon fa-user-times'></span>",click:function(){webix.message({text:"Удаление пользователя. Позже.",type:"debug"})}},{view:"button",type:"htmlbutton",hidden:!t.config.roles[t.config.role].userdel,localId:"_aroles",resizable:!0,sWidth:132,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>Добавить</span>",oldLabel:"<span class='webix_icon fa-user-secret'></span>",click:function(){e.poproles.show("Админка ролей")}}]},i]}},i.ready=function(){var e=[this.$$("_add"),this.$$("_del"),this.$$("_aroles")];(0,a.setButtons)(this.app,e);var t=this.app,i=t.config.searchDelay,o=this.$$("__table").config.id;setTimeout(a.get_refs,0*i,{app:t,type:"async",method:"getUsersAll",store:o})},i.init=function(){this.poproles=this.ui(r.default),this.popnewuser=this.ui(s.default)},t}(n.iC)},6274:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r});var o=i(1583),n=i(280),s=i(2478),a=i(4402),r=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this,t=this.app;return{view:"layout",rows:[{view:"toolbar",height:40,cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Строка поиска",keyPressTimeout:900,tooltip:"поиск по поставщику",on:{onTimedKeyPress:function(e,t){var i=this.getValue().toString().toLowerCase();this.$scope.$$("__table").filter((function(e){return-1!=e.c_zavod.toString().toLowerCase().indexOf(i)}))}}},{view:"button",type:"htmlbutton",tooltip:"Добавить производителя",localId:"_add",resizable:!0,sWidth:240,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>Добавить производителя</span>",oldLabel:"<span class='webix_icon fa-plus'></span>",click:function(){var t={type:"Vendor",callback:s.addItem,mode:"new",source:e.$$("__table")};e.popnew.show("Добавление производителя",t)}},{view:"button",type:"htmlbutton",hidden:!0,localId:"_del",tooltip:"Удалить производителя",resizable:!0,sWidth:240,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>Удалить производителя</span>",oldLabel:"<span style='color: red', class='webix_icon fa-times'></span>",on:{onItemClick:function(){var t=e.$$("__table").getSelectedItem().id,i={};i.user=e.app.config.user,i.id=t;var o=(0,s.request)("delVendor",i,!0,e.app).response;(o=(0,s.checkVal)(o,"s"))&&((0,s.delItem)("Vendor",o.id,e.$$("__table")),e.$$("_del").hide())}}}]},{view:"datatable",name:"_vendors",localId:"__table",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,startPos:1,posPpage:20,totalPos:1250,old_stri:"",type:{itemIcon:s.DelEdIcons},onClick:{delete_button:function(e,t,i){var o=this,n=this.getItem(t);!1!==n.delete?setTimeout((function(){o.select(n.id,!1),o.$scope.$$("_del").callEvent("onItemClick")}),50):webix.message({type:"debug",text:"Удаление группы "+n.c_issue+" невозможно",expire:5e3})},edit_button:function(e,t,i){this.select(t,!1),this.callEvent("onItemDblClick",t)}},columns:[{id:"c_zavod",headermenu:!1,fillspace:1,sort:"text",header:[{text:"Производитель"}],template:s.refTemplate},{id:"website",width:320,header:[{text:"Веб-сайт"}],template:function(e,t,i){return i?"<a href='"+i+"'>"+i+"</a>":""}},{id:"id",sort:"text",width:150,header:[{text:"ID"}]},{id:"id_state",hidden:!0,width:150,header:[{text:"Статус"}]},{id:"dt",hidden:!0,width:250,header:[{text:"Дата заведения"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){this.count||this.showProgress({type:"icon",icon:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>'})},onAfterRender:function(e){var i=this;Array.prototype.slice.call(document.getElementsByClassName("delete_button")).forEach((function(e){e.onmousedown=function(o){i.$scope.$$("_del").blockEvent(),e.onmouseup=function(){clearInterval(i.interval)},i.interval=setTimeout((function(){i.$scope.$$("_del").unblockEvent()}),t.config.popDelay)}}))},onItemDblClick:function(e){var t={text:(e=this.getSelectedItem()).c_zavod,id:e.id,type:"Vendor",callback:s.updItem,mode:"upd",source:this,website:e.website};this.$scope.popnew.show("Редактирование поставщика",t)},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(){},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}}]}},i.ready=function(){var e=[this.$$("_add"),this.$$("_del")];(0,s.setButtons)(this.app,e),(0,s.singleRefReload)(this.app,"getVendorAll",this.$$("__table"))},i.init=function(){this.popnew=this.ui(a.default),webix.extend(this.$$("__table"),webix.ProgressBar)},t}(n.iC)},8838:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r});var o=i(1583),n=i(280),s=i(2478),a=i(6010),r=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this,t={view:"datatable",name:"_roles",localId:"__table",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,css:"dt_css",columns:[{id:"act_name",width:375,header:[{text:"Тип действия"}]},{id:"user",fillspace:1,css:"center_p",template:"{common.checkbox()}",header:[{text:"Имя роли",colspan:5,css:"center_p"},{text:$$("roles_dc").getItem(1).r_name}]},{id:"linker",fillspace:1,css:"center_p",template:"{common.checkbox()}",header:[{},{text:$$("roles_dc").getItem(9).r_name}]},{id:"admin",css:"center_p",template:"{common.checkbox()}",fillspace:1,header:[{},{text:$$("roles_dc").getItem(10).r_name}]},{id:"superadmin",css:"center_p",template:"{common.checkbox()}",fillspace:1,header:[{},{text:$$("roles_dc").getItem(34).r_name}]},{id:"qqq",css:"center_p",template:"{common.checkbox()}",fillspace:1,header:[{},{text:$$("roles_dc").getItem(35).r_name}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onAfterLoad:function(){this.hideProgress()}}},i={height:40,view:"toolbar",cols:[{},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-times'></span><span style='line-height: 20px;'> Отменить</span>",width:140,click:function(){e.hide()}},{view:"button",type:"htmlbutton",hidden:!this.app.config.roles[this.app.config.role].userdel,label:"<span class='webix_icon fa-save'></span><span style='line-height: 20px;'> Сохранить</span>",width:140,click:function(){var t=e.$$("__table").serialize(),i={user:e.app.config.user,values:t},o=(0,s.checkVal)((0,s.request)("setAdmRoles",i,!0).response,"s",e.app);if(o){var n={command:"killAll",type:"async"};n.action=o,e.popconfirm.show("Отключить всех пользователей?",n),e.hide()}}}]};return{view:"cWindow",width:.8*document.documentElement.clientWidth,height:.8*document.documentElement.clientHeight,modal:!0,on:{onHide:function(){e.$$("__table").clearAll()},onShow:function(){var t=e,i={user:e.app.config.user};(0,s.request)("getAdmRoles",i,0,e.app).then((function(e){(e=(0,s.checkVal)(e,"a"))?t.$$("__table").parse(e):t.$$("__table").clearAll(),this.$scope.$$("__table").hideProgress()}))}},body:{view:"layout",rows:[i,t]}}},i.show=function(e){this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show()},i.init=function(){this.popconfirm=this.ui(a.default)},i.hide=function(){this.getRoot().hide()},t}(n.iC)},6144:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>n});var o=i(1583),n=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this;return{view:"cWindow",modal:!0,body:{view:"form",margin:0,_params:{},on:{onShow:function(e){$$("_yes").focus()}},elements:[{view:"label",label:"Подтвердите",height:44,align:"center"},{cols:[{view:"button",type:"base",label:"Нет",width:120,height:44,click:function(){e.getRoot().getBody().config._params={},e.hide()}},{},{view:"button",type:"base",label:"Да",width:120,height:44,localId:"_yes",click:function(){var t=e.getRoot().getBody().config._params,i=t.callback?t.callback:void 0;e.hide(),i&&i(t.params)}}]}]}}},i.show=function(e,t){this.getRoot().getHead().getChildViews()[0].setValue("Подтвердите действие"),t&&(this.getRoot().getBody().config._params=t),this.getRoot().getBody().getChildViews()[0].setValue(e),this.getRoot().show()},i.hide=function(){this.getRoot().hide()},t}(i(280).iC)},5299:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var o=i(1583),n=i(280),s=i(5640),a=function(e){function t(){return e.apply(this,arguments)||this}return(0,o.Z)(t,e),t.prototype.config=function(){return{view:"layout",borderless:!0,css:"margin-zero",rows:[{$subview:s.default,name:"top_menu"}]}},t}(n.iC)},1300:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>n});var o=i(1583),n=function(e){function t(){return e.apply(this,arguments)||this}return(0,o.Z)(t,e),t.prototype.config=function(){return{view:"list",layout:"x",select:!1,scroll:!1,height:32,template:"{common.checkBox()} #value#",data:[{id:1,value:"as0as",ch:0},{id:2,value:"asadsf",ch:1},{id:3,value:"sdffwerg",ch:0}],type:{checkBox:function(e){return"<span class='check webix_icon fa-"+(e.ch?"check-":"")+"square-o'></span>"}},onClick:{check:function(e,t){var i=this.getItem(t);i.ch=i.ch?0:1,this.updateItem(t,i)}}}},t}(i(280).iC)},5595:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var o=i(1583),n=i(280),s=i(2478),a=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this,t=this.app;return{view:"cWindow",modal:!0,on:{onHide:function(){for(var t=e.$$("_lists").getChildViews(),i=t.length;i>0;i--)e.$$("_lists").removeView(t[i-1].config.id)}},body:{view:"form",margin:0,height:.5*document.documentElement.clientHeight,width:730,scroll:!0,elements:[{cols:[{view:"label",label:"Препарат:",height:32,width:100},{view:"label",label:"",height:32,localId:"_tovar",css:"highlited"}]},{cols:[{view:"label",label:"Письмо:",height:32,width:100},{view:"label",label:"",height:32,localId:"_letter",css:"highlited"}]},{view:"label",label:"Серии:",height:32},{view:"layout",localId:"_lists",rows:[]},{},{cols:[{view:"button",type:"base",label:"Нет",width:120,height:32,click:function(){e.hide_w()}},{},{view:"button",type:"base",label:"Да",width:120,height:32,localId:"_yes",click:function(){var i=[];if(e.$$("_lists").getChildViews().forEach((function(e){"list"===e.config.view&&e.data.each((function(e){1===e.ch&&i.push(e.series)}))})),i.length>0){e.item.id=99999999;var o={user:t.config.user,item:e.item,series_list:i},n=(0,s.request)("setMassBrakMail",o,!0,t).response;(n=(0,s.checkVal)(n,"s"))?(webix.message({type:"success",text:"Сохранено",expire:2500}),e.parent.$$("_ls").callEvent("onKeyPress",[13])):webix.message({type:"error",text:"Ошибка сохранения",expire:2500})}e.hide_w()}}]}]}}},i.show_w=function(e,t,i){this.parent=e,this.item=t;var o={view:"list",layout:"x",select:!1,scroll:!1,height:32,template:"{common.checkBox()} #series#",type:{width:140,checkBox:function(e){return"<span class='check webix_icon fa-"+(e.ch?"check-":"")+"square-o'></span>"}},onClick:{check:function(e,t){var i=this.getItem(t);i.ch=i.ch?0:1,this.updateItem(t,i)}}};this.$$("_tovar").setValue(t.name),this.$$("_letter").setValue(t.n_doc);for(var n=Math.ceil(i.length/5),s=0;s<n;s++)this.$$("_lists").addView(o);this.$$("_lists").getChildViews().forEach((function(e){for(var t=[],o=0;o<5;o++)if(i.length>0){var n=i.pop(0);n.ch=0,t.push(n)}"list"===e.config.view&&e.parse(t)})),this.getRoot().getHead().getChildViews()[0].setValue("Есть другие серии с таким препаратом. Привязать?"),this.getRoot().show()},i.hide_w=function(){this.getRoot().hide()},i.ready=function(e){},i.init=function(e){},t}(n.iC)},1908:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>u});var o=i(1583),n=i(280),s=i(9968),a=i(2478),r=i(1118),l=i(5338),c=i(2922),d=i(5953),h=i(8274),u=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e,t,i=this,o=this.app;return{view:"layout",type:"clean",rows:[{view:"toolbar",css:{"border-top":"0px"},cols:[{view:"text",label:"",placeholder:"Строка поиска",height:40,fillspace:!0,localId:"_ls",on:{onKeyPress:function(e,t){var i=this;clearTimeout(this.config._keytimed),(0,a.checkKey)(e)&&(this.config._keytimed=setTimeout((function(){i.$scope.startSearch()}),this.$scope.app.config.searchDelay))}}},{view:"checkbox",labelRight:"<span style='color: white'>Без писем</span>",labelWidth:0,tooltip:"Отображать только записи где нет писем",width:100,localId:"_noMail",css:"check",on:{onChange:function(){1===this.getValue()?this.$scope.$$("__table").define({searchMethod:"getBrakSearchNoMail"}):this.$scope.$$("__table").define({searchMethod:"getBrakSearch"}),this.$scope._search.callEvent("onKeyPress",[13]),this.$scope._search.focus()}}},{view:"checkbox",labelRight:"<span style='color: white'>Проверять с письмами</span>",labelWidth:0,tooltip:"При сохранении новых писем проверять записи с письмами",value:0,hidden:!0,width:160,localId:"_check_w_mails",on:{onChange:function(){webix.message({text:"Опция пока не доступна",type:"error",delay:1e3})}}},{view:"button",type:"htmlbutton",localId:"_history",resizable:!0,sWidth:116,eWidth:40,label:"",width:40,tooltip:"История поиска",extLabel:"<span class='button_label'>История</span>",oldLabel:"<span class='webix_icon fa-history'></span>",click:function(){var e=webix.storage.session.get(i.$$("__table").config.name);i.pophistory.show(e,i.$$("_ls"))}},{view:"button",type:"htmlbutton",localId:"_renew",resizable:!0,sWidth:124,eWidth:40,label:"",width:40,tooltip:"Обновить таблицу",extLabel:"<span class='button_label'>Обновить</span>",oldLabel:"<span class='webix_icon fa-refresh'></span>",click:function(){i.startSearch()}},(e={view:"button",width:40,tooltip:"Сбросить фильтры",type:"imageButton",image:h.ZY.unFilter.icon,localId:"_unfilt",resizable:!0,sWidth:180,eWidth:40,label:""},e.width=40,e.extLabel=h.ZY.unFilter.label,e.oldLabel="",e.click=function(){i.$$("_ls").setValue("");var e=i.$$("__table");(0,a.unFilter)(e),i.startSearch()},e),{view:"button",type:"htmlbutton",tooltip:"Загрузить брак",localId:"_fileload",resizable:!0,sWidth:160,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>Загрузить брак</span>",oldLabel:"<span class='webix_icon fa-upload'></span>",click:function(){i.pop_upl.show_window("Загрузка файла")}},{view:"button",type:"htmlbutton",tooltip:"Сверить базу забраковки с внешним файлом",localId:"_filecheck",resizable:!0,sWidth:155,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>Сверить брак</span>",oldLabel:"<span class='webix_icon fa-check'></span>",click:function(){i.pop_check.show_w()}},{view:"button",type:"htmlbutton",hidden:!0,tooltip:"Удалить письмо",localId:"_delletter",resizable:!0,sWidth:162,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>Удалить письмо</span>",oldLabel:"<span class='webix_icon fa-trash'></span>",click:function(){var e=i.$$("__table").getSelectedId(),t=i.$$("__table").getSubView(e);if(t){var n=t.getSelectedId();if(n){var s={user:o.config.user,id:n,f_name:t.getItem(n).f_name},r=(0,a.request)("delBrakMail",s,!0,o).response;(r=(0,a.checkVal)(r,"s"))&&(i.$$("_delletter").hide(),i.$$("__table").getSelectedItem().m_count=+r.m_count,i.sideView.$scope.clear_info(),i.sideView.$scope.disable_info(),t.remove(n),i.$$("__table").closeSub(e),i.$$("__table").openSub(e,i.$$("__table")))}}}}]},{height:3},{view:"layout",cols:[{css:{"border-left":"1px solid #dddddd !important"},rows:[{view:"datatable",name:"__brak",localId:"__table",select:!0,borderless:!0,rowHeight:30,fixedRowHeight:!1,headermenu:{autowidth:!0},resizeColumn:!0,startPos:1,posPpage:o.config.posPpage,totalPos:0,fi:"dt",di:"desc",searchBar:void 0,searchMethod:"getBrakSearch",old_stri:"",tooltip:function(e,t){return"<i>"+e.series+"<br>"+e.c_name+"<br>"+e.c_zavod+"</i>"},subview:function(e,t){var n=i.$$("__table").getItem(e.id),s={sh_prc:n.sh_prc,series:n.series,user:o.config.user},r=(0,a.checkVal)((0,a.request)("getBrakMail",s,!0,o).response,"s");r.push({id:99999999,n_doc:"...добавить письмо"});var l=r.length,c={view:"list",localId:"__list",$scope:i,$new:!1,oldSelectedItem:void 0,css:"sublist",item:{height:32},borderless:!0,navigation:!0,select:!0,scroll:!1,height:32*l,template:"#n_doc#",on:{onBeforeUnSelect:function(e){this.$scope.$$("_delletter").hide()},onBeforeSelect:function(e){if(!0===this.config.$new)return webix.message("Сначала сохраните изменения"),!1},onAfterSelect:function(e){var t=this.getSelectedItem();this.oldSelectedItem=t.id,99999999===t.id?(t.n_doc="Новое письмо",t.name=n.c_name,t.t_name=n.c_name,t.series=n.series,t.vendor=n.c_zavod,t.sh_prc=n.sh_prc,this.refresh(),this.config.$new=!0):this.$scope.$$("_delletter").show(),this.$scope.sideView.$scope.load_data(t,this,this.$scope.$$("__table")),!0===t.has_link?this.$scope.sideView.$scope.disable_info():this.$scope.sideView.$scope.enable_info()}},data:r};return webix.ui(c,t)},columns:[{id:"id",width:270,hidden:!0,headermenu:!1,header:[{text:"id"}]},{id:"sh_prc",width:270,hidden:!0,header:[{text:"Хэш"}]},{id:"series",width:100,hidden:!1,sort:"server",css:"overflow",header:[{text:"Серия"}]},{id:"c_name",fillspace:!0,sort:"server",css:"overflow",header:[{text:"Наименование"}],headermenu:!1},{id:"c_zavod",width:200,hidden:!1,sort:"server",css:"overflow",header:[{text:"Производитель"}]},{id:"razbr",width:100,hidden:!1,header:[{text:"Разбраковка"}],css:"center_p",template:"{common.checkbox()}"},(t={id:"dt",width:140,sort:"server",hidden:!1},t.sort="server",t.format=a.dt_formating,t.css="center_p",t.header=[{text:"Дата добавления"},{content:"dateRangeFilter",compare:a.compareTrue,inputConfig:{format:a.dt_formating,width:120},suggest:{view:"daterangesuggest",body:{timepicker:!1,calendarCount:2}}}],t)],on:{onresize:function(){var e=this;clearTimeout(this.delayResize);var t=(0,a.recalcRowsRet)(this);t&&(this.config.posPpage=t,this.delayResize=setTimeout((function(){e.$scope.startSearch()}),250))},"data->onParse":function(e,t){this.clearAll()},onCheck:function(e,t,i){var n=this.getItem(e),s={user:o.config.user,sh_prc:n.sh_prc,series:n.series,razbr:i};(0,a.request)("setRazbr",s,!0,o).response},onBeforeRender:function(e){webix.extend(this,webix.ProgressBar),function(e){e.order.forEach((function(t,i,o){var n=e.getItem(t);n.$css=0==+n.m_count?"highlighted":"nothing"}))}(e)},onSubViewClose:function(e){this.$scope.sideView.$scope.hide_b(),delete this.getItem(e).$subContent,delete this.getItem(e).$subHeight,delete this.getItem(e).$subOpen},onBeforeSort:function(e,t){i.$$("__table").config.fi=e,i.$$("__table").config.di=t,i.startSearch()},onItemDblClick:function(e){},onKeyPress:function(e,t){13===e&&this.getSelectedItem()&&this.callEvent("onItemDblClick")},onBeforeSelect:function(e){},onBeforeUnSelect:function(e){this.$scope.$$("_delletter").hide(),this.$scope.sideView.$scope.clear_info(),this.$scope.sideView.$scope.disable_info(),this.getItem(e.id)&&this.closeSub(e.id)},onAfterSelect:function(e){this.openSub(e.id,this)},onAfterLoad:function(){this.hideProgress()}}},{$subview:r.default}]},{$subview:l.default}]}]}},i.startSearch=function(){var e=this.getRoot().getChildViews()[2].getChildViews()[0].getChildViews()[1].$scope.$$("__page");e.setValue(0==+e.getValue()?"1":"0")},i.ready=function(){var e=this,t=this.$$("__table");(0,a.setButtons)(this.app,this.app.config.getButt(this.getRoot()));var i=this;$$(t.getColumnConfig("dt").header[1].suggest.body.id).getChildViews()[1].getChildViews()[1].setValue("Применить"),$$(t.getColumnConfig("dt").header[1].suggest.body.id).getChildViews()[1].getChildViews()[1].define("click",(function(){this._filter_timer&&window.clearTimeout(this._filter_timer),this._filter_timer=window.setTimeout((function(){i.startSearch()}),webix.ui.datafilter.textWaitDelay),this.getParentView().getParentView().hide()})),this._search=this.$$("_ls"),t.config.searchBar=this._search.config.id,this.sideView=this.getRoot().getChildViews()[2].getChildViews()[1],setTimeout((function(){var i=(0,a.recalcRowsRet)(t);i&&(t.config.posPpage=i),e.startSearch()}),10),setTimeout((function(){e._search.focus()}),10)},i.init=function(){this.pophistory=this.ui(s.default),this.pop_upl=this.ui(c.default),this.pop_check=this.ui(d.default)},t}(n.iC)},5338:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r});var o=i(1583),n=i(280),s=i(2478),a=i(5595),r=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this.app;return{type:"clean",localId:"_prop",rows:[{localId:"_acord",header:"Свойства документа",body:{view:"form",localId:"_dHead",oldData:void 0,bodredless:!0,margin:0,padding:0,elements:[{view:"text",value:"",label:"Нормативный документ",labelWidth:155,name:"n_doc",localId:"tte",on:{onKeyPress:function(){this.$scope.show_b()},onTimedKeyPress:function(){var e=this.getValue();this.$scope.parent.getSelectedItem().n_doc=e,this.$scope.parent.refresh(this.$scope.parent.getSelectedId())}}},{view:"text",value:"",label:"Наименование",labelWidth:155,name:"name",p_disable:!0,on:{onKeyPress:function(){this.$scope.show_b()}}},{view:"text",value:"",label:"Торговое наименование",labelWidth:155,name:"t_name",on:{onKeyPress:function(){this.$scope.show_b()}}},{view:"text",value:"",label:"Серия",labelWidth:155,name:"series",p_disable:!0,on:{onKeyPress:function(){this.$scope.show_b()}}},{view:"text",value:"",label:"Производитель",labelWidth:155,name:"vendor",p_disable:!0,on:{onKeyPress:function(){this.$scope.show_b()}}},{view:"text",value:"",label:"Регион",labelWidth:155,name:"region",on:{onKeyPress:function(){this.$scope.show_b()}}},{view:"text",value:"",label:"№ записи",labelWidth:155,name:"number",on:{onKeyPress:function(){this.$scope.show_b()}}},{view:"text",value:"",label:"Дата изменения",labelWidth:155,name:"ch_dt",disabled:!0,p_disable:!1,on:{onKeyPress:function(){this.$scope.show_b()}}},{view:"text",value:"",label:"ЖВ",labelWidth:155,name:"gv",on:{onKeyPress:function(){this.$scope.show_b()}}},{view:"text",value:"",label:"Описание",labelWidth:155,name:"desc",on:{onKeyPress:function(){this.$scope.show_b()}}},{view:"text",value:"",label:"О",labelWidth:155,name:"f_name",hidden:!0},{cols:[{view:"text",label:"Внешняя ссылка",width:155,name:"",labelWidth:155,value:"",p_disable:!0},{view:"label",localId:"__ext_label",label:"",name:"external_link",p_disable:!0}]}]}},{view:"tinymce-editor",css:{"margin-top":"-1px !important"},borderless:!0,localId:"_editor",config:{theme:"modern",statusbar:!1,image_advtab:!0,branding:!1,language:"ru",menubar:!1,toolbar:!0,toolbar1:"fontselect fontsizeselect | undo redo | bold italic strikethrough forecolor backcolor | alignleft aligncenter alignright alignjustify | codesample",plugins:["searchreplace visualblocks visualchars codesample","pagebreak nonbreaking anchor insertdatetime advlist lists textcolor","colorpicker textpattern"],content_css:[]}},{view:"toolbar",height:35,css:{"margin-top":"-1px !important"},borderless:!0,cols:[{},{view:"button",value:"Отменить",width:120,localId:"_cancel",hidden:!0,on:{onItemClick:function(){if(this.$scope.parent.config.$new)this.$scope.reopen();else if(this.$scope.$$("_dHead").config.oldData){console.log("1"),console.log(this.$scope.$$("_dHead").config.oldData),this.$scope.load_data(this.$scope.$$("_dHead").config.oldData,this.$scope.parent,this.$scope.topParent),this.$scope.hide_b();var e=this.$scope.$$("_dHead").getValues().n_doc;this.$scope.parent.getSelectedItem().n_doc=e,this.$scope.parent.refresh(this.$scope.parent.getSelectedId())}else console.log("2"),this.$scope.clear_info()}}},{view:"button",value:"Сохранить",width:120,localId:"_save",hidden:!0,on:{onItemClick:function(){var t=this.$scope.$$("_dHead").getValues();t.letter=this.$scope.$$("_editor").getValue();var i=this.$scope.topParent.$scope.$$("_check_w_mails").getValue(),o={user:e.config.user,item:t,check_letter:i},n=(0,s.request)("setBrakMail",o,!0,e).response;(n=(0,s.checkVal)(n,"s"))?(webix.message({type:"success",text:"Сохранено",expire:2e3}),this.$scope.topParent.getSelectedItem().m_count=+n.m_count,this.$scope.reopen(),n.similar&&n.similar.length&&n.similar.length>0&&this.$scope.popmass.show_w(this.$scope.topParent.$scope,t,n.similar)):(webix.message({type:"error",text:"Ошибка сохранения",expire:2e3}),this.$scope.$$("_cancel").callEvent("onItemClick"))}}}]}]}},i.ready=function(){this.disable_info()},i.reopen=function(){var e=this.topParent.$scope.$$("_noMail").getValue(),t=this.topParent.getSelectedItem().id;this.clear_info(),1===e&&this.topParent.getItem(t).m_count>0?this.topParent.remove(t):(this.topParent.closeSub(t),this.topParent.openSub(t,this.topParent)),this.disable_info()},i.load_data=function(e,t,i){var o=this;if(this.$$("_acord").define({collapsed:!1}),this.$$("_acord").resize(),this.clear_info(),1==e.has_link&&-1===e.external_link.indexOf("href")){var n="<a target='_blank' rel='noreferrer noopener' href='"+e.external_link+"'>Загрузить документ</a>";e.external_link=n}this.$$("_dHead").parse(e),this.$$("_editor").setValue(e.letter||""),this.parent=t,this.topParent=i,this.$$("_dHead").config.oldData=this.$$("_dHead").getValues(),this.$$("_dHead").config.oldData.letter=this.$$("_editor").getValue(),t.config.$new&&this.show_b(),document.getElementsByTagName("iframe")[0].contentDocument.body.onkeydown=function(){o.show_b()},this.$$("_editor").focus()},i.clear_info=function(){this.$$("_dHead").clear(),this.$$("_editor").setValue(""),this.$$("__ext_label").setValue(""),this.hide_b()},i.show_b=function(){this.$$("_save").show(),this.$$("_cancel").show()},i.hide_b=function(){this.$$("_save").hide(),this.$$("_cancel").hide()},i.disable_info=function(){this.$$("_dHead").getChildViews().forEach((function(e,t,i){var o=e.getChildViews();o.length>0&&o.forEach((function(e,t,i){e.disable()})),e.disable()}))},i.enable_info=function(){this.$$("_dHead").getChildViews().forEach((function(e,t,i){var o=e.getChildViews();o.length>0&&o.forEach((function(e,t,i){e.config.p_disable||e.disable()})),e.config.p_disable||e.enable()}))},i.init=function(){this.popmass=this.ui(a.default)},t}(n.iC)},2922:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>n});var o=i(1583),n=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this;return{view:"cWindow",modal:!1,on:{onHide:function(){e.$$("_uploader").files.clearAll()}},body:{view:"form",rows:[{view:"uploader",localId:"_uploader",type:"iconButton",icon:"plus-circle",multiple:!0,autosend:!1,align:"left",label:"Добавить файл",directory:!1,accept:"application/dbf",urlData:{},link:void 0,upload:this.app.config.r_url+"?uploadBrak",datatype:"json",on:{onUploadComplete:function(t){t.result?webix.message({type:"success",text:"брак сохранен",expire:1500}):webix.message({type:"error",text:t.ret_val,expire:1500}),e.hide_window()}}},{view:"list",localId:"_f_list",type:"uploader",autoheight:!0,borderless:!0},{view:"button",label:"Отправить",type:"iconButton",icon:"upload",click:function(){e.$$("_uploader").files.data.each((function(t){t.urlData={filename:t.name,source:"linker"},e.$$("_uploader").send(t.id)}))}}]}}},i.ready=function(){this.$$("_uploader").define({link:this.$$("_f_list").config.id}),this.$$("_uploader").refresh()},i.show_window=function(e){this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show(),this.$$("_uploader").fileDialog()},i.hide_window=function(){this.getRoot().hide()},i.init=function(){},t}(i(280).iC)},5659:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>s});var o=i(1583),n=i(280),s=(i(2478),function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this;return{view:"uploader",localId:"_uploader",accept:"application/vnd.ms-excel,",apiOnly:!0,urlData:{},link:void 0,upload:this.app.config.r_url+"?checkBrakXls",datatype:"json",on:{onBeforeFileAdd:function(e){if("xls"!=e.type.toLowerCase())return webix.message({type:"error",text:"Поддерживаются только XLS-файлы",delay:800}),!1},onFileUploadError:function(){e.view.$$("__table").hideProgress()},onAfterFileAdd:function(t){e.view.$$("__table").hideOverlay(),e.view.$$("__table").clearAll(),e.view.$$("_show").config.filter=!1,e.view.$$("__table").showProgress({type:"icon",icon:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>'}),e.$$("_uploader").files.data.each((function(t){t.urlData={filename:t.name,source:"linker"},e.$$("_uploader").send(t.id)}))},onUploadComplete:function(t){if(e.view.$$("__table").hideProgress(),t.result)(t=t.ret_val)&&(e.view.$$("__table").parse(t),e.view.$$("__table").adjustRowHeight("title"),(o=e.view.$$("__table")).data.order.forEach((function(e){var t=o.getItem(e);t.$css=t.result?"shadow":""})),o.refresh());else{var i=t.ret_val;e.view.$$("__table").showOverlay(i||"Ошибка загрузки")}var o}}}},i.ready=function(){},i.show_window=function(e){this.view=e,this.$$("_uploader").fileDialog()},i.hide_window=function(){this.getRoot().hide()},i.init=function(){},t}(n.iC))},1114:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var o=i(1583),n=i(280),s=i(2478),a=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this;return this.app,{view:"cWindow",autoheight:!0,modal:!1,on:{},body:{view:"layout",rows:[{height:40,view:"toolbar",css:"side_tool_bar",cols:[{view:"text",value:"",css:"info",pattern:webix.patterns.phone,localId:"_dsp"},{view:"button",type:"htmlbutton",label:"<span class='address_book_icon webix_icon fa-address-book'></span>",width:30}]},{view:"toolbar",css:"side_tool_bar",borderless:!0,width:200,rows:[{cols:[{view:"button",type:"htmlbutton",name:"1",label:"<span class='address_book_icon'>1</span>",on:{onItemClick:function(){this.$scope.tape(this)}}},{view:"button",type:"htmlbutton",name:"2",label:"<span class='address_book_icon'>2</span>",on:{onItemClick:function(){this.$scope.tape(this)}}},{view:"button",type:"htmlbutton",name:"3",label:"<span class='address_book_icon'>3</span>",on:{onItemClick:function(){this.$scope.tape(this)}}}]},{cols:[{view:"button",type:"htmlbutton",name:"4",label:"<span class='address_book_icon'>4</span>",on:{onItemClick:function(){this.$scope.tape(this)}}},{view:"button",type:"htmlbutton",name:"5",label:"<span class='address_book_icon'>5</span>",on:{onItemClick:function(){this.$scope.tape(this)}}},{view:"button",type:"htmlbutton",name:"6",label:"<span class='address_book_icon'>6</span>",on:{onItemClick:function(){this.$scope.tape(this)}}}]},{cols:[{view:"button",type:"htmlbutton",name:"7",label:"<span class='address_book_icon'>7</span>",on:{onItemClick:function(){this.$scope.tape(this)}}},{view:"button",type:"htmlbutton",name:"8",label:"<span class='address_book_icon'>8</span>",on:{onItemClick:function(){this.$scope.tape(this)}}},{view:"button",type:"htmlbutton",name:"9",label:"<span class='address_book_icon'>9</span>",on:{onItemClick:function(){this.$scope.tape(this)}}}]},{cols:[{view:"button",value:"#",on:{onItemClick:function(){e.$$("_dsp").focus()}}},{view:"button",type:"htmlbutton",name:"0",label:"<span class='address_book_icon'>0</span>",on:{onItemClick:function(){this.$scope.tape(this)}}},{view:"button",type:"htmlbutton",label:"<span class='address_book_icon'><=</span>",on:{onItemClick:function(){var t=e.$$("_dsp").getValue();t.length>0&&(e.$$("_dsp").setValue(t.slice(0,-1)),e.$$("_dsp").focus())}}}]}]},{view:"toolbar",css:"side_tool_bar",height:30,cols:[{view:"button",type:"htmlbutton",label:"<span class='address_book_icon'>reset</span>",on:{onItemClick:function(){e.hangUp(),e.$$("_dsp").focus()}}},{view:"button",type:"htmlbutton",label:"<span class='address_book_icon webix_icon fa-phone'></span>",on:{onItemClick:function(){e.call(),e.$$("_dsp").focus()}}}]},{view:"toolbar",css:"side_tool_bar",cols:[{css:"info",view:"text",value:"",disabled:!0,placeholder:"inbound call info"}]}]}}},i.tape=function(e){var t=e.config.name;this.$$("_dsp").setValue(this.$$("_dsp").getValue()+t),this.$$("_dsp").focus()},i.show_w=function(e){this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show(),this.$$("_dsp").focus()},i.hide_w=function(){this.getRoot().hide()},i.isVisible=function(){return this.getRoot().isVisible()},i.call=function(){var e=this;console.log("call");var t=this.$$("_dsp");localStorage.setItem("callNumber",t),this.callButton.addClass("d-none"),this.hangUpButton.removeClass("d-none"),this.session=this._ua.call(t,{pcConfig:{hackStripTcp:!0,rtcpMuxPolicy:"negotiate",iceServers:[]},mediaConstraints:{audio:!0,video:!1},rtcOfferConstraints:{offerToReceiveAudio:1,offerToReceiveVideo:0}}),this._ua.on("newRTCSession",(function(t){e._mounted&&t.originator})),this.session.on("connecting",(function(){console.log("UA session connecting"),e.playSound("ringback.ogg",!0);var t=e.session.connection,i=t.getLocalStreams()[0];i&&(e._localClonedStream=i.clone(),console.log("UA set local stream"),document.getElementById("localAudio").srcObject=e._localClonedStream),t.addEventListener("addstream",(function(e){console.log("UA session addstream"),document.getElementById("remoteAudio").srcObject=e.stream}))})),this.session.on("progress",(function(){console.log("UA session progress"),e.playSound("ringback.ogg",!0)})),this.session.on("failed",(function(t){console.log("UA session failed"),e.stopSound("ringback.ogg"),e.playSound("rejected.mp3",!1),e.callButton.removeClass("d-none"),e.hangUpButton.addClass("d-none")})),this.session.on("ended",(function(){console.log("UA session ended"),e.playSound("rejected.mp3",!1),JsSIP.Utils.closeMediaStream(e._localClonedStream),e.callButton.removeClass("d-none"),e.hangUpButton.addClass("d-none")})),this.session.on("accepted",(function(){console.log("UA session accepted"),e.stopSound("ringback.ogg"),e.playSound("answered.mp3",!1)}))},i.hangUp=function(){console.log("hangUp"),this.session.terminate(),JsSIP.Utils.closeMediaStream(this._localClonedStream)},i.login=function(){var e="user";localStorage.setItem("login",e),localStorage.setItem("pwd","pwd"),socket=new JsSIP.WebSocketInterface("wss://YOUR_SERVER:PORT/ws"),this._ua=new JsSIP.UA({uri:"sip:user@YOUR_SERVER",password:"pwd",display_name:e,sockets:[socket]}),this._ua.on("connecting",(function(){console.log("UA connecting")})),this._ua.on("connected",(function(){console.log("UA connected")})),this._ua.on("registered",(function(){console.log("UA registered")})),this._ua.on("unregistered",(function(){console.log("UA unregistered")})),this._ua.on("registrationFailed",(function(e){console.error("UA registrationFailed",e.cause)})),this._ua.start()},i.logout=function(){console.log("on logout"),this._ua.stop()},i.playSound=function(e,t){this._soundsControl.pause(),this._soundsControl.currentTime=0,this._soundsControl.src="sounds/"+e,this._soundsControl.loop=t,this._soundsControl.play()},i.stopSound=function(){this._soundsControl.pause(),this._soundsControl.currentTime=0},i.init=function(){this.a1=document.createElement("audio"),this.a1.id="localAudio",this.a1.autoplay=!0,this.a1.muted=!0,this.a2=document.createElement("audio"),this.a2.id="remoteAudio",this.a2.autoplay=!0,this.a3=document.createElement("audio"),this.a3.id="sounds",this.a3.autoplay=!0,document.body.appendChild(this.a1),document.body.appendChild(this.a2),document.body.appendChild(this.a3)},i.ready=function(){(0,s.setButtons)(this.app,this.app.config.getButt(this.getRoot().getBody())),this.app,this._soundsControl=document.getElementById("sounds"),this.login()},t}(n.iC)},5953:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r});var o=i(1583),n=i(280),s=i(2478),a=i(5659),r=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e,t=this;return this.app,{view:"cWindow",modal:!1,on:{onHide:function(){t.$$("__table").hideOverlay()}},body:{rows:[{view:"toolbar",height:40,cols:[{},{view:"button",type:"htmlbutton",tooltip:"Убрать/показать прошедшие проверку",localId:"_show",resizable:!0,sWidth:175,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>Убрать/показать</span>",oldLabel:"<span class='webix_icon fa-eye'></span>",filter:!1,click:function(){this.config.filter?(this.config.filter=!1,this.$scope.$$("__table").filter()):(this.config.filter=!0,this.$scope.$$("__table").filter((function(e){return!e.result})))}},{view:"button",type:"htmlbutton",tooltip:"Загрузить файл забраковки Excel",localId:"_load",resizable:!0,sWidth:155,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>Загрузить файл</span>",oldLabel:"<span class='webix_icon fa-upload'></span>",click:function(){t.upload.show_window(t)}}]},{height:3},{view:"datatable",localId:"__table",width:.7*document.documentElement.clientWidth,height:.8*document.documentElement.clientHeight,select:!0,resizeColumn:!0,navigation:"row",editable:!1,fixedRowHeight:!1,rowLineHeight:24,rowHeight:24,autowidth:!0,headermenu:{autowidth:!0},columns:[{id:"result",width:70,hidden:!1,headermenu:!1,header:[{text:"Результат"}],css:"center_p",template:function(e){return!0===e.result?"<span class='webix_icon fa-check-circle', style='color: green'></span>":"<span class='webix_icon fa-times-circle', style='color: red'></span>"}},{id:"file_series",width:140,headermenu:!1,sort:"text",header:[{text:"Серия в файле"}]},{id:"file_rus",width:50,hidden:!0,header:[{text:""}],template:function(e){return"<span class='flag', style='background-image: url(addons/img/"+e.file_rus+".svg) !important;'>"+e.file_rus+"</span>"}},{id:"file_number",width:140,hidden:!1,header:[{text:"Номер письма"}]},{id:"letter_match",width:120,headermenu:!1,header:[{text:"Письмо в базе"}],css:"center_p",template:function(e){return!0===e.letter_match?"<span class='webix_icon fa-check-circle', style='color: green'></span>":"<span class='webix_icon fa-times-circle', style='color: red'></span>"}},(e={id:"title",width:.7*document.documentElement.clientWidth-470,headermenu:!1,sort:"text",header:[{text:"Название письма в базе"}]},e.headermenu=!1,e),{id:"base_lang",width:50,hidden:!0,header:[{text:""}],template:function(e){return e.base_lang?"<span class='flag', style='background-image: url(addons/img/"+e.base_lang+".svg) !important;'>"+e.base_lang+"</span>":""}}],on:{onresize:webix.once((function(){this.adjustRowHeight("title",!0)})),"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onItemDblClick:function(e){}}}]}}},i.show_w=function(e,t){this.getRoot().getHead().getChildViews()[0].setValue("Сравнение файла с базой"),this.getRoot().show()},i.ready=function(){var e=[this.$$("_show"),this.$$("_load")];(0,s.setButtons)(this.app,e)},i.init=function(){this.upload=this.ui(a.default)},t}(n.iC)},1651:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>s});var o=i(1583),n=i(280),s=(i(2478),function(e){function t(){return e.apply(this,arguments)||this}return(0,o.Z)(t,e),t.prototype.config=function(){var e=this.app.config,t=e.b_prod?"Production":"test";return{view:"toolbar",css:"header",cols:[{view:"label",label:"Вы находитесь на сервере:  "+location.hostname+" | fv. "+e.version+" | bv. "+e.b_ver+" | "+t,css:{color:"#404040 !important","font-size":"11px !important"},height:12},{},{view:"button",type:"htmlbutton",width:32,hidden:!0,label:"<span class='webix_icon fa-info', style='color: #666666;'></span>"}]}},t}(n.iC))},2478:(e,t,i)=>{"use strict";i.r(t),i.d(t,{u_roles:()=>n,barcodes:()=>s,prcs:()=>a,allIs:()=>r,strana:()=>l,vendor:()=>c,dv:()=>d,nds:()=>h,id521:()=>u,sezon:()=>p,hran:()=>f,group:()=>g,compareTrue:()=>_,cEvent:()=>b,unFilter:()=>w,strana_filter:()=>v,zavod_filter:()=>$,dv_filter:()=>m,gr_filter:()=>y,sez_filter:()=>x,hran_filter:()=>k,nds_filter:()=>C,id521_filter:()=>V,checkKey:()=>I,checkVal:()=>S,getStorageFromName:()=>P,addItem:()=>R,delItem:()=>L,getFieldFromName:()=>E,updItem:()=>T,addTGr:()=>z,delTGr:()=>B,updTGr:()=>A,parseToLink:()=>F,get_bars:()=>W,refLoad:()=>D,refReload:()=>H,singleRefReload:()=>M,get_tg:()=>j,clear_obj:()=>N,gen_params:()=>q,str_join:()=>Z,get_data_test:()=>U,parse_unlinked_item:()=>O,get_spr:()=>K,getDtParams:()=>Y,dt_formating_sec:()=>G,dt_formating:()=>J,mcf_filter:()=>X,init_first:()=>Q,setRefs:()=>ee,getRefs:()=>te,clear_names_bar:()=>ie,get_prcs:()=>oe,get_prcs_source:()=>ne,get_prcs_date:()=>se,get_refs:()=>ae,get_suppl:()=>re,delPrc:()=>le,after_call:()=>ce,request:()=>de,getCookie:()=>he,setCookie:()=>ue,deleteCookie:()=>pe,checkSSE:()=>fe,spinIconEnable:()=>ge,spinIconDisable:()=>_e,setButtons:()=>be,DelEdIcons:()=>we,refTemplate:()=>ve,recalcRowsRet:()=>$e,setRows:()=>me,fillFilterOptions:()=>ye,addScrollTooltip:()=>xe,getPNumber:()=>ke,setApplyButton:()=>Ce,save_storage:()=>Ve,del_storage:()=>Ie,toolTipAssign:()=>Se,getHeaderLength:()=>Pe,setMouseEvents:()=>Re,onKeyPressAction:()=>Le});var o=i(8274),n=new webix.DataCollection({id:"roles_dc"}),s=new webix.DataCollection({id:"bars_dc"}),a=new webix.DataCollection({id:"prcs_dc",on:{onAfterLoad:function(){var e=this.data.order[0];this.setCursor(e);$$("main_ui");$$("_suppl").config.state?$$("_suppl").config.state=!1:O()}}}),r=new webix.DataCollection({id:"allIs_dc"}),l=new webix.DataCollection({id:"strana_dc"}),c=new webix.DataCollection({id:"vendor_dc"}),d=new webix.DataCollection({id:"dv_dc"}),h=new webix.DataCollection({id:"nds_dc"}),u=new webix.DataCollection({id:"id521_dc"}),p=new webix.DataCollection({id:"sezon_dc"}),f=new webix.DataCollection({id:"hran_dc"}),g=new webix.DataCollection({id:"group_dc"});function _(){return!0}var b=function(e,t,i,o){(o=o||{}).inner=!0,webix.event(e,t,i,o)},w=function(e){e.config.columns.forEach((function(t){if(t.id&&"checkbox"!==t.id&&e.isColumnVisible(t.id)&&t.header[1]&&t.header[1].content){var i=e.getFilter(t.id);"function"==typeof i.setValue?(i.blockEvent(),i.setValue(""),i.unblockEvent()):i.readOnly||(i.value="")}}))};function v(e,t){return t=t.toString().toLowerCase(),t=new RegExp(".*"+t.replace(/ /g,".*")+".*"),-1!=e.c_strana.toString().toLowerCase().search(t)}function $(e,t){return t=t.toString().toLowerCase(),-1!=e.c_zavod.toString().toLowerCase().search(t)}function m(e,t){return t=t.toString().toLowerCase(),t=new RegExp(".*"+t.replace(/ /g,".*")+".*"),-1!=e.act_ingr.toString().toLowerCase().search(t)}function y(e,t){return t=t.toString().toLowerCase(),t=new RegExp(".*"+t.replace(/ /g,".*")+".*"),-1!=e.group.toString().toLowerCase().search(t)}function x(e,t){return t=t.toString().toLowerCase(),t=new RegExp(".*"+t.replace(/ /g,".*")+".*"),-1!=e.sezon.toString().toLowerCase().search(t)}function k(e,t){return t=t.toString().toLowerCase(),t=new RegExp(".*"+t.replace(/ /g,".*")+".*"),-1!=e.usloviya.toString().toLowerCase().search(t)}function C(e,t){return t=t.toString().toLowerCase(),t=new RegExp(".*"+t.replace(/ /g,".*")+".*"),-1!=e.nds.toString().toLowerCase().search(t)}function V(e,t){return t=t.toString().toLowerCase(),t=new RegExp(".*"+t.replace(/ /g,".*")+".*"),-1!=e.id_521.toString().toLowerCase().search(t)}function I(e){return 8===e||13===e||32===e||46===e||e>47&&e<91||e>95&&e<112||e>185&&e<193||e>219&&e<223}function S(e,t){var i;return"s"===t?i=JSON.parse(e):"a"===t&&(i=e.json()),i.result?i.ret_val:void 0}function P(e){return $$(e[0].toLowerCase()+e.slice(1)+"_dc")}function R(e,t,i){e=P(e),i.add(t,0),e.add(t,0)}function L(e,t,i){e=P(e),i.remove(t,0),e.remove(t,0)}function E(e){return"Nds"===e?"nds":"Dv"===e?"act_ingr":"Group"===e?"group":"Hran"===e?"usloviya":"AllIs"===e?"c_issue":"Sezon"===e?"sezon":"Strana"===e?"c_strana":"Vendor"===e?"c_zavod":""}function T(e,t,i){var o=E(e);e=P(e);var n=t.id,s=i.getItem(n);s[o]=t.value,i.updateItem(n,s),e.updateItem(n,s),i.refresh()}function z(e,t){e.c_tgroup=e.group,delete e.group,t.add(e,0)}function B(e,t){t.remove(e)}function A(e,t){var i=e.id,o=t.getItem(i);o.c_tgroup=e.value,t.updateItem(i,o),t.refresh()}function F(e){var t,i=$$("_suppl").getList(),o=i.data.order,n=$$("main_ui").$scope.app;if(S(de("setWork",{user:n.config.user,sh_prc:e.sh_prc},!0,n).response,"s"),o.forEach((function(o,n,s){i.getItem(o).c_vnd===e.c_vnd&&(t=i.getItem(o).id)})),t)i.getItem(t).count+=1,$$("_suppl").setValue(t),setTimeout((function(){if(a.getItem(e.id))a.setCursor(e.id),O(0,e);else{a.add(e,0);var t=a.data.order[0];a.setCursor(t),O(0,e)}}),400);else{var s=Math.round(999999999999.5+0xe8d4a51001*Math.random()),r={id:s,count:1,c_vnd:e.c_vnd,id_vnd:e.id_vnd};$$("_suppl").config.manual=!0,i.add(r),$$("_suppl").setValue(s),setTimeout((function(){a.clearAll(),a.add(e,0);var t=a.data.order[0];a.setCursor(t),O(0,e)}),400)}}function W(e,t){var i=de("getBar",{user:e.app.config.user,id_spr:t},!0,e.app).response;(i=S(i,"s"))&&($$("bars_dc").clearAll(),$$("bars_dc").parse(i))}function D(e,t){var i={user:e.config.user},o=[],n="gr"===t?"getGroupAll":"dv"===t?"getDvAll":"sezon"===t?"getSezonAll":"hran"===t?"getHranAll":"issue"===t?"getIssueAll":"nds"===t?"getNdsAll":"id_521"===t?"getNCodeAll":void 0;return(o=n?H(n,i,!0,e):[{id:"_set_",value:"Установить"},{id:"_unset_",value:"Снять"}]).length>2&&o.forEach((function(e){e.value="gr"===t?e.group:"dv"===t?e.act_ingr:"sezon"===t?e.sezon:"hran"===t?e.usloviya:"issue"===t?e.c_issue:"nds"===t?e.nds:"id_521"===t?e.id_521+" - "+e.nom_name:void 0})),o}function H(e,t,i,o){if(!i){var n=de(e,t,!0,o).response;return(n=S(n,"s"))||[]}de(e,t,0,o).then((function(e){(e=S(e,"a"))&&i.parse(e)}))}function M(e,t,i){return H(t,{user:e.config.user},i,e)}function j(e,t){var i=de("getTg",{user:e.config.user,id_spr:t},!0,e).response;return(i=S(i,"s"))||[]}function N(e){for(var t in e){var i=e[t];"object"==typeof i?i=N(i):null==i&&delete e[t]}return e}function q(e){var t=e.view.$scope.app,i=e.searchBar,o=e.field?e.field:void 0,n=e.direction?e.direction:void 0,s=i?$$(i).getValue():void 0,a=e.filter?e.filter:void 0,r=t.config.user,l=(e.method,{user:r,search:s,start:e.start,count:e.count,field:o,direction:n,c_filter:a,cbars:e.cbars,total:e.total});return N(l)}function Z(e){var t="";if("string"==typeof e)t=e;else for(var i in e){var o=e[i];if(o&&"object"==typeof o&&o.__proto__.hasOwnProperty("getDate")){for(var n=[o.getFullYear(),o.getMonth()+1,o.getDate(),o.getHours(),o.getMinutes()],s=0;s<n.length;s++)n[s]<10?n[s]="0"+n[s]:n[s]=n[s].toString();t+=(n.slice(0,3).join("-")+" "+n[3]+":"+n[4]).toString()}else t+="object"==typeof o?Z(o):o.toString()}return t}function U(e){var t=e.view,i=t.$scope.app;t&&t.clearAll();var o=e.navBar,n=e.method,s=q(e),a=s.search;""===a&&(a="%%");var r=void 0!==a?a.replace(/\ /g,"").length:2;if((void 0!==a?a.length:2)>1&&r>1){t.showProgress({type:"icon",icon:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>'});var l=webix.storage.session.get(t.config.name+"sel")||{},c=l.s_pars;if(t.bState&&1===t.bState){var d=webix.storage.session.get(t.config.name+"sel");s.id_sprs=[],Object.keys(d).forEach((function(e){d[e]&&s.id_sprs.push(e)}))}var h=JSON.parse(JSON.stringify(s));delete h.start;var u=!1;Z(h)===Z(c)||h.id_sprs&&c&&!c.id_sprs||!h.id_sprs&&c&&c.id_sprs||(l={s_pars:h},webix.storage.session.put(t.config.name+"sel",l),u=!0),de(n,s,0,i).then((function(i){if(i=S(i,"a")){if(i.params){var n=JSON.parse(JSON.stringify(i.params));delete n.id_sprs;var s=Z(q(e));if(Z(n)!==s)return void t.hideProgress()}t.parse(i.datas),t.config.startPos=i.start,t.config.totalPos=i.total;var r=t.getTopParentView().getChildViews()[1].getChildViews()[0].getChildViews()[1].getChildViews()[1];r&&(r.$view.childNodes[1].getElementsByClassName("webix_selected")[0].title="Всего позиций: "+t.config.totalPos);var l=Math.ceil(t.config.totalPos/t.config.posPpage),c=0!==l?Math.ceil(t.config.startPos/t.config.posPpage):1,d=o.getChildViews()[2],h=o.getChildViews()[6];webix.storage.session.put(t.config.name+"_pages",l),!0===u&&t.$scope.scroll&&setTimeout((function(){var e=+webix.storage.session.get(t.config.name+"_pages")*+t.$scope.scroll.config.container.clientHeight;t.$scope.scroll.pageNumber=1,t.$scope.scroll.define("scrollHeight",e),t.$scope.scroll.reset()}),0),h.define("label","Всего записей: "+t.config.totalPos),h.refresh(),+o.$scope.$$("__page").getValue()!==c&&(o.$scope.$$("__page").config.manual=!1);var p=d.getChildViews();p[2].define("label",l),p[2].refresh(),o.$scope.$$("__page").setValue(c),o.$scope.$$("__page").refresh();var f=webix.storage.session.get(t.config.name);f?"%%"!==a&&f.push(a):f=["%%"!==a?a:""],webix.storage.session.put(t.config.name,f)}t.hideProgress()}))}}function O(e,t){var i={},n="<a target='_blank' rel='noreferrer noopener' href='https://www.google.ru/search?newwindow=1&q="+(t=t||$$("prcs_dc").getItem($$("prcs_dc").getCursor())).c_tovar+"'><span>"+t.c_tovar+"</span></a>",s="<span style='color: #666666; text-decoration: underline;'>Осталось свести в текущей сессии:</span><span style='color: red; font-weight: bold;'>  "+$$("prcs_dc").count()+"</span>";i._name=n,i._count=s,i._vendor=t.c_zavod,i.p_name=t.c_tovar,i.sh_prc=t.sh_prc;var a=$$("main_ui").$scope.app.config;(a.roles[a.role].spradd||o.Xd.users.includes($$("main_ui").$scope.app.config.user))&&$$("_add").show(),o.Xd.id_vnds.includes(t.id_vnd)&&o.Xd.users.includes(a.user)&&$$("_add").show(),$$("_left").show(),$$("_skip").show(),$$("_right").show(),$$("_names_bar").parse(i);var r=t.c_tovar.split(" "),l=0;r[l].length<4&&(l+=1);for(var c=r[l],d=l;d<r.length;d++)for(var h=0;h<r[d].length;h++)!isNaN(r[d][h])&&(c+=" "+r[d][h]);c=(c=(c=(c=(c=(c=(c=(c=(c=c.replace('"'," ")).replace("!"," ")).replace("-"," ")).replace("."," ")).replace(","," ")).replace("*"," ")).replace("+"," ")).replace("/"," ")).replace("\\"," "),$$("_spr_search").setValue(c);var u=$$("app-nav").getChildViews()[3].getChildViews(),p=Y(u[0]);U({view:u[0],navBar:u[1],start:1,searchBar:u[0].config.searchBar,method:u[0].config.searchMethod,field:p[2],direction:p[3],filter:p[0],count:p[1]}),$$("_spr_search").focus()}function K(e,t){var i=de("getSpr",{user:e.app.config.user,id_spr:t},!0,e.app).response;return(i=S(i,"s"))?i[0]:(webix.message("error"),"error")}function Y(e){var t;return"__ttl"===e.config.name?t={id:$$(e).isColumnVisible("id")?$$(e).getFilter("id").value:void 0,c_vnd:$$(e).isColumnVisible("c_vnd")?$$(e).getFilter("c_vnd").getValue():void 0,c_zavod:$$(e).isColumnVisible("c_zavod")?$$(e).getFilter("c_zavod").value:void 0,id_tovar:$$(e).isColumnVisible("id_tovar")?$$(e).getFilter("id_tovar").value:void 0,id_spr:$$(e).isColumnVisible("id_spr")?$$(e).getFilter("id_spr").value:void 0,dt:$$(e).isColumnVisible("dt")?$$(e).getFilter("dt").getValue():void 0,spr:$$(e).isColumnVisible("spr")?$$(e).getFilter("spr").value:void 0,owner:$$(e).isColumnVisible("owner")?$$(e).getFilter("owner").value:void 0,source:$$(e).isColumnVisible("source")?$$(e).getFilter("source").getValue():void 0}:"__tt"===e.config.name?t={c_vnd:$$(e).isColumnVisible("c_vnd")?$$(e).getFilter("c_vnd").getValue():void 0,c_zavod:$$(e).isColumnVisible("c_zavod")?$$(e).getFilter("c_zavod").value:void 0,owner:$$(e).isColumnVisible("owner")?$$(e).getFilter("owner").value:void 0}:"__dt_sk"===e.config.name?t={status:$$(e).isColumnVisible("status")?$$(e).getFilter("status").getValue():void 0,dt:$$(e).isColumnVisible("dt")?$$(e).getFilter("dt").getValue():void 0}:"__dt_a"===e.config.name?(console.log("vnd",$$(e).isColumnVisible("c_vnd")?$$(e).getFilter("c_vnd").getValue():void 0),t={id_tovar:$$(e).isColumnVisible("id_tovar")?$$(e).getFilter("id_tovar").value:void 0,c_vnd:$$(e).isColumnVisible("c_vnd")?$$(e).getFilter("c_vnd").getValue():void 0,c_zavod:$$(e).isColumnVisible("c_zavod")?$$(e).getFilter("c_zavod").value:void 0,id_org:$$(e).isColumnVisible("id_org")?$$(e).getFilter("id_org").value:void 0,c_tovar:$$(e).isColumnVisible("c_tovar")?$$(e).getFilter("c_tovar").value:void 0,sh_prc:$$(e).isColumnVisible("sh_prc")?$$(e).getFilter("sh_prc").value:void 0,c_user:$$(e).isColumnVisible("c_user")?$$(e).getFilter("c_user").getText():void 0,source:$$(e).isColumnVisible("source")?$$(e).getFilter("source").getValue():void 0,dt:$$(e).isColumnVisible("dt")?$$(e).getFilter("dt").getValue():void 0}):"__dt_s"===e.config.name?t={id_tovar:$$(e).isColumnVisible("id_tovar")?$$(e).getFilter("id_tovar").value:void 0,c_tovar:$$(e).isColumnVisible("c_tovar")?$$(e).getFilter("c_tovar").value:void 0,sh_prc:$$(e).isColumnVisible("sh_prc")?$$(e).getFilter("sh_prc").value:void 0,c_vnd:$$(e).isColumnVisible("c_vnd")?$$(e).getFilter("c_vnd").getValue():void 0,c_zavod:$$(e).isColumnVisible("c_zavod")?$$(e).getFilter("c_zavod").value:void 0,id_org:$$(e).isColumnVisible("id_org")?$$(e).getFilter("id_org").value:void 0,dt:$$(e).isColumnVisible("dt")?$$(e).getFilter("dt").getValue():void 0,source:$$(e).isColumnVisible("source")?$$(e).getFilter("source").getValue():void 0}:"__dt_as"===e.config.name?t={price:$$(e).isColumnVisible("price")?$$(e).getFilter("price").getValue():void 0,dt:$$(e).isColumnVisible("dt")?$$(e).getFilter("dt").getValue():void 0,id_spr:$$(e).isColumnVisible("id_spr")?$$(e).getFilter("id_spr").value:void 0,id_zavod:$$(e).isColumnVisible("id_zavod")?$$(e).getFilter("id_zavod").getValue():void 0,id_strana:$$(e).isColumnVisible("id_strana")?$$(e).getFilter("id_strana").getValue():void 0,c_dv:$$(e).isColumnVisible("c_dv")?$$(e).getFilter("c_dv").getValue():void 0,c_group:$$(e).isColumnVisible("c_group")?$$(e).getFilter("c_group").getValue():void 0,t_group:$$(e).isColumnVisible("t_group")?$$(e).getFilter("t_group").getValue():void 0,c_nds:$$(e).isColumnVisible("c_nds")?$$(e).getFilter("c_nds").getValue():void 0,c_hran:$$(e).isColumnVisible("c_hran")?$$(e).getFilter("c_hran").getValue():void 0,c_sezon:$$(e).isColumnVisible("c_sezon")?$$(e).getFilter("c_sezon").getValue():void 0,mandat:$$(e).isColumnVisible("mandat")?$$(e).getFilter("mandat").getValue():void 0,prescr:$$(e).isColumnVisible("prescr")?$$(e).getFilter("prescr").getValue():void 0,id_jv:$$(e).isColumnVisible("id_jv")?$$(e).getFilter("id_jv").getValue():void 0}:"__dt"===e.config.name?t={id_spr:$$(e).isColumnVisible("id_spr")?$$(e).getFilter("id_spr").value:void 0,c_dv:$$(e).isColumnVisible("c_dv")?$$(e).getFilter("c_dv").getValue():void 0}:"__brak"===e.config.name?t={dt:$$(e).isColumnVisible("dt")?$$(e).getFilter("dt").getValue():void 0}:"rlslink"===e.config.name?t={c_vnd:51078,id_org:$$(e).isColumnVisible("id_org")?$$(e).getFilter("id_org").value:void 0,sh_prc:$$(e).isColumnVisible("sh_prc")?$$(e).getFilter("sh_prc").value:void 0,c_user:$$(e).isColumnVisible("c_user")?$$(e).getFilter("c_user").getText():void 0,source:$$(e).isColumnVisible("source")?$$(e).getFilter("source").getValue():void 0,dt:$$(e).isColumnVisible("dt")?$$(e).getFilter("dt").getValue():void 0}:"relink"===e.config.name&&(t={dt:$$(e).isColumnVisible("dt")?$$(e).getFilter("dt").getValue():void 0,id_spr:$$(e).isColumnVisible("id_spr")?$$(e).getFilter("id_spr").value:void 0,id_zavod:$$(e).isColumnVisible("id_zavod")?$$(e).getFilter("id_zavod").getValue():void 0,id_strana:$$(e).isColumnVisible("id_strana")?$$(e).getFilter("id_strana").getValue():void 0,c_dv:$$(e).isColumnVisible("c_dv")?$$(e).getFilter("c_dv").getValue():void 0,c_group:$$(e).isColumnVisible("c_group")?$$(e).getFilter("c_group").getValue():void 0,c_nds:$$(e).isColumnVisible("c_nds")?$$(e).getFilter("c_nds").getValue():void 0,c_hran:$$(e).isColumnVisible("c_hran")?$$(e).getFilter("c_hran").getValue():void 0,c_sezon:$$(e).isColumnVisible("c_sezon")?$$(e).getFilter("c_sezon").getValue():void 0,mandat:$$(e).isColumnVisible("mandat")?$$(e).getFilter("mandat").getValue():void 0,prescr:$$(e).isColumnVisible("prescr")?$$(e).getFilter("prescr").getValue():void 0}),[t,e.config.posPpage,e.config.fi,e.config.di]}function G(e){return webix.Date.dateToStr("%d-%m-%Y  %G:%i:%s")(e)}function J(e){return webix.Date.dateToStr("%d-%m-%Y")(e)}function X(e,t){return t=t.toString().toLowerCase(),t=new RegExp(".*"+t.replace(/ /g,".*")+".*"),-1!=e.value.toString().toLowerCase().search(t)}function Q(e){webix.i18n.setLocale("ru-RU"),webix.protoUI({name:"activeList"},webix.ui.list,webix.ActiveContent),webix.protoUI({name:"cWindow",defaults:{resize:!0,modal:!1,move:!0,position:"center"},$init:function(e){webix.extend(e,{head:{view:"toolbar",cols:[{view:"label",label:"Название окна"},{view:"button",type:"icon",icon:"times",css:"times",height:26,width:26,on:{onItemClick:function(){this.getTopParentView().hide()}}}]}})}},webix.ui.window),webix.ui.datafilter.richFilt=Object.create(webix.ui.datafilter.richSelectFilter),webix.ui.datafilter.richFilt.refresh=function(e,t,i){if(!e.$destructed){var o=webix.$$(i.richselect);t._comp_id=e.config.id,t.$webix=i.richselect,t.style.marginLeft="-10px",i.compare=i.compare||this.compare,i.prepare=i.prepare||this.prepare,e.registerFilter(t,i,this);var n=i.inputConfig?i.inputConfig.emptyRow:void 0,s=i.inputConfig.options,a=i.options,r=o.getPopup().getList();if(webix.$$(a),t.firstChild.appendChild(o.$view.parentNode),r.parse&&(r.clearAll(),r.parse(s),n&&r.add({id:"-100",value:n},0),!this.$noEmptyOption&&!1!==i.emptyOption||i.emptyOption)){var l={id:"-1",value:i.emptyOption||"",$empty:!0};r.add(l,0)}i.value&&this.setValue(t,i.value),o.render(),webix.delay(o.resize,o)}},webix.ui.datafilter.richFilt.render=function(t,i){if(!i.richselect){var o={container:webix.html.create("div",{class:"webix_richfilter"}),view:(i.inputConfig?i.inputConfig.inputtype:void 0)||this.inputtype,options:[]},n=webix.extend(this.inputConfig||{},i.inputConfig||{},!0);webix.extend(o,n,!0),i.separator&&(o.separator=i.separator),i.suggest&&(o.suggest=i.suggest);var s=webix.ui(o),a=i.inputConfig.pager||2;s.attachEvent("onChange",(function(){t.config.columns.forEach((function(e){e.id===s.config.column_name&&(e.header[1].height=t.getHeaderNode(e.id,1).children[0].offsetHeight+5,t.refreshColumns())}));var o=i.inputConfig.scrollView?t.getParentView().getParentView().getChildViews()[a].$scope.$$("__page"):t.getParentView().getChildViews()[a].$scope.$$("__page");this._filter_timer&&window.clearTimeout(this._filter_timer),this._filter_timer=window.setTimeout((function(){var e=o.getValue();o.setValue(0==+e?"1":"0"),o.refresh()}),e.config.searchDelay)})),i.richselect=s.config.id}return i.css="webix_div_filter"," "},webix.ui.datafilter.cFilt=Object.create(webix.ui.datafilter.textFilter),webix.ui.datafilter.cFilt.on_key_down=function(t,i,o){var n=this._comp_id,s=webix.$$(n);if(9!=(t.which||t.keyCode)&&I(t.keyCode)){this._filter_timer&&window.clearTimeout(this._filter_timer);var a=this._pager||1,r=this._scrollView;this._filter_timer=window.setTimeout((function(){var e=r?s.getParentView().getParentView().getChildViews()[a].$scope.$$("__page"):s.getParentView().getChildViews()[a].$scope.$$("__page"),t=e.getValue();e.setValue(0==+t?"1":"0"),e.refresh()}),e.config.searchDelay)}},webix.ui.datafilter.cFilt.refresh=function(e,t,i){t.component=e.config.id,e.registerFilter(t,i,this),t._comp_id=e.config.id,i.inputConfig&&(t._pager=i.inputConfig.pager,t._scrollView=i.inputConfig.scrollView),i.value&&this.getValue(t)!=i.value&&this.setValue(t,i.value),t.onclick=webix.html.preventEvent,b(t,"keydown",this.on_key_down)},webix.ui.datafilter.cFilt.render=function(e,t){return this.init&&this.init(t),t.css="my_filter","<input "+(t.placeholder?'placeholder="'+t.placeholder+'" ':"")+"type='text'>"},webix.ui.datafilter.threeStCh={getValue:function(){},setValue:function(){},getHelper:function(e,t){return{check:function(){t.checked=!0,t.indeter=!1,e.repaint()},checkInder:function(){t.checked=!1,t.indeter=!0,e.repaint()},uncheck:function(){t.checked=!1,t.indeter=!1,e.repaint(),e.recount(0)},recount:function(t){e.recount(t)},getState:function(){return e.bState}}},refresh:function(e,t,i){e.bState&&1===e.bState?t.button="<button class='header-button header-button-highlited fa-"+i.inputConfig.buttonIcon+"' title='Показать выделенные'></button>":t.button="<button class='header-button fa-"+i.inputConfig.buttonIcon+"' title='Показать выделенные'></button>",t.counter=e.getHeaderNode(i.inputConfig.counter),t.storageName=e.config.name+"sel",t.repaint=function(){i.indeter?t.children[0].children[0].innerHTML="<span class='threeSt-indeterminate'></span>"+t.button:t.children[0].children[0].innerHTML="<input class='header-checkbox' type='checkbox' "+(i.checked?"checked='1'":"")+">"+t.button},t.recount=function(e){t.counter&&(t.counter.innerHTML=e>0?e:"")},t.onclick=function(o){if(1===t.disabled)return!1;if("header-checkbox"===o.target.className||"threeSt-indeterminate"===o.target.className){if(0===e.count())return!1;var n=t.children[0].children[0],s=webix.storage.session.get(t.storageName).s_pars;if(i.indeter||i.checked)i.checked=!1,i.indeter=!1,n.innerHTML="<input class='header-checkbox' type='checkbox'>"+t.button,webix.storage.session.put(t.storageName,{s_pars:s});else{i.checked=!0,i.indeter=!1,n.innerHTML="<input class='header-checkbox' type='checkbox' checked='1'>"+t.button;var a=i.inputConfig.getIdMethod?i.inputConfig.getIdMethod:void 0;a&&(t.disabled=1,de(a,s,0,e.$scope.app).then((function(e){if(t.disabled=0,e=S(e,"a"))if(e.length>(i.inputConfig.maxCount||2500))webix.message({text:"Слишком много выделяем, давайте так не делать.",type:"error",expire:3e3}),i.checked=!1,i.indeter=!0,t.repaint();else{var o=webix.storage.session.get(t.storageName)||{};e.forEach((function(e){o[e]=!0})),webix.storage.session.put(t.storageName,o),t.recount(e.length)}}),(function(){t.disabled=0})))}var r=e.getColumnConfig(i.columnId),l=i.checked?r.checkValue:r.uncheckValue;e.data.each((function(t){t[i.columnId]=l,e.callEvent("onCheck",[t.id,i.columnId,l,!0]),this.callEvent("onStoreUpdated",[t.id,t,"save"])})),e.refresh()}else if(-1!=o.target.className.search("header-button")){-1!=o.target.className.search("header-button-highlited")?(o.target.classList.remove("header-button-highlited"),o.target.title="Показать выделенные",t.bState=0,e.bState=0):(o.target.classList.add("header-button-highlited"),o.target.title="Показать все",t.bState=1,e.bState=1),t.button=o.target.outerHTML;var c=e.$scope.getRoot().getChildViews()[2].$scope.$$("__page"),d=c.getValue();c.setValue(0==+d?"1":"0"),c.refresh()}}},render:function(e,t){return"<div style='width: 100%; height: 100%; display: flex; flex-direction: row; '><input class='header-checkbox' type='checkbox'><button class='header-button fa-"+t.inputConfig.buttonIcon+"' title='Показать выделенные'></button></div"}}}function ee(e){e&&($$("strana_dc").clearAll(),$$("strana_dc").parse(e.strana),$$("vendor_dc").clearAll(),$$("vendor_dc").parse(e.vendor),$$("dv_dc").clearAll(),$$("dv_dc").parse(e.dv),$$("nds_dc").clearAll(),$$("nds_dc").parse(e.nds),$$("id521_dc").clearAll(),$$("id521_dc").parse(e.id_521),$$("hran_dc").clearAll(),$$("hran_dc").parse(e.hran),$$("sezon_dc").clearAll(),$$("sezon_dc").parse(e.sezon),$$("group_dc").clearAll(),$$("group_dc").parse(e.group),$$("allIs_dc").clearAll(),$$("allIs_dc").parse(e.issue))}function te(e,t){var i="getRefs",o={user:e.config.user};t?ee(S(de(i,o,!0,e).response,"s")):de(i,o,0,e).then((function(e){ee(e=S(e,"a"))}))}function ie(e,t){var i=e.getRoot().getChildViews()[3].getChildViews();i[0].clearAll();var o={_name:"",_count:"",_vendor:t||"",p_name:""};e.$$("_local_add")&&e.$$("_local_add").hide(),e.$$("_local_left").hide(),e.$$("_local_skip").hide(),e.$$("_local_right").hide(),e.$$("_local_link").hide(),e.$$("_local_names_bar").parse(o),e.$$("_local_spr_search").setValue("");var n=i[1];n.getChildViews()[6].define("label","Всего записей: 0"),n.getChildViews()[6].refresh(),n.$scope.$$("__page").config.manual=!1,n.$scope.$$("__page").setValue("1"),n.$scope.$$("__page").refresh(),n.getChildViews()[2].getChildViews()[2].define("label","1"),n.getChildViews()[2].getChildViews()[2].refresh()}function oe(e,t){de("getPrcs",{user:e.app.config.user,id_vnd:+t,value_search:e.$$("_value_search").getValue()},0,e.app).then((function(t){(t=S(t,"a"))?($$("prcs_dc").clearAll(),t.length>0?$$("prcs_dc").parse(t):ie(e,"записей нет")):webix.message("error")}))}function ne(e,t){de("getPrcsSou",{user:e.app.config.user,source:+t},0,e.app).then((function(t){(t=S(t,"a"))?($$("prcs_dc").clearAll(),t.length>0?$$("prcs_dc").parse(t):ie(e,"записей нет")):webix.message("error")}))}function se(e,t){de("getPrcsDate",{user:e.app.config.user,date:t},0,e.app).then((function(t){(t=S(t,"a"))?($$("prcs_dc").clearAll(),t.length>0?$$("prcs_dc").parse(t):ie(e,"записей нет")):webix.message("error")}))}function ae(e){var t=e.app,i=e.method,o=e.store,n=i,s={user:t.config.user};if("sync"!==e.type)de(n,s,0,t).then((function(e){(e=S(e,"a"))?($$(o).clearAll(),$$(o).parse(e)):webix.message("error")}));else{var a=de(n,s,!0,t).response;(a=S(a,"s"))&&($$(o).clearAll(),$$(o).parse(a))}}function re(e,t,i){var o;t.$$("_value_search")&&(o=t.$$("_value_search").getValue()),de(i,{user:t.app.config.user,value_search:o},0,t.app).then((function(i){if(i=S(i,"a")){$$(e).getList().clearAll(),$$(e).getList().parse(i);var o=$$(e).getList().getFirstId();o?$$(e).setValue(o):$$(e).setValue(),$$(e).refresh()}else ie(t,"записей нет");$$(e).getList().count()<1&&ie(t,"записей нет")}))}function le(e,t){var i,o=a.getCursor();$$("prcs_dc").data.order.forEach((function(e,t,n){e===o&&(i=t)})),i===$$("prcs_dc").count()-1?i=0:i+=1;var n=$$("prcs_dc").data.order[+i];if(a.remove(o),a.count()<1)2==+$$("_link_by").getValue()?re("_suppl",t,"getDatesUnlnk"):3==+$$("_link_by").getValue()?re("_suppl",t,"getSourceUnlnk"):re("_suppl",t,"getSupplUnlnk");else{a.setCursor(n),O();var s=$$("_suppl").getList(),r=$$("_suppl").getValue(),l=s.getItem(r);l.count=l.count-1,s.updateItem(r,l),$$("_suppl").refresh()}}function ce(e,t,i){403==i.status&&(pe("linker-app"),location.href="localhost"===location.hostname?"http://localhost:8080":"/linker/")}function de(e,t,i,o){var n=o?o.config.r_url+"?"+e:e;return!0===i?webix.ajax().sync().headers({"Content-type":"application/json"}).post(n,t,{error:ce}):webix.ajax().timeout(9e4).headers({"Content-type":"application/json"}).post(n,t,{error:ce})}function he(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):NaN}function ue(e,t,i){var o=(i=i||{}).expires;if("number"==typeof o&&o){var n=new Date;n.setTime(n.getTime()+1e3*o),o=i.expires=n}o&&o.toUTCString&&(i.expires=o.toUTCString());var s=e+"="+(t=encodeURIComponent(t));for(var a in i){s+="; "+a;var r=i[a];!0!==r&&(s+="="+r)}document.cookie=s}function pe(e){ue(e,"",{expires:-1,path:"/"})}function fe(e){var t=e.$scope.app.config.eventS;if(t&&1===t.readyState)return!0;try{t.close()}catch(e){}return!1}function ge(e){if(-1===e.config.label.indexOf("fa-spin")){var t=e.config.label.replace("webix_icon","webix_icon fa-spin");e.define({label:t}),e.refresh()}}function _e(e){var t=e.config.label.replace(" fa-spin","");e.define({label:t}),e.refresh(),clearTimeout(e.config.qw)}function be(e,t){t.forEach((function(t){var i,o;e.config.expert?(o=t.config.eWidth,i=t.config.oldLabel):(o=t.config.sWidth,i="<span style='float: left; width:"+t.config.eWidth+"px'>"+t.config.oldLabel+"</span><span stile='width:",i+=+(t.config.sWidth-t.config.eWidth)+"px'>"+t.config.extLabel+"</span>"),t.define({width:o,label:i}),t.resize(),t.refresh()}))}function we(e){var t="<div class='webix_el_button posi'><button class='webix_img_btn_abs edit_button'><div class='webix_image image20x20', style='background-image:url(./addons/img/edit_20x20.svg);'</div></button> </div>";return e?"<div title='Удерживайте для удаления', class='webix_el_button posi'><button class='webix_img_btn_abs delete_button'><div class='webix_image image20x20', style='background-image:url(./addons/img/delete_20x20.svg);'</div></button> </div>"+t:t}function ve(e,t,i){var o="<div class='right_col"+(!1===e.delete?"_1":"_2")+"'>"+i+"</div>";return"<div class = 'dt_hover'>"+t.itemIcon(!1!==e.delete)+o+"</div>"}function $e(e){var t=e.$view.getElementsByClassName("webix_ss_center_scroll")[0].clientHeight,i=Math.floor(t/e.config.rowHeight);return i!=e.config.posPpage&&i}function me(e){setTimeout((function(){var t=e.$$("__table"),i=t.$view.getElementsByClassName("webix_ss_center_scroll")[0].clientHeight,o=Math.floor(i/t.config.rowHeight);t.config.posPpage=o}),10)}function ye(e){te(e,!0);var t={sezonList:[],tgList:[],ndsList:[],hranList:[],stranaList:[],dvList:[],vList:[],tovGList:[]};return $$("sezon_dc").data.getRange($$("sezon_dc").data.getFirstId(),$$("sezon_dc").data.getLastId()).forEach((function(e){var i={id:e.id,value:e.sezon};t.sezonList.push(i)})),$$("hran_dc").data.getRange($$("hran_dc").data.getFirstId(),$$("hran_dc").data.getLastId()).forEach((function(e){var i={id:e.id,value:e.usloviya};t.hranList.push(i)})),$$("nds_dc").data.getRange($$("nds_dc").data.getFirstId(),$$("nds_dc").data.getLastId()).forEach((function(e){var i={id:e.id,value:e.nds};t.ndsList.push(i)})),$$("group_dc").data.getRange($$("group_dc").data.getFirstId(),$$("group_dc").data.getLastId()).forEach((function(e){var i={id:e.id,value:e.group};t.tgList.push(i)})),M(e,"getTgAll").forEach((function(e){var i={id:e.id,value:e.c_tgroup};t.tovGList.push(i)})),$$("strana_dc").data.getRange($$("strana_dc").data.getFirstId(),$$("strana_dc").data.getLastId()).forEach((function(e){var i={id:e.id,value:e.c_strana};t.stranaList.push(i)})),$$("dv_dc").data.getRange($$("dv_dc").data.getFirstId(),$$("dv_dc").data.getLastId()).forEach((function(e){var i={id:e.id,value:e.act_ingr};t.dvList.push(i)})),$$("vendor_dc").data.getRange($$("vendor_dc").data.getFirstId(),$$("vendor_dc").data.getLastId()).forEach((function(e){var i={id:e.id,value:e.c_zavod};t.vList.push(i)})),t}function xe(e){var t=document.createElement("div");t.classList.add("scroll-tooltip"),document.body.appendChild(t);var i=e,o=e.scroll.config.container;i.scroll.mouseIsDown=!1,i.scroll.displayed=!1,o.addEventListener("mousedown",(function(){i.scroll.mouseIsDown=!0,t.style.top=o.scrollTop*(o.clientHeight-o.offsetTop+5)/o.scrollHeight+o.getBoundingClientRect().top+5+"px",t.textContent=ke(i.scroll.config),i.scroll.displayed||(t.style.display="block",i.scroll.displayed=!0)})),o.addEventListener("mouseup",(function(){i.scroll.mouseIsDown=!1,i.scroll.displayed&&(i.scroll.displayed=!1,t.style.display="none",i.scroll.callEvent("onScroll"))})),o.addEventListener("scroll",(function(e){i.scroll.mouseIsDown&&(t.style.top=o.scrollTop*(o.clientHeight-o.offsetTop+5)/o.scrollHeight+o.getBoundingClientRect().top+5+"px",t.textContent=ke(i.scroll.config),i.scroll.displayed||(t.style.display="block",i.scroll.displayed=!0))}))}function ke(e){var t=e.container.clientHeight,i=e.scrollPos,o=e.zoom*(i+t*(i/(1+i))),n=Math.ceil(o/t-i/(t+i));return 0===n&&(n=1),n}function Ce(e,t){var i=$$(e.$$("__table").getColumnConfig("dt").header[1].suggest.body.id).getChildViews()[1].getChildViews()[1];i.setValue("Применить"),i.define("click",(function(){e._filter_timer&&window.clearTimeout(e._filter_timer),e._filter_timer=window.setTimeout((function(){var i=e.getRoot().getChildViews()[t].$scope.$$("__page"),o=i.getValue();i.setValue(0==+o?"1":"0"),i.refresh()}),webix.ui.datafilter.textWaitDelay),this.getParentView().getParentView().hide()}))}function Ve(e,t){var i=webix.storage.session.get(e.config.name+"sel")||{};i[t]=!0,webix.storage.session.put(e.config.name+"sel",i)}function Ie(e,t){var i=webix.storage.session.get(e.config.name+"sel");delete i[t],webix.storage.session.put(e.config.name+"sel",i)}function Se(e,t){var i=e,o=webix.storage.session.get(i.$$("__table").config.name+"sel");delete o.s_pars;var n=0;Object.keys(o).forEach((function(e){o[e]&&n++})),n>0?(i.app.config.roles[i.app.config.role].skipped||["antey1","antey2"].includes(i.app.config.user))&&(t.define({tooltip:"Назначить свойства эталону. Выделенно "+n+" товаров."}),t.show()):(t.define({tooltip:"Назначить свойства эталону"}),t.hide()),t.refresh()}function Pe(e){var t=document.createElement("div");t.innerHTML=e,document.body.insertBefore(t,document.body.firstChild);var i=t.childNodes[1].offsetWidth;return i+=75,t.remove(),i}function Re(e){e.getNode().onmouseover=function(t){if(1===t.buttons&&"gridcell"===t.target.getAttribute("role")&&t.target.children.length>0&&t.target.firstChild.classList.contains("webix_table_checkbox")||1===t.buttons&&"webix_table_checkbox"===t.target.class){t.target.classList.add("cell-highlighted");var i=t.target.getAttribute("aria-rowindex"),o=e.data.order[i-1],n=e.getItem(o);e.$scope.checked_id!==n.id&&(e.$scope.checked_id=n.id,n.checkbox=n.checkbox?0:1,e.updateItem(n.id,n),e.callEvent("onCheck",[n.id,void 0,n.checkbox]))}},e.getNode().onmouseout=function(e){(1===e.buttons&&"gridcell"===e.target.getAttribute("role")&&e.target.children.length>0&&e.target.firstChild.classList.contains("webix_table_checkbox")||1===e.buttons&&"webix_table_checkbox"===e.target.class)&&e.target.classList.remove("cell-highlighted")}}function Le(e,t,i){if("End"===i.code&&!0===i.shiftKey)e.$scope.pager.$scope.$$("_lastPB").callEvent("onItemClick"),e.$scope.setScroll(),e.getNode().focus();else if("PageDown"===i.code&&!0===i.shiftKey)e.$scope.pager.$scope.$$("_nextPB").callEvent("onItemClick"),e.$scope.setScroll(),e.getNode().focus();else if("PageUp"===i.code&&!0===i.shiftKey)e.$scope.pager.$scope.$$("_prevPB").callEvent("onItemClick"),e.$scope.setScroll(),e.getNode().focus();else if("Home"===i.code&&!0===i.shiftKey)e.$scope.pager.$scope.$$("_firstPB").callEvent("onItemClick"),e.$scope.setScroll(),e.getNode().focus();else if("PageDown"===i.code&&e.getSelectedId()&&e.data.getLastId().toString()===e.getSelectedId().id.toString())e.$scope.pager.$scope.$$("_nextPB").callEvent("onItemClick"),e.$scope.setScroll(),e.setRow="last";else if("PageUp"===i.code&&e.getSelectedId()&&e.data.getFirstId().toString()===e.getSelectedId().id.toString())e.$scope.pager.$scope.$$("_prevPB").callEvent("onItemClick"),e.$scope.setScroll(),e.getNode().focus(),e.setRow="first";else if("ArrowDown"===i.code&&e.getSelectedId()&&e.data.getLastId().toString()===e.getSelectedId().id.toString())e.$scope.pager.$scope.$$("_nextPB").callEvent("onItemClick"),e.$scope.setScroll(),e.setRow="first";else if("ArrowUp"===i.code&&e.getSelectedId()&&e.data.getFirstId().toString()===e.getSelectedId().id.toString())e.$scope.pager.$scope.$$("_prevPB").callEvent("onItemClick"),e.$scope.setScroll(),e.setRow="last";else if(13===t)e.getSelectedItem()&&e.callEvent("onItemDblClick");else if("Space"===i.code){var o=e.getItem(e.getSelectedId().id);o.checkbox=o.checkbox?0:1,e.updateItem(o.id,o),e.callEvent("onCheck",[o.id,void 0,o.checkbox])}}},8926:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var o=i(1583),n=i(280),s=i(2478),a=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var n=t.prototype;return n.config=function(){var e=this.app,t=this,o=i(279);try{e.config.eventS.close()}catch(e){}var n=o.v4()+"::"+e.config.user,a="localhost"===location.hostname?"http://saas.local/events_logic/SSE?":"../events/SSE?";a+=n,setTimeout((function i(){e.config.production&&(e.config.eventS&&1===e.config.eventS.readyState||(e.config.eventS=new EventSource(a),e.config.notify&&(e.config.eventS.onmessage=function(t){webix.message({type:"info",text:t.data,expire:e.config.nDelay})}),e.config.eventS.addEventListener("error_badge",(function(e){webix.message("qqq")})),34!=+e.config.role&&10!=+e.config.role||setTimeout((function(){var i=t.getRoot().getParentView().getChildViews()[1].getChildViews()[0].getChildViews()[0].$scope.$$("_errorbut");e.config.eventS.addEventListener("badgeErr",(function(t){+t.data>0?e.config.expert?i.$view.childNodes[0].childNodes[0].childNodes[0].classList.add("alert_b"):i.$view.childNodes[0].childNodes[0].childNodes[0].childNodes[0].classList.add("alert_b"):e.config.expert?i.$view.childNodes[0].childNodes[0].childNodes[0].classList.remove("alert_b"):i.$view.childNodes[0].childNodes[0].childNodes[0].childNodes[0].classList.remove("alert_b")}))}),200),e.config.eventS.addEventListener("update",(function(t){webix.message({type:"event",text:t.data,expire:e.config.nDelay})})),e.config.eventS.addEventListener("enablespin",(function(e){var t,i=e.data.split("::");if("spr"===i[0]&&(t=$$("_spr_button")),"spr_roz"===i[0]&&(t=$$("_spr_roz_button")),t){t.blockEvent(),(0,s.spinIconEnable)(t);var o="\n выгружает: "+i[2];t.define({tooltip:t.config.tooltipTemplate+o}),t.refresh()}})),e.config.eventS.addEventListener("disablespin",(function(e){var t,i=e.data.split("::");if("spr"===i[0]?t=$$("_spr_button"):"spr_roz"===i[0]&&(t=$$("_spr_roz_button")),t){if(t.config.lastModified!==+i[1]){t.config.lastModified=+i[1],t.config.lastUser=i[2];var o=". Выгружал: "+(t.config.lastUser||"неизвестно"),n=new Date(1e3*t.config.lastModified).toLocaleString("ru"),a=t.config.lastModified>0?n:" неизвестно";t.define({tooltip:t.config.tooltipTemplate+"\nПоследняя выгрузка: "+a+o}),t.refresh()}t.unblockEvent(),(0,s.spinIconDisable)(t)}})),e.config.eventS.addEventListener("close",(function(e){eventS.close()}))),setTimeout(i,4e3))}),50);var r=function(t){var i=(0,s.getCookie)("linker-app");if(i){var o=i.split("::");i=o[0],o[1],o[2];var n={user:i};(0,s.request)("setExit",n,0,e)}};return window.addEventListener("beforeunload",r,!1),{view:"toolbar",css:"realy_header",cols:[{view:"label",label:"<a href='http://ms71.org'><span class='ms-logo', style='margin-left: -5px !important; background-image: url(addons/img/logo.png);'></span></a>",width:44,align:"center",height:36},{view:"label",label:"МАНУСКРИПТ-СОЛЮШН: Связки и эталоны | "+this.app.config.user,css:"ms-logo-text",height:36,width:550},{},{view:"button",type:"htmlbutton",tooltip:"Выход",resizable:!0,sWidth:102,eWidth:40,label:"",width:40,extLabel:"<span class='side_icon button_label'>Выйти</span>",oldLabel:"<span class='side_icon webix_icon fa-sign-out'></span>",id:"__logout_button",on:{onItemClick:function(){r(),(0,s.deleteCookie)("linker-app"),t.app.config.user="",t.app.config.role="0",t.app.config.x_api="x_login",location.href="localhost"===location.hostname?location.href:"/linker/"}}}]}},n.ready=function(){},t}(n.iC)},9968:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>n});var o=i(1583),n=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this;return{view:"cWindow",modal:!0,height:.8*document.documentElement.clientHeight,on:{onHide:function(){e.$$("_tb").clear(),e.$$("_hist").clearAll(),e.$$("_tb").reconstruct()}},body:{view:"toolbar",localId:"_tb",searchBar:void 0,cols:[{view:"list",localId:"_hist",width:.5*document.documentElement.clientWidth,select:!0,resizeColumn:!0,navigation:"row",editable:!1,on:{onItemDblClick:function(t){var i=e.$$("_tb").config.searchBar;t=e.$$("_hist").getItem(t).value,i.setValue(t),i.refresh(),e.getRoot().hide(),i.callEvent("onKeyPress",[13])}}},{}]}}},i.show=function(e,t){this.getRoot().getHead().getChildViews()[0].setValue("История поиска"),this.getRoot().show(),this.$$("_tb").config.searchBar=t,e&&this.$$("_hist").parse(e)},i.init=function(){},t}(i(280).iC)},8662:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>u});var o=i(1583),n=i(280),s=i(2478),a=i(7610),r=i(9968),l=i(6891),c=i(6010),d=i(2720),h=i(8208),u=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this,t=this.app;return{view:"layout",id:"app-nav",type:"clean",rows:[{view:"toolbar",css:{"border-top":"0px !important"},height:40,cols:[{view:"combo",hidden:t.config.link,name:"suppliers",id:"_suppl",manual:!1,state:!1,localId:"__suppl",width:300,options:{filter:function(e,t){return t=t.toString().toLowerCase(),-1!=e.c_vnd.toString().toLowerCase().search(t)},body:{template:"#c_vnd# - #count#",yCount:10}},on:{onChange:function(){if(this.$scope.$$("_local_add").hide(),$$("_suppl").config.manual)$$("_suppl").config.manual=!1;else{var e=$$("_suppl").getList();if(e.count()>0){var t=this.$scope.$$("_local_link_by").getValue(),i=e.getItem($$("_suppl").getValue()).id_vnd;1==+t?(0,s.get_prcs)(this.$scope,i):2==+t?(0,s.get_prcs_date)(this.$scope,i):3==+t&&(0,s.get_prcs_source)(this.$scope,i)}else this.setValue("")}}}},{view:"radio",label:"СВОДИТЬ ПО",value:1,css:"c-radio",id:"_link_by",labelWidth:100,width:405,localId:"_local_link_by",hidden:t.config.link,options:[{id:1,value:"<span style='color: white'>поставщикам</span>"},{id:2,value:"<span style='color: white'>дате</span>"},{id:3,value:"<span style='color: white'>источнику</span>"}],on:{onChange:function(){var e=+this.getValue();$$("_suppl").getList().clearAll(),$$("_suppl").setValue(""),1===e?(0,s.get_suppl)("_suppl",this.$scope,"getSupplUnlnk"):2===e?(0,s.get_suppl)("_suppl",this.$scope,"getDatesUnlnk"):3===e?(0,s.get_suppl)("_suppl",this.$scope,"getSourceUnlnk"):webix.message({type:"error",text:"не сводим"}),console.log("this.$sc",this.$scope),this.$scope.ready()}}},{view:"text",localId:"_value_search",width:350,label:"Фильтр по значению",labelWidth:140,value:"",_keytimed:void 0,on:{onKeyPress:function(e,t){var i=this;clearTimeout(this.config._keytimed),(0,s.checkKey)(e)&&(this.config._keytimed=setTimeout((function(){(0,s.get_suppl)("_suppl",i.$scope,"getSupplUnlnk")}),this.$scope.app.config.searchDelay))}}},{},{view:"button",type:"htmlbutton",tooltip:"Обновить",hidden:t.config.link,resizable:!0,sWidth:132,eWidth:38,label:"",width:38,extLabel:"<span class = 'button_label'>Обновить</span>",oldLabel:"<span class='webix_icon fa-refresh'></span>",click:function(){2==+$$("_link_by").getValue()?(0,s.get_suppl)("_suppl",e,"getDatesUnlnk"):3==+$$("_link_by").getValue()?(0,s.get_suppl)("_suppl",e,"getSourceUnlnk"):(0,s.get_suppl)("_suppl",e,"getSupplUnlnk")}}]},{view:"toolbar",id:"_names_bar",css:"header",localId:"_local_names_bar",rows:[{height:32,cols:[{view:"text",name:"sh_prc",hidden:!0},{view:"label",label:"",name:"_name",fillspace:1}]},{height:32,cols:[{view:"label",label:"",css:"header",name:"_vendor"},{},{view:"label",label:"",css:"right",name:"_count",width:320,click:function(){var t=$$("_suppl").getValue();t&&(t=$$("_suppl").getList().getItem(t).c_vnd,e.popunlink.show("Осталось связать в этой сессии по поставщику "+t))}},{width:10},{view:"button",type:"htmlbutton",hidden:t.config.link,label:"<span style='color: #3498db'>Обновить сессию</span>",width:200,click:function(){if($$("_suppl").getList().getItem($$("_suppl").getValue())){var t=$$("_suppl").getList().getItem($$("_suppl").getValue()).id_vnd;(0,s.get_prcs)(e,t)}}}]}]},{view:"toolbar",height:40,cols:[{view:"text",label:"",labelWidth:1,placeholder:"Строка поиска",id:"_spr_search",_keytimed:void 0,localId:"_local_spr_search",on:{onKeyPress:function(e,t){var i=this;clearTimeout(this.config._keytimed),(0,s.checkKey)(e)&&(this.config._keytimed=setTimeout((function(){var e=i.$scope.table,t=i.$scope.nav;if(e){var o=(0,s.getDtParams)(e);(0,s.get_data_test)({view:e,navBar:t,start:1,searchBar:e.config.searchBar,method:e.config.searchMethod,field:o[2],direction:o[3],filter:o[0],count:o[1]})}}),this.$scope.app.config.searchDelay))}}},{view:"button",type:"htmlbutton",width:38,hidden:!0,label:"<span class='webix_icon fa-history'></span><span style='line-height: 20px;'></span>",click:function(){var t=e.table.config.name,i=webix.storage.session.get(t);e.pophistory.show(i,$$("_spr_search"))}},{view:"button",type:"htmlbutton",id:"_add",width:140,hidden:!0,localId:"_local_add",label:"Добавить (Ins)",hotkey:"insert",on:{onItemClick:function(){var t={},i=e.$$("_local_names_bar").getValues().p_name;t.t_name="Название товара:   "+i,t.c_tovar=i.toUpperCase(),e.popnew.show("Добавление в справочник",$$("_spr_search"),t)}}},{view:"button",type:"htmlbutton",id:"_link",localId:"_local_link",label:"<span class='webix_icon fa-link'></span><span style='line-height: 20px;'>  Связать (Ctrl+Home)</span>",hidden:!0,width:200,hotkey:"home+ctrl",click:function(){$$("_link").hide();var t=e.$$("_local_names_bar").getValues().sh_prc,i=e.table.getSelectedItem().id_spr,o={};o.th=e,o.command="setLnk",o.sh_prc=t,o.id_spr=i,o.type="async",o.callback=s.delPrc,e.popconfirm.show("Связать?",o)}},{view:"button",type:"htmlbutton",id:"_left",hidden:!0,localId:"_local_left",label:"<span class='webix_icon fa-angle-left'></span><span style='line-height: 20px;'>Ctrl+</span><span class='webix_icon fa-arrow-down'></span>",width:90,hotkey:"down+ctrl",click:function(){var t,i=$$("prcs_dc").getCursor();$$("prcs_dc").data.order.forEach((function(e,o,n){e===i&&(t=o)})),(t-=1)<0&&(t=$$("prcs_dc").count()-1),i=$$("prcs_dc").data.order[+t],$$("prcs_dc").setCursor(i),(0,s.parse_unlinked_item)(e)}},{view:"button",type:"htmlbutton",id:"_skip",hidden:!0,localId:"_local_skip",label:"Пропустить (Ctrl+M)",width:160,hotkey:"m+ctrl",click:function(){var t=s.prcs.getItem(s.prcs.getCursor()).sh_prc,i={};i.th=e,i.command="skipLnk",i.sh_prc=t,i.type="async",i.callback=s.delPrc,e.popconfirm.show("Пропустить?",i)}},{view:"button",type:"htmlbutton",id:"_right",hidden:!0,localId:"_local_right",label:"<span style='line-height: 20px;'>Ctrl+</span><span class='webix_icon fa-arrow-up'></span><span class='webix_icon fa-angle-right'></span>",width:90,hotkey:"up+ctrl",click:function(){var t,i=$$("prcs_dc").getCursor();$$("prcs_dc").data.order.forEach((function(e,o,n){e===i&&(t=o)})),(t+=1)===$$("prcs_dc").count()-1&&(t=0),i=$$("prcs_dc").data.order[+t],$$("prcs_dc").setCursor(i),(0,s.parse_unlinked_item)(e)}},{view:"button",type:"htmlbutton",hidden:!0,localId:"sideButton",tooltip:"Информация о товаре",label:"<span class='webix_icon fa-caret-left'></span>",resizable:!1,sWidth:136,eWidth:38,width:38,extLabel:"<span class='button_label'>О товаре</span>",oldLabel:"<span class='webix_icon fa-caret-left'></span>",formOpen:!1,on:{onItemClick:function(){var e=this.$scope.table;if(this.config.formOpen)this.define({label:"<span class='webix_icon fa-caret-left'></span>",formOpen:!1}),this.$scope.sideForm.hide_f();else{this.define({label:"<span class='webix_icon fa-caret-right'></span>",formOpen:!0}),this.$scope.sideForm.show_f(this.$scope.$$("sideButton").getNode());var t=e?e.getSelectedItem():void 0;t&&(t=t.id_spr,(t=(0,s.get_spr)(e.$scope,t)).s_name="Страна: "+t.c_strana,t.t_name="Название товара: "+t.c_tovar,t.v_name="Производитель: "+t.c_zavod,t.dv_name="Д. вещество: "+t.c_dv,this.$scope.sideForm.parse_f("Просмотр записи <span style='color: red'>"+t.id_spr+"</span>.  Изменения не будут сохранены",$$("_spr_search"),t))}this.refresh()}}}]},{$subview:d.default,name:"spr_dt"}]}},i.ready=function(){this.table=this.getRoot().getChildViews()[3].getChildViews()[0],this.nav=this.getRoot().getChildViews()[3].getChildViews()[1];var e=this.app.config.getButt(this.getRoot().getTopParentView());(0,s.setButtons)(this.app,e),1==+this.$$("_local_link_by").getValue()?this.$$("_value_search").show():this.$$("_value_search").hide(),this.table.callEvent("onresize"),this.$$("_local_spr_search").focus()},i.init=function(){this.app.config.link||(2==+$$("_link_by").getValue()?(0,s.get_suppl)("_suppl",this,"getDatesUnlnk"):3==+$$("_link_by").getValue()?(0,s.get_suppl)("_suppl",this,"getSourceUnlnk"):(0,s.get_suppl)("_suppl",this,"getSupplUnlnk")),this.sideForm=this.ui(h.default),this.popconfirm=this.ui(c.default),this.popnew=this.ui(l.default),this.popunlink=this.ui(a.default),this.pophistory=this.ui(r.default)},t}(n.iC)},2282:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>d});var o=i(1583),n=i(280),s=i(9968),a=i(6891),r=i(2478),l=i(4201),c=i(8274),d=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e,t=this,i=(this.app,function(){return t.getRoot().getChildViews()[2].getChildViews()[0]});return{view:"layout",type:"clean",rows:[{view:"toolbar",css:{"border-top":"0px"},cols:[{view:"text",label:"",placeholder:"Строка поиска",height:40,fillspace:!0,localId:"_ls",on:{onKeyPress:function(e,t){var i=this;clearTimeout(this.config._keytimed),(0,r.checkKey)(e)&&(this.config._keytimed=setTimeout((function(){i.$scope.seachPress(i)}),this.$scope.app.config.searchDelay))}}},{view:"button",type:"htmlbutton",localId:"_history",resizable:!0,sWidth:126,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>История</span>",oldLabel:"<span class='webix_icon fa-history'></span>",click:function(){var e=webix.storage.session.get(i().config.name);t.pophistory.show(e,t.$$("_ls"))}},{view:"checkbox",labelRight:"<span style='color: white'>Поиск по эталонам</span>",labelWidth:0,value:this.lch,width:150,localId:"_spr_ch",on:{onChange:function(){t.$$("_ls").setValue("");var e,i=t.$$("_spr_ch").getValue(),o=t.getRoot().getParentView().getParentView().getChildViews()[1].config.options,n=t.getRoot().getParentView().getParentView().getChildViews()[1].getValue();0===i?(t.lch=0,e=c.FB.LinksBarView):1===i&&(t.lch=1,e=c.FB.LinksSprBarView),o.forEach((function(i,o,s){+i.id==+n&&(i.value=e,i.width=(0,r.getHeaderLength)(e),t.getRoot().getParentView().getParentView().getChildViews()[1].refresh())}));var s=1===t.lch?"links_form_spr":"links_form_lnk";t.show(s)}}},(e={view:"button",width:40,tooltip:"Сбросить фильтры",type:"imageButton",image:c.ZY.unFilter.icon,localId:"_unfilt",resizable:!0,sWidth:180,eWidth:40,label:""},e.width=40,e.extLabel=c.ZY.unFilter.label,e.oldLabel="",e.click=function(){t.$$("_br").hide(),t.$$("_ls").setValue("");var e=i();(0,r.unFilter)(e),t.seachPress()},e),{view:"button",type:"htmlbutton",hidden:!1,localId:"_br",tooltip:"Удаить связку",resizable:!0,sWidth:140,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>Разорвать</span>",oldLabel:"<span style='color: red', class='webix_icon fa-unlink'></span>",click:function(){i().callEvent("onItemDblClick")}},{view:"button",type:"htmlbutton",hidden:!1,localId:"_hist",tooltip:"История связки",resizable:!0,sWidth:140,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>История</span>",oldLabel:"<span class='webix_icon fa-unlink'></span>",on:{onItemClick:function(){var e=i().getSelectedItem().id;console.log("sh_prc",e)}}}]},{height:1},{$subview:!0}]}},i.seachPress=function(e){var t=this.getRoot().getChildViews()[2].getChildViews()[0];if(t){var i=(0,r.getDtParams)(t);(0,r.get_data_test)({view:t,navBar:this.getRoot().getChildViews()[2].getChildViews()[1],start:1,count:i[1],searchBar:this.$$("_ls").config.id,method:this.getRoot().getChildViews()[2].getChildViews()[0].config.searchMethod,field:i[2],direction:i[3],filter:i[0]})}},i.ready=function(){var e=this.app.config.getButt(this.getRoot());(0,r.setButtons)(this.app,e);var t=1===this.app.config.lch?"links_form_spr":"links_form_lnk";this.show(t)},i.init=function(){this.lch=0,this.popnew=this.ui(a.default),this.popunlink=this.ui(l.default),this.pophistory=this.ui(s.default)},t}(n.iC)},5652:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>c});var o=i(1583),n=i(280),s=i(2478),a=i(4201),r=i(1118),l=i(8274),c=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this,t=this.app,i={user:t.config.user},o=(0,s.checkVal)((0,s.request)("getSupplAll",i,!0,t).response,"s"),n=[];o&&(n=o);var a=function(){var t=e.$$("__table").getSelectedItem().id;e.$$("__table").remove(t)},c={view:"datatable",name:"__ttl",localId:"__table",startPos:1,posPpage:t.config.posPpage,totalPos:1250,select:!0,borderless:!0,rowHeight:30,fixedRowHeight:!1,headermenu:{autowidth:!0},resizeColumn:!0,fi:"dt",di:"desc",searchBar:void 0,searchMethod:"getLnkSprs",tooltip:!0,columns:[{id:"id",width:270,hidden:!0,tooltip:!1,header:[{text:"Хэш"},{content:"cFilt"}]},{id:"id_tovar",width:100,hidden:!0,tooltip:!1,header:[{text:"Код"},{content:"cFilt"}]},{id:"c_tovar",fillspace:!0,sort:"server",css:"overflow",header:[{text:"Наименование"}],headermenu:!1},{id:"c_zavod",width:200,hidden:!0,css:"overflow",header:[{text:"Производитель"},{content:"cFilt"}]},{id:"id_spr",width:150,hidden:!0,sort:"server",tooltip:!1,header:[{text:"id_spr"},{content:"cFilt"}]},{id:"spr",width:350,css:"overflow",header:[{text:"Эталон"},{content:"cFilt",placeholder:"!слово - исключить из поиска",inputConfig:{height:30}}]},{id:"e_zavod",width:300,hidden:!0,css:"overflow",header:[{text:"Производитель эталона"}]},{id:"c_vnd",width:300,css:"overflow",header:[{text:"Поставщик"},{content:"richFilt",compare:s.compareTrue,inputConfig:{inputtype:"multicombo",tagMode:!1,keepText:!0,pager:1,options:{filter:s.mcf_filter,data:n,body:{yCount:10}}}}]},{id:"dt",width:200,sort:"server",tooltip:!1,format:s.dt_formating_sec,css:"center_p",header:[{text:"Дата изменения"},{content:"dateRangeFilter",compare:s.compareTrue,inputConfig:{format:s.dt_formating,width:180},suggest:{view:"daterangesuggest",body:{timepicker:!1,calendarCount:2}}}]},{id:"owner",width:100,sort:"server",tooltip:!1,header:[{text:"Создал"},{content:"cFilt"}]},{id:"source",width:150,hidden:!0,tooltip:!1,header:[{text:"Источник"},{content:"richFilt",compare:s.compareTrue,inputConfig:{pager:1,options:l.YM.sources}}]}],on:{onresize:function(){var e=this;clearTimeout(this.delayResize);var t=(0,s.recalcRowsRet)(this);t&&(this.config.posPpage=t,this.delayResize=setTimeout((function(){e.$scope.startSearch()}),150))},"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(e){webix.extend(this,webix.ProgressBar)},onBeforeSort:function(e,t){this.config.fi=e,this.config.di=t,this.$scope.startSearch()},onItemDblClick:function(t){var i=e.$$("__table").getSelectedItem().id,o={command:"delLnk"};o.sh_prc=i,o.type="async",o.callback=a,o.parent=e;var n=$$("_link_by");if(!n)return webix.message({text:"Для работы со связками откройте вкладку Линкер вначале.",type:"debug",expire:4e3}),!1;1==+n.getValue()?e.popunlink.show("Причина разрыва связки?",o,e._break):webix.message({text:"Выберите в параметрах сведение по поставщикам",type:"debug"})},onKeyPress:function(e,t){13===e&&this.getSelectedItem()&&this.callEvent("onItemDblClick")},onAfterSelect:function(e){this.$scope._break.show(),this.$scope._history.show()},onAfterUnselect:function(){this.$scope._break.hide(),this.$scope._history.hide()},onAfterLoad:function(){var e=this.getFilter("c_vnd"),t=e.$getValue();$$(e.config.popup).getList().filter("#value#",t)}}};return{view:"layout",css:{"border-left":"1px solid #dddddd !important"},rows:[c,{$subview:r.default}]}},i.startSearch=function(){var e=this.getRoot().getChildViews()[1].$scope.$$("__page");e.setValue(0==+e.getValue()?"1":"0")},i.ready=function(){var e=this,t=this.app,i=this,o=this.$$("__table");$$(o.getColumnConfig("dt").header[1].suggest.body.id).getChildViews()[1].getChildViews()[1].setValue("Применить"),$$(o.getColumnConfig("dt").header[1].suggest.body.id).getChildViews()[1].getChildViews()[1].define("click",(function(){this._filter_timer&&window.clearTimeout(this._filter_timer),this._filter_timer=window.setTimeout((function(){i.startSearch()}),webix.ui.datafilter.textWaitDelay),this.getParentView().getParentView().hide()})),o.isColumnVisible("owner")&&(t.config.roles[t.config.role].lnkdel?o.getFilter("owner").readOnly=!1:(o.getFilter("owner").value=this.app.config.user,o.getFilter("owner").readOnly=!0)),this._break=this.getRoot().getParentView().$scope.$$("_br"),this._search=this.getRoot().getParentView().$scope.$$("_ls"),this._history=this.getRoot().getParentView().$scope.$$("_hist"),o.config.searchBar=this._search.config.id,this._break.hide(),this._history.hide(),o.getFilter("dt").setValue(new Date),setTimeout((function(){var t=(0,s.recalcRowsRet)(o);t&&(o.config.posPpage=t),e.startSearch()}),10),o.getFilter("dt").blockEvent(),setTimeout((function(){o.getFilter("dt").setValue(null),o.getFilter("dt").unblockEvent()}),150),o.markSorting(o.config.fi,o.config.di),setTimeout((function(){$$(o.config.searchBar).focus()}),50)},i.init=function(){(0,s.setRows)(this),this.popunlink=this.ui(a.default)},t}(n.iC)},8181:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>c});var o=i(1583),n=i(280),s=i(6891),a=i(2478),r=i(4201),l=i(1118),c=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this,t=this.app,i=this,o={user:t.config.user},n=(0,a.checkVal)((0,a.request)("getSupplAll",o,!0,t).response,"s"),s=[];n&&(s=n);var r=function(){var e=i.$$("__table").getSelectedItem().id;i.$$("__table").remove(e)};return{view:"layout",css:{"border-left":"1px solid #dddddd !important"},rows:[{view:"treetable",name:"__tt",localId:"__table",startPos:1,posPpage:t.config.posPpage,totalPos:1250,select:!0,borderless:!0,rowHeight:30,fixedRowHeight:!1,headermenu:{autowidth:!0},resizeColumn:!0,fi:"c_tovar",di:"asc",old_stri:" ",searchBar:void 0,searchMethod:"getSprLnks",columns:[{id:"c_tovar",fillspace:!0,sort:"server",template:"<span>{common.treetable()} #c_tovar#</span><span style='color: red'> #count#</span>",header:[{text:"Наименование"}],headermenu:!1},{id:"c_zavod",width:200,header:[{text:"Производитель"},{content:"cFilt"}]},{id:"c_vnd",width:300,sort:"server",header:[{text:"Поставщик"},{content:"richFilt",compare:a.compareTrue,inputConfig:{inputtype:"combo",pager:1,options:{filter:a.mcf_filter,data:s}}}]},{id:"id_tovar",width:100,hidden:!0,sort:"server",header:[{text:"Код"}]},{id:"dt",width:200,format:a.dt_formating_sec,css:"center_p",header:[{text:"Дата изменения"}]},{id:"owner",width:100,header:[{text:"Создал"},{content:"cFilt"}]}],on:{onresize:function(){var e=this;clearTimeout(this.delayResize);var t=(0,a.recalcRowsRet)(this);t&&(this.config.posPpage=t,this.delayResize=setTimeout((function(){e.$scope.startSearch()}),150))},"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onBeforeSort:function(t,i){e.$$("__table").config.fi=t,e.$$("__table").config.di=i,e.startSearch()},onItemDblClick:function(e,i,o){var n=this.getSelectedItem().$level;if(1===n)t.config.roles[t.config.role].spredit?(e=e.row,(e=(0,a.get_spr)(this.$scope,e)).s_name="Страна: "+e.c_strana,e.t_name="Название товара: "+e.c_tovar,e.v_name="Производитель: "+e.c_zavod,e.dv_name="Д. вещество: "+e.c_dv,this.$scope.popnew.show("Редактирование записи "+e.id_spr,this.$scope._search,e)):webix.message({type:"error",text:"Редактирование запрещено"});else if(2===n){var s=this.$scope.$$("__table").getSelectedItem().id,l={action:"return",command:"delLnk"};l.sh_prc=s,l.type="async",l.callback=r,l.parent=this.$scope,this.$scope.popunlink.show("Причина разрыва связки?",l,this.$scope._break)}},onKeyPress:function(e,t){13===e&&this.getSelectedItem()&&this.callEvent("onItemDblClick")},onBeforeSelect:function(e){},onAfterSelect:function(e){var t=this.getSelectedItem().$level;1===t?(this.$scope._break.hide(),this.$scope._history.hide()):2===t&&(this.$scope._break.show(),this.$scope._history.show())}}},{$subview:l.default}]}},i.startSearch=function(){var e=this.getRoot().getChildViews()[1].$scope.$$("__page");e.setValue(0==+e.getValue()?"1":"0")},i.init=function(){this.popnew=this.ui(s.default),this.popunlink=this.ui(r.default),(0,a.setRows)(this)},i.ready=function(){var e=this,t=this.$$("__table");this._break=this.getRoot().getParentView().$scope.$$("_br"),this._search=this.getRoot().getParentView().$scope.$$("_ls"),this._history=this.getRoot().getParentView().$scope.$$("_hist"),t.config.searchBar=this._search.config.id,this._break.hide(),this._history.hide(),t.markSorting(t.config.fi,t.config.di),setTimeout((function(){var i=(0,a.recalcRowsRet)(t);i&&(t.config.posPpage=i),e.startSearch()}),10),setTimeout((function(){$$(t.config.searchBar).focus()}),50)},t}(n.iC)},9391:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>l});var o=i(1583),n=i(280),s=i(2478),a=i(6178),r=i.n(a),l=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this.app,t={view:"form",css:{border:"None"},localId:"auth_box",label:"Аутентификация",elements:[{view:"text",label:"Пользователь",name:"user",labelWidth:120,width:400,localId:"_user"},{view:"text",type:"password",label:"Пароль",name:"pass",labelWidth:120,width:400},{cols:[{},{},{view:"button",label:"OK",hotkey:"enter",click:function(){!function(t){var i=t.$scope.$$("auth_box").getValues();i.pass=r()(i.pass);var o=!1,n=(0,s.request)("login",i,!0,e).response;return(n=(0,s.checkVal)(n,"s"))&&(o=!0,e.config.user=n.user,e.config.role=n.role,e.config.x_api=n.key,(0,s.setCookie)("linker-app",[n.user,n.key,n.role].join("::"),{path:"/"})),o}(this)?(webix.message({text:"не авторизованно",type:"debug"}),(0,s.deleteCookie)("linker-app")):this.$scope.show("/start/body")}}]}]};return{view:"layout",rows:[{height:document.documentElement.clientHeight/4},{cols:[{},t,{}]},{}]}},i.ready=function(){this.$$("_user").focus()},i.init=function(){var e,t,i;try{var o=(0,s.getCookie)("linker-app").split("::");e=o[0],t=o[1],i=o[2]}catch(e){}e&&t&&i?(this.app.config.user=e,this.app.config.role=i,this.app.config.x_api=t,this.show("/start/body")):(0,s.deleteCookie)("linker-app")},t}(n.iC)},7116:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>l});var o=i(1583),n=i(280),s=i(2478),a=i(6178),r=i.n(a),l=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){return{view:"cWindow",modal:!0,on:{onHide:function(){this.$scope.$$("auth_form").clear(),this.$scope.$$("new_user").clear(),this.$scope.$$("new_pwd").clear(),this.$scope.$$("_forgot").setValue(0),this.$scope.$$("auth_form").show()}},body:{view:"multiview",localId:"auth_box",animate:!1,cells:[{view:"form",localId:"auth_form",elements:[{view:"text",label:"Пользователь",name:"user",localId:"_user",placeholder:"Имя пользователя",labelWidth:120,height:32,width:400},{view:"text",type:"password",label:"Пароль",name:"password",localId:"_pass",labelWidth:120,width:400,height:32},{view:"checkbox",labelRight:"Я не помню пароль",value:0,localId:"_forgot",labelWidth:0},{cols:[{},{view:"button",label:"Регистрация",click:function(){this.$scope.$$("new_user").show(),this.$scope.getRoot().getHead().getChildViews()[0].setValue("Заявка на регистрацию пользователя")}},{view:"button",label:"Войти",click:function(){0===this.$scope.$$("_forgot").getValue()?function(e){var t=e.$scope.app,i={},o=e.$scope.$$("auth_form").getValues(),n=!1;return i.display_name=o.user,i.hash=r()(o.password),location.hostname,console.log("item",i),(i="121212121212121")&&(n=!0,(0,s.setCookie)("qlks1k8wkgvvlto0",t.config.x_api,{path:"/"})),n}(this)?(this.$scope.getRoot().hide(),webix.message({text:"авторизованно",type:"debug"}),console.log("переход в кабинет пользователя")):(webix.message({text:"не авторизованно",type:"error"}),(0,s.deleteCookie)("qlks1k8wkgvvlto0")):1===this.$scope.$$("_forgot").getValue()&&(this.$scope.$$("new_pwd").show(),this.$scope.getRoot().getHead().getChildViews()[0].setValue("Заявка на сброс пароля"))}}]}]},{localId:"new_user",view:"form",rule:{login:webix.rules.isNotEmpty,email:webix.rules.isEmail,lastname:webix.rules.isNotEmpty,firstname:webix.rules.isNotEmpty},elements:[{view:"text",label:"Логин (номер зачетки)",labelWidth:160,width:450,name:"login",required:!0},{view:"text",label:"e-mail",labelWidth:160,width:450,name:"email",required:!0},{view:"text",label:"Фамилия",labelWidth:160,width:450,name:"lastname",required:!0},{view:"text",label:"Имя",labelWidth:160,width:450,name:"firstname",required:!0},{cols:[{},{view:"label",label:"Здесь будет reCaptcha"},{}]},{view:"label",label:"  После проверки информации администратором на указанный email",css:{"margin-bottom":"0px !important;"}},{view:"label",label:"будет выслана ссылка для подтверждения регистрации",css:{"margin-top":"-10px !important;"}},{cols:[{},{view:"button",label:"Отмена",click:function(){this.$scope.$$("auth_box").back(),this.$scope.getRoot().getHead().getChildViews()[0].setValue("Вход в систему")}},{view:"button",label:"Запросить",click:function(){if(this.$scope.$$("new_user").validate()){var e=this.$scope.$$("new_user").getValues(),t=(location.hostname,{newUser:e});return console.log("params",t),webix.message("Запрос отправлен"),void this.$scope.getRoot().hide()}}}]}]},{localId:"new_pwd",view:"form",rules:{email:webix.rules.isEmail},elements:[{view:"text",label:"e-mail при регистрации",labelWidth:140,width:400,name:"email",required:!0,labelPosition:"top"},{cols:[{},{view:"label",label:"Здесь будет reCaptcha"},{}]},{view:"label",label:"На указанный email будет выслана ссылка для сброса пароля",width:400},{cols:[{},{view:"button",label:"Отмена",click:function(){this.$scope.$$("auth_box").back(),this.$scope.getRoot().getHead().getChildViews()[0].setValue("Вход в систему")}},{view:"button",label:"Запросить",click:function(){if(this.$scope.$$("new_pwd").validate()){var e=this.$scope.$$("new_pwd").getValues(),t=(location.hostname,{newPwd:e});return console.log("params",t),webix.message("Запрос отправлен"),void this.$scope.getRoot().hide()}}}]}]}]}}},i.show_w=function(e){this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show()},i.init=function(){(0,s.getCookie)("qlks1k8wkgvvlto0")},t}(n.iC)},6178:function(e,t,i){var o;!function(n){"use strict";function s(e,t){var i=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(i>>16)<<16|65535&i}function a(e,t,i,o,n,a){return s((r=s(s(t,e),s(o,a)))<<(l=n)|r>>>32-l,i);var r,l}function r(e,t,i,o,n,s,r){return a(t&i|~t&o,e,t,n,s,r)}function l(e,t,i,o,n,s,r){return a(t&o|i&~o,e,t,n,s,r)}function c(e,t,i,o,n,s,r){return a(t^i^o,e,t,n,s,r)}function d(e,t,i,o,n,s,r){return a(i^(t|~o),e,t,n,s,r)}function h(e,t){var i,o,n,a,h;e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;var u=1732584193,p=-271733879,f=-1732584194,g=271733878;for(i=0;i<e.length;i+=16)o=u,n=p,a=f,h=g,u=r(u,p,f,g,e[i],7,-680876936),g=r(g,u,p,f,e[i+1],12,-389564586),f=r(f,g,u,p,e[i+2],17,606105819),p=r(p,f,g,u,e[i+3],22,-1044525330),u=r(u,p,f,g,e[i+4],7,-176418897),g=r(g,u,p,f,e[i+5],12,1200080426),f=r(f,g,u,p,e[i+6],17,-1473231341),p=r(p,f,g,u,e[i+7],22,-45705983),u=r(u,p,f,g,e[i+8],7,1770035416),g=r(g,u,p,f,e[i+9],12,-1958414417),f=r(f,g,u,p,e[i+10],17,-42063),p=r(p,f,g,u,e[i+11],22,-1990404162),u=r(u,p,f,g,e[i+12],7,1804603682),g=r(g,u,p,f,e[i+13],12,-40341101),f=r(f,g,u,p,e[i+14],17,-1502002290),u=l(u,p=r(p,f,g,u,e[i+15],22,1236535329),f,g,e[i+1],5,-165796510),g=l(g,u,p,f,e[i+6],9,-1069501632),f=l(f,g,u,p,e[i+11],14,643717713),p=l(p,f,g,u,e[i],20,-373897302),u=l(u,p,f,g,e[i+5],5,-701558691),g=l(g,u,p,f,e[i+10],9,38016083),f=l(f,g,u,p,e[i+15],14,-660478335),p=l(p,f,g,u,e[i+4],20,-405537848),u=l(u,p,f,g,e[i+9],5,568446438),g=l(g,u,p,f,e[i+14],9,-1019803690),f=l(f,g,u,p,e[i+3],14,-187363961),p=l(p,f,g,u,e[i+8],20,1163531501),u=l(u,p,f,g,e[i+13],5,-1444681467),g=l(g,u,p,f,e[i+2],9,-51403784),f=l(f,g,u,p,e[i+7],14,1735328473),u=c(u,p=l(p,f,g,u,e[i+12],20,-1926607734),f,g,e[i+5],4,-378558),g=c(g,u,p,f,e[i+8],11,-2022574463),f=c(f,g,u,p,e[i+11],16,1839030562),p=c(p,f,g,u,e[i+14],23,-35309556),u=c(u,p,f,g,e[i+1],4,-1530992060),g=c(g,u,p,f,e[i+4],11,1272893353),f=c(f,g,u,p,e[i+7],16,-155497632),p=c(p,f,g,u,e[i+10],23,-1094730640),u=c(u,p,f,g,e[i+13],4,681279174),g=c(g,u,p,f,e[i],11,-358537222),f=c(f,g,u,p,e[i+3],16,-722521979),p=c(p,f,g,u,e[i+6],23,76029189),u=c(u,p,f,g,e[i+9],4,-640364487),g=c(g,u,p,f,e[i+12],11,-421815835),f=c(f,g,u,p,e[i+15],16,530742520),u=d(u,p=c(p,f,g,u,e[i+2],23,-995338651),f,g,e[i],6,-198630844),g=d(g,u,p,f,e[i+7],10,1126891415),f=d(f,g,u,p,e[i+14],15,-1416354905),p=d(p,f,g,u,e[i+5],21,-57434055),u=d(u,p,f,g,e[i+12],6,1700485571),g=d(g,u,p,f,e[i+3],10,-1894986606),f=d(f,g,u,p,e[i+10],15,-1051523),p=d(p,f,g,u,e[i+1],21,-2054922799),u=d(u,p,f,g,e[i+8],6,1873313359),g=d(g,u,p,f,e[i+15],10,-30611744),f=d(f,g,u,p,e[i+6],15,-1560198380),p=d(p,f,g,u,e[i+13],21,1309151649),u=d(u,p,f,g,e[i+4],6,-145523070),g=d(g,u,p,f,e[i+11],10,-1120210379),f=d(f,g,u,p,e[i+2],15,718787259),p=d(p,f,g,u,e[i+9],21,-343485551),u=s(u,o),p=s(p,n),f=s(f,a),g=s(g,h);return[u,p,f,g]}function u(e){var t,i="",o=32*e.length;for(t=0;t<o;t+=8)i+=String.fromCharCode(e[t>>5]>>>t%32&255);return i}function p(e){var t,i=[];for(i[(e.length>>2)-1]=void 0,t=0;t<i.length;t+=1)i[t]=0;var o=8*e.length;for(t=0;t<o;t+=8)i[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return i}function f(e){var t,i,o="0123456789abcdef",n="";for(i=0;i<e.length;i+=1)t=e.charCodeAt(i),n+=o.charAt(t>>>4&15)+o.charAt(15&t);return n}function g(e){return unescape(encodeURIComponent(e))}function _(e){return function(e){return u(h(p(e),8*e.length))}(g(e))}function b(e,t){return function(e,t){var i,o,n=p(e),s=[],a=[];for(s[15]=a[15]=void 0,n.length>16&&(n=h(n,8*e.length)),i=0;i<16;i+=1)s[i]=909522486^n[i],a[i]=1549556828^n[i];return o=h(s.concat(p(t)),512+8*t.length),u(h(a.concat(o),640))}(g(e),g(t))}function w(e,t,i){return t?i?b(t,e):f(b(t,e)):i?_(e):f(_(e))}void 0===(o=function(){return w}.call(t,i,t,e))||(e.exports=o)}()},6028:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var o=i(1583),n=i(280),s=i(2478),a=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this;return{view:"cWindow",modal:!0,on:{onHide:function(){e.$$("_nbar").setValue(""),e.$$("b_code").setValue("0000000000000"),e.$$("_n_b").reconstruct()},onShow:function(){e.$$("_nbar").setValue(""),e.$$("b_code").setValue("0000000000000");var t=e.$$("_n_b").config.id_spr;(0,s.get_bars)(e,t),e.$$("b_list").clearAll(),e.$$("b_list").parse(s.barcodes)}},body:{view:"form",localId:"_n_b",margin:0,id_spr:void 0,th:void 0,callback:void 0,elements:[{rows:[{cols:[{view:"text",label:"Название",value:"",name:"_new_bar",placeholder:"Введите новый штрихкод",localId:"_nbar",required:!1},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-plus'></span>",width:30,click:function(){if(function(e){var t=0;if(isNaN(e)||13!==e.length)return!1;for(var i=0;i<13;i++)t+=Number(e[i])*(i%2*2+1);return!(t%10)}(e.$$("_nbar").getValue())){var t={barcode:e.$$("_nbar").getValue()};e.$$("b_list").add(t),e.$$("_nbar").setValue("")}}}]},{cols:[{view:"activeList",activeContent:{deleteBut:{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-minus'></span>",width:30,click:function(t,i){var o=e.$$("b_list").locate(i);e.$$("b_list").callEvent("onItemDblClick",[o])}}},localId:"b_list",width:250,height:350,type:{height:32},template:"<div class ='barcode'>#barcode#</div><div class = 'butt1'>{common.deleteBut()}</div>",select:!0,on:{onAfterSelect:function(){var e=this.getSelectedItem();this.$scope.$$("b_code").setValue(e.barcode)},onItemDblClick:function(e){this.remove(e),this.$scope.$$("b_code").setValue("0000000000000")}}},{width:10},{rows:[{view:"barcode",type:"ean13",value:"0000000000000",width:300,name:"_new_",localId:"b_code",hieght:200},{}]}]},{height:10},{cols:[{view:"button",type:"base",label:"Отменить",width:120,click:function(){e.hide()}},{},{view:"button",type:"base",label:"Применить",width:120,click:function(){e.$$("b_list").selectAll();var t=e.$$("b_list").getSelectedItem(),i="",o=e.$$("_n_b").config.th,n=e.$$("_n_b").config.id_spr,s=e.$$("_n_b").config.callback;if(t)try{t.forEach((function(e,t,o){i+=e.barcode+" "}))}catch(e){i=t.barcode}o&&o.$$("_barc").setValue(i),s&&s(n,i),e.hide()}}]}]}]}}},i.show=function(e,t,i,o){this.$$("_n_b").config.id_spr=t,this.$$("_n_b").config.th=i,this.$$("_n_b").config.callback=o,this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show()},i.hide=function(){this.getRoot().hide()},t}(n.iC)},1181:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>n});var o=i(1583),n=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this,t=this.app,i=this;return{view:"cWindow",modal:!0,on:{onShow:function(){e.$$("code").focus()},onHide:function(){e.$$("_n_f").clear(),e.$$("_n_f").clearValidation()}},body:{view:"form",localId:"_n_f",parent:void 0,item:void 0,margin:0,rules:{code:function(e){var t=!0;if(parseFloat(e)==e){var o=i.$$("_n_f").config.parent;o&&o.eachRow((function(i){+o.getItem(i).code==+e&&(t=!1)}),!0)}else t=!1;return i.$$("_n_f").config.item&&(t=!0),t},name:webix.rules.isNotEmpty},elements:[{cols:[{view:"text",localId:"code",label:"Код",value:"",width:120,name:"code",labelPosition:"top",labelAlign:"center",required:!0,invalidMessage:"Ошибочный код",readonly:!0},{view:"text",label:"Название",value:"",width:220,name:"name",labelPosition:"top",labelAlign:"center",localId:"name",required:!0,invalidMessage:"Введите значение"},{view:"text",label:"Непонятное поле",value:"",width:150,name:"inn",labelPosition:"top",labelAlign:"center",localId:"inn",required:!1,invalidMessage:"Введите значение"}]},{height:15},{height:30,cols:[{view:"button",type:"base",label:"Отменить",width:120,click:function(){e.hide()}},{},{view:"button",type:"base",label:"Сохранить",width:120,click:function(){if(e.$$("_n_f").validate({hidden:!1,disabled:!1})){var i=e.$$("_n_f").getValues();i.change=2,i.process=1,i.owner=t.config.user,e.$$("_n_f").config.item?e.$$("_n_f").config.parent.updateItem(e.$$("_n_f").config.item.id,i):e.$$("_n_f").config.parent.add(i,0),e.hide(),e.$$("_n_f").config.parent.$scope.show_b()}}}]}]}}},i.show=function(e,t,i){this.$$("_n_f").config.parent=t,this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show(),i?(this.$$("_n_f").config.item=i,this.$$("code").setValue(i.code),this.$$("name").setValue(i.name),this.$$("inn").setValue(i.inn),this.$$("code").define({readonly:!0})):(this.$$("_n_f").config.item=void 0,this.$$("code").define({readonly:!1})),this.$$("_n_f").refresh(),this.$$("code").refresh()},i.hide=function(){this.getRoot().hide()},t}(i(280).iC)},5141:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var o=i(1583),n=i(280),s=i(2478),a=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this;function t(e){var t="check"+this.config._params.type,i={};i.check=e,i.user=this.$scope.app.config.user;var o=!1,n=(0,s.request)(t,i,!0,this.$scope.app).response;return((n=(0,s.checkVal)(n,"s"))||this.config._params.text===e)&&(o=!0),o}return{view:"cWindow",modal:!0,on:{onHide:function(){e.$$("_n_f").clear(),e.$$("_n_f").clearValidation()}},body:{view:"form",localId:"_n_f",_params:{},margin:0,rules:{id:t,text:t},elements:[{view:"text",localId:"_id",label:"ID",value:"",name:"id",placeholder:"Введите значение",readonly:!0,required:!1,invalidMessage:"Такой ID уже есть",hidden:!0},{view:"text",label:"Название",value:"",name:"text",placeholder:"Введите значение",required:!0,invalidMessage:"Неверное название"},{view:"select",label:"Обязательный ассортимент",value:3,labelWidth:200,width:450,name:"oa",options:[{id:3,value:"Нет"},{id:1,value:"Для аптек"},{id:2,value:"Для аптек и аптечных пунктов"}],labelAlign:"left"},{height:15},{height:30,cols:[{view:"button",type:"base",label:"Отменить",width:120,click:function(){e.hide()}},{},{view:"button",type:"base",label:"Сохранить",width:120,click:function(){if(e.$$("_n_f").validate({hidden:!1,disabled:!1})){var t=e.$$("_n_f").getValues(),i={},o=e.$$("_n_f").config._params;i.value=t.text,i.user=e.app.config.user,i.id="upd"===o.mode?o.id:t.id,i.oa=t.oa;var n="new"===o.mode?"set"+o.type:"upd"+o.type,a=(0,s.request)(n,i,!0,e.app).response;(a=(0,s.checkVal)(a,"s"))&&o.callback(a,o.source),e.hide()}}}]}]}}},i.show=function(e,t){if(this.$$("_n_f").config._params=t,this.getRoot().getHead().getChildViews()[0].setValue(e),"upd"===t.mode){var i="Для аптек"===t.oa?1:"Для аптек и аптечных пунктов"===t.oa?2:3,o={text:t.text,id:t.id,oa:i};this.$$("_n_f").parse(o),this.$$("_id").define("readonly",!0)}else this.$$("_id").define("readonly",!1);this.$$("_id").refresh(),this.getRoot().show()},i.hide=function(){this.getRoot().hide()},i.getValues=function(){return this.getRoot().getBody().getValues()},t}(n.iC)},8881:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>n});var o=i(1583),n=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this,t=this.app;return{view:"cWindow",modal:!0,on:{onShow:function(){e.$$("name").focus()},onHide:function(){e.$$("_n_f").clear(),e.$$("_n_f").clearValidation()}},body:{view:"form",localId:"_n_f",parent:void 0,item:void 0,margin:0,rules:{name:webix.rules.isNotEmpty},elements:[{cols:[{view:"text",label:"Слово исключение",value:"",width:220,name:"name",labelPosition:"top",labelAlign:"center",required:!0,invalidMessage:"Введите значение",localId:"name"},{view:"radio",label:"условие",value:1,width:220,labelPosition:"top",labelAlign:"center",vertical:!1,localId:"conditions",options:[{id:0,value:"<span style='color: #666666'>начинается</span>"},{id:1,value:"<span style='color: #666666'>содержит</span>"}]}]},{height:15},{height:30,cols:[{view:"button",type:"base",label:"Отменить",width:120,click:function(){e.hide()}},{},{view:"button",type:"base",label:"Сохранить",width:120,click:function(){if(e.$$("_n_f").validate({hidden:!1,disabled:!1})){var i=e.$$("_n_f").getValues();i.change=2,i.process=1;var o=e.$$("conditions").getValue();1==+o?(i.options_st=0,i.options_in=1):0==+o&&(i.options_st=1,i.options_in=0),i.owner=t.config.user,e.$$("_n_f").config.item?e.$$("_n_f").config.parent.updateItem(e.$$("_n_f").config.item.id,i):e.$$("_n_f").config.parent.add(i,0),e.hide(),e.$$("_n_f").config.parent.$scope.show_b()}}}]}]}}},i.show=function(e,t,i){this.$$("_n_f").config.parent=t,this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show(),i?(this.$$("_n_f").config.item=i,this.$$("name").setValue(i.name),this.$$("conditions").setValue(i.options_st?0:1),this.$$("_n_f").refresh()):this.$$("_n_f").config.item=void 0},i.hide=function(){this.getRoot().hide()},t}(i(280).iC)},6891:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>h});var o=i(1583),n=i(280),s=i(9210),a=i(6028),r=i(721),l=i(934),c=i(2478),d=i(8274),h=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e,t,i=this,o=this.app;function n(e){c.vendor.add(e,0)}function s(e){c.dv.add(e,0)}return{view:"cWindow",modal:!0,on:{onHide:function(){c.barcodes.clearAll(),this.$scope.$$("new_form").clear(),this.$scope.$$("new_form").reconstruct()}},body:{view:"form",localId:"new_form",margin:0,spr:!1,search_bar:void 0,rules:{c_tovar:webix.rules.isNotEmpty,id_strana:webix.rules.isNotEmpty,id_zavod:webix.rules.isNotEmpty,id_dv:webix.rules.isNotEmpty},elements:[{rows:[{view:"label",label:"Название товара:",name:"t_name"},{view:"text",label:"",value:"",name:"c_tovar",required:!0,css:"raw_text",localId:"inputTxt"},{height:10,width:750},{cols:[{rows:[{view:"label",label:"Страна:",name:"s_name"},{view:"combo",width:400,value:"",name:"id_strana",required:!0,options:{filter:c.strana_filter,body:{template:"#c_strana#",yCount:7}},on:{onAfterRender:function(){this.getList().sync(c.strana)},onChange:function(e,t,i){}}},{view:"label",label:"Производитель:",name:"v_name"},{cols:[{view:"combo",label:"",value:"",name:"id_zavod",required:!0,options:{filter:c.zavod_filter,body:{template:"#c_zavod#",yCount:7}},on:{onAfterRender:function(){this.getList().sync(c.vendor)}}},{view:"button",type:"base",label:"+",width:30,hidden:!o.config.roles[o.config.role].vendoradd,click:function(){var e={new_name:"c_zavod",url:"Zavod",callback:n};i.popstri.show("Добавление производителя",e)}}]},{view:"label",label:"Д. вещество:",name:"dv_name"},{cols:[{view:"combo",label:"",value:"",name:"id_dv",required:!0,options:{filter:c.dv_filter,body:{autoheight:!1,view:"list",type:{height:"auto"},template:"<div class='comboList'>#act_ingr#</div>",height:200,yCount:0}},on:{onAfterRender:function(){this.getList().sync(c.dv)}}},{view:"button",type:"base",label:"+",width:30,hidden:!o.config.roles[o.config.role].vendoradd,click:function(){var e={new_name:"act_ingr",url:"Dv1",callback:s};i.popstri.show("Добавление д.вещества",e)}}]},{view:"label",label:"Форма выпуска:"},(e={view:"text",label:"",value:"",labelPosition:"left",readonly:!0,name:"issue",localId:"_issue",css:"raw_text"},e.readonly=!0,e.click=function(){var e=i.$$("new_form").getValues().id_spr;i.popis.show("Редактирование форм выпуска",e,i)},e),(t={view:"text",label:"Штрих-код:",value:"",labelPosition:"top",readonly:!0,name:"barcode",localId:"_barc",css:"raw_text"},t.readonly=!0,t.click=function(){var e=i.$$("new_form").getValues().id_spr;i.popbar.show("Редактирование ш.кодов",e,i)},t),{view:"text",label:"Товарная группа:",labelPosition:"top",value:"",name:"c_tgroup",localId:"_c_tgroup",css:"raw_text",readonly:!0,click:function(){var e=i.$$("new_form").getValues().id_spr;i.poptg.show("Редактирование товарных групп",e,i)}}]},{width:5},{rows:[{view:"form",css:"borders",localId:"new_f_right",elements:[{height:5},{cols:[{view:"checkbox",labelRight:"Рецептурный",labelWidth:0,align:"left",name:"_prescr"},{view:"checkbox",labelRight:"Обязательный",labelWidth:0,align:"left",name:"_mandat"},{view:"checkbox",labelRight:"ЖВ",labelWidth:0,align:"left",name:"id_jv"}]},{view:"combo",label:"Сезон:",labelPosition:"top",value:"",name:"id_sezon",css:"small",options:{filter:c.sez_filter,body:{template:"#sezon#",yCount:5}},on:{onAfterRender:function(){this.getList().sync(c.sezon)}}},{view:"combo",label:"Условия хранения:",labelPosition:"top",value:"",name:"id_usloviya",css:"small",options:{filter:c.hran_filter,body:{template:"#usloviya#",yCount:5}},on:{onAfterRender:function(){this.getList().sync(c.hran)}}},{view:"combo",label:"Группа:",labelPosition:"top",value:"",name:"id_group",css:"small",localId:"_local_id_group",required:!0,options:{filter:c.gr_filter,body:{autoheight:!1,view:"list",type:{height:"auto"},template:"<div class='comboList'>#group#</div>",height:200,yCount:0}},on:{onChange:function(e,t,i){var o=this.$scope.$$("__nds");"ZakMedCtg.1114"==e?o.setValue("ZakMedCtg.1358"):o.setValue()},onAfterRender:function(){var e=this;d.Xd.users.includes(this.$scope.app.config.user)&&51066==this.$scope._id_vnd||d.Xd.users.includes(this.$scope.app.config.user)&&45835==this.$scope._id_vnd||d.Xd.users.includes(this.$scope.app.config.user)?c.group.serialize().forEach((function(t){"ZakMedCtg.1114"!=t.id&&"ZakMedCtg.39"!=t.id&&e.getList().add(t)})):this.getList().parse(c.group)}}},{view:"combo",label:"НДС:",labelPosition:"top",value:"",name:"id_nds",css:"small",localId:"__nds",options:{filter:c.nds_filter,body:{template:"#nds#",yCount:5}},on:{onAfterRender:function(){this.getList().sync(c.nds)}}},{view:"combo",label:"Код ном.:",labelPosition:"top",value:"",name:"id_521",css:"small",localId:"__id_521",options:{filter:c.id521_filter,body:{template:"#id_521#",yCount:5}},on:{onAfterRender:function(){this.getList().sync(c.id521)}}}]}]}]},{cols:[{view:"button",type:"base",label:"Отменить",width:120,height:32,click:function(){i.hide()}},{},o.config.roles[o.config.role].spredit||d.Xd.users.includes(o.config.user)?{view:"button",type:"base",label:"Сохранить",width:120,height:32,localId:"_save",hidden:!(o.config.roles[o.config.role].spredit||d.Xd.users.includes(o.config.user)),click:function(){if(i.$$("new_form").validate({hidden:!1,disabled:!1})){var e=i.$$("new_form").getValues(),t=i.$$("new_f_right").getValues(),o={};if(o.id_spr=e.id_spr?e.id_spr:-1,o.barcode=e.barcode,o.issue=e.issue,o.c_tovar=e.c_tovar,o.id_strana=e.id_strana,o.id_zavod=e.id_zavod,o.id_dv=e.id_dv,o.c_opisanie=e.c_opisanie,o.prescr=1===t._prescr,o.mandat=1===t._mandat,o.id_jv=1===t.id_jv,o.id_sezon=t.id_sezon,o.id_usloviya=t.id_usloviya,o.id_group=t.id_group,o.id_521=i.$$("__id_521").getText(),o.id_nds=t.id_nds,i.p_item){var n=$$("prcs_dc").getCursor();n&&$$("prcs_dc").getItem(n).sh_prc?o.sh_prc=$$("prcs_dc").getItem(n).sh_prc||void 0:o.sh_prc=void 0}else o.sh_prc=void 0;o.c_tgroup=e.c_tgroup,o.user=i.app.config.user,o.id_521=t.id_521;var s=(0,c.request)("setSpr",o,!0,i.app).response;(s=(0,c.checkVal)(s,"s"))&&s.new&&i.$$("new_form").config.spr?(0,c.delPrc)(o,i):i.$$("new_form").config.search_bar.callEvent("onKeyPress",[13]),i.$$("new_form").config.spr=!1,i.hide()}}}:{width:1}]}]}]}}},i.show=function(e,t,i){this.$$("new_form").config.search_bar=t,i&&(this.p_item=i,this.$$("new_form").parse(i),this.$$("new_f_right").parse(i),this.$$("new_form").config.spr=!0),"_sb"!==t.config.localId&&(this._id_vnd=$$("_suppl").getList().getItem($$("_suppl").getValue()).id_vnd,(d.Xd.users.includes(this.app.config.user)&&45835==this._id_vnd||d.Xd.users.includes(this.app.config.user))&&this.$$("_local_id_group").setValue("ZakMedCtg.18")),this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show(),this.$$("inputTxt").focus()},i.hide=function(){this.getRoot().hide()},i.init=function(){this.popstri=this.ui(s.default),this.popbar=this.ui(a.default),this.poptg=this.ui(r.default),this.popis=this.ui(l.default)},t}(n.iC)},934:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var o=i(1583),n=i(280),s=i(2478),a=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this;return this.app,{view:"cWindow",modal:!0,body:{view:"form",localId:"_n_is",margin:0,id_spr:void 0,th:void 0,callback:void 0,elements:[{rows:[{view:"text",label:"Название",value:"",name:"_filter",placeholder:"Введите форму выпуска",localId:"_filt",on:{onTimedKeyPress:function(e,t){var i=this.getValue().toString().toLowerCase();this.$scope.$$("__e_table").filter("c_issue",i)}}},{cols:[{rows:[{view:"label",label:"Формы выпуска"},{view:"list",localId:"__table",width:350,height:.7*document.documentElement.clientHeight,template:"#c_issue#",select:!0,on:{onItemDblClick:function(e){var t=this.getItem(e);this.remove(e),this.$scope.$$("__e_table").add(t),this.$scope.$$("__e_table").sort("c_issue","asc")}}}]},{width:10},{rows:[{view:"label",label:"Все формы выпуска"},{view:"list",localId:"__e_table",width:350,template:"#c_issue#",select:!0,on:{onItemDblClick:function(e){var t=this.getItem(e);this.remove(e),this.$scope.$$("__table").add(t),this.$scope.$$("__table").sort("c_issue","asc")}}}]}]},{height:10},{cols:[{view:"button",type:"base",label:"Отменить",width:120,click:function(){e.hide()}},{},{view:"button",type:"base",label:"Применить",width:120,click:function(){e.$$("__table").selectAll();var t=e.$$("__table").getSelectedItem(),i="",o=e.$$("_n_is").config.th,n=e.$$("_n_is").config.id_spr,s=e.$$("_n_is").config.callback;if(t)try{t.forEach((function(e,t,o){i+=e.c_issue+"; "}))}catch(e){i=t.c_issue}o&&(o.$$("_issue").setValue(i),o.$$("_issue").refresh()),s&&s(n,i),e.hide()}}]}]}]}}},i.show=function(e,t,i,o){var n=this;this.$$("__e_table").clearAll(),this.$$("_n_is").reconstruct(),this.$$("__table").clearAll(),this.$$("_filt").setValue(""),this.$$("_n_is").config.id_spr=t,this.$$("_n_is").config.th=i,this.$$("_n_is").config.callback=o,this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show();var a={user:this.app.config.user,id_spr:t},r=(0,s.request)("getIs",a,!0,this.app).response;(r=(0,s.checkVal)(r,"s"))&&this.$$("__table").parse(r);var l=s.allIs.data.order;l.forEach((function(e,t,i){n.$$("__e_table").add(s.allIs.getItem(e))})),(l=this.$$("__table").data.order).forEach((function(e,t,i){n.$$("__e_table").remove(e)})),this.$$("_filt").focus()},i.hide=function(){this.getRoot().hide()},t}(n.iC)},4402:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var o=i(1583),n=i(280),s=i(2478),a=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this;return this.app,{view:"cWindow",modal:!0,on:{onHide:function(){e.$$("_n_f").clear(),e.$$("_n_f").clearValidation()}},body:{view:"form",localId:"_n_f",_params:{},margin:0,rules:{text:function(e){var t="check"+this.config._params.type,i={};i.check=e,i.user=this.$scope.app.config.user;var o=!1,n=(0,s.request)(t,i,!0,this.$scope.app).response;return((n=(0,s.checkVal)(n,"s"))||this.config._params.text===e)&&(o=!0),o}},elements:[{view:"text",localId:"_id",label:"ID",value:"",width:380,name:"id",placeholder:"Введите значение",readonly:!1,required:!1,invalidMessage:"Такой ID уже есть",hidden:!0},{view:"text",label:"Название",value:"",width:380,name:"text",placeholder:"Введите значение",required:!0,invalidMessage:"Неверное название",localId:"_text"},{view:"text",label:"Веб-сайт",value:"",width:380,name:"website",hidden:!0,localId:"_web"},{height:15},{height:30,cols:[{view:"button",type:"base",label:"Отменить",width:120,click:function(){e.hide()}},{},{view:"button",type:"base",label:"Сохранить",width:120,click:function(){if(e.$$("_n_f").validate({hidden:!1,disabled:!1})){var t=e.$$("_n_f").getValues(),i={},o=e.$$("_n_f").config._params;i.value=t.text,i.user=e.app.config.user,i.id=o.text?o.id:t.id,i.index=o.index,i.website=t.website;var n="new"===o.mode?"set"+o.type:"upd"+o.type,a=(0,s.request)(n,i,!0,e.app).response;(a=(0,s.checkVal)(a,"s"))&&("Issue"===o.type?o.callback("AllIs",a,o.source):"Sez"===o.type?o.callback("Sezon",a,o.source):"Gr"===o.type?o.callback("Group",a,o.source):o.callback(o.type,a,o.source)),e.hide()}}}]}]}}},i.show=function(e,t,i){var o=this.app;if(this.$$("_n_f").config._params=t,"Vendor"===t.type?this.$$("_web").show():this.$$("_web").hide(),this.getRoot().getHead().getChildViews()[0].setValue(e),this.$$("_id").define("readonly",!1),t.id_is){var n={text:t.text,id:t.id_is};this.$$("_n_f").parse(n),this.$$("_id").define("readonly",!0)}if(t.text){var a={text:t.text,id:t.id};this.$$("_n_f").parse(a),this.$$("_id").define("readonly",!0)}else if(i){var r={user:o.config.user};this.$$("_id").define("readonly",!0);var l=(0,s.request)("genGrId",r,!0,o).response;(l=(0,s.checkVal)(l,"s"))&&this.$$("_id").setValue(l)}t.website&&this.$$("_web").setValue(t.website),this.$$("_id").refresh(),this.getRoot().show(),this.$$("_text").focus()},i.hide=function(){this.getRoot().hide()},i.getValues=function(){return this.getRoot().getBody().getValues()},t}(n.iC)},8122:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var o=i(1583),n=i(280),s=i(2478),a=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this,t=this.app,i={1:"Табуляция",2:";",3:",",4:".",5:"Свое значение"},o={1:"xlsx",2:"ods",3:"pdf",4:"текст с разделителем"};return{view:"cWindow",modal:!0,on:{onHide:function(){e.$$("_form").reconstruct()},onShow:function(){}},body:{view:"form",localId:"_form",c_view:void 0,margin:0,elements:[{rows:[{cols:[{rows:[{view:"label",label:"КОЛОНКИ",align:"center"},{localId:"_check",view:"form",borderless:!0,elements:[]}]},{width:10},{rows:[{view:"label",label:"ТИП ФАЙЛА",align:"center"},{view:"radio",value:1,localId:"_type",margin:30,align:"center",width:200,vertical:!0,options:[{id:1,value:"<span style='color: #74747d'>"+o[1]+"</span>"},{id:2,value:"<span style='color: #74747d'>"+o[2]+"</span>"},{id:4,value:"<span style='color: #74747d'>"+o[4]+"</span>"}],on:{onChange:function(){4==+this.getValue()?(this.$scope.$$("_separator").show(),5==+this.$scope.$$("_separator").getValue()&&this.$scope.$$("_custom").show()):(this.$scope.$$("_separator").hide(),this.$scope.$$("_custom").hide())}}},{height:10},{view:"radio",value:1,label:"РАЗДЕЛИТЕЛЬ",hidden:!0,localId:"_separator",margin:30,labelWidth:100,labelPosition:"top",labelAlign:"center",align:"center",width:200,vertical:!0,options:[{id:1,value:"<span style='color: #74747d'>"+i[1]+"</span>"},{id:2,value:"<span style='color: #74747d'>"+i[2]+"</span>"},{id:3,value:"<span style='color: #74747d'>"+i[3]+"</span>"},{id:4,value:"<span style='color: #74747d'>"+i[4]+"</span>"},{id:5,value:"<span style='color: #74747d'>"+i[5]+"</span>"}],on:{onChange:function(){5==+this.getValue()?this.$scope.$$("_custom").show():this.$scope.$$("_custom").hide()}}},{view:"text",label:"ЗНАЧЕНИЕ",value:"",hidden:!0,localId:"_custom"}]}]},{height:10},{cols:[{view:"button",type:"base",label:"Отменить",width:120,click:function(){e.hide_w()}},{},{view:"button",type:"base",label:"Создать",width:120,click:function(){var n=e.$$("_form").config.c_view,a=t.config.r_url+"?saveData",r=[];e.$$("_check").getChildViews().forEach((function(e,t,i){var o={};1==+e.getValue()&&(o[e.config.id]=e.config.labelRight,r.push(o))}));var l=(0,s.getDtParams)(n),c={c_filt:l[0],field:l[2],direction:l[3]},d=void 0;try{d=$$(n.getParentView().$scope.$$("__table").config.searchBar).getValue()}catch(e){}var h=o[+e.$$("_type").getValue()],u={headers:r,user:t.config.user,type:h===o[4]?"csv":h,s_params:c,sep:i[+e.$$("_separator").getValue()],c_sep:e.$$("_custom").getValue(),table:e.$$("_form").config.c_view.config.name,search:d||""};(0,s.spinIconEnable)($$("_rep_button")),$$("_rep_button").blockEvent(),webix.ajax().timeout(18e4).headers({"Content-type":"application/json"}).response("blob").post(a,u,(function(e,t,i){var o=i.getResponseHeader("content-disposition").split("filename=")[1].replace(/^\s+|\s+$/g,"");webix.html.download(t,o),$$("_rep_button").unblockEvent(),(0,s.spinIconDisable)($$("_rep_button"))})),e.hide_w()}}]}]}]}}},i.show_w=function(e,t){var i=this;this.getRoot().getHead().getChildViews()[0].setValue(e),this.$$("_form").config.c_view=t,t.eachColumn((function(e){var o={view:"checkbox",labelRight:t.getColumnConfig(e).header[0].text,id:e,value:1,labelWidth:0,width:175};i.$$("_check").addView(o)}),!0),this.getRoot().show()},i.hide_w=function(){this.getRoot().hide()},t}(n.iC)},9210:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var o=i(1583),n=i(280),s=i(2478),a=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this;return{view:"cWindow",modal:!0,on:{onHide:function(){e.$$("_n_f").clear(),e.$$("_n_f").clearValidation()}},body:{view:"form",localId:"_n_f",_params:{},margin:0,rules:{_new_str:function(e){var t=this.config._params,i="check"+t.url,o={};o[t.new_name]=e,o.user=this.$scope.app.config.user;var n=(0,s.request)(i,o,!0,this.$scope.app).response,a=!1;return(n=(0,s.checkVal)(n,"s"))&&(a=!0),a}},elements:[{view:"text",label:"Название",value:"",width:320,name:"_new_str",required:!0,placeholder:"Введите новое значение",invalidMessage:"Такое название уже есть"},{cols:[{view:"button",type:"base",label:"Отменить",width:120,click:function(){e.hide()}},{},{view:"button",type:"base",label:"Сохранить",width:120,click:function(){if(e.$$("_n_f").validate({hidden:!1,disabled:!1})){var t=e.$$("_n_f").getValues(),i={},o=e.$$("_n_f").config._params;i[o.new_name]=t._new_str,i.user=e.app.config.user,i.id_spr=!!o.id_spr&&o.id_spr;var n="set"+o.url,a=(0,s.request)(n,i,!0,e.app).response;(a=(0,s.checkVal)(a,"s"))&&o.callback(a),e.hide()}}}]}]}}},i.show=function(e,t){this.$$("_n_f").config._params=t,this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show()},i.hide=function(){this.getRoot().hide()},i.getValues=function(){return this.getRoot().getBody().getValues()},t}(n.iC)},721:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var o=i(1583),n=i(280),s=i(2478),a=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this,t=this.app;return{view:"cWindow",modal:!0,on:{onHide:function(){e.$$("_filt").setValue(""),e.$$("t_list").clearAll(),e.$$("e_list").clearAll(),e.$$("_n_tg").reconstruct()},onShow:function(){e.$$("_filt").setValue("");var i=e.$$("_n_tg").config.id_spr,o=e.$$("e_list");if(o.clearAll(!0),o.parse((0,s.singleRefReload)(e.app,"getTgAll")),"number"==typeof i){var n=e.$$("t_list");n.clearAll(!0),n.parse((0,s.get_tg)(t,i)),n.data.order.forEach((function(e){o.remove(e)}))}e.$$("_filt").focus()}},body:{view:"form",localId:"_n_tg",margin:0,id_spr:void 0,th:void 0,callback:void 0,elements:[{rows:[{view:"text",label:"Название",value:"",name:"_filter",placeholder:"Введите название группы",localId:"_filt",on:{onTimedKeyPress:function(e,t){var i=this.getValue().toString().toLowerCase();this.$scope.$$("e_list").filter("c_tgroup",i)}}},{cols:[{rows:[{view:"label",label:"Товарные группы"},{view:"list",localId:"t_list",width:350,height:.7*document.documentElement.clientHeight,template:"#c_tgroup#",select:!0,on:{onItemDblClick:function(e){var t=this.getItem(e);this.remove(e),this.$scope.$$("e_list").add(t),this.$scope.$$("e_list").sort("c_tgroup","asc")}}}]},{width:10},{rows:[{view:"label",label:"Все товарные группы"},{view:"list",localId:"e_list",width:350,template:"#c_tgroup#",select:!0,on:{onItemDblClick:function(e){var t=this.getItem(e);this.remove(e),this.$scope.$$("t_list").add(t),this.$scope.$$("t_list").sort("c_tgroup","asc")}}}]}]},{height:10},{cols:[{view:"button",type:"base",label:"Отменить",width:120,click:function(){e.hide()}},{},{view:"button",type:"base",label:"Применить",width:120,click:function(){e.$$("t_list").selectAll();var t=e.$$("t_list").getSelectedItem(),i="",o=[],n=e.$$("_n_tg").config.th,s=e.$$("_n_tg").config.id_spr,a=e.$$("_n_tg").config.callback;if(t)try{t.forEach((function(e,t,n){i+=e.c_tgroup+"; ",o.push(e.id)}))}catch(e){i=t.c_tgroup,o.push(t.id)}n&&(n.$$("_c_tgroup").setValue(i),n.$$("_c_tgroup").refresh()),a&&(s?a(s,i,o):a("tgr",o)),e.hide()}}]}]}]}}},i.show=function(e,t,i,o){this.$$("_n_tg").config.id_spr=t,this.$$("_n_tg").config.th=i,this.$$("_n_tg").config.callback=o,this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show()},i.hide=function(){this.getRoot().hide()},t}(n.iC)},2917:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var o=i(1583),n=i(280),s=i(2478),a=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this,t=this.app;return{view:"cWindow",modal:!0,on:{onHide:function(){e.$$("new_user").clear(),e.$$("new_user").clearValidation()},onShow:function(){e.$$("_pwrd").define({type:"password"}),e.$$("_eye").define({label:"<span class='webix_icon fa-eye'></span><span style='line-height: 20px;'></span>"}),e.$$("_pwrd").refresh(),e.$$("_eye").refresh()}},body:{view:"form",localId:"new_user",margin:0,_params:{},rules:{c_user:function(e){var t="check"+this.config._params.type,i={};i.check=e,i.user=this.$scope.app.config.user;var o=!1,n=(0,s.request)(t,i,!0,this.$scope.app).response;return((n=(0,s.checkVal)(n,"s"))||this.config._params.id)&&(o=!0),o},c_pwrd:webix.rules.isNotEmpty,id_role:webix.rules.isNotEmpty},elements:[{rows:[{view:"text",labelPosition:"top",label:"Пользователь:",value:"",name:"c_user",required:!0,invalidMessage:"Укажите коректное имя"},{height:10,width:600},{view:"label",label:"Пароль:"},{cols:[{view:"text",label:"",value:"",name:"c_pwrd",type:"password",localId:"_pwrd",required:!0,invalidMessage:"Пароль обязателен"},{view:"button",type:"htmlbutton",localId:"_eye",label:"<span class='webix_icon fa-eye'></span><span style='line-height: 20px;'></span>",width:30,hidden:!t.config.roles[t.config.role].userdel,_vis:!1,click:function(){e.$$("_eye").config._vis?(e.$$("_pwrd").define({type:"password"}),e.$$("_eye").define({label:"<span class='webix_icon fa-eye'></span><span style='line-height: 20px;'></span>"}),e.$$("_pwrd").refresh(),e.$$("_eye").refresh(),e.$$("_eye").config._vis=!1):e.$$("_eye").config._vis||(e.$$("_pwrd").define({type:"text"}),e.$$("_eye").define({label:"<span class='webix_icon fa-eye-slash'></span><span style='line-height: 20px;'></span>"}),e.$$("_pwrd").refresh(),e.$$("_eye").refresh(),e.$$("_eye").config._vis=!0)}}]},{view:"text",labelPosition:"top",label:"Группа:",name:"id_group"},{view:"text",labelPosition:"top",label:"Список ИНН:",value:"",name:"c_inn"},{view:"label",label:"Роль пользователя:"},{cols:[{view:"combo",label:"",value:"",name:"id_role",localId:"_rolesC",required:!0,invalidMessage:"Роль пользователя должна быть указана",options:{body:{template:"#r_name#",yCount:5}}},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-plus'></span><span style='line-height: 20px;'></span>",width:30,hidden:!t.config.roles[t.config.role].userdel,click:function(){webix.message({type:"debug",text:"Пока не реализованно"})}}]},{height:10,width:600},{cols:[{view:"button",type:"base",label:"Отменить",width:120,height:32,click:function(){e.hide()}},{},{view:"button",type:"base",label:"Сохранить",width:120,height:32,hidden:!t.config.roles[t.config.role].useradd,click:function(){if(e.$$("new_user").validate({hidden:!1,disabled:!1})){var t=e.$$("new_user").getValues();1==+t.id_role&&(t.id_role="0"),t.user=e.app.user;var i=t.id?"updUser":"setUser";(0,s.checkVal)((0,s.request)(i,t,!0,e.app).response,"s")&&(i="getUsersAll",(0,s.request)(i,t,0,e.app).then((function(e){(e=(0,s.checkVal)(e,"a"))&&(this.$scope.users_dt.clearAll(),this.$scope.users_dt.parse(e))})),e.hide())}}}]}]}]}}},i.show=function(e,t,i){i&&(this.users_dt=i),t?(this.$$("new_user").parse(t),this.$$("new_user").config._params.id=t.id):(this.$$("new_user").clear(),this.$$("new_user").config._params={}),this.$$("new_user").config._params.type="User",this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show()},i.init=function(){var e=this.$$("_rolesC");e.getList().clearAll(),e.getList().parse(s.u_roles)},i.hide=function(){this.getRoot().hide()},t}(n.iC)},1118:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var o=i(1583),n=i(280),s=i(2478),a=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this;return this.app,{view:"toolbar",height:36,css:"custom_tool_bar",parent:void 0,cols:[{view:"button",type:"htmlbutton",localId:"_firstPB",label:"<span class='webix_icon fa-angle-double-left'></span>",width:50,on:{onItemClick:function(){e.$$("__page").setValue("1"),e.$$("__page").refresh()}}},{view:"button",type:"htmlbutton",localId:"_prevPB",label:"<span class='webix_icon fa-angle-left'></span>",width:50,on:{onItemClick:function(){var t=+e.$$("__page").getValue()-1;t>0&&(e.$$("__page").setValue(t),e.$$("__page").refresh())}}},{width:250,type:"wide",css:"lay_pg",cols:[{view:"text",label:"Страница",localId:"__page",labelWidth:70,width:150,value:"1",css:"raw_page",manual:!0,on:{onChange:function(t,i){if(e.$$("__page").config.manual){var o;o=1==+i&&0==+t?1:e.$$("__page").getValue();var n=e.getRoot().config.parent.config.posPpage,a=Math.ceil(e.getRoot().config.parent.config.totalPos/n);try{o=+o}catch(e){}if("number"==typeof o&&o>=0&&(a=o<=(0===a)?1:a)){var r=(o-1)*n+1,l=e.getRoot().config.parent;if(l){var c,d,h=(0,s.getDtParams)(l);try{c="__dtd"===e.getRoot().config.parent.$scope.getParentView().getRoot().getChildViews()[1].getChildViews()[0].config.name}catch(e){}c&&(d=1===e.checkbar.getValue()?"0,100":e.bnum.getValue()),(0,s.get_data_test)({view:e.getRoot().config.parent,navBar:e.getRoot(),start:r,count:h[1],searchBar:e.getRoot().config.parent.config.searchBar,method:e.getRoot().config.parent.config.searchMethod,field:h[2],direction:h[3],filter:h[0],cbars:d,total:r<2?void 0:e.getRoot().config.parent.config.totalPos})}}}else e.$$("__page").config.manual=!0}}},{view:"label",label:"из",width:30},{view:"label",label:"1",width:50,css:"p_center_p",localId:"__totalPages"}]},{view:"button",type:"htmlbutton",localId:"_nextPB",label:"<span class='webix_icon fa-angle-right'></span>",width:50,on:{onItemClick:function(){var t=+e.$$("__page").getValue()+1;t<=Math.ceil(e.getRoot().config.parent.config.totalPos/e.getRoot().config.parent.config.posPpage)&&(e.$$("__page").setValue(t),e.$$("__page").refresh())}}},{view:"button",type:"htmlbutton",localId:"_lastPB",label:"<span class='webix_icon fa-angle-double-right'></span>",width:50,on:{onItemClick:function(){var t=Math.ceil(e.getRoot().config.parent.config.totalPos/e.getRoot().config.parent.config.posPpage);e.$$("__page").setValue(t),e.$$("__page").refresh()}}},{},{view:"label",label:"Всего записей: 0",width:180}]}},i.ready=function(e){var t=e.getParentView().getParentView().$scope.$$("_chbar"),i=e.getParentView().getParentView().$scope.$$("_bnum");t&&(this.checkbar=t),i&&(this.bnum=i)},i.init=function(e){var t=e.getParentView().$scope.$$("__table");this.getRoot().config.parent=t},t}(n.iC)},755:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var o=i(1583),n=i(280),s=i(2478),a=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e,t=this,i=this.app,o={borderless:!0,rows:[{view:"counter",localId:"_counter",align:"center",label:"Добавляем позиций:",labelPosition:"top",labelAlign:"center",value:1,min:1,max:10},{view:"button",type:"htmlbutton",height:36,resizable:!1,label:"<span class='', style='line-height: 20px'>Добавить</span>",width:120,on:{onItemClick:function(){var e=~~t.$$("_counter").getValue(),o={user:i.config.user,value:e,sh_prc:t.sh_prc};(0,s.checkVal)((0,s.request)("copyPrc",o,!0,i).response,"s")&&t.topParent.startSearch(),t.hideM()}}}]};return(e={view:"popup",relative:!0,css:"pop-up-menu"}).relative=!0,e.body=o,e.on={onShow:function(){t.$$("_counter").setValue(1)}},e},i.isVisible=function(){return this.getRoot().isVisible()},i.showM=function(e,t){this.topParent=t,this.sh_prc=this.topParent.$$("__table").getSelectedItem().sh_prc,this.getRoot().show(e)},i.hideM=function(){this.getRoot().hide()},i.ready=function(){},i.init=function(){},t}(n.iC)},4472:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>l});var o=i(1583),n=i(280),s=i(2478),a=i(721),r=i(9870),l=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this,t=e.app,i=function(i,o){var n="tgr"===i?"setTGrMass":"id_521"===i?"setNCode":"setPropMass",a={user:t.config.user,method:i,items:e.id_sprs,prop_id:o,s_pars:e.s_pars},r=(0,s.request)(n,a,!0,t).response;(r=(0,s.checkVal)(r,"s"))?(webix.message({type:"success",text:"Свойство установленно",expire:2e3}),e.pTable.$scope.$$("_sb").callEvent("onKeyPress",[13]),webix.storage.session.put("__dt_assel",{s_pars:void 0})):webix.message({type:"error",text:"Свойство НЕ установленно",expire:2e3})},o={view:"toolbar",borderless:!0,rows:[{view:"button",type:"htmlbutton",height:40,width:150,resizable:!1,label:"<span class='', style='line-height: 20px'>Код номенкл.</span>",hidden:!(t.config.roles[t.config.role].skipped||["antey1","antey2"].includes(t.config.user)),on:{onItemClick:function(){this.$scope.hideM(),this.$scope.pTable.getSelectedItem(),this.$scope.popprop.showW("Изменение номенклатурного кода","id_521",i)}}},{view:"button",type:"htmlbutton",height:40,resizable:!1,label:"<span class='', style='line-height: 20px'>Товарная группа</span>",hidden:!t.config.roles[t.config.role].skipped,width:150,on:{onItemClick:function(){this.$scope.hideM(),this.$scope.pTable.getSelectedItem(),this.$scope.poptgnew.show("Добавление товарных групп",void 0,void 0,i)}}},{view:"button",type:"htmlbutton",height:40,width:150,resizable:!1,label:"<span class='', style='line-height: 20px'>Группа товара</span>",hidden:!t.config.roles[t.config.role].skipped,on:{onItemClick:function(){this.$scope.hideM(),this.$scope.pTable.getSelectedItem(),this.$scope.popprop.showW("Изменение группы товара","gr",i)}}},{view:"button",type:"htmlbutton",height:40,width:150,resizable:!1,label:"<span class='', style='line-height: 20px'>Д. вещество</span>",hidden:!t.config.roles[t.config.role].skipped,on:{onItemClick:function(){this.$scope.hideM(),this.$scope.pTable.getSelectedItem(),this.$scope.popprop.showW("Изменение действующего вещества","dv",i)}}},{view:"button",type:"htmlbutton",height:40,width:150,resizable:!1,label:"<span class='', style='line-height: 20px'>Рецептурный</span>",hidden:!t.config.roles[t.config.role].skipped,on:{onItemClick:function(){this.$scope.hideM(),this.$scope.pTable.getSelectedItem(),this.$scope.popprop.showW("Изменение рецептурности","recipt",i)}}},{view:"button",type:"htmlbutton",height:40,width:150,resizable:!1,label:"<span class='', style='line-height: 20px'>Обязательный</span>",hidden:!t.config.roles[t.config.role].skipped,on:{onItemClick:function(){this.$scope.hideM(),this.$scope.pTable.getSelectedItem(),this.$scope.popprop.showW("Изменение обязательного ассортимента","mandat",i)}}},{view:"button",type:"htmlbutton",height:40,width:150,resizable:!1,label:"<span class='', style='line-height: 20px'>Сезон</span>",hidden:!t.config.roles[t.config.role].skipped,on:{onItemClick:function(){this.$scope.hideM(),this.$scope.pTable.getSelectedItem(),this.$scope.popprop.showW("Изменение сезона","sezon",i)}}},{view:"button",type:"htmlbutton",height:40,width:150,resizable:!1,label:"<span class='', style='line-height: 20px'>Условия хранения</span>",hidden:!t.config.roles[t.config.role].skipped,on:{onItemClick:function(){this.$scope.hideM(),this.$scope.pTable.getSelectedItem(),this.$scope.popprop.showW("Изменение условий хранения","hran",i)}}},{view:"button",type:"htmlbutton",height:40,width:150,resizable:!1,label:"<span class='', style='line-height: 20px'>Форма выпуска</span>",hidden:!t.config.roles[t.config.role].skipped,on:{onItemClick:function(){this.$scope.hideM(),this.$scope.pTable.getSelectedItem(),this.$scope.popprop.showW("Изменение формы выпуска","issue",i)}}},{view:"button",type:"htmlbutton",height:40,width:150,resizable:!1,label:"<span class='', style='line-height: 20px'>НДС</span>",hidden:!t.config.roles[t.config.role].skipped,on:{onItemClick:function(){this.$scope.hideM(),this.$scope.pTable.getSelectedItem(),this.$scope.popprop.showW("Изменение НДС","nds",i)}}},{view:"button",type:"htmlbutton",height:40,width:150,resizable:!1,label:"<span class='', style='line-height: 20px'>Признак ЖВ</span>",hidden:!t.config.roles[t.config.role].skipped,on:{onItemClick:function(){this.$scope.hideM(),this.$scope.pTable.getSelectedItem(),this.$scope.popprop.showW("Изменение признака ЖВ","jv",i)}}}]};return{view:"popup",relative:!0,borderless:!0,autofit:!0,height:t.config.roles[t.config.role].skipped?0:50,padding:1,body:o}},i.isVisible=function(){return this.getRoot().isVisible()},i.showM=function(e,t){var i=this;this.pTable=t,this.getRoot().show(e);var o=webix.storage.session.get(t.config.name+"sel");this.s_pars=o.s_pars,delete o.s_pars,this.id_sprs=[],o.all?this.id_sprs=["all"]:Object.keys(o).forEach((function(e){"all"!==e&&o[e]&&i.id_sprs.push(e)}))},i.hideM=function(){this.getRoot().hide()},i.init=function(){this.poptgnew=this.ui(a.default),this.popprop=this.ui(r.default)},t}(n.iC)},742:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r});var o=i(1583),n=i(280),s=i(2478),a=i(8274),r=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e,t=this,i=this.app;return a.WM.forEach((function(t){t.value1===i.config.defaultView&&(e=t.id)})),{view:"cWindow",modal:!0,body:{view:"form",localId:"prop_form",margin:0,elements:[{rows:[{view:"counter",label:"Количество отображаемых строк в таблице:",value:20,labelWidth:270,width:370,step:1,align:"left",min:1,max:50,name:"posPpage",localId:"_ppage",hidden:!0},{height:10},{view:"checkbox",label:"Получать уведомления",value:1,labelWidth:270,width:370,readonly:!1,localId:"notify",name:"notify",on:{onChange:function(){1===t.$$("notify").getValue()?t.$$("nTime").show():0===t.$$("notify").getValue()&&t.$$("nTime").hide()}}},{height:10},{view:"counter",label:"Время вывода уведомлений",value:3,labelWidth:270,width:370,step:1,align:"left",min:0,max:30,readonly:!1,localId:"nTime",name:"nDelay",hidden:!0},{height:10},{view:"checkbox",label:'Вид кнопок "Эксперт"',value:1,labelWidth:270,width:370,readonly:!1,localId:"expert",name:"expert"},{height:10},{view:"checkbox",label:"Запоминать окна и параметры поиска",value:0,labelWidth:270,width:370,readonly:!0,localId:"save",name:"save"},{height:10},{view:"combo",label:"Вкладка по умолчанию",labelWidth:170,width:370,options:a.WM,value:e,name:"default",localId:"_default"},{view:"checkbox",label:"<span>Я </span><span style='color:red; font-weight: bold'>НЕ</span><span> собираюсь сводить</span>",value:0,labelWidth:270,width:370,readonly:!1,localId:"link",name:"link",hidden:!0},{height:15},{view:"label",label:"<span style='color: red'>После сохранения настроек страница будет обновленна</span>"},{height:15},{cols:[{view:"button",type:"base",label:"Отменить",width:120,height:32,click:function(){t.hide_w()}},{},{view:"button",type:"base",label:"Сохранить",width:120,height:32,click:function(){var e=t.$$("prop_form").getValues(),o="setExpert",n={user:i.config.user,expert:e.expert?"1":"5"};(0,s.request)(o,n,0,i),delete e.expert,e.default="LinkerView";var r=t.$$("_default").getValue();a.WM.forEach((function(t){+t.id==+r&&(e.default=t.value1)})),e.nDelay=1e3*e.nDelay,o="saveParams",n={user:i.config.user,pars:e},(0,s.request)(o,n,0,i),t.hide_w(),location.href="localhost"===location.hostname?"http://localhost:8080":"/linker/"}}]}]}]}}},i.ready=function(){1===this.$$("notify").getValue()?this.$$("nTime").show():0===this.$$("notify").getValue()&&this.$$("nTime").hide()},i.show_w=function(e){var t=this.app;if(this.getRoot().getHead().getChildViews()[0].setValue(e),this.$$("_ppage").setValue(t.config.posPpage),this.$$("notify").setValue(t.config.notify),this.$$("nTime").setValue(Math.ceil(t.config.nDelay/1e3)),this.$$("expert").setValue(!0===t.config.expert?1:0),this.$$("save").setValue(t.config.save),this.$$("link").setValue(t.config.link),!t.config.roles[t.config.role].skipped){var i=this.$$("_default").getList();i.exists(5)&&i.remove(5),i.exists(2)&&i.remove(2)}this.getRoot().show()},i.hide_w=function(){this.getRoot().hide()},i.init=function(){},t}(n.iC)},1614:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>w});var o=i(1583),n=i(280),s=i(2478),a=i(8442),r=i(5501),l=i(8243),c=i(6274),d=i(3335),h=i(3636),u=i(1456),p=i(4376),f=i(6874),g=i(7504),_=i(7204),b=i(8274),w=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this.app;function t(e){var t=e.$scope.target.$scope.getRoot().getTopParentView().getChildViews()[1].getChildViews()[0].getChildViews()[1],i=e.config.b_id;t.getChildViews()[1].setValue(i)}function i(e,t){var i=e.$scope.target.$scope.getRoot().getTopParentView().getChildViews()[1].getChildViews()[0].getChildViews()[1],o=t===a.default?b.FB.SeasonsView:t===l.default?b.FB.CountryView:t===c.default?b.FB.VendorsView:t===d.default?b.FB.DvView:t===h.default?b.FB.BarcodesView:t===u.default?b.FB.GroupsView:t===p.default?b.FB.HranView:t===f.default?b.FB.NdsView:t===g.default?b.FB.IssueView:t===_.default?b.FB.TGroupsView:t===r.default?b.FB.SprView:void 0;if(o){var n=webix.uid(),w={id:n,value:o,width:(0,s.getHeaderLength)(o),close:!0},v={$scope:e.$scope,id:n,$subview:t};e.config.b_id=n,i.getChildViews()[2].addView(v),i.getChildViews()[1].addOption(w,!0)}}var o={view:"toolbar",css:"side_tool_bar",borderless:!0,rows:[{view:"button",type:"htmlbutton",tooltip:"Просмотр и редактирование эталонов",label:"<span class='side_icon'>Эталоны</span>",hidden:!1,height:40,on:{onItemClick:function(){$$(this.config.b_id)?t(this):i(this,r.default),this.$scope.hide()}}},{view:"button",type:"htmlbutton",tooltip:"Просмотр и редактирование товарных групп",label:"<span class='side_icon'>Товарные группы</span>",hidden:!e.config.roles[e.config.role].skipped,height:40,on:{onItemClick:function(){$$(this.config.b_id)?t(this):i(this,_.default),this.$scope.hide()}}},{view:"button",type:"htmlbutton",tooltip:"Просмотр и редактирование форм выпуска",label:"<span class='side_icon'>Формы выпуска</span>",hidden:!e.config.roles[e.config.role].skipped,height:40,on:{onItemClick:function(){$$(this.config.b_id)?t(this):i(this,g.default),this.$scope.hide()}}},{view:"button",type:"htmlbutton",tooltip:"Просмотр и редактирование стран",label:"<span class='side_icon'>Страны</span>",hidden:!e.config.roles[e.config.role].skipped,height:40,on:{onItemClick:function(){$$(this.config.b_id)?t(this):i(this,l.default),this.$scope.hide()}}},{view:"button",type:"htmlbutton",tooltip:"Просмотр и редактирование производителей",label:"<span class='side_icon'>Производители</span>",hidden:!e.config.roles[e.config.role].skipped,height:40,on:{onItemClick:function(){$$(this.config.b_id)?t(this):i(this,c.default),this.$scope.hide()}}},{view:"button",type:"htmlbutton",tooltip:"Просмотр и редактирование действующих веществ",label:"<span class='side_icon'>ДВ</span>",hidden:!e.config.roles[e.config.role].skipped,height:40,on:{onItemClick:function(){$$(this.config.b_id)?t(this):i(this,d.default),this.$scope.hide()}}},{view:"button",type:"htmlbutton",tooltip:"Просмотр и редактирование штрих-кодов",label:"<span class='side_icon'>Штрих-коды</span>",hidden:!e.config.roles[e.config.role].skipped,height:40,on:{onItemClick:function(){$$(this.config.b_id)?t(this):i(this,h.default),this.$scope.hide()}}},{view:"button",type:"htmlbutton",tooltip:"Просмотр и редактирование групп",label:"<span class='side_icon'>Группы</span>",hidden:!e.config.roles[e.config.role].skipped,height:40,on:{onItemClick:function(){$$(this.config.b_id)?t(this):i(this,u.default),this.$scope.hide()}}},{view:"button",type:"htmlbutton",tooltip:"Просмотр и редактирование условий хранения",label:"<span class='side_icon'>Условия хранения</span>",hidden:!e.config.roles[e.config.role].skipped,height:40,on:{onItemClick:function(){$$(this.config.b_id)?t(this):i(this,p.default),this.$scope.hide()}}},{view:"button",type:"htmlbutton",tooltip:"Просмотр и редактирование НДС",label:"<span class='side_icon'>НДС</span>",hidden:!e.config.roles[e.config.role].skipped,height:40,on:{onItemClick:function(){$$(this.config.b_id)?t(this):i(this,f.default),this.$scope.hide()}}},{view:"button",type:"htmlbutton",tooltip:"Просмотр и редактирование сезонов",label:"<span class='side_icon'>Сезоны</span>",hidden:!e.config.roles[e.config.role].skipped,height:40,on:{onItemClick:function(){$$(this.config.b_id)?t(this):i(this,a.default),this.$scope.hide()}}}]};return{view:"popup",head:"sub-menu",loclalId:"_pop",height:e.config.roles[e.config.role].skipped?0:60,width:180,css:"pop-up-menu",relative:!0,body:o}},i.isVisible=function(){return this.getRoot().isVisible()},i.show=function(e,t){return this.target=e,this.parent=t,this.getRoot().show(this.target.$view)},i.hide=function(){return this.getRoot().hide()},i.init=function(){},i.ready=function(){},t}(n.iC)},3291:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>l});var o=i(1583),n=i(280),s=i(2478),a=i(1118),r=i(8274),l=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this,t=this.app,i=$$("sezon_dc").data.getRange($$("sezon_dc").data.getFirstId(),$$("sezon_dc").data.getLastId()),o=[],n=[],l=[],c=[],d=[],h=[],u=[];if(i.forEach((function(e,t,i){var n={id:e.id,value:e.sezon};o.push(n)})),(i=$$("hran_dc").data.getRange($$("hran_dc").data.getFirstId(),$$("hran_dc").data.getLastId())).forEach((function(e,t,i){var o={id:e.id,value:e.usloviya};c.push(o)})),(i=$$("nds_dc").data.getRange($$("nds_dc").data.getFirstId(),$$("nds_dc").data.getLastId())).forEach((function(e,t,i){var o={id:e.id,value:e.nds};l.push(o)})),(i=$$("group_dc").data.getRange($$("group_dc").data.getFirstId(),$$("group_dc").data.getLastId())).forEach((function(e,t,i){var o={id:e.id,value:e.group};n.push(o)})),(i=$$("dv_dc").data.getRange($$("dv_dc").data.getFirstId(),$$("dv_dc").data.getLastId())).forEach((function(e,t,i){var o={id:e.id,value:e.act_ingr};h.push(o)})),(i=$$("strana_dc").data.getRange($$("strana_dc").data.getFirstId(),$$("strana_dc").data.getLastId())).length>1)i.forEach((function(e,t,i){var o={id:e.id,value:e.c_strana};d.push(o)}));else{var p={user:t.config.user},f=(0,s.checkVal)((0,s.request)("getStranaAll",p,!0,t).response,"s");f&&f.forEach((function(e,t,i){var o={id:e.id,value:e.c_strana};u.push(o)}))}if((i=$$("vendor_dc").data.getRange($$("vendor_dc").data.getFirstId(),$$("vendor_dc").data.getLastId())).length>1)i.forEach((function(e,t,i){var o={id:e.id,value:e.c_zavod};u.push(o)}));else{var g={user:t.config.user},_=(0,s.checkVal)((0,s.request)("getVendorAll",g,!0,t).response,"s");_&&_.forEach((function(e,t,i){var o={id:e.id,value:e.c_zavod};u.push(o)}))}var b={view:"datatable",name:"relink",localId:"__table",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:{autowidth:!0},startPos:1,posPpage:20,totalPos:1250,fi:"c_tovar",di:"asc",parent:void 0,searchBar:void 0,searchMethod:"getSprSearchAdm",old_spr:void 0,old_id:void 0,old_stri:"",css:"dt_css",columns:[{id:"id_spr",width:80,sort:"server",header:[{text:"IDSPR"},{content:"cFilt",inputConfig:{pager:2}}],headermenu:!1},{id:"c_tovar",fillspace:1,sort:"server",header:[{text:"Наименование"}],headermenu:!1},{id:"id_zavod",sort:"server",width:300,header:[{text:"Производитель"},{content:"richFilt",compare:s.compareTrue,inputConfig:{inputtype:"combo",options:{data:u}}}]},{id:"id_strana",sort:"server",width:200,header:[{text:"Страна"},{content:"richFilt",compare:s.compareTrue,inputConfig:{inputtype:"combo",options:{data:d}}}]},{id:"c_dv",hidden:!0,sort:"server",width:300,header:[{text:"Д. в-во"},{content:"richFilt",compare:s.compareTrue,inputConfig:{inputtype:"combo",options:{data:h}}}]},{id:"c_group",hidden:!0,width:300,header:[{text:"Группа"},{content:"richFilt",compare:s.compareTrue,inputConfig:{inputtype:"combo",options:{data:n}}}]},{id:"c_nds",hidden:!0,width:150,header:[{text:"НДС"},{content:"richFilt",compare:s.compareTrue,inputConfig:{options:l}}]},{id:"c_hran",hidden:!0,width:150,header:[{text:"Условия хранения"},{content:"richFilt",compare:s.compareTrue,inputConfig:{options:c}}]},{id:"c_sezon",hidden:!0,width:180,header:[{text:"Сезонность"},{content:"richFilt",compare:s.compareTrue,inputConfig:{options:o}}]},{id:"mandat",width:100,template:function(e){return e.c_mandat?"<div><span class='webix_icon fa-check-circle'></span></div>":"<div><span class='webix_icon fa-times'></span></div>"},hidden:!0,css:"center_p",header:[{text:"Обязательный"},{content:"richFilt",compare:s.compareTrue,inputConfig:{options:[{id:1,value:"Да"},{id:2,value:"Нет"}]}}]},{id:"prescr",width:100,hidden:!0,css:"center_p",template:function(e){return e.c_prescr?"<div><span class='webix_icon fa-check-circle'></span></div>":"<div><span class='webix_icon fa-times'></span></div>"},header:[{text:"Рецептурный"},{content:"richFilt",compare:s.compareTrue,inputConfig:{options:[{id:1,value:"Да"},{id:2,value:"Нет"}]}}]},{id:"dt",width:200,sort:"server",format:s.dt_formating_sec,css:"center_p",header:[{text:"Дата изменения"},{content:"dateRangeFilter",compare:s.compareTrue,inputConfig:{format:s.dt_formating,width:180},suggest:{view:"daterangesuggest",body:{timepicker:!1,calendarCount:2}}}]}],on:{onresize:function(){var e=this;clearTimeout(this.delayResize);var t=(0,s.recalcRowsRet)(this);t&&(this.delayResize=setTimeout((function(){e.config.posPpage=t,e.$scope.startSearch()}),150))},"data->onParse":function(e,t){this.clearAll()},onBeforeSort:function(i,o){setTimeout((function(){e.$$("__table").config.fi=i,e.$$("__table").config.di=o,e.startSearch()}),t.config.searchDelay)},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onItemDblClick:function(e){if(e=this.getItem(e.row),this.$scope.$$("__table").config.old_spr===e.id_spr)webix.message({type:"error",text:"Нельзя заменять эталон на самого себя",expire:5e3});else{var i={user:t.config.user,old_spr:this.$scope.$$("__table").config.old_spr,new_spr:e.id_spr},o=(0,s.request)("delSpr",i,!0,t).response;(o=(0,s.checkVal)(o,"s"))&&(this.config.parent.$$("__table").remove(this.config.old_id),this.config.parent.$$("_del").hide(),this.$scope.hide())}},onAfterLoad:function(){this.hideProgress()},onKeyPress:function(e,t){13===e&&this.getSelectedItem()&&this.callEvent("onItemDblClick")}}},w={view:"layout",rows:[{view:"toolbar",rows:[{view:"label",label:"наименование удаляемого товара",localId:"old_tovar"},{height:40,cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Введите наименование",localId:"_sb",hidden:!1,on:{onKeyPress:function(e,t){var i=this;clearTimeout(this.config._keytimed),(0,s.checkKey)(e)&&(this.config._keytimed=setTimeout((function(){i.$scope.startSearch()}),this.$scope.app.config.searchDelay))}}},{view:"button",localId:"__reset",tooltip:"Сбросить фильтры",type:"imageButton",image:r.ZY.unFilter.icon,width:38,on:{onItemClick:function(){var t=e.$$("__table");(0,s.unFilter)(t),e.startSearch()}}}]}]},b,{$subview:a.default}]};return{view:"cWindow",width:.95*document.documentElement.clientWidth,height:.95*document.documentElement.clientHeight,modal:!0,resize:!1,on:{onHide:function(){this.$scope.$$("__table").clearAll()}},body:w}},i.show=function(e,t,i){var o=this.$$("__table");if(this.getRoot().show(),i&&(o.config.parent=i),this.getRoot().getHead().getChildViews()[0].setValue(e),t){this.$$("old_tovar").setValue("<span style='color:red'>"+t.id_spr+" </span>"+t.c_tovar),o.config.old_spr=t.id_spr,o.config.old_id=t.id;var n=t.c_tovar.replace(/^\s+|\s+$/g,"").split(" ")[0];o.config.searchBar.setValue(n),o.callEvent("onresize")}o.config.searchBar.focus()},i.hide=function(){this.getRoot().hide()},i.startSearch=function(){var e=this.$$("__table").getParentView().getChildViews()[2].$scope.$$("__page");e.setValue(0==+e.getValue()?"1":"0")},i.ready=function(){var e=this.$$("__table");e.config.searchBar=this.$$("_sb");var t=this;$$(e.getColumnConfig("dt").header[1].suggest.body.id).getChildViews()[1].getChildViews()[1].setValue("Применить"),$$(e.getColumnConfig("dt").header[1].suggest.body.id).getChildViews()[1].getChildViews()[1].define("click",(function(){this._filter_timer&&window.clearTimeout(this._filter_timer),this._filter_timer=window.setTimeout((function(){t.startSearch()}),webix.ui.datafilter.textWaitDelay),this.getParentView().getParentView().hide()}))},i.init=function(){},t}(n.iC)},9534:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>l});var o=i(1583),n=i(280),s=i(2478),a=i(1118),r=i(8274),l=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this,t=this.app,i={view:"datatable",name:"rlslink",localId:"__table",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:{autowidth:!0},startPos:1,posPpage:20,totalPos:1250,fi:"c_tovar",di:"asc",parent:void 0,searchBar:void 0,searchMethod:"getPrcsAll",old_stri:"",css:"dt_css",columns:[{id:"id_tovar",width:80,hidden:!0,header:[{text:"ID товара"}]},{id:"sh_prc",width:280,hidden:!0,header:[{text:"sh_prc"},{content:"cFilt",inputConfig:{pager:2}}]},{id:"c_tovar",fillspace:1,sort:"server",header:[{text:"Наименование"}],headermenu:!1},{id:"c_zavod",sort:"server",hidden:!1,headermenu:!0,width:200,header:[{text:"Производитель"},{content:"cFilt",inputConfig:{pager:2}}]},{id:"c_vnd",sort:"server",width:200,hidden:!0,headermenu:!1,header:[{text:"Поставщик"},{content:"textFilter",compare:s.compareTrue,inputConfig:{pager:2,value:"51078"}}]},{id:"c_user",sort:"server",hidden:!0,headermenu:!0,width:160,header:[{text:"Группа пользователей"},{content:"richFilt",compare:s.compareTrue,inputConfig:{options:r.YM.users}}]},{id:"dt",width:200,sort:"server",format:s.dt_formating_sec,css:"center_p",header:[{text:"Дата добавления"},{content:"dateRangeFilter",compare:s.compareTrue,inputConfig:{format:s.dt_formating,width:180},suggest:{view:"daterangesuggest",body:{timepicker:!1,calendarCount:2}}}]},{id:"source",width:150,hidden:!0,headermenu:!1,header:[{text:"Источник"},{content:"richFilt",compare:s.compareTrue,inputConfig:{options:r.YM.sources}}]},{id:"in_work",width:5,hidden:!0,headermenu:!1},{id:"in_work_name",width:100,hidden:!0,headermenu:!1,header:[{text:"В работе"}]},{id:"id_org",width:100,hidden:!0,headermenu:!1,header:[{text:"id_org"},{content:"cFilt",inputConfig:{pager:2}}]}],on:{onresize:function(){var e=this;clearTimeout(this.delayResize);var t=(0,s.recalcRowsRet)(this);t&&(this.delayResize=setTimeout((function(){e.config.posPpage=t,e.$scope.startSearch()}),150))},"data->onParse":function(e,t){this.clearAll()},onBeforeSort:function(t,i){e.$$("__table").config.fi=t,e.$$("__table").config.di=i,e.startSearch()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onItemDblClick:function(e){var i=this;e=this.getItem(e.row);var o={user:t.config.user,id_spr:this.$scope.id_spr,sh_prc:e.sh_prc};(0,s.request)("setLnk",o,0,t).then((function(e){(e=(0,s.checkVal)(e,"a"))&&(i.$scope.parent.$$("__table").remove(i.$scope.d_id),i.$scope.hide_w())}))},onAfterLoad:function(){this.hideProgress()},onKeyPress:function(e,t){13===e&&this.getSelectedItem()&&this.callEvent("onItemDblClick")}}},o={view:"layout",rows:[{view:"toolbar",rows:[{view:"label",label:"наименование связываемого эталона",localId:"old_tovar"},{height:40,cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Введите наименование",localId:"_sb",hidden:!1,on:{onKeyPress:function(e,t){var i=this;clearTimeout(this.config._keytimed),(0,s.checkKey)(e)&&(this.config._keytimed=setTimeout((function(){i.$scope.startSearch()}),this.$scope.app.config.searchDelay))}}},{view:"button",localId:"__reset",tooltip:"Сбросить фильтры",type:"imageButton",image:r.ZY.unFilter.icon,width:38,on:{onItemClick:function(){var t=e.$$("__table");(0,s.unFilter)(t),e.startSearch()}}}]}]},i,{$subview:a.default}]};return{view:"cWindow",width:.95*document.documentElement.clientWidth,height:.95*document.documentElement.clientHeight,modal:!0,resize:!1,on:{onHide:function(){this.$scope.$$("__table").clearAll()}},body:o}},i.show_w=function(e,t,i){if(i&&(this.parent=i),t){var o=t.c_tovar+", "+t.id_zavod+", "+t.id_strana;this.$$("old_tovar").setValue("<span style='color:red'>"+t.id_spr+" </span>"+o),this.id_spr=t.id_spr,this.d_id=t.id;var n=t.c_tovar.split(" ")[0];this.$$("__table").config.searchBar.setValue(n)}this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show(),this.startSearch(),this.$$("_sb").focus()},i.hide_w=function(){this.getRoot().hide()},i.startSearch=function(){var e=this.$$("__table").getParentView().getChildViews()[2].$scope.$$("__page");e.setValue(0==+e.getValue()?"1":"0")},i.ready=function(){this.$$("__table").config.searchBar=this.$$("_sb");var e=this;$$(this.$$("__table").getColumnConfig("dt").header[1].suggest.body.id).getChildViews()[1].getChildViews()[1].setValue("Применить"),$$(this.$$("__table").getColumnConfig("dt").header[1].suggest.body.id).getChildViews()[1].getChildViews()[1].define("click",(function(){this._filter_timer&&window.clearTimeout(this._filter_timer),this._filter_timer=window.setTimeout((function(){e.startSearch()}),webix.ui.datafilter.textWaitDelay),this.getParentView().getParentView().hide()}))},i.init=function(){},t}(n.iC)},8208:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var o=i(1583),n=i(280),s=i(2478),a=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e,t,i=this;return this.app,{view:"cWindow",localId:"sw",relative:!0,animate:!0,head:!1,resize:!1,modal:!1,on:{onHide:function(){s.barcodes.clearAll(),this.$scope.$$("new_form").clear(),this.$scope.$$("new_form").reconstruct()}},body:{view:"form",localId:"new_form",readonly:!0,margin:0,spr:!1,search_bar:void 0,rules:{c_tovar:webix.rules.isNotEmpty,id_strana:webix.rules.isNotEmpty,id_zavod:webix.rules.isNotEmpty,id_dv:webix.rules.isNotEmpty},elements:[{view:"label",label:"Просмотр записи",name:"idspr"},{rows:[{view:"label",label:"Название товара:",name:"t_name"},{view:"text",label:"",value:"",name:"c_tovar",required:!0,css:"raw_text"},{height:10,width:720},{cols:[{rows:[{view:"label",label:"Страна:",name:"s_name"},{view:"combo",width:400,value:"",name:"id_strana",required:!0,options:{filter:s.strana_filter,body:{template:"#c_strana#",yCount:7}},on:{onAfterRender:function(){this.getList().sync(s.strana)}}},{view:"label",label:"Производитель:",name:"v_name"},{view:"combo",label:"",value:"",name:"id_zavod",required:!0,options:{filter:s.zavod_filter,body:{template:"#c_zavod#",yCount:7}},on:{onAfterRender:function(){this.getList().sync(s.vendor)}}},{view:"label",label:"Д. вещество:",name:"dv_name"},{view:"combo",label:"",value:"",name:"id_dv",required:!0,options:{filter:s.dv_filter,body:{autoheight:!1,view:"list",type:{height:"auto"},template:"<div class='comboList'>#act_ingr#</div>",height:200,yCount:0}},on:{onAfterRender:function(){this.getList().sync(s.dv)}}},{view:"label",label:"Форма выпуска:"},(e={view:"text",label:"",value:"",labelPosition:"left",readonly:!0,name:"issue",localId:"_issue",css:"raw_text"},e.readonly=!0,e),(t={view:"text",label:"Штрих-код:",value:"",labelPosition:"top",readonly:!0,name:"barcode",localId:"_barc",css:"raw_text"},t.readonly=!0,t),{view:"text",label:"Товарная группа:",labelPosition:"top",value:"",name:"c_tgroup",localId:"_c_tgroup",css:"raw_text",readonly:!0}]},{width:5},{rows:[{view:"form",css:"borders",localId:"new_f_right",elements:[{height:5},{cols:[{view:"checkbox",labelRight:"Рецептурный",labelWidth:0,align:"left",name:"_prescr"},{view:"checkbox",labelRight:"Обязательный",labelWidth:0,align:"left",name:"_mandat"},{view:"checkbox",labelRight:"ЖВ",labelWidth:0,align:"left",name:"id_jv"}]},{view:"combo",label:"Сезон:",labelPosition:"top",value:"",name:"id_sezon",css:"small",options:{filter:s.sez_filter,body:{template:"#sezon#",yCount:5}},on:{onAfterRender:function(){this.getList().sync(s.sezon)}}},{view:"combo",label:"Условия хранения:",labelPosition:"top",value:"",name:"id_usloviya",css:"small",options:{filter:s.hran_filter,body:{template:"#usloviya#",yCount:5}},on:{onAfterRender:function(){this.getList().sync(s.hran)}}},{view:"combo",label:"Группа:",labelPosition:"top",value:"",name:"id_group",css:"small",options:{filter:s.gr_filter,body:{autoheight:!1,view:"list",type:{height:"auto"},template:"<div class='comboList'>#group#</div>",height:200,yCount:0}},on:{onAfterRender:function(){this.getList().sync(s.group)}}},{view:"combo",label:"НДС:",labelPosition:"top",value:"",name:"id_nds",css:"small",options:{filter:s.nds_filter,body:{template:"#nds#",yCount:5}},on:{onAfterRender:function(){this.getList().sync(s.nds)}}},{view:"combo",label:"Код ном.:",labelPosition:"top",value:"",name:"id_521",css:"small",options:{filter:s.id521_filter,body:{template:"#id_521#",yCount:5}},on:{onAfterRender:function(){this.getList().sync(s.id521)}}}]}]}]},{cols:[{view:"button",type:"base",label:"Отменить",width:120,height:32,hidden:!0,click:function(){i.hide()}},{hidden:!0},{view:"button",type:"base",label:"Сохранить",width:120,height:32,hidden:!0,click:function(){}}]}]}]}}},i.parse_f=function(e,t,i){this.$$("new_form").config.search_bar=t,i&&(console.log("item",i),i.idspr=e,this.$$("new_form").parse(i),this.$$("new_form").config.spr=!0)},i.show_f=function(e,t,i){this.$$("new_form").config.search_bar=t,i&&(this.$$("new_form").parse(i),this.$$("new_f_right").parse(i),this.$$("new_form").config.spr=!0),this.getRoot().show(e)},i.hide_f=function(){this.getRoot().hide()},i.init=function(){},t}(n.iC)},2116:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>w});var o=i(1583),n=i(280),s=i(2478),a=i(6034),r=i(4281),l=i(2282),c=i(5631),d=i(8122),h=i(742),u=i(1908),p=i(1614),f=i(8274),g=i(8662),_=i(5501),b=i(9642),w=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this,t=this.app,i=this;function o(e,t){var i=t===a.default?f.FB.SkippedBarView:t===r.default?f.FB.AllUnlinkedBarView:t===l.default?f.FB.LinksBarView:t===c.default?f.FB.AdmBarView:t===u.default?f.FB.BrakBarView:t===g.default?f.FB.LinkerView:t===b.default?f.FB.SkladUnlinked:void 0;if(!i)return!1;var o=t===g.default?"app-nav":webix.uid(),n={id:o,value:i,width:(0,s.getHeaderLength)(i),close:!0},d={$scope:e.$scope,id:o,$subview:t};e.config.b_id=o,e.$scope.tabView.getChildViews()[2].addView(d),e.$scope.tabView.getChildViews()[1].addOption(n,!0)}function n(e){var t=void 0;return e.forEach((function(e,i,o){var s,a=e;(s=e.config.multiview?$$($$(e.config.id).getValue()).getChildViews():e.getChildViews()).length>0&&(a=n(s)),a&&(t=a.$scope.$$("__table"))})),t}function d(){var e;try{e=n($$(i.getRoot().getParentView().getChildViews()[1].getChildViews()[2].getActiveId()).getChildViews()).config.id}catch(e){}return e}return{view:"toolbar",localId:"sideMenu",css:"side_tool_bar",borderless:!0,width:t.config.expert?44:152,rows:[{view:"button",type:"htmlbutton",tooltip:"Широкая/узкая панель",height:30,align:"left",localId:"_rbut",label:"<span class='side_icon webix_icon fa-bars'></span>",width:40,on:{onItemClick:function(){t.config.expert=!t.config.expert,e.$$("sideMenu").define({width:t.config.expert?44:155}),e.$$("sideMenu").resize(),e.getRoot().getTopParentView(),(0,s.setButtons)(e.app,e.app.config.getButt(e.getRoot().getTopParentView()));var i={user:t.config.user,expert:t.config.expert?"1":"5"};(0,s.request)("setExpert",i,0,e.app)}}},{view:"button",type:"htmlbutton",tooltip:"Персональные настройки",height:40,longPress:!1,resizable:!0,sWidth:143,eWidth:40,label:"",width:40,oldLabel:"<span class='side_icon webix_icon fa-cogs'></span>",extLabel:"<span class='side_icon button_label'>Настройки</span>",on:{onAfterRender:function(){var e=this,i=this.getNode();i.onmousedown=function(){e.interval=setInterval((function(){e.config.longPress=!0}),t.config.popDelay),i.onmouseup=function(){clearInterval(e.interval)}}},onItemClick:function(e,i){var o=this;webix.html.addCss(this.$view,"bounceIn animated"),setTimeout((function(){webix.html.removeCss(o.$view,"bounceIn animated")}),900),this.config.longTouch=!1,this.$scope.popprop.show_w("Персональные настройки: "+t.config.user)}}},{view:"button",type:"htmlbutton",tooltip:"Справочники",height:40,b_id:void 0,longPress:!1,resizable:!0,sWidth:144,eWidth:40,label:"",width:40,oldLabel:"<span class='side_icon webix_icon fa-list-alt'></span>",extLabel:"<span class='side_icon button_label'>Справочники</span>",on:{onAfterRender:function(){},onItemClick:function(){this.$scope.popref.isVisible()?this.$scope.popref.hide():this.$scope.popref.show(this)}}},{view:"button",type:"htmlbutton",tooltip:"Тестовая кнопка, только для разработчиков",height:40,b_id:void 0,longPress:!1,resizable:!0,sWidth:143,eWidth:40,label:"",width:40,hidden:t.config.production,oldLabel:"<span class='side_icon webix_icon fa-bug'></span>",extLabel:"<span class='side_icon button_label'>Тесты</span>",on:{onAfterRender:function(){},onItemClick:function(){}}},{view:"button",type:"htmlbutton",tooltip:"Линкер",height:40,b_id:void 0,longPress:!1,hidden:!1,resizable:!0,sWidth:143,eWidth:40,label:"",width:40,oldLabel:"<span class='side_icon webix_icon fa-link'></span>",extLabel:"<span class='side_icon button_label'>Линкер</span>",on:{onItemClick:function(){var e=this;$$(this.config.b_id)?(webix.html.addCss(this.$view,"bounceIn animated"),setTimeout((function(){webix.html.removeCss(e.$view,"bounceIn animated")}),900),this.$scope.tabView.getChildViews()[1].setValue(this.config.b_id)):o(this,g.default)}}},{view:"button",type:"htmlbutton",tooltip:"Админка",height:40,b_id:void 0,longPress:!1,resizable:!0,sWidth:143,eWidth:40,label:"",width:40,hidden:!t.config.roles[t.config.role].adm,oldLabel:"<span class='side_icon webix_icon fa-magic'></span>",extLabel:"<span class='side_icon button_label'>Админка</span>",on:{onAfterRender:function(){var e=this,i=this.getNode();i.onmousedown=function(){e.interval=setInterval((function(){e.config.longPress=!0,o(e,c.default),clearInterval(e.interval)}),t.config.popDelay),i.onmouseup=function(){clearInterval(e.interval)}}},onItemClick:function(){var e=this,t=$$(this.config.b_id);this.config.longPress||(t?(webix.html.addCss(this.$view,"bounceIn animated"),setTimeout((function(){webix.html.removeCss(e.$view,"bounceIn animated")}),900),this.$scope.tabView.getChildViews()[1].setValue(this.config.b_id)):o(this,c.default)),this.config.longPress=!1}}},{view:"button",type:"htmlbutton",tooltip:"Забраковка",height:40,b_id:void 0,longPress:!1,resizable:!0,sWidth:143,eWidth:40,label:"",width:40,hidden:!t.config.roles[t.config.role].skipped,oldLabel:"<span class='side_icon webix_icon fa-ban'></span>",extLabel:"<span class='side_icon button_label'>Забраковка</span>",on:{onAfterRender:function(){var e=this,i=this.getNode();i.onmousedown=function(){e.interval=setInterval((function(){e.config.longPress=!0,o(e,u.default),clearInterval(e.interval)}),t.config.popDelay),i.onmouseup=function(){clearInterval(e.interval)}}},onItemClick:function(){var e=this,t=$$(this.config.b_id);this.config.longPress||(t?(webix.html.addCss(this.$view,"bounceIn animated"),setTimeout((function(){webix.html.removeCss(e.$view,"bounceIn animated")}),900),this.$scope.tabView.getChildViews()[1].setValue(this.config.b_id)):o(this,u.default)),this.config.longPress=!1}}},{view:"button",type:"htmlbutton",tooltip:"Неверные, по мнению клиентов, связки из склада",localId:"_errorbut",height:40,b_id:void 0,longPress:!1,resizable:!0,sWidth:143,eWidth:40,label:"",width:40,badge:void 0,css:"c_badge",hidden:!t.config.roles[t.config.role].adm,oldLabel:"<span class='side_icon webix_icon fa-exclamation'></span>",extLabel:"<span class='side_icon button_label'>Ошибки</span>",on:{onAfterRender:function(){},onItemClick:function(){this.$scope.skladErr.isVisible()?this.$scope.skladErr.hide_w():this.$scope.skladErr.show_w("Неверные, по мнению клиентов, связки из склада. Режим тестирования.")}}},{view:"button",type:"htmlbutton",tooltip:"Пропущенные",height:40,b_id:void 0,longPress:!1,resizable:!0,sWidth:148,eWidth:40,label:"",width:40,oldLabel:"<span class='side_icon webix_icon fa-archive'></span>",hidden:!t.config.roles[t.config.role].skipped,extLabel:"<span class='side_icon button_label'>Пропущенные</span>",on:{onAfterRender:function(){var e=this,i=this.getNode();i.onmousedown=function(){e.interval=setInterval((function(){e.config.longPress=!0,o(e,a.default),clearInterval(e.interval)}),t.config.popDelay),i.onmouseup=function(){clearInterval(e.interval)}}},onItemClick:function(){var e=this,t=$$(this.config.b_id);this.config.longPress||(t?(webix.html.addCss(this.$view,"bounceIn animated"),setTimeout((function(){webix.html.removeCss(e.$view,"bounceIn animated")}),900),this.$scope.tabView.getChildViews()[1].setValue(this.config.b_id)):o(this,a.default)),this.config.longPress=!1}}},{view:"button",type:"htmlbutton",tooltip:"Несвязанные",height:40,b_id:void 0,longPress:!1,resizable:!0,sWidth:148,eWidth:40,label:"",width:40,extLabel:"<span class='side_icon button_label'>Несвязанные</span>",oldLabel:"<span class='side_icon webix_icon fa-unlink'></span>",on:{onAfterRender:function(){var e=this,i=this.getNode();i.onmousedown=function(){e.interval=setInterval((function(){e.config.longPress=!0,o(e,r.default),clearInterval(e.interval)}),t.config.popDelay),i.onmouseup=function(){clearInterval(e.interval)}}},onItemClick:function(){var e=this,t=$$(this.config.b_id);this.config.longPress||(t?(webix.html.addCss(this.$view,"bounceIn animated"),setTimeout((function(){webix.html.removeCss(e.$view,"bounceIn animated")}),900),this.$scope.tabView.getChildViews()[1].setValue(this.config.b_id)):o(this,r.default)),this.config.longPress=!1}}},{view:"button",type:"htmlbutton",tooltip:"Связки",height:40,b_id:void 0,longPress:!1,resizable:!0,sWidth:143,eWidth:40,label:"",width:40,extLabel:"<span class='side_icon button_label'>Связки</span>",oldLabel:"<span class='side_icon webix_icon fa-stumbleupon'></span>",on:{onAfterRender:function(){var e=this,i=this.getNode();i.onmousedown=function(){e.interval=setInterval((function(){e.config.longPress=!0,o(e,l.default),clearInterval(e.interval)}),t.config.popDelay),i.onmouseup=function(){clearInterval(e.interval)}}},onItemClick:function(){var e=this,t=$$(this.config.b_id);this.config.longPress||(t?(webix.html.addCss(this.$view,"bounceIn animated"),setTimeout((function(){webix.html.removeCss(e.$view,"bounceIn animated")}),900),this.$scope.tabView.getChildViews()[1].setValue(this.config.b_id)):o(this,l.default)),this.config.longPress=!1}}},{view:"button",type:"htmlbutton",width:40,hidden:!1,tooltip:"Создание отчета по текущей таблице",id:"_rep_button",resizable:!0,sWidth:143,eWidth:40,label:"",extLabel:"<span class='side_icon button_label'>Отчеты</span>",oldLabel:"<span class='side_icon webix_icon fa-file'></span>",height:40,on:{onItemClick:function(){var e=$$(d());e&&"__brak"!==e.config.name&&this.$scope.popreport.show_w("Создание отчета",e)}}},{view:"button",type:"htmlbutton",height:40,b_id:void 0,longPress:!1,localId:"_spr",id:"_spr_button",resizable:!0,sWidth:143,eWidth:40,label:"",width:40,hidden:!t.config.roles[t.config.role].skipped,oldLabel:"<span class='side_icon webix_icon fa-database', style='color: green !important'></span>",extLabel:"<span class='side_icon button_label'>spr.db3</span>",lastModified:void 0,lastUser:void 0,tooltip:"Выгрузка spr.db3",tooltipTemplate:"Выгрузка spr.db3",on:{onItemClick:function(){var e=this;(0,s.checkSSE)(this)||(this.config.qw=setTimeout((function(){e.unblockEvent(),(0,s.spinIconDisable)(e)}),6e5)),(0,s.spinIconEnable)(this),this.blockEvent();var i={user:t.config.user,type:"spr"};(0,s.request)("processSpr",i,0,t).then((function(e){e=(0,s.checkVal)(e,"a")}))}}},{view:"button",type:"htmlbutton",height:40,b_id:void 0,longPress:!1,localId:"_spr_r",id:"_spr_roz_button",lastModified:void 0,lastUser:void 0,tooltip:"Выгрузка spr-roz.db3",tooltipTemplate:"Выгрузка spr-roz.db3",resizable:!0,sWidth:143,eWidth:40,label:"",width:40,hidden:!t.config.roles[t.config.role].skipped,oldLabel:"<span class='side_icon webix_icon fa-database', style='color: blue !important'></span>",extLabel:"<span class='side_icon button_label'>spr-roz.db3</span>",on:{onItemClick:function(){var e=this;(0,s.checkSSE)(this)||(this.config.qw=setTimeout((function(){e.unblockEvent(),(0,s.spinIconDisable)(e)}),6e5)),(0,s.spinIconEnable)(this),this.blockEvent();var i={user:t.config.user,type:"spr_roz"};(0,s.request)("processSpr",i,0,t).then((function(e){e=(0,s.checkVal)(e,"a")}))}}},{}]}},i.ready=function(){var e=this.app,t={SkippedBarView:a.default,AllUnlinkedBarView:r.default,LinksBarView:l.default,AdmBarView:c.default,BrakBarView:u.default,LinkerView:g.default,SprView:_.default},i=this.app.config.getButt(this.getRoot().getTopParentView()),o=f.FB[this.app.config.defaultView],n="LinkerView"===e.config.defaultView?"app-nav":webix.uid(),d={id:n,value:o,width:(0,s.getHeaderLength)(o),close:!1},h={$scope:this,id:n,$subview:t[e.config.defaultView]},p=this.tabView;p.getChildViews()[2].addView(h),p.getChildViews()[1].addOption(d,!0),p.getChildViews()[1].removeOption("template"),(0,s.setButtons)(this.app,i)},i.init=function(){this.popreport=this.ui(d.default),this.popprop=this.ui(h.default),this.popref=this.ui(p.default),this.skladErr=this.ui(b.default),this.tabView=this.getRoot().getTopParentView().getChildViews()[1].getChildViews()[0].getChildViews()[1]},t}(n.iC)},6034:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>c});var o=i(1583),n=i(280),s=i(2478),a=i(6010),r=i(1118),l=i(8274),c=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e,t=this,i=this.app,o=function(){var e=t.$$("__table").getSelectedId();t.$$("__table").remove(e)},n={user:i.config.user},a=(0,s.checkVal)((0,s.request)("getSupplAll",n,!0,i).response,"s"),c=[];a&&(c=a);var d={view:"datatable",name:"__dt_s",localId:"__table",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:{autowidth:!0},startPos:1,posPpage:i.config.posPpage,totalPos:1250,old_stri:" ",searchBar:void 0,searchMethod:"getPrcsSkip",fi:"c_tovar",di:"asc",tooltip:!0,columns:[{id:"id_tovar",width:80,hidden:!0,tooltip:!1,header:[{text:"ID товара"},{content:"cFilt",inputConfig:{pager:2}}]},{id:"sh_prc",width:280,css:"overflow",hidden:!0,header:[{text:"sh_prc"},{content:"cFilt",inputConfig:{pager:2}}]},{id:"c_tovar",fillspace:1,sort:"server",headermenu:!1,css:"overflow",header:[{text:"Название"},{content:"cFilt",inputConfig:{pager:2}}]},{id:"c_vnd",sort:"server",width:200,css:"overflow",header:[{text:"Поставщик"},{content:"richFilt",compare:s.compareTrue,inputConfig:{inputtype:"combo",options:{filter:s.mcf_filter,data:c}}}]},{id:"c_zavod",sort:"server",width:200,css:"overflow",header:[{text:"Производитель"},{content:"cFilt",inputConfig:{pager:2}}]},{id:"dt",width:200,sort:"server",format:s.dt_formating_sec,css:"center_p",tooltip:!1,header:[{text:"Дата изменения"},{content:"dateRangeFilter",compare:s.compareTrue,inputConfig:{format:s.dt_formating,width:180},suggest:{view:"daterangesuggest",body:{timepicker:!1,calendarCount:2}}}]},{id:"source",width:150,hidden:!0,tooltip:!1,header:[{text:"Источник"},{content:"richFilt",compare:s.compareTrue,inputConfig:{pager:2,options:l.YM.sources}}]},{id:"id_org",width:100,hidden:!0,tooltip:!1,header:[{text:"id_org"},{content:"cFilt",inputConfig:{pager:2}}]}],on:{onresize:function(){var e=this;clearTimeout(this.delayResize);var t=(0,s.recalcRowsRet)(this);t&&(this.config.posPpage=t,this.delayResize=setTimeout((function(){e.$scope.startSearch()}),150))},"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onBeforeSort:function(e,o){setTimeout((function(){t.$$("__table").config.fi=e,t.$$("__table").config.di=o,t.startSearch()}),i.config.searchDelay)},onItemDblClick:function(e){this.$scope.app.config.user;var t=this.$scope.app;if(t.config.roles[t.config.role].adm){var i=this.getSelectedItem().sh_prc,n={command:"returnLnk"};n.sh_prc=i,n.type="async",n.callback=o,this.$scope.popconfirm.show("Вернуть на сведение?",n)}},onKeyPress:function(e,t){"text"!==document.activeElement.type&&13===e&&this.getSelectedItem()&&this.callEvent("onItemDblClick")},onAfterLoad:function(){this.hideProgress()}}};return{view:"layout",type:"clean",rows:[{rows:[{view:"toolbar",css:{"border-top":"0px"},height:40,cols:[{},{view:"checkbox",localId:"_process",hidden:!i.config.roles[i.config.role].lnkdel,value:0,labelRight:"<span style='color: white; font-weight: 600'>спец.обработка</span>",width:200,on:{onChange:function(){this.$scope.setSearchMethod(this.getValue())}},click:function(){}},{view:"button",type:"htmlbutton",tooltip:"Обновить",localId:"_renew",resizable:!0,sWidth:136,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>Обновить</span>",oldLabel:"<span class='webix_icon fa-refresh'></span>",click:function(){t.$$("__table").callEvent("onBeforeSort")}},(e={view:"button",tooltip:"Сбросить фильтры",type:"imageButton",image:l.ZY.unFilter.icon,width:40,localId:"_unfilt",resizable:!0,sWidth:180,eWidth:40,label:""},e.width=40,e.extLabel=l.ZY.unFilter.label,e.oldLabel="",e.click=function(){var e=t.$$("__table");(0,s.unFilter)(e),t.startSearch()},e)]},{height:3}]},d,{$subview:r.default}]}},i.setSearchMethod=function(e){console.log(e,typeof e),1==e?this.$$("__table").config.searchMethod="getPrcsProcess":0==e&&(this.$$("__table").config.searchMethod="getPrcsSkip"),this.startSearch()},i.startSearch=function(){var e=this.getRoot().getChildViews()[2].$scope.$$("__page").getValue();this.getRoot().getChildViews()[2].$scope.$$("__page").setValue(0==+e?"1":"0")},i.ready=function(){var e=this;(0,s.setButtons)(this.app,this.app.config.getButt(this.getRoot()));var t=this.$$("__table"),i=this,o=webix.$$(t.getColumnConfig("dt").header[1].suggest.body.id);o.getChildViews()[1].getChildViews()[1].setValue("Применить"),o.getChildViews()[1].getChildViews()[1].define("click",(function(){this._filter_timer&&window.clearTimeout(this._filter_timer),this._filter_timer=window.setTimeout((function(){i.startSearch()}),webix.ui.datafilter.textWaitDelay),this.getParentView().getParentView().hide()})),t.getFilter("dt").setValue(new Date),setTimeout((function(){var i=(0,s.recalcRowsRet)(t);i&&(t.config.posPpage=i),e.startSearch()}),10),t.getFilter("dt").blockEvent(),setTimeout((function(){t.getFilter("dt").setValue(null),t.getFilter("dt").unblockEvent()}),100),setTimeout((function(){t.getFilter("c_tovar").focus()}),150),t.markSorting(t.config.fi,t.config.di)},i.init=function(){this.popconfirm=this.ui(a.default)},t}(n.iC)},2720:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>c});var o=i(1583),n=i(280),s=i(6891),a=i(2478),r=i(1118),l=i(14),c=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this;return{view:"layout",css:{"border-bottom":"0px solid #dddddd !important"},rows:[{view:"datatable",css:{"margin-top":"-5px !important"},name:"__dt",localId:"__table",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:30,rowHeight:30,editable:!1,headermenu:{autowidth:!0},startPos:1,posPpage:this.app.config.posPpage,totalPos:0,fi:"c_tovar",di:"asc",old_stri:"",searchBar:"_spr_search",searchMethod:"getSprSearch",subview:function(t,i){var o=e.$$("__table").getItem(t.id);o=o.id_spr,(o=(0,a.get_spr)(e,o)).id=t.id,o.s_name="Страна: "+o.c_strana,o.t_name="Название товара: "+o.c_tovar,o.v_name="Производитель: "+o.c_zavod,o.dv_name="Д. вещество: "+o.c_dv;var n=new l.default(e.app,{pager:e.$$("__table").getParentView().getChildViews()[1].$scope.$$("__page"),dt:e.$$("__table"),item:o,header:"<span style='color: red; text-transform: uppercase;'>Редактирование записи </span>"+o.id_spr,search_bar:$$("_spr_search")});return e.ui(n,{container:i}),n.getRoot()},tooltip:function(e,t){return"<i>"+e.c_tovar+"</i>"},columns:[{id:"id_mnn",width:75,template:function(e){return 0!=+e.id_dv?"<span class='webix_icon fa-check-circle', style='color: green'></span>":"<span class='webix_icon fa-times-circle', style='color: red'></span>"},css:"center_p",header:[{text:"МНН"}]},{id:"id_jv",width:75,tooltip:!1,template:function(e){return 0!=+e.id_jv?"<span class='webix_icon fa-check-circle', style='color: green'></span>":""},css:"center_p",header:[{text:"ЖВ",css:"center_p"}]},{id:"id_spr",width:80,sort:"server",header:[{text:"IDSPR"},{content:"cFilt"}],headermenu:!1},{id:"c_tovar",fillspace:1,sort:"server",header:[{text:"Название"}],headermenu:!1},{id:"id_zavod",sort:"server",width:300,header:[{text:"Производитель"}]},{id:"id_strana",width:200,header:[{text:"Страна"}]},{id:"c_dv",hidden:!0,width:300,header:[{text:"Д. в-во"},{content:"richFilt",compare:a.compareTrue,inputConfig:{inputtype:"combo",pager:1,options:{data:[]}}}]},{id:"c_group",hidden:!0,width:150,header:[{text:"Группа"}]},{id:"c_nds",hidden:!0,width:150,header:[{text:"НДС"}]},{id:"c_hran",hidden:!0,width:150,header:[{text:"Условия хранения"}]},{id:"c_sezon",hidden:!0,width:150,header:[{text:"Сезонность"}]},{id:"mandat",width:100,template:function(e){return e.c_mandat?"<div><span class='webix_icon fa-check-circle'></span></div>":"<div><span></span></div>"},hidden:!0,css:"center_p",header:[{text:"Обязательный"}]},{id:"prescr",width:100,template:function(e){return e.c_prescr?"<div><span class='webix_icon fa-check-circle'></span></div>":"<div><span></span></div>"},hidden:!0,css:"center_p",header:[{text:"Рецептурный"}]},{id:"owner",width:200,tooltip:!1,hidden:!0,header:[{text:"Кто изменил"}]}],on:{onresize:function(){var e=this;clearTimeout(this.delayResize);var t=(0,a.recalcRowsRet)(this);t&&(this.config.posPpage=t,this.delayResize=setTimeout((function(){e.$scope.startSearch()}),150))},"data->onParse":function(e,t){if(this.$scope.getRoot().getParentView().$scope.$$("sideButton").config.formOpen){this.$scope.getParentView().sideForm.parse_f("",$$("_spr_search"),{s_name:"Страна: ",t_name:"Название товара: ",v_name:"Производитель: ",dv_name:"Д. вещество: "})}this.clearAll(),$$("_link").hide()},onAfterColumnShow:function(e){if("c_dv"===e){var t=this.getColumnConfig(e),i=[];$$("dv_dc").data.each((function(e){var t={id:e.id,value:e.act_ingr};i.push(t)})),setTimeout((function(){t.header[1].inputConfig.options.data=i}),200)}},onBeforeSort:function(t,i){e.$$("__table").config.fi=t,e.$$("__table").config.di=i,e.startSearch()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onSubViewClose:function(e){delete this.getItem(e).$subContent,delete this.getItem(e).$subHeight,delete this.getItem(e).$subOpen},onItemDblClick:function(e){this.$scope.getRoot().getParentView().$scope.$$("sideButton");var t=this.getSelectedId();this.openSub(t)},onAfterLoad:function(){this.hideProgress()},onAfterSelect:function(){if(this.$scope.getRoot().getParentView().$scope.$$("sideButton").config.formOpen){var e=this.$scope.$$("__table").getSelectedItem();e=e.id_spr,(e=(0,a.get_spr)(this.$scope,e)).s_name="Страна: "+e.c_strana,e.t_name="Название товара: "+e.c_tovar,e.v_name="Производитель: "+e.c_zavod,e.dv_name="Д. вещество: "+e.c_dv,this.$scope.getParentView().sideForm.parse_f("Просмотр записи <span style='color: red'>"+e.id_spr+"</span>.  Изменения не будут сохранены",$$("_spr_search"),e)}$$("prcs_dc").count()>0&&$$("_link").show()},onKeyPress:function(e,t){13===e&&this.getSelectedItem()&&this.callEvent("onItemDblClick")}}},{$subview:r.default}]}},i.startSearch=function(){var e=this.getRoot().getChildViews()[1].$scope.$$("__page");e.setValue(0==+e.getValue()?"1":"0")},i.ready=function(){var e=this,t=this.$$("__table");setTimeout((function(){var i=(0,a.recalcRowsRet)(t);i&&(t.config.posPpage=i),e.startSearch()}),10),this.$$("__table").markSorting(this.$$("__table").config.fi,this.$$("__table").config.di),setTimeout((function(){$$("_spr_search").focus()}),50)},i.init=function(){this.popnew=this.ui(s.default),(0,a.setRows)(this)},t}(n.iC)},5143:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r});var o=i(1583),n=i(280),s=i(8926),a=i(2478),r=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){return{type:"line",id:"main_ui",rows:[{$subview:s.default},{$subview:!0,borderless:!0}]}},i.get_ready=function(){var e=this.app,t={user:e.config.user},i=(0,a.request)("getVersion",t,!0,e).response;if(i=(0,a.checkVal)(i,"s"),console.log(i),void 0===i){var o=(0,a.getCookie)("linker-app");if(console.log(o),o){var n=o.split("::");o=n[0],n[1],n[2];var s={user:o};(0,a.request)("setExit",s,0,e)}(0,a.deleteCookie)("linker-app"),e.config.user="",e.config.role="0",e.config.x_api="x_login",location.href="localhost"===location.hostname?location.href:"/linker/"}console.log("23"),e.config.group=i.group,e.config.roles=i.cfg,e.config.expert=5!=+i.expert;var r=i.info;e.config.b_ver=r.version,e.config.b_prod=r.prod;var l=i.params;l&&(l=JSON.parse(l),e.config.posPpage="posPpage"in l?l.posPpage:e.config.posPpage,e.config.notify="notify"in l?l.notify:e.config.notify,e.config.nDelay="nDelay"in l?l.nDelay:e.config.nDelay,e.config.save="save"in l?l.save:e.config.save,e.config.dtParams="dtParams"in l?l.dtParams:e.config.dtParams,e.config.defaultView="default"in l?l.default:"LinkerView")},i.init=function(){var e=this.app;(0,a.init_first)(e),this.get_ready()},i.ready=function(){var e=this.app,t=e.config.searchDelay;setTimeout(a.get_refs,0*t,{app:e,type:"sync",method:"getRoles",store:"roles_dc"}),(0,a.getRefs)(e)},t}(n.iC)},14:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>h});var o=i(1583),n=i(280),s=i(9210),a=i(6028),r=i(721),l=i(934),c=i(2478),d=i(8274),h=function(e){function t(t,i){var o;return(o=e.call(this,t)||this).customData=i,o}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e,t,i=this,o=this.app;function n(e){c.vendor.add(e,0)}function s(e){c.dv.add(e,0)}return{cols:[{width:160},{view:"form",css:"no_border",localId:"new_form",margin:0,spr:!1,search_bar:void 0,rules:{c_tovar:webix.rules.isNotEmpty,id_strana:webix.rules.isNotEmpty,id_zavod:webix.rules.isNotEmpty,id_dv:webix.rules.isNotEmpty,id_group:webix.rules.isNotEmpty},on:{onViewShow:function(){}},elements:[{view:"label",label:"",name:"idspr",css:{"margin-top":"0px !important"}},{rows:[{view:"label",label:"Название товара:",name:"t_name"},{view:"text",label:"",value:"",name:"c_tovar",required:!0,css:"raw_text"},{height:10,width:1050},{cols:[{rows:[{cols:[{rows:[{view:"label",label:"Страна:",name:"s_name"},{view:"combo",width:350,value:"",name:"id_strana",required:!0,options:{filter:c.strana_filter,body:{template:"#c_strana#",yCount:7}},on:{onAfterRender:function(){this.getList().sync(c.strana)}}}]},{rows:[{view:"label",label:"Производитель:",name:"v_name"},{cols:[{view:"combo",width:320,label:"",value:"",name:"id_zavod",required:!0,options:{filter:c.zavod_filter,body:{template:"#c_zavod#",yCount:7}},on:{onAfterRender:function(){this.getList().sync(c.vendor)}}},{view:"button",type:"base",label:"+",width:30,hidden:!o.config.roles[o.config.role].vendoradd,click:function(){var e={new_name:"c_zavod",url:"Zavod",callback:n};i.popstri.show("Добавление производителя",e)}}]}]}]},{cols:[{rows:[{view:"label",label:"Д. вещество:",name:"dv_name"},{cols:[{view:"combo",label:"",value:"",name:"id_dv",required:!0,options:{filter:c.dv_filter,body:{autoheight:!1,view:"list",type:{height:"auto",width:"auto"},template:"<div class='comboList'>#act_ingr#</div>",height:200,yCount:0}},on:{onAfterRender:function(){this.getList().sync(c.dv)}}},{view:"button",type:"base",label:"+",width:30,hidden:!o.config.roles[o.config.role].vendoradd,click:function(){var e={new_name:"act_ingr",url:"Dv1",callback:s};i.popstri.show("Добавление д.вещества",e)}}]}]},{rows:[{view:"label",label:"Форма выпуска:"},(e={view:"text",label:"",value:"",labelPosition:"left",readonly:!0,name:"issue",localId:"_issue",css:"raw_text"},e.readonly=!0,e.click=function(){var e=i.$$("new_form").getValues().id_spr;i.popis.show("Редактирование форм выпуска",e,i)},e)]}]},{rows:[{view:"label",label:"Штрих-код:"},(t={view:"text",label:"",value:"",labelPosition:"left",readonly:!0,name:"barcode",localId:"_barc",css:"raw_text"},t.readonly=!0,t.click=function(){var e=i.$$("new_form").getValues().id_spr;i.popbar.show("Редактирование ш.кодов",e,i)},t)]},{rows:[{view:"label",label:"Товарная группа:"},{view:"text",label:"",labelPosition:"left",value:"",name:"c_tgroup",localId:"_c_tgroup",css:"raw_text",readonly:!0,click:function(){var e=i.$$("new_form").getValues().id_spr;i.poptg.show("Редактирование товарных групп",e,i)}}]}]},{width:5},{width:400,rows:[{type:"form",css:"borders",localId:"new_f_right",rows:[{css:{"margin-top":"0px !important;"},cols:[{view:"checkbox",labelRight:"Рецептурный",labelWidth:0,align:"left",name:"_prescr"},{view:"checkbox",labelRight:"Обязательный",labelWidth:0,align:"left",name:"_mandat"},{view:"checkbox",labelRight:"ЖВ",labelWidth:0,align:"left",name:"id_jv"}]},{view:"combo",label:"Сезон:",labelPosition:"top",value:"",name:"id_sezon",css:"small",options:{filter:c.sez_filter,body:{template:"#sezon#",yCount:5}},on:{onAfterRender:function(){this.getList().sync(c.sezon)}}},{view:"combo",label:"Условия хранения:",labelPosition:"top",value:"",name:"id_usloviya",css:"small",options:{filter:c.hran_filter,body:{template:"#usloviya#",yCount:5}},on:{onAfterRender:function(){this.getList().sync(c.hran)}}},{view:"combo",label:"Группа:",labelPosition:"top",value:"",name:"id_group",css:"small",localId:"_local_id_group",required:!0,options:{filter:c.gr_filter,body:{autoheight:!1,view:"list",type:{height:"auto"},template:"<div class='comboList'>#group#</div>",height:200,yCount:0}},on:{onChange:function(e){var t=this.getValue();console.log("i1",t),this.$scope.savePermitted=!0,this.$scope.$$("_save").show();var i=this.$scope.$$("__nds");"ZakMedCtg.1114"==e&&i.setValue("ZakMedCtg.1358")},onAfterRender:function(){var e=this;["antey1","antey2"].includes(this.$scope.app.config.user)&&!this.$scope.customData.item.id_group?this.getList().parse(c.group):["antey1","antey2"].includes(this.$scope.app.config.user)&&"ZakMedCtg.1115"===this.$scope.customData.item.id_group?this.getList().parse([{id:"ZakMedCtg.1115",group:"Изделия медицинского назначения"}]):d.Xd.users.includes(this.$scope.app.config.user)&&51066==this.$scope._id_vnd||d.Xd.users.includes(this.$scope.app.config.user)&&45835==this.$scope._id_vnd||d.Xd.users.includes(this.$scope.app.config.user)?c.group.serialize().forEach((function(t){"ZakMedCtg.1114"!=t.id&&"ZakMedCtg.39"!=t.id&&e.getList().add(t)})):this.getList().parse(c.group)}}},{view:"combo",label:"НДС:",labelPosition:"top",value:"",name:"id_nds",css:"small",localId:"__nds",options:{filter:c.nds_filter,body:{template:"#nds#",yCount:5}},on:{onAfterRender:function(){this.getList().sync(c.nds)}}},{view:"combo",label:"Код ном.:",labelPosition:"top",value:"",name:"id_521",css:"small",localId:"__id_521",options:{tooltip:!0,filter:c.id521_filter,body:{template:"#id_521#",tooltip:"#id_521#",yCount:5}},on:{onAfterRender:function(){this.getList().sync(c.id521)}}}]}]}]},{cols:[{view:"button",type:"base",label:"Отменить",width:120,height:32,hidden:!1,click:function(){i.customData.dt.closeSub(i.customData.item.id)}},{},{view:"button",type:"base",label:"Сохранить",width:120,height:32,hidden:!this.savePermitted,localId:"_save",click:function(){if(i.$$("new_form").validate({hidden:!1,disabled:!1})){var e=i.$$("new_form").getValues(),t={};t.id_spr=e.id_spr?e.id_spr:-1,t.barcode=e.barcode,t.issue=e.issue,t.c_tovar=e.c_tovar,t.id_strana=e.id_strana,t.id_zavod=e.id_zavod,t.id_dv=e.id_dv,t.c_opisanie=e.c_opisanie,t.prescr=1===e._prescr,t.mandat=1===e._mandat,t.id_jv=1===e.id_jv,t.id_sezon=e.id_sezon,t.id_usloviya=e.id_usloviya,t.id_group=e.id_group,t.id_nds=e.id_nds,t.sh_prc=void 0,t.c_tgroup=e.c_tgroup,t.user=i.app.config.user,t.id_521=i.$$("__id_521").getText();var o=(0,c.request)("setSpr",t,!0,i.app).response;if((o=(0,c.checkVal)(o,"s"))&&o.new&&i.$$("new_form").config.spr)(0,c.delPrc)(t,i);else{var n=+i.$$("new_form").config.pag.getValue();i.$$("new_form").config.pag.callEvent("onChange",[n,n+1]),c.barcodes.clearAll(),i.$$("new_form").clear(),i.$$("new_form").reconstruct()}i.$$("new_form").config.spr=!1,i.customData.dt.focusEditor()}}}]}]}]}]}},i.ready=function(e){this.$$("new_form").config.search_bar=this.customData.search_bar,this.$$("new_form").config.dt=this.customData.dt,this.$$("new_form").config.pag=this.customData.pager;var t=this.customData.item,i=this.customData.header;t&&(i&&(t.idspr=i),this.$$("new_form").parse(t),console.log("item",t),this.$$("new_form").config.spr=!0),(d.Xd.users.includes(this.app.config.user)&&!["ZakMedCtg.1114","ZakMedCtg.39"].includes(t.id_group)||["antey1","antey2"].includes(this.app.config.user)&&!this.customData.item.id_group||this.app.config.roles[this.app.config.role].spredit||!["ZakMedCtg.1114","ZakMedCtg.39"].includes(t.id_group))&&(this.savePermitted=!0,this.$$("_save").show())},i.init=function(){this.popstri=this.ui(s.default),this.popbar=this.ui(a.default),this.poptg=this.ui(r.default),this.popis=this.ui(l.default)},t}(n.iC)},5640:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r});var o=i(1583),n=i(280),s=i(1651),a=i(2116),r=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this,t=(this.app,{view:"tabbar",localId:"_tabbar",popupWidth:170,tabMinWidth:170,tabMoreWidth:70,animate:!1,multiview:!0,on:{onOptionRemove:function(e){$$(e).destructor()},onChange:function(t,i){var o=e.getRoot().getTopParentView().getChildViews()[1].getChildViews()[0].getChildViews()[1].getChildViews()[1];o=o.$view.childNodes[1].getElementsByClassName("webix_selected")[0];var n=$$(t).$scope.$$("__table");n&&(o.title="Всего позиций: "+n.config.totalPos)}},options:[{value:"template",id:"template",close:!1,width:100}]}),i={view:"multiview",css:{"margin-right":"0px !important"},vis:!1,animate:!1,keepViews:!0,on:{onViewChange:function(e,t){var i;"app-nav"===e&&(i=$$("app-nav").$scope.$$("sideButton").config.formOpen,$$("app-nav").$scope.sideForm.hide_f(),$$("app-nav").$scope.$$("sideButton").config.formOpen=!1,$$("app-nav").$scope.config.vis=i),"app-nav"===t&&(i=$$("app-nav").$scope.config.vis)&&$$("app-nav").$scope.$$("sideButton").callEvent("onItemClick")}},cells:[{template:"template",id:"template"}]};return{cols:[{$subview:a.default},{borderless:!1,rows:[{height:1},t,i,{$subview:s.default}]}]}},i.ready=function(){},i.init=function(){},t}(n.iC)},4201:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var o=i(1583),n=i(280),s=i(2478),a=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this,t=this.app;function i(e,i){var o=e.getRoot().getBody().config._params,n=o.sh_prc,a=e.app.config.user,r=o.command,l=o.callback,c={user:a,sh_prc:n,action:i};e.hide(),"sync"===o.type?console.log("sync"):(0,s.request)(r,c,0).then((function(r){if((r=(0,s.checkVal)(r,"a"))&&(l&&l(r),"return"===i)){var c=(0,s.checkVal)((0,s.request)("getPrcsItem",{user:a,sh_prc:n},!0,e.app).response,"s").datas;(0,s.parseToLink)(c),t.config.roles[t.config.role].skipped||o.parent.getRoot().getParentView().$scope.hide()}}))}return{view:"cWindow",modal:!0,body:{view:"form",margin:0,_params:{},elements:[{view:"label",label:"Причина разрыва связкии",height:44,align:"center"},{cols:[{view:"button",type:"base",label:"Ошибка",width:120,height:44,click:function(){i(e,"return"),e._break.hide()}},{},{view:"button",type:"base",label:"Устарела",width:120,height:44,hidden:!t.config.roles[t.config.role].lnkdel,click:function(){i(e,"delete")}}]}]}}},i.show=function(e,t,i){this._break=i,this.getRoot().getHead().getChildViews()[0].setValue("Подтвердите действие"),t&&(this.getRoot().getBody().config._params=t),this.getRoot().getBody().getChildViews()[0].setValue(e),this.getRoot().show()},i.hide=function(){this.getRoot().hide()},i.getValues=function(){return this.getRoot().getBody().getValues()},t}(n.iC)},7610:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var o=i(1583),n=i(280),s=i(2478),a=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this,t={view:"datatable",localId:"__table",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,old_stri:"",columns:[{id:"id_tovar",width:120,sort:"int",header:[{text:"ID поставщика"}]},{id:"c_tovar",fillspace:1,sort:"text",header:[{text:"Название"}]},{id:"c_zavod",sort:"text",width:300,header:[{text:"Производитель"}]}],on:{onItemDblClick:function(t){$$("prcs_dc").setCursor(t.row),(0,s.parse_unlinked_item)(e),e.getRoot().hide()},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")},onBeforeSelect:function(){}}};return{view:"cWindow",width:.8*document.documentElement.clientWidth,height:.8*document.documentElement.clientHeight,modal:!0,on:{onShow:function(){this.$scope.$$("__table").clearAll(),this.$scope.$$("__table").parse($$("prcs_dc"))}},body:t}},i.show=function(e){this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show()},i.hide=function(){this.getRoot().hide()},t}(n.iC)},9642:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>l});var o=i(1583),n=i(280),s=i(2478),a=i(1118),r=i(8274),l=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e,t=this,i=this,o=this.app,n={user:o.config.user},l=((0,s.checkVal)((0,s.request)("getSupplAll",n,!0,o).response,"s"),{view:"datatable",name:"__dt_sk",localId:"__table",resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,headermenu:{autowidth:!0},startPos:1,posPpage:o.config.posPpage,totalPos:0,fi:"dt",di:"desc",searchBar:void 0,searchMethod:"getErrorsFromSklad",old_stri:"",editable:!0,editaction:"click",tooltip:!0,columns:[{id:"id",width:20,hidden:!0,headermenu:!1},{id:"status",width:150,hidden:!1,css:"center_p",editor:"select",options:r.YM.sklad_err_lnk_status,header:[{text:"Статус"},{content:"richFilt",compare:s.compareTrue,inputConfig:{options:r.YM.sklad_err_lnk_status}}],template:function(e,t,i){var o;return r.YM.sklad_err_lnk_status.forEach((function(e){+e.id==+i&&(o=e.value)})),"<span>"+o+"</span>"}},{id:"dt",width:200,sort:"server",hidden:!1,format:s.dt_formating_sec,css:"center_p",header:[{text:"Дата добавления"},{content:"dateRangeFilter",compare:s.compareTrue,inputConfig:{format:s.dt_formating,width:180},suggest:{view:"daterangesuggest",body:{timepicker:!1,calendarCount:2}}}]},{id:"sh_prc",width:280,hidden:!0,header:[{text:"sh_prc"}]},{id:"sklad_name",width:100,hidden:!1,header:[{text:"Склад"}]},{id:"nakl",width:100,hidden:!1,header:[{text:"Накладная"}]},{id:"sklad_user",width:100,hidden:!1,header:[{text:"Пользователь"}]},{id:"id_spr",width:80,header:[{text:"id_spr"}]},{id:"id_vnd",width:50,hidden:!0,headermenu:!1,header:[{text:"id_vnd"}]},{id:"c_vnd",sort:"server",width:200,header:[{text:"Поставщик"}]},{id:"sklad_id_tovar",width:100,header:[{text:"Код товара",colspan:2,css:"center_p"},{text:"в складе",css:"center_p"}]},{id:"vnd_id_tovar",width:100,header:["",{text:"у поставщика",css:"center_p"}]},{id:"sklad_c_tovar",width:350,header:[{text:"Название",colspan:2,css:"center_p"},{text:"в складе",css:"center_p"}]},{id:"vnd_c_tovar",width:350,header:["",{text:"у поставщика",css:"center_p"}]},{id:"sklad_c_zavod",width:150,header:[{text:"Производитель",colspan:2,css:"center_p"},{text:"в складе",css:"center_p"}]},{id:"vnd_c_zavod",width:150,header:["",{text:"у поставщика",css:"center_p"}]},{id:"sklad_c_strana",width:100,header:[{text:"Страна",colspan:2,css:"center_p"},{text:"в складе",css:"center_p"}]},{id:"vnd_c_strana",width:100,header:["",{text:"у поставщика",css:"center_p"}]},{id:"change_dt",width:200,sort:"server",hidden:!0,format:s.dt_formating_sec,css:"center_p",header:[{text:"Дата изменения"}]}],on:{onresize:function(){var e=this;clearTimeout(this.delayResize);var t=(0,s.recalcRowsRet)(this);t&&(this.delayResize=setTimeout((function(){e.config.posPpage=t,e.$scope.startSearch()}),150))},"data->onParse":function(e,t){this.clearAll()},onAfterColumnHide:function(e){"sklad_c_tovar"===e?(this.blockEvent(),this.hideColumn("vnd_c_tovar"),this.unblockEvent()):"sklad_id_tovar"===e?(this.blockEvent(),this.hideColumn("vnd_id_tovar"),this.unblockEvent()):"sklad_c_zavod"===e?(this.blockEvent(),this.hideColumn("vnd_c_zavod"),this.unblockEvent()):"sklad_id_strana"===e&&(this.blockEvent(),this.hideColumn("vnd_id_strana"),this.unblockEvent())},onAfterColumnShow:function(e){"sklad_c_tovar"===e?(this.blockEvent(),this.showColumn("vnd_c_tovar"),this.unblockEvent()):"sklad_id_tovar"===e?(this.blockEvent(),this.showColumn("vnd_id_tovar"),this.unblockEvent()):"sklad_c_zavod"===e?(this.blockEvent(),this.showColumn("vnd_c_zavod"),this.unblockEvent()):"sklad_id_strana"===e&&(this.blockEvent(),this.showColumn("vnd_id_strana"),this.unblockEvent())},onEditorChange:function(e,t){if("status"===e.column){n={user:o.config.user,id:e.row,status:t};var i=(0,s.checkVal)((0,s.request)("updErrorFromSkladStatus",n,!0,o).response,"s");if(i){var a=this.getItem(e.row);a.change_dt=i,this.updateItem(e.row,a),this.editStop()}else this.editCancel()}},onBeforeRender:function(e){t.data_formating(e)},onBeforeSort:function(e,i){setTimeout((function(){t.$$("__table").config.fi=e,t.$$("__table").config.di=i,t.startSearch()}),o.config.searchDelay)},onAfterLoad:function(){this.hideProgress()}}}),c={view:"layout",rows:[{rows:[{view:"toolbar",css:{"border-top":"0px"},height:40,cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Введите название",localId:"_sb",on:{onKeyPress:function(e,t){clearTimeout(this.config._keytimed),(0,s.checkKey)(e)&&(this.config._keytimed=setTimeout((function(){i.startSearch()}),this.$scope.app.config.searchDelay))}}},{view:"button",type:"htmlbutton",tooltip:"Обновить",localId:"_renew",resizable:!0,sWidth:136,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>Обновить</span>",oldLabel:"<span class='webix_icon fa-refresh'></span>",click:function(){t.startSearch()}},(e={view:"button",tooltip:"Сбросить фильтры",type:"imageButton",image:r.ZY.unFilter.icon,width:40,localId:"_unfilt",resizable:!0,sWidth:180,eWidth:40,label:""},e.width=40,e.extLabel=r.ZY.unFilter.label,e.oldLabel="",e.click=function(){var e=t.$$("__table");(0,s.unFilter)(e),t.startSearch()},e)]},{height:3}]},l,{$subview:a.default}]};return{view:"cWindow",modal:!1,width:.9*document.documentElement.clientWidth,height:.95*document.documentElement.clientHeight,on:{},body:c}},i.data_formating=function(e){e.order.forEach((function(t){var i=e.getItem(t);i.$css=10==+i.status?"lowlighted":2==+i.status||3==+i.status?"darklighted":"nothing"}))},i.show_w=function(e){this.getRoot().getHead().getChildViews()[0].setValue(e);var t=this.$$("__table");this.startSearch(),this.$$("_sb").focus(),t.markSorting(t.config.fi,t.config.di),this.getRoot().show()},i.hide_w=function(){this.getRoot().hide()},i.isVisible=function(){return this.getRoot().isVisible()},i.startSearch=function(){var e=this.getRoot().getBody().getChildViews()[2].$scope.$$("__page").getValue();this.getRoot().getBody().getChildViews()[2].$scope.$$("__page").setValue(0==+e?"1":"0")},i.init=function(){webix.extend(this.$$("__table"),webix.ProgressBar)},i.ready=function(){(0,s.setButtons)(this.app,this.app.config.getButt(this.getRoot().getBody())),this.app;var e=this,t=this.$$("__table");t.config.searchBar=this.$$("_sb"),$$(t.getColumnConfig("dt").header[1].suggest.body.id).getChildViews()[1].getChildViews()[1].setValue("Применить"),$$(t.getColumnConfig("dt").header[1].suggest.body.id).getChildViews()[1].getChildViews()[1].define("click",(function(){this._filter_timer&&window.clearTimeout(this._filter_timer),this._filter_timer=window.setTimeout((function(){e.startSearch()}),webix.ui.datafilter.textWaitDelay),this.getParentView().getParentView().hide()})),this.$$("__table").isColumnVisible("status")&&this.$$("__table").getFilter("status").setValue(1),t.markSorting(t.config.fi,t.config.di)},t}(n.iC)},4281:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>c});var o=i(1583),n=i(280),s=i(2478),a=i(1118),r=i(8274),l=i(755),c=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e,t=this,i=this.app,o={user:i.config.user},n=(0,s.checkVal)((0,s.request)("getSupplAll",o,!0,i).response,"s"),l=[];n&&(l=n);var c={view:"datatable",name:"__dt_a",localId:"__table",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:{autowidth:!0},startPos:1,posPpage:i.config.posPpage,totalPos:0,fi:"dt",di:"desc",searchBar:void 0,searchMethod:"getPrcsAll",old_stri:"",tooltip:!0,columns:[{id:"id_tovar",width:80,hidden:!0,tooltip:!1,header:[{text:"ID товара"},{content:"cFilt",inputConfig:{pager:2}}]},{id:"sh_prc",width:280,hidden:!0,css:"overflow",header:[{text:"sh_prc"},{content:"cFilt",inputConfig:{pager:2}}]},{id:"c_tovar",fillspace:1,sort:"server",headermenu:!1,css:"overflow",header:[{text:"Название"},{content:"cFilt",inputConfig:{pager:2}}]},{id:"c_vnd",sort:"server",width:200,css:"overflow",header:[{text:"Поставщик"},{content:"richFilt",compare:s.compareTrue,inputConfig:{inputtype:"combo",options:{filter:s.mcf_filter,data:l}}}]},{id:"c_zavod",sort:"server",width:200,css:"overflow",header:[{text:"Производитель"},{content:"cFilt",inputConfig:{pager:2}}]},{id:"c_user",sort:"server",width:160,tooltip:!1,header:[{text:"Группа пользователей"},{content:"richFilt",compare:s.compareTrue,inputConfig:{options:r.YM.users}}]},{id:"dt",width:200,sort:"server",format:s.dt_formating_sec,css:"center_p",tooltip:!1,header:[{text:"Дата добавления"},{content:"dateRangeFilter",compare:s.compareTrue,inputConfig:{format:s.dt_formating,width:180},suggest:{view:"daterangesuggest",body:{timepicker:!1,calendarCount:2}}}]},{id:"source",width:150,hidden:!0,tooltip:!1,header:[{text:"Источник"},{content:"richFilt",compare:s.compareTrue,inputConfig:{options:r.YM.sources}}]},{id:"in_work",width:5,hidden:!0,headermenu:!1,tooltip:!1},{id:"in_work_name",width:100,hidden:!0,tooltip:!1,header:[{text:"В работе"}]},{id:"id_org",width:100,hidden:!0,tooltip:!1,header:[{text:"id_org"},{content:"cFilt",inputConfig:{pager:2}}]},{id:"n_fg",width:70,hidden:!0,tooltip:!1,header:[{text:"n_fg"}]}],on:{onresize:function(){var e=this;clearTimeout(this.delayResize);var t=(0,s.recalcRowsRet)(this);t&&(this.config.posPpage=t,this.delayResize=setTimeout((function(){e.$scope.startSearch()}),150))},"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(e){e.order.forEach((function(t,i,o){var n=e.getItem(t);"-1"!==n.in_work&&(n.$css="table_row_light")}))},onBeforeSort:function(e,o){setTimeout((function(){t.$$("__table").config.fi=e,t.$$("__table").config.di=o,t.startSearch()}),i.config.searchDelay)},onAfterSelect:function(e){e?i.config.roles[i.config.role].adm&&t.$$("_double").show():t.$$("_double").hide()},onAfterUnSelect:function(){this.getSelectedItem()||this.$scope.$$("_double").hide()},onItemDblClick:function(e){var o=t.$$("__table").getSelectedItem();if(o&&(!e||o.id===e.row)){var n=$$("_link_by");if(!n)return webix.message({text:"Для работы со связками откройте вкладку Линкер вначале.",type:"debug",expire:4e3}),!1;1==+n.getValue()?i.config.roles[i.config.role].lnkdel||o.id_org===t.app.config.group?($$("_suppl").config.state=!0,(0,s.parseToLink)(o),setTimeout((function(){t.getRoot().getTopParentView().getChildViews()[1].getChildViews()[0].getChildViews()[1].getChildViews()[1].setValue("app-nav")}),300),setTimeout((function(){t.startSearch()}),800)):webix.message({text:"Упс. Нет доступа.",type:"debug"}):webix.message({text:"Выберите сведение по поставщикам",type:"debug"})}},onKeyPress:function(e,t){"text"!==document.activeElement.type&&13===e&&this.getSelectedItem()&&this.callEvent("onItemDblClick")},onAfterLoad:function(){this.hideProgress()}}};return{view:"layout",rows:[{rows:[{view:"toolbar",css:{"border-top":"0px"},height:40,cols:[{},{view:"button",type:"htmlbutton",tooltip:"Обновить",localId:"_renew",resizable:!0,sWidth:136,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>Обновить</span>",oldLabel:"<span class='webix_icon fa-refresh'></span>",click:function(){t.startSearch()}},{view:"button",type:"htmlbutton",tooltip:"Размножить позицию",hidden:!0,localId:"_double",resizable:!0,sWidth:136,eWidth:40,label:"",width:40,extLabel:"<span class='button_label'>Размножить</span>",oldLabel:"<span class='webix_icon fa-sitemap'></span>",on:{onItemClick:function(){if(!this.$scope.$$("__table").getSelectedItem())return!1;this.$scope.popcount.isVisible()?this.$scope.popcount.hideM():this.$scope.popcount.showM(this.getNode(),this.$scope)}}},(e={view:"button",tooltip:"Сбросить фильтры",type:"imageButton",image:r.ZY.unFilter.icon,width:40,localId:"_unfilt",resizable:!0,sWidth:180,eWidth:40,label:""},e.width=40,e.extLabel=r.ZY.unFilter.label,e.oldLabel="",e.click=function(){var e=t.$$("__table");(0,s.unFilter)(e),t.startSearch()},e)]},{height:3}]},c,{$subview:a.default}]}},i.startSearch=function(){var e=this.getRoot().getChildViews()[2].$scope.$$("__page").getValue();this.getRoot().getChildViews()[2].$scope.$$("__page").setValue(0==+e?"1":"0")},i.init=function(){webix.extend(this.$$("__table"),webix.ProgressBar),this.popcount=this.ui(l.default)},i.ready=function(){var e=this;(0,s.setButtons)(this.app,this.app.config.getButt(this.getRoot()));var t=this.app,i=this,o=this.$$("__table");o.isColumnVisible("c_user")&&(t.config.roles[t.config.role].lnkdel?o.getFilter("c_user").readOnly=!1:(o.getFilter("c_user").value=this.app.config.role,o.getFilter("c_user").readOnly=!0)),$$(o.getColumnConfig("dt").header[1].suggest.body.id).getChildViews()[1].getChildViews()[1].setValue("Применить"),$$(o.getColumnConfig("dt").header[1].suggest.body.id).getChildViews()[1].getChildViews()[1].define("click",(function(){this._filter_timer&&window.clearTimeout(this._filter_timer),this._filter_timer=window.setTimeout((function(){i.startSearch()}),webix.ui.datafilter.textWaitDelay),this.getParentView().getParentView().hide()})),o.getFilter("dt").setValue(new Date),setTimeout((function(){var t=(0,s.recalcRowsRet)(o);t&&(o.config.posPpage=t),e.startSearch()}),10),o.getFilter("dt").blockEvent(),setTimeout((function(){o.getFilter("dt").setValue(null),o.getFilter("dt").unblockEvent()}),100),setTimeout((function(){o.getFilter("c_tovar").focus()}),150),o.markSorting(o.config.fi,o.config.di)},t}(n.iC)},8755:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>n});var o=i(1583),n=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this;return this.app,{view:"cWindow",modal:!1,on:{onHide:function(){e.$$("__upl_1").files.clearAll()}},body:{view:"form",rows:[{view:"uploader",localId:"__upl_1",type:"iconButton",icon:"plus-circle",multiple:!0,autosend:!1,align:"left",label:"Добавить файл",directory:!1,accept:"application/nolink",urlData:{},link:void 0,upload:"localhost"===location.hostname?"http://saas.local/linker_upl":"../linker_upl",datatype:"json",on:{onUploadComplete:function(t){e.hide_window()}}},{view:"list",localId:"_f_list",type:"uploader",autoheight:!0,borderless:!0},{view:"button",label:"Отправить",type:"iconButton",icon:"upload",click:function(){e.$$("__upl_1").files.data.each((function(t){t.urlData={filename:t.name,source:"linker"},e.$$("__upl_1").send(t.id)}))}}]}}},i.ready=function(){this.$$("__upl_1").define({link:this.$$("_f_list").config.id}),this.$$("__upl_1").refresh()},i.show_window=function(e){this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show(),this.$$("__upl_1").fileDialog()},i.hide_window=function(){this.getRoot().hide()},i.init=function(){},t}(i(280).iC)},6010:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var o=i(1583),n=i(280),s=i(2478),a=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var i=t.prototype;return i.config=function(){var e=this;return{view:"cWindow",modal:!0,body:{view:"form",margin:0,_params:{},elements:[{view:"label",label:"Подтвердите",height:44,align:"center"},{cols:[{view:"button",type:"base",label:"Нет",width:120,height:44,click:function(){e.getRoot().getBody().config._params={},e.hide()}},{},{view:"button",type:"base",label:"Да",width:120,height:44,localId:"_yes"}]}],on:{onShow:function(){e.$$("_yes").focus()}}}}},i.show=function(e,t){this.getRoot().getHead().getChildViews()[0].setValue("Подтвердите действие"),t&&(this.getRoot().getBody().config._params=t,"setLnk"===t.command)?this.getRoot().$scope.$$("_yes").callEvent("onItemClick"):(this.getRoot().getBody().getChildViews()[0].setValue(e),this.getRoot().show())},i.hide=function(){this.getRoot().hide()},i.getValues=function(){return this.getRoot().getBody().getValues()},i.init=function(){var e=this;this.$$("_yes").attachEvent("onItemClick",(function(){var t=e.getRoot().getBody().config._params,i=t.sh_prc?t.sh_prc:void 0,o=e.app.config.user,n=t.command,a=t.type?t.type:void 0,r=t.action?t.action:"no_action",l=t.id_spr?t.id_spr:void 0,c=t.callback?t.callback:void 0,d=t.th?t.th:void 0,h={user:o,sh_prc:i,action:r,id_spr:l};e.hide(),"sync"===a||(0,s.request)(n,h,0,e.app).then((function(e){(e=(0,s.checkVal)(e,"a"))&&c&&c(e,d)}))}))},t}(n.iC)},796:(e,t,i)=>{var o={"./en":8251,"./en.js":8251,"./ru":7359,"./ru.js":7359};function n(e){var t=s(e);return i(t)}function s(e){if(!i.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}n.keys=function(){return Object.keys(o)},n.resolve=s,e.exports=n,n.id=796},2403:(e,t,i)=>{var o={"./add_ch_prop":9870,"./add_ch_prop.js":9870,"./adm-adm-adm":5072,"./adm-adm-adm.js":5072,"./adm-bar":5631,"./adm-bar.js":5631,"./adm-barcodes":3636,"./adm-barcodes-b":3926,"./adm-barcodes-b.js":3926,"./adm-barcodes-s":4493,"./adm-barcodes-s.js":4493,"./adm-barcodes.js":3636,"./adm-country":8243,"./adm-country.js":8243,"./adm-dv":3335,"./adm-dv.js":3335,"./adm-groups":1456,"./adm-groups.js":1456,"./adm-hran":4376,"./adm-hran.js":4376,"./adm-issues":7504,"./adm-issues.js":7504,"./adm-linker":1695,"./adm-linker-codes":9890,"./adm-linker-codes.js":9890,"./adm-linker-excludes":8160,"./adm-linker-excludes.js":8160,"./adm-linker-files":1574,"./adm-linker-files.js":1574,"./adm-linker-suppliers":78,"./adm-linker-suppliers.js":78,"./adm-linker-vendors":8191,"./adm-linker-vendors.js":8191,"./adm-linker.js":1695,"./adm-nds":6874,"./adm-nds.js":6874,"./adm-references":5007,"./adm-references.js":5007,"./adm-seasons":8442,"./adm-seasons.js":8442,"./adm-spr":5501,"./adm-spr.js":5501,"./adm-t-groups":7204,"./adm-t-groups.js":7204,"./adm-top-menu":3220,"./adm-top-menu.js":3220,"./adm-users":9169,"./adm-users.js":9169,"./adm-vendors":6274,"./adm-vendors.js":6274,"./adm_roles":8838,"./adm_roles.js":8838,"./bar-yes-no":6144,"./bar-yes-no.js":6144,"./body":5299,"./body.js":5299,"./brak-add-list":1300,"./brak-add-list.js":1300,"./brak-add-mass":5595,"./brak-add-mass.js":5595,"./brak_bar":1908,"./brak_bar.js":1908,"./brak_side_info":5338,"./brak_side_info.js":5338,"./brak_upl":2922,"./brak_upl.js":2922,"./brak_xls_upl":5659,"./brak_xls_upl.js":5659,"./call_center":1114,"./call_center.js":1114,"./excel_check":5953,"./excel_check.js":5953,"./footer":1651,"./footer.js":1651,"./globals":2478,"./globals.js":2478,"./header":8926,"./header.js":8926,"./history":9968,"./history.js":9968,"./linker_bar":8662,"./linker_bar.js":8662,"./links_form_bar":2282,"./links_form_bar.js":2282,"./links_form_lnk":5652,"./links_form_lnk.js":5652,"./links_form_spr":8181,"./links_form_spr.js":8181,"./login":9391,"./login.js":9391,"./login_test":7116,"./login_test.js":7116,"./md5":6178,"./md5.js":6178,"./new_bar":6028,"./new_bar.js":6028,"./new_code":1181,"./new_code.js":1181,"./new_dv":5141,"./new_dv.js":5141,"./new_exclude":8881,"./new_exclude.js":8881,"./new_form":6891,"./new_form.js":6891,"./new_issue":934,"./new_issue.js":934,"./new_prop":4402,"./new_prop.js":4402,"./new_report":8122,"./new_report.js":8122,"./new_stri":9210,"./new_stri.js":9210,"./new_tg":721,"./new_tg.js":721,"./new_user":2917,"./new_user.js":2917,"./pager_view":1118,"./pager_view.js":1118,"./pop-counter":755,"./pop-counter.js":755,"./prop-select-view":4472,"./prop-select-view.js":4472,"./prop_window":742,"./prop_window.js":742,"./references_pop":1614,"./references_pop.js":1614,"./relink_form":3291,"./relink_form.js":3291,"./rls_link":9534,"./rls_link.js":9534,"./side_form":8208,"./side_form.js":8208,"./sidebuttons-bar":2116,"./sidebuttons-bar.js":2116,"./skipped_bar":6034,"./skipped_bar.js":6034,"./spr_dt":2720,"./spr_dt.js":2720,"./start":5143,"./start.js":5143,"./sub_row":14,"./sub_row.js":14,"./top-menu":5640,"./top-menu.js":5640,"./unlink":4201,"./unlink.js":4201,"./unlinked":7610,"./unlinked.js":7610,"./unlinked_from_sklad_bar":9642,"./unlinked_from_sklad_bar.js":9642,"./unlinkedall_bar":4281,"./unlinkedall_bar.js":4281,"./v_upl":8755,"./v_upl.js":8755,"./yes-no":6010,"./yes-no.js":6010};function n(e){var t=s(e);return i(t)}function s(e){if(!i.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}n.keys=function(){return Object.keys(o)},n.resolve=s,e.exports=n,n.id=2403},1583:(e,t,i)=>{"use strict";function o(e,t){return o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},o(e,t)}function n(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,o(e,t)}i.d(t,{Z:()=>n})}},t={};function i(o){var n=t[o];if(void 0!==n)return n.exports;var s=t[o]={exports:{}};return e[o].call(s.exports,s,s.exports,i),s.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var o in t)i.o(t,o)&&!i.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";var e=i(280);i(7359),webix.ready((function(){console.log("PRODUCTION",!0);var t=new e.Dd({production:!0,id:"mainApp",name:"linker",b_prod:"",b_ver:"",version:"2023.197.1142",start:"/login",user:"",role:"0",group:"-1",eventS:void 0,r_url:"../linker_logic",router:e.cD,x_api:"x_login",debug:!1,searchDelay:1e3,popDelay:800,roles:{},expert:!0,link:!1,defaultView:"LinkerView",getButt:function(e,t){var i=[];return e.getChildViews().forEach((function(e,t,o){e.getChildViews().length>0?e.$scope&&(i=e.$scope.app.config.getButt(e,i)):"button"===e.config.view&&e.config.resizable&&i.push(e)})),t&&(i=i.concat(t)),i},posPpage:20,notify:!0,nDelay:-1,save:!1,dtParams:void 0});webix.attachEvent("onBeforeAjax",(function(e,i,o,n,s,a,r){s["x-api-key"]=t.config.x_api})),t.render(),window.onerror=function(e,t,i,o,n){return webix.message({text:"Возникла ошибка - мы работаем над ее исправлением. Текст в консоли",type:"error",width:"800px",delay:"5"}),window.console.log("message:",e),window.console.log("source:",t),window.console.log("err:",n),!0},t.attachEvent("app:error:resolve",(function(e,t){window.console.error(t)}))}))})()})();