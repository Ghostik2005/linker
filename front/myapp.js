!function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/codebase/",t(t.s=47)}([function(e,t,n){"use strict";function i(){return!0}function o(e){var t=!1;return(8===e||13===e||32===e||46===e||e>47&&e<91||e>95&&e<112||e>185&&e<193||e>219&&e<223)&&(t=!0),t}function r(e,t){var n,i;return"s"===t?n=JSON.parse(e):"a"===t&&(n=e.json()),n.result?n=n.ret_val:(n=void 0,i="error"),i&&console.log(i),n}function a(e){ae.add(e)}function s(e){ae.remove(e)}function c(e,t){var n=e.id,i=t.getItem(n);i.usloviya=e.value,t.updateItem(n,i),t.refresh()}function l(e){te.add(e)}function u(e){te.remove(e)}function d(e,t){var n=e.id,i=t.getItem(n);i.c_strana=e.value,t.updateItem(n,i),t.refresh()}function p(e){ie.add(e)}function f(e){ie.remove(e)}function h(e,t){var n=e.id,i=t.getItem(n);i.act_ingr=e.value,i.oa=e.oa,t.updateItem(n,i),t.refresh()}function _(e){oe.add(e)}function b(e){oe.remove(e)}function g(e,t){var n=e.id,i=t.getItem(n);i.nds=e.value,t.updateItem(n,i),t.refresh()}function w(e){re.add(e)}function v(e){re.remove(e)}function y(e,t){var n=e.id,i=t.getItem(n);i.sezon=e.value,t.updateItem(n,i),t.refresh()}function m(e){se.add(e)}function $(e){se.remove(e)}function x(e,t){var n=e.id,i=t.getItem(n);i.group=e.value,t.updateItem(n,i),t.refresh()}function k(e){ne.add(e)}function O(e){ne.remove(e)}function j(e,t){var n=e.id,i=t.getItem(n);i.c_zavod=e.value,t.updateItem(n,i),t.refresh()}function P(e){var t=$$(e).config.totalPos,n=$$(e).config.posPpage;return(Math.ceil(t/n)-1)*n+1}function C(e){var t=$$("_suppl").getList(),n=t.data.order,i=void 0;console.log("item to parse",e);var o=$$("main_ui").$scope.app,a=o.config.r_url+"?setWork",s={user:o.config.user,sh_prc:e.sh_prc},c=r(q(a,s,!0).response,"s");if(console.log("res",c),n.forEach(function(n,o,r){t.getItem(n).c_vnd===e.c_vnd&&(i=t.getItem(n).id)}),i)t.getItem(i).count+=1,$$("_suppl").setValue(i),setTimeout(function(){X.add(e,0),X.setCursor(i),B(this,e)},800);else{var l={id:"new",count:1,c_vnd:e.c_vnd,id_vnd:e.id_vnd};t.add(l),$$("_suppl").setValue("new"),setTimeout(function(){X.clearAll(),X.add(e,0);var t=X.data.order[0];X.setCursor(t),B(this,e)},800)}}function S(e,t){var n=e.app.config.user,i=e.app.config.r_url+"?getBar",o={user:n,id_spr:t},a=q(i,o,!0).response;(a=r(a,"s"))&&($$("bars_dc").clearAll(),$$("bars_dc").parse(a))}function V(e,t){var n=e.app.config.user,i=e.app.config.r_url+"?getTg",o={user:n,id_spr:t},a=q(i,o,!0).response;(a=r(a,"s"))&&($$("tg_dc").clearAll(),$$("tg_dc").parse(a))}function E(e,t){var n=$$(e).config.startPos/$$(e).config.posPpage,i=$$(e).config.totalPos/$$(e).config.posPpage;i=Math.ceil(i);var o=$$(t).getChildViews()[2],r=$$(t).getChildViews()[6];n=0!==i?Math.ceil(n):0,o.define("label","Страница "+n+" из "+i),o.refresh(),r.define("label","Всего записей: "+$$(e).config.totalPos),r.refresh()}function R(e){var t=e.cbars,n=e.view,i=e.navBar,o=e.start,a=e.count,s=e.searchBar,c=e.method,l=e.field?e.field:void 0,u=(e.s_field&&e.s_field,e.direction?e.direction:void 0),d=s?$$(s).getValue():void 0,p=e.filter?e.filter:void 0,f=$$("main_ui").$scope.app,h=f.config.user,_=f.config.r_url+"?"+c,b={user:h,search:d,start:o,count:a,field:l,direction:u,c_filter:p,cbars:t},g=($$(n).config.old_stri,void 0!==d?d.replace(/\ /g,"").length:2);(void 0!==d?d.length:2)>1&&g>1&&($$(n).config.old_stri=d,$$(n).showProgress({type:"icon",icon:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>'}),q(_,b).then(function(e){if(e=r(e,"a")){$$(n).parse(e.datas),$$(n).config.startPos=e.start,$$(n).config.totalPos=e.total,E(n,i);var t=webix.storage.session.get(n);t?t.push(d):t=[d],webix.storage.session.put(n,t)}else $$(n).clearAll(),webix.message("error");$$(n).hideProgress()}))}function B(e,t){t=t||$$("prcs_dc").getItem($$("prcs_dc").getCursor());var n={},i="https://www.google.ru/search?newwindow=1&q="+t.c_tovar,o="<a target='_balnk' href='"+i+"'><span>"+t.c_tovar+"</span></a>",r="<span style='color: #666666; text-decoration: underline;'>Осталось свести в текущей сессии:</span><span style='color: red; font-weight: bold;'>  "+$$("prcs_dc").count()+"</span>";n._name=o,n._count=r,n._vendor=t.c_zavod,n.p_name=t.c_tovar,$$("_names_bar").parse(n);var a=t.c_tovar.split(" "),s=0;a[s].length<4&&(s+=1);for(var c=a[s],l=s;l<a.length;l++)for(var u=a[l],d=0;d<u.length;d++){var p=(parseInt(u[d],10),!isNaN(u[d]));p&&(c+=" "+u[d])}c=c.replace('"'," "),c=c.replace("!"," "),c=c.replace("-"," "),c=c.replace("."," "),c=c.replace("*"," "),c=c.replace("+"," "),c=c.replace("/"," "),c=c.replace("\\"," "),$$("prcs_dc").config.old_stri=c,$$("_spr_search").setValue(c),r=$$("__dt").config.posPpage,R({th:e,view:"__dt",navBar:"__nav",start:1,count:r,searchBar:"_spr_search",method:"getSprSearch"}),$$("_spr_search").focus()}function I(e,t){var n=e.app.config.user,i=e.app.config.r_url+"?getSpr",o={user:n,id_spr:t},a=q(i,o,!0).response;return a=r(a,"s"),a?a[0]:(webix.message("error"),"error")}function T(e){var t=void 0;return"__ttl"===e.config.id?t={c_vnd:$$(e).isColumnVisible("c_vnd")?$$(e).getFilter("c_vnd").value:void 0,c_zavod:$$(e).isColumnVisible("c_zavod")?$$(e).getFilter("c_zavod").value:void 0,id_tovar:$$(e).isColumnVisible("id_tovar")?$$(e).getFilter("id_tovar").value:void 0,dt:$$(e).isColumnVisible("dt")?$$(e).getFilter("dt").getValue():void 0,spr:$$(e).isColumnVisible("spr")?$$(e).getFilter("spr").value:void 0,owner:$$(e).isColumnVisible("owner")?$$(e).getFilter("owner").value:void 0}:"__tt"===e.config.id?t={c_vnd:$$(e).isColumnVisible("c_vnd")?$$(e).getFilter("c_vnd").value:void 0,c_zavod:$$(e).isColumnVisible("c_zavod")?$$(e).getFilter("c_zavod").value:void 0,id_tovar:$$(e).isColumnVisible("id_tovar")?$$(e).getFilter("id_tovar").value:void 0,owner:$$(e).isColumnVisible("owner")?$$(e).getFilter("owner").value:void 0}:"__dt_a"===e.config.id?t={c_vnd:$$(e).isColumnVisible("c_vnd")?$$(e).getFilter("c_vnd").value:void 0,c_zavod:$$(e).isColumnVisible("c_zavod")?$$(e).getFilter("c_zavod").value:void 0,c_tovar:$$(e).isColumnVisible("c_tovar")?$$(e).getFilter("c_tovar").value:void 0,c_user:$$(e).isColumnVisible("c_user")?$$(e).getFilter("c_user").value:void 0,dt:$$(e).isColumnVisible("dt")?$$(e).getFilter("dt").getValue():void 0}:"__dt_s"===e.config.id?t={c_tovar:$$(e).isColumnVisible("c_tovar")?$$(e).getFilter("c_tovar").value:void 0,c_vnd:$$(e).isColumnVisible("c_vnd")?$$(e).getFilter("c_vnd").value:void 0,c_zavod:$$(e).isColumnVisible("c_zavod")?$$(e).getFilter("c_zavod").value:void 0,dt:$$(e).isColumnVisible("dt")?$$(e).getFilter("dt").getValue():void 0}:"__dt_as"===e.config.id&&(t={dt:$$(e).isColumnVisible("dt")?$$(e).getFilter("dt").getValue():void 0,id_spr:$$(e).isColumnVisible("id_spr")?$$(e).getFilter("id_spr").value:void 0,id_zavod:$$(e).isColumnVisible("id_zavod")?$$(e).getFilter("id_zavod").value:void 0,id_strana:$$(e).isColumnVisible("id_strana")?$$(e).getFilter("id_strana").value:void 0,c_dv:$$(e).isColumnVisible("c_dv")?$$(e).getFilter("c_dv").value:void 0,c_group:$$(e).isColumnVisible("c_group")?$$(e).getFilter("c_group").value:void 0,c_nds:$$(e).isColumnVisible("c_nds")?$$(e).getFilter("c_nds").getValue():void 0,c_hran:$$(e).isColumnVisible("c_hran")?$$(e).getFilter("c_hran").getValue():void 0,c_sezon:$$(e).isColumnVisible("c_sezon")?$$(e).getFilter("c_sezon").getValue():void 0,mandat:$$(e).isColumnVisible("mandat")?$$(e).getFilter("mandat").getValue():void 0,prescr:$$(e).isColumnVisible("prescr")?$$(e).getFilter("prescr").getValue():void 0}),[t,e.config.posPpage,e.config.fi,e.config.di]}function A(e){return webix.Date.dateToStr("%d-%m-%Y  %G:%i:%s")(e)}function L(e){return webix.Date.dateToStr("%d-%m-%Y")(e)}function D(e){var t=e.config.searchDelay;setTimeout(H,2*t,{app:e,type:"async",method:"getStranaAll",store:"strana_dc"}),setTimeout(H,2*t,{app:e,type:"async",method:"getVendorAll",store:"vendor_dc"}),setTimeout(H,3*t,{app:e,type:"async",method:"getDvAll",store:"dv_dc"}),setTimeout(H,3*t,{app:e,type:"async",method:"getNdsAll",store:"nds_dc"}),setTimeout(H,4*t,{app:e,type:"async",method:"getHranAll",store:"hran_dc"}),setTimeout(H,4*t,{app:e,type:"async",method:"getSezonAll",store:"sezon_dc"}),setTimeout(H,5*t,{app:e,type:"async",method:"getGroupAll",store:"group_dc"}),setTimeout(H,5*t,{app:e,type:"async",method:"getTgAll",store:"allTg_dc"}),setTimeout(H,5*t,{app:e,type:"async",method:"getRoles",store:"roles_dc"})}function F(e,t){var n=e.app.config.user;q(e.app.config.r_url+"?getPrcs",{user:n,id_vnd:+t}).then(function(e){e=r(e,"a"),e?($$("prcs_dc").clearAll(),$$("prcs_dc").parse(e)):webix.message("error")})}function H(e){var t=e.app,n=e.method,i=e.store,o=t.config.user,a=t.config.r_url+"?"+n,s={user:o};if("sync"!==e.type)q(a,s).then(function(e){e=r(e,"a"),e?($$(i).clearAll(),$$(i).parse(e)):webix.message("error")});else{var c=q(a,s,!0).response;(c=r(c,"s"))&&($$(i).clearAll(),$$(i).parse(c))}}function z(e,t){var n=t.app.config.user;q(t.app.config.r_url+"?getSupplUnlnk",{user:n}).then(function(t){if(t=r(t,"a")){$$(e).getList().clearAll(),$$(e).getList().parse(t);var n=$$(e).getList().getFirstId();$$(e).setValue(n)}else webix.message("error")}).then(function(){})}function M(e,t){var n=X.getCursor();if(X.remove(n),X.count()<1)z("_suppl",t);else{n=X.data.order[0],X.setCursor(n),B();var i=$$("_suppl").getList(),o=$$("_suppl").getValue(),r=i.getItem(o);r.count=r.count-1,i.updateItem(o,r),$$("_suppl").refresh()}}function W(e,t){return t=t.toString().toLowerCase(),t=new RegExp(".*"+t.replace(/ /g,".*")+".*"),-1!=e.c_vnd.toString().toLowerCase().search(t)}function K(e,t,n){G("linker_user"),G("linker_auth_key"),G("linker_role"),location.href="localhost"===location.hostname?"http://localhost:8080":"/linker/"}function q(e,t,n){return!0===n?webix.ajax().sync().headers({"Content-type":"application/json"}).post(e,t,{error:K}):webix.ajax().headers({"Content-type":"application/json"}).post(e,t,{error:K})}function N(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):NaN}function U(e,t,n){n=n||{};var i=n.expires;if("number"==typeof i&&i){var o=new Date;o.setTime(o.getTime()+1e3*i),i=n.expires=o}i&&i.toUTCString&&(n.expires=i.toUTCString()),t=encodeURIComponent(t);var r=e+"="+t;for(var a in n){r+="; "+a;var s=n[a];!0!==s&&(r+="="+s)}document.cookie=r}function G(e){U(e,"",{expires:-1,path:"/"})}Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"users",function(){return Y}),n.d(t,"u_roles",function(){return Z}),n.d(t,"barcodes",function(){return J}),n.d(t,"tg",function(){return Q}),n.d(t,"prcs",function(){return X}),n.d(t,"allTg",function(){return ee}),n.d(t,"strana",function(){return te}),n.d(t,"vendor",function(){return ne}),n.d(t,"dv",function(){return ie}),n.d(t,"nds",function(){return oe}),n.d(t,"sezon",function(){return re}),n.d(t,"hran",function(){return ae}),n.d(t,"group",function(){return se}),t.compareTrue=i,n.d(t,"cEvent",function(){return ce}),n.d(t,"fRefresh",function(){return le}),n.d(t,"rRefresh",function(){return ue}),n.d(t,"rRender",function(){return de}),n.d(t,"fRender",function(){return pe}),t.checkKey=o,t.checkVal=r,t.addHran=a,t.delHran=s,t.updHran=c,t.addStrana=l,t.delStrana=u,t.updStrana=d,t.addDv=p,t.delDv=f,t.updDv=h,t.addNds=_,t.delNds=b,t.updNds=g,t.addSez=w,t.delSez=v,t.updSez=y,t.addGr=m,t.delGr=$,t.updGr=x,t.addVendor=k,t.delVendor=O,t.updVendor=j,t.last_page=P,t.parseToLink=C,t.get_bars=S,t.get_tg=V,t.form_navi=E,t.get_data=R,t.parse_unlinked_item=B,t.get_spr=I,t.getDtParams=T,t.dt_formating_sec=A,t.dt_formating=L,t.init_first=D,t.get_prcs=F,t.get_refs=H,t.get_suppl=z,t.delPrc=M,t.filter_1=W,t.after_call=K,t.request=q,t.getCookie=N,t.setCookie=U,t.deleteCookie=G;var Y=(n(1),new webix.DataCollection({id:"users_dc",on:{onAfterLoad:function(){}}})),Z=new webix.DataCollection({id:"roles_dc",on:{onAfterLoad:function(){}}}),J=new webix.DataCollection({id:"bars_dc",on:{onAfterLoad:function(){}}}),Q=new webix.DataCollection({id:"tg_dc",on:{onAfterLoad:function(){}}}),X=new webix.DataCollection({id:"prcs_dc",on:{onAfterLoad:function(){var e=this.data.order[0];this.setCursor(e),B()}}}),ee=new webix.DataCollection({id:"allTg_dc",on:{onAfterLoad:function(){}}}),te=new webix.DataCollection({id:"strana_dc",on:{onAfterLoad:function(){}}}),ne=new webix.DataCollection({id:"vendor_dc",on:{onAfterLoad:function(){}}}),ie=new webix.DataCollection({id:"dv_dc",on:{onAfterLoad:function(){}}}),oe=new webix.DataCollection({id:"nds_dc",on:{onAfterLoad:function(){}}}),re=new webix.DataCollection({id:"sezon_dc",on:{onAfterLoad:function(){}}}),ae=new webix.DataCollection({id:"hran_dc",on:{onAfterLoad:function(){}}}),se=new webix.DataCollection({id:"group_dc",on:{onAfterLoad:function(){}}}),ce=function(e,t,n,i){i=i||{},i.inner=!0,webix.event(e,t,n,i)},le=function(e,t,n){t.component=e.config.id,e.registerFilter(t,n,this),t._comp_id=e.config.id,n.value&&this.getValue(t)!=n.value&&this.setValue(t,n.value),t.onclick=webix.html.preventEvent,ce(t,"keydown",this.on_key_down)},ue=function(e,t,n){if(!e.$destructed){var i=webix.$$(n.richselect);t.$webix=n.richselect,t.style.marginLeft="-10px",n.compare=n.compare||this.compare,n.prepare=n.prepare||this.prepare,e.registerFilter(t,n,this);var o=n.inputConfig.options,r=n.options,a=i.getPopup().getList();webix.$$(r);if(t.firstChild.appendChild(i.$view.parentNode),a.parse&&(a.clearAll(),a.parse(o),!this.$noEmptyOption&&!1!==n.emptyOption||n.emptyOption)){var s={id:"",value:n.emptyOption||"",$empty:!0};a.add(s,0)}n.value&&this.setValue(t,n.value),i.render(),webix.delay(i.resize,i)}},de=function(e){return function(t,n){if(!n.richselect){var i=webix.html.create("div",{class:"webix_richfilter"}),o={container:i,view:this.inputtype,options:[]},r=webix.extend(this.inputConfig||{},n.inputConfig||{},!0);webix.extend(o,r,!0),n.separator&&(o.separator=n.separator),n.suggest&&(o.suggest=n.suggest);var a=webix.ui(o);a.attachEvent("onChange",e),n.richselect=a.config.id}return n.css="webix_div_filter"," "}},pe=function(e,t){return this.init&&this.init(t),t.css="my_filter","<input "+(t.placeholder?'placeholder="'+t.placeholder+'" ':"")+"type='text'>"}},function(e,t,n){"use strict";var i=n(49);n.d(t,"b",function(){return i.a});var o=n(6);n.d(t,"c",function(){return o.a});var r=(n(26),n(55),n(56),n(57));n.d(t,"a",function(){return r.a});var a=n(58),s=n(59),c=n(62),l=n(63),u=n(64),d=n(65);a.a,s.a,c.a,u.a,d.a,l.a;window.Promise||(window.Promise=webix.promise)},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=n(0),c=function(e){function t(){return i(this,t),o(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){function e(e){var t=this.$scope.app.config.r_url+"?check"+this.config._params.type,n={};n.check=e,n.user=this.$scope.app.config.user;var i=!1,o=Object(s.request)(t,n,!0).response;return o=Object(s.checkVal)(o,"s"),(o||this.config._params.text)&&(i=!0),i}var t=this;return{view:"cWindow",modal:!0,on:{onHide:function(){t.$$("_n_f").clear(),t.$$("_n_f").clearValidation()}},body:{view:"form",localId:"_n_f",_params:{},margin:0,rules:{id:e,text:webix.rules.isNotEmpty},elements:[{view:"text",localId:"_id",label:"ID",value:"",width:320,name:"id",placeholder:"Введите значение",readonly:!0,required:!0,invalidMessage:"Такой ID уже есть"},{view:"text",label:"Название",value:"",width:320,name:"text",placeholder:"Введите значение",required:!0,invalidMessage:"Введите название"},{height:15},{height:30,cols:[{view:"button",type:"base",label:"Отменить",width:120,click:function(){t.hide()}},{},{view:"button",type:"base",label:"Сохранить",width:120,click:function(){if(t.$$("_n_f").validate({hidden:!1,disabled:!1})){var e=t.$$("_n_f").getValues(),n={},i=t.$$("_n_f").config._params;n.value=e.text,n.user=t.app.config.user,n.id=i.text?i.id:e.id;var o="new"===i.mode?t.app.config.r_url+"?set"+i.type:t.app.config.r_url+"?upd"+i.type,r=Object(s.request)(o,n,!0).response;r=Object(s.checkVal)(r,"s"),r&&i.callback(r,i.source),t.hide()}}}]}],on:{onBeforeShow:function(){},onShow:function(){}}}}},t.prototype.show=function(e,t){if(this.$$("_n_f").config._params=t,this.getRoot().getHead().getChildViews()[0].setValue(e),t.text){var n={text:t.text,id:t.id};this.$$("_n_f").parse(n),this.$$("_id").define("readonly",!0)}else this.$$("_id").define("readonly",!1);this.$$("_id").refresh(),this.getRoot().show()},t.prototype.hide=function(){this.getRoot().hide()},t.prototype.getValues=function(){return this.getRoot().getBody().getValues()},t}(a.c);t.default=c},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=n(12),c=n(8),l=n(13),u=n(0),d=function(e){function t(){return i(this,t),o(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){function e(e,t){return t=t.toString().toLowerCase(),t=new RegExp(".*"+t.replace(/ /g,".*")+".*"),-1!=e.c_strana.toString().toLowerCase().search(t)}function t(e,t){return t=t.toString().toLowerCase(),t=new RegExp(".*"+t.replace(/ /g,".*")+".*"),-1!=e.c_zavod.toString().toLowerCase().search(t)}function n(e,t){return t=t.toString().toLowerCase(),t=new RegExp(".*"+t.replace(/ /g,".*")+".*"),-1!=e.act_ingr.toString().toLowerCase().search(t)}function i(e,t){return t=t.toString().toLowerCase(),t=new RegExp(".*"+t.replace(/ /g,".*")+".*"),-1!=e.group.toString().toLowerCase().search(t)}function o(e,t){return t=t.toString().toLowerCase(),t=new RegExp(".*"+t.replace(/ /g,".*")+".*"),-1!=e.sezon.toString().toLowerCase().search(t)}function r(e,t){return t=t.toString().toLowerCase(),t=new RegExp(".*"+t.replace(/ /g,".*")+".*"),-1!=e.usloviya.toString().toLowerCase().search(t)}function a(e){u.vendor.add(e,0)}function s(e){u.dv.add(e,0)}var c=this,l=$$("main_ui").$scope.app;return{view:"cWindow",modal:!0,on:{onHide:function(){u.barcodes.clearAll(),this.$scope.$$("new_form").clear(),this.$scope.$$("new_form").reconstruct()}},body:{view:"form",localId:"new_form",margin:0,spr:!1,search_bar:void 0,rules:{c_tovar:webix.rules.isNotEmpty,id_strana:webix.rules.isNotEmpty,id_zavod:webix.rules.isNotEmpty,id_dv:webix.rules.isNotEmpty},elements:[{rows:[{view:"label",label:"Название товара:",name:"t_name"},{view:"text",label:"",value:"",name:"c_tovar",required:!0},{height:10,width:700},{cols:[{rows:[{view:"label",label:"Страна:",name:"s_name"},{view:"combo",width:400,value:"",name:"id_strana",required:!0,options:{filter:e,body:{template:"#c_strana#",yCount:7}},on:{onAfterRender:function(){this.getList().sync(u.strana)}}},{view:"label",label:"Производитель:",name:"v_name"},{cols:[{view:"combo",label:"",value:"",name:"id_zavod",required:!0,options:{filter:t,body:{template:"#c_zavod#",yCount:7}},on:{onAfterRender:function(){this.getList().sync(u.vendor)}}},{view:"button",type:"base",label:"+",width:30,disabled:!0,on:{onAfterRender:function(){l.config.roles[l.config.role].vendoradd&&this.enable()}},click:function(){var e={new_name:"c_zavod",url:"Zavod",callback:a};c.popstri.show("Добавление производителя",e)}}]},{view:"label",label:"Действующее вещество:",name:"dv_name"},{cols:[{view:"combo",label:"",value:"",name:"id_dv",required:!0,options:{filter:n,body:{autoheight:!1,view:"list",type:{height:"auto"},template:"<div class='comboList'>#act_ingr#</div>",height:200,yCount:0}},on:{onAfterRender:function(){this.getList().sync(u.dv)}}},{view:"button",type:"base",label:"+",width:30,disabled:!0,on:{onAfterRender:function(){l.config.roles[l.config.role].vendoradd&&this.enable()}},click:function(){var e={new_name:"act_ingr",url:"Dv1",callback:s};c.popstri.show("Добавление д.вещества",e)}}]},{view:"text",label:"Штрих-код:",value:"",labelPosition:"top",readonly:!0,name:"barcode",localId:"_barc",click:function(){var e=c.$$("new_form").getValues().id_spr;c.popbar.show("Редактирование ш.кодов",e,c)}},{view:"text",label:"Товарная группа:",labelPosition:"top",value:"",name:"c_tgroup",localId:"_c_tgroup",readonly:!0,click:function(){var e=c.$$("new_form").getValues().id_spr;c.poptg.show("Редактирование товарных групп",e,c)}}]},{width:5},{rows:[{view:"form",css:"borders",localId:"new_f_right",elements:[{view:"checkbox",labelRight:"Рецептурный",labelWidth:0,align:"left",name:"_prescr"},{view:"checkbox",labelRight:"Обязательный",labelWidth:0,align:"left",name:"_mandat"},{view:"combo",label:"Сезон:",labelPosition:"top",value:"",name:"id_sezon",css:"small",options:{filter:o,body:{template:"#sezon#",yCount:5}},on:{onAfterRender:function(){this.getList().sync(u.sezon)}}},{view:"combo",label:"Условия хранения:",labelPosition:"top",value:"",name:"id_usloviya",css:"small",options:{filter:r,body:{template:"#usloviya#",yCount:5}},on:{onAfterRender:function(){this.getList().sync(u.hran)}}},{view:"combo",label:"Группа:",labelPosition:"top",value:"",name:"id_group",css:"small",options:{filter:i,body:{autoheight:!1,view:"list",type:{height:"auto"},template:"<div class='comboList'>#group#</div>",height:200,yCount:0}},on:{onAfterRender:function(){this.getList().sync(u.group)}}},{view:"combo",label:"НДС:",labelPosition:"top",value:"",name:"id_nds",css:"small",options:{body:{template:"#nds#",yCount:5}},on:{onAfterRender:function(){this.getList().sync(u.nds)}}}]}]}]},{cols:[{view:"button",type:"base",label:"Отменить",width:120,height:32,click:function(){c.hide()}},{},{view:"button",type:"base",label:"Сохранить",width:120,height:32,disabled:!0,on:{onAfterRender:function(){l.config.roles[l.config.role].spredit&&this.enable()}},click:function(){if(c.$$("new_form").validate({hidden:!1,disabled:!1})){var e=c.$$("new_form").getValues(),t=c.$$("new_f_right").getValues(),n={};n.id_spr=e.id_spr?e.id_spr:-1,n.barcode=e.barcode,n.c_tovar=e.c_tovar,n.id_strana=e.id_strana,n.id_zavod=e.id_zavod,n.id_dv=e.id_dv,n.c_opisanie=e.c_opisanie,n.prescr=1===t._prescr,n.mandat=1===t._mandat,n.id_sezon=t.id_sezon,n.id_usloviya=t.id_usloviya,n.id_group=t.id_group,n.id_nds=t.id_nds,n.sh_prc=c.$$("new_form").config.spr?u.prcs.getItem(u.prcs.getCursor()).sh_prc:void 0,n.c_tgroup=e.c_tgroup,n.user=c.app.config.user;var i=c.app.config.r_url+"?setSpr",o=Object(u.request)(i,n,!0).response;o=Object(u.checkVal)(o,"s"),o&&o.new&&c.$$("new_form").config.spr?Object(u.delPrc)(n,c):c.$$("new_form").config.search_bar.callEvent("onKeyPress",[13]),c.$$("new_form").config.spr=!1,c.hide()}}}]}]}]}}},t.prototype.show=function(e,t,n){this.$$("new_form").config.search_bar=t,n&&(this.$$("new_form").parse(n),this.$$("new_f_right").parse(n),this.$$("new_form").config.spr=!0),this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show()},t.prototype.hide=function(){this.getRoot().hide()},t.prototype.init=function(){this.popstri=this.ui(s.default),this.popbar=this.ui(c.default),this.poptg=this.ui(l.default)},t}(a.c);t.default=d},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=function(e){function t(){return i(this,t),o(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this;return{view:"cWindow",modal:!0,height:.8*document.documentElement.clientHeight,on:{onHide:function(){e.$$("_tb").clear(),e.$$("_hist").clearAll(),e.$$("_tb").reconstruct()}},body:{view:"toolbar",localId:"_tb",searchBar:void 0,cols:[{view:"list",localId:"_hist",readonly:!1,disabled:!1,width:.5*document.documentElement.clientWidth,select:!0,resizeColumn:!0,navigation:"row",editable:!1,on:{onItemDblClick:function(t){e.$$("_tb").config.searchBar.setValue(t),e.getRoot().hide(),e.$$("_tb").config.searchBar.callEvent("onKeyPress",[13]),e.$$("_tb").config.searchBar.focus()}}},{}]}}},t.prototype.show=function(e,t){this.$$("_tb").config.searchBar=t,e&&this.$$("_hist").parse(e),this.getRoot().getHead().getChildViews()[0].setValue("История поиска"),this.getRoot().show()},t.prototype.init=function(){},t}(a.c);t.default=s},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=n(0),c=function(e){function t(){return i(this,t),o(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){function e(e,t){var n=e.getRoot().getBody().config._params,i=n.sh_prc,o=e.app.config.user,r=e.app.config.r_url+n.command,a=n.callback,c={user:o,sh_prc:i,action:t};e.hide(),"sync"===n.type?console.log("sync"):Object(s.request)(r,c).then(function(r){if((r=Object(s.checkVal)(r,"a"))&&(a&&a(r),"return"===t)){var c=Object(s.checkVal)(Object(s.request)(e.app.config.r_url+"?getPrcsItem",{user:o,sh_prc:i},!0).response,"s").datas;Object(s.parseToLink)(c),n.parent.getRoot().getParentView().$scope.hide()}})}var t=this,n=$$("main_ui").$scope.app;return{view:"cWindow",modal:!0,body:{view:"form",margin:0,_params:{},elements:[{view:"label",label:"Причина разрыва связкии",height:44,align:"center"},{cols:[{view:"button",type:"base",label:"Ошибка",width:120,height:44,click:function(){e(t,"return")}},{},{view:"button",type:"base",label:"Устарела",width:120,height:44,disabled:!0,on:{onAfterRender:function(){n.config.roles[n.config.role].lnkdel&&this.enable()}},click:function(){e(t,"delete")}}]}],on:{onBeforeShow:function(){},onShow:function(){}}}}},t.prototype.show=function(e,t){this.getRoot().getHead().getChildViews()[0].setValue("Подтвердите действие"),t&&(this.getRoot().getBody().config._params=t),this.getRoot().getBody().getChildViews()[0].setValue(e),this.getRoot().show()},t.prototype.hide=function(){this.getRoot().hide()},t.prototype.getValues=function(){return this.getRoot().getBody().getValues()},t}(a.c);t.default=c},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.d(t,"a",function(){return c});var a=n(24),s=n(25),c=function(e){function t(n,r){i(this,t);var a=o(this,e.call(this));return a.app=n,a._name=r,a._children=[],a}return r(t,e),t.prototype.ui=function(e,t){if("function"==typeof e){var n=new e(this.app,t);return this._children.push(n),n.render(),n}var i=this.app.webix.ui(e);return this._children.push(i),i},t.prototype.show=function(e,t){var n=this;if("string"==typeof e){if("/"===e.substr(0,1))return this.app.show(e);if(0===e.indexOf("./")&&(e=e.substr(2)),0===e.indexOf("../")){var i=this.getParentView();return void(i?i.show("./"+e.substr(3)):this.app.show("/"+e.substr(3)))}var o=this.getSubView();if(!o)return this.app.show("/"+e);if(o.parent!==this)return o.parent.show(e,t);var r=Object(s.a)(e),a=null,c=this.app.getRouter().get();if(this._index){a=Object(s.a)(c).slice(0,this._index).concat(r);for(var l=0;l<a.length;l++)a[l].index=l+1;var u=Object(s.b)(a);this.app.canNavigate(u,this).then(function(e){u!==e?n.app.show(e):n._finishShow(o.subview,a,e)}).catch(function(){return!1})}else this._finishShow(o.subview,r,"")}},t.prototype.init=function(e,t){},t.prototype.ready=function(e,t){},t.prototype.config=function(){this.app.webix.message("View:Config is not implemented")},t.prototype.urlChange=function(e,t){},t.prototype.destroy=function(){},t.prototype.destructor=function(){this.destroy();for(var t=this._children,n=t.length-1;n>=0;n--)t[n]&&t[n].destructor&&t[n].destructor();this.app=this._children=null,this._root.destructor(),e.prototype.destructor.call(this)},t.prototype.use=function(e,t){e(this.app,this,t)},t.prototype._render=function(e){var t=this,n=this.config();return n.then?n.then(function(n){return t._render_final(n,e)}):this._render_final(n,e)},t.prototype._render_final=function(e,t){var n=this,i=void 0,o={ui:{}};this.app.copyConfig(e,o.ui,this._subs),this.app.callEvent("app:render",[this,t,o]),o.ui.$scope=this;try{this._root=this.app.webix.ui(o.ui,this._container),this._root.getParentView()&&(this._container=this._root),this._init(this._root,t),i=this._urlChange(t).then(function(){return n.ready(n._root,t)})}catch(e){i=Promise.reject(e)}return i.catch(function(e){return n._initError(n,e)})},t.prototype._init=function(e,t){return this.init(e,t)},t.prototype._urlChange=function(e){var t=this,n=[];for(var i in this._subs){var o=this._subs[i];if(o.url)if("string"==typeof o.url){var r=Object(s.a)(o.url);n.push(this._createSubView(o,r))}else{var a=o.view;"function"!=typeof o.url||a instanceof o.url||(a=new o.url(this.app,"")),a||(a=o.url),n.push(this._renderSubView(o,a,e))}else if("default"===i&&e&&e.length>1){var c=e.slice(1);n.push(this._createSubView(o,c))}}return Promise.all(n).then(function(){t.urlChange(t._root,e)})},t.prototype._initError=function(e,t){return this.app.error("app:error:initview",[t,e]),!0},t.prototype._createSubView=function(e,t){var n=this;return this.app.createFromURL(t,e.view).then(function(i){return n._renderSubView(e,i,t)})},t.prototype._renderSubView=function(e,t,n){var i=this.app.webix.$$(e.id);return t.render(i,n,this).then(function(n){return e.view&&e.view!==t&&e.view.destructor(),e.view=t,e.id=n.config.id,n})},t.prototype._finishShow=function(e,t,n){this._index?(this._urlChange(t.slice(this._index-1)),this.app.getRouter().set(n,{silent:!0}),this.app.callEvent("app:route",[t])):this._createSubView(e,t)},t}(a.a)},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=function(e){function t(){return i(this,t),o(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e,t=this;return{view:"cWindow",modal:!0,body:(e={view:"form",margin:0,_params:{},on:{onShow:function(e){$$("_yes").focus()}},elements:[{view:"label",label:"Подтвердите",height:44,align:"center"},{cols:[{view:"button",type:"base",label:"Нет",width:120,height:44,click:function(){t.getRoot().getBody().config._params={},t.hide()}},{},{view:"button",type:"base",label:"Да",width:120,height:44,localId:"_yes",click:function(){var e=t.getRoot().getBody().config._params,n=e.callback?e.callback:void 0;t.hide(),n&&n(e.params)}}]}]},e.on={onBeforeShow:function(){},onShow:function(){}},e)}},t.prototype.show=function(e,t){this.getRoot().getHead().getChildViews()[0].setValue("Подтвердите действие"),t&&(this.getRoot().getBody().config._params=t),this.getRoot().getBody().getChildViews()[0].setValue(e),this.getRoot().show()},t.prototype.hide=function(){this.getRoot().hide()},t}(a.c);t.default=s},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=n(0),c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=function(e){function t(){return i(this,t),o(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){function e(e){var t=0;if(isNaN(e)||13!==e.length)return!1;for(var n=0;n<13;n++)t+=Number(e[n])*(n%2*2+1);return!(t%10)}var t=this;return{view:"cWindow",modal:!0,on:{onHide:function(){t.$$("_nbar").setValue(""),t.$$("b_code").setValue("0000000000000"),t.$$("_n_b").reconstruct()},onShow:function(){t.$$("_nbar").setValue(""),t.$$("b_code").setValue("0000000000000");var e=t.$$("_n_b").config.id_spr;Object(s.get_bars)(t,e),t.$$("b_list").clearAll(),t.$$("b_list").parse(s.barcodes)}},body:{view:"form",localId:"_n_b",margin:0,id_spr:void 0,th:void 0,callback:void 0,rules:{},elements:[{rows:[{cols:[{view:"text",label:"Название",value:"",name:"_new_bar",placeholder:"Введите новый штрихкод",localId:"_nbar",required:!1},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-plus'></span>",width:30,disabled:!1,click:function(){if(e(t.$$("_nbar").getValue())){var n={barcode:t.$$("_nbar").getValue()};t.$$("b_list").add(n),t.$$("_nbar").setValue("")}}}]},{cols:[{view:"activeList",activeContent:{deleteBut:{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-minus'></span>",width:30,click:function(e,n){var i=t.$$("b_list").locate(n);t.$$("b_list").callEvent("onItemDblClick",[i])}}},localId:"b_list",width:250,height:350,type:{height:32},template:"<div class ='barcode'>#barcode#</div><div class = 'butt1'>{common.deleteBut()}</div>",select:!0,on:{onAfterSelect:function(){var e=this.getSelectedItem();this.$scope.$$("b_code").setValue(e.barcode)},onItemDblClick:function(e){this.remove(e),this.$scope.$$("b_code").setValue("0000000000000")}}},{width:10},{rows:[{view:"barcode",type:"ean13",value:"0000000000000",width:300,name:"_new_",localId:"b_code",hieght:200},{}]}]},{height:10},{cols:[{view:"button",type:"base",label:"Отменить",width:120,click:function(){t.hide()}},{},{view:"button",type:"base",label:"Применить",width:120,click:function(){t.$$("b_list").selectAll();var e=t.$$("b_list").getSelectedItem(),n="",i=t.$$("_n_b").config.th,o=t.$$("_n_b").config.id_spr,r=t.$$("_n_b").config.callback;if(e){void 0===e||c(e);try{e.forEach(function(e,t,i){n+=e.barcode+" "})}catch(t){n=e.barcode}}i&&i.$$("_barc").setValue(n),r&&r(o,n),t.hide()}}]}]}],on:{onBeforeShow:function(){},onShow:function(){}}}}},t.prototype.show=function(e,t,n,i){this.$$("_n_b").config.id_spr=t,this.$$("_n_b").config.th=n,this.$$("_n_b").config.callback=i,this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show()},t.prototype.hide=function(){this.getRoot().hide()},t}(a.c);t.default=l},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=n(0),c=function(e){function t(){return i(this,t),o(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e,t=this;return{view:"cWindow",modal:!0,body:(e={view:"form",margin:0,_params:{},on:{onShow:function(e){$$("_yes").focus()}},elements:[{view:"label",label:"Подтвердите",height:44,align:"center"},{cols:[{view:"button",type:"base",label:"Нет",width:120,height:44,click:function(){t.getRoot().getBody().config._params={},t.hide()}},{},{view:"button",type:"base",label:"Да",width:120,height:44,localId:"_yes",click:function(){var e=t.getRoot().getBody().config._params,n=e.sh_prc?e.sh_prc:void 0,i=t.app.config.user,o=t.app.config.r_url+e.command,r=e.type?e.type:void 0,a=e.action?e.action:"no_action",c=e.id_spr?e.id_spr:void 0,l=e.callback?e.callback:void 0,u=e.th?e.th:void 0,d={user:i,sh_prc:n,action:a,id_spr:c};t.hide(),"sync"===r||Object(s.request)(o,d).then(function(e){(e=Object(s.checkVal)(e,"a"))&&l&&l(e,u)})}}]}]},e.on={onBeforeShow:function(){},onShow:function(){}},e)}},t.prototype.show=function(e,t){this.getRoot().getHead().getChildViews()[0].setValue("Подтвердите действие"),t&&(this.getRoot().getBody().config._params=t),this.getRoot().getBody().getChildViews()[0].setValue(e),this.getRoot().show()},t.prototype.hide=function(){this.getRoot().hide()},t.prototype.getValues=function(){return this.getRoot().getBody().getValues()},t}(a.c);t.default=c},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=(n(0),function(e){function t(){return i(this,t),o(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this;return{view:"toolbar",height:40,cols:[{view:"combo",localId:"_options",value:1,readonly:!1,disabled:!1,width:190,options:[{id:1,value:"Справочник"},{id:2,value:"Страны"},{id:3,value:"Производители"},{id:4,value:"Действующие вещества"},{id:5,value:"Группы"},{id:6,value:"Штрих-коды"},{id:7,value:"Сезоны"},{id:8,value:"Условия хранения"},{id:9,value:"Ставки НДС"},{id:10,value:"Пользователи"}],on:{onChange:function(){var t=e.$$("_options").getValue(),n=6==+t?"/start/adm/adm-barcodes/adm-barcodes-s":2==+t?"/start/adm/adm-country":3==+t?"/start/adm/adm-vendors":4==+t?"/start/adm/adm-dv":5==+t?"/start/adm/adm-groups":7==+t?"/start/adm/adm-seasons":8==+t?"/start/adm/adm-hran":9==+t?"/start/adm/adm-nds":10==+t?"/start/adm/adm-users":"/start/adm/adm-spr";e.app.show(n)}}},{}]}},t.prototype.init=function(){},t}(a.c));t.default=s},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=n(0),c=function(e){function t(){return i(this,t),o(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){function e(e){var t=this.$scope.app.config.r_url+"?check"+this.config._params.type,n={};n.check=e,n.user=this.$scope.app.config.user;var i=!1;if("new"==this.$scope.$$("_n_f").config._params.mode){var o=Object(s.request)(t,n,!0).response;o=Object(s.checkVal)(o,"s"),(o||this.config._params.text)&&(i=!0)}else i=!0;return i}var t=this;return{view:"cWindow",modal:!0,on:{onHide:function(){t.$$("_n_f").clear(),t.$$("_n_f").clearValidation()}},body:{view:"form",localId:"_n_f",_params:{},margin:0,rules:{id:e,text:webix.rules.isNotEmpty},elements:[{view:"text",localId:"_id",label:"ID",value:"",name:"id",placeholder:"Введите значение",readonly:!0,required:!0,invalidMessage:"Такой ID уже есть"},{view:"text",label:"Название",value:"",name:"text",placeholder:"Введите значение",required:!0,invalidMessage:"Введите название"},{view:"select",label:"Обязательный ассортимент",value:3,labelWidth:200,width:450,name:"oa",options:[{id:3,value:"Нет"},{id:1,value:"Для аптек"},{id:2,value:"Для аптек и аптечных пунктов"}],labelAlign:"left"},{height:15},{height:30,cols:[{view:"button",type:"base",label:"Отменить",width:120,click:function(){t.hide()}},{},{view:"button",type:"base",label:"Сохранить",width:120,click:function(){if(t.$$("_n_f").validate({hidden:!1,disabled:!1})){var e=t.$$("_n_f").getValues(),n={},i=t.$$("_n_f").config._params;n.value=e.text,n.user=t.app.config.user,n.id="upd"===i.mode?i.id:e.id,n.oa=e.oa;var o="new"===i.mode?t.app.config.r_url+"?set"+i.type:t.app.config.r_url+"?upd"+i.type,r=Object(s.request)(o,n,!0).response;r=Object(s.checkVal)(r,"s"),r&&i.callback(r,i.source),t.hide()}}}]}],on:{onBeforeShow:function(){},onShow:function(){}}}}},t.prototype.show=function(e,t){if(this.$$("_n_f").config._params=t,this.getRoot().getHead().getChildViews()[0].setValue(e),"upd"===t.mode){var n="Для аптек"===t.oa?1:"Для аптек и аптечных пунктов"===t.oa?2:3,i={text:t.text,id:t.id,oa:n};this.$$("_n_f").parse(i),this.$$("_id").define("readonly",!0)}else this.$$("_id").define("readonly",!1);this.$$("_id").refresh(),this.getRoot().show()},t.prototype.hide=function(){this.getRoot().hide()},t.prototype.getValues=function(){return this.getRoot().getBody().getValues()},t}(a.c);t.default=c},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=n(0),c=function(e){function t(){return i(this,t),o(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){function e(e){var t=this.config._params,n=this.$scope.app.config.r_url+"?check"+t.url,i={};i[t.new_name]=e,i.user=this.$scope.app.config.user;var o=Object(s.request)(n,i,!0).response;o=Object(s.checkVal)(o,"s");var r=!1;return o&&(r=!0),r}var t=this;return{view:"cWindow",modal:!0,on:{onHide:function(){t.$$("_n_f").clear(),t.$$("_n_f").clearValidation()}},body:{view:"form",localId:"_n_f",_params:{},margin:0,rules:{_new_str:e},elements:[{view:"text",label:"Название",value:"",width:320,name:"_new_str",required:!0,placeholder:"Введите новое значение",invalidMessage:"Такое название уже есть"},{cols:[{view:"button",type:"base",label:"Отменить",width:120,click:function(){t.hide()}},{},{view:"button",type:"base",label:"Сохранить",width:120,click:function(){if(t.$$("_n_f").validate({hidden:!1,disabled:!1})){var e=t.$$("_n_f").getValues(),n={},i=t.$$("_n_f").config._params;n[i.new_name]=e._new_str,n.user=t.app.config.user,n.id_spr=!!i.id_spr&&i.id_spr;var o=t.app.config.r_url+"?set"+i.url,r=Object(s.request)(o,n,!0).response;r=Object(s.checkVal)(r,"s"),r&&i.callback(r),t.hide()}}}]}],on:{onBeforeShow:function(){},onShow:function(){}}}}},t.prototype.show=function(e,t){this.$$("_n_f").config._params=t,this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show()},t.prototype.hide=function(){this.getRoot().hide()},t.prototype.getValues=function(){return this.getRoot().getBody().getValues()},t}(a.c);t.default=c},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=n(0),c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=function(e){function t(){return i(this,t),o(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this;return{view:"cWindow",modal:!0,on:{onHide:function(){e.$$("_filt").setValue(""),e.$$("t_list").clearAll(),e.$$("e_list").clearAll(),e.$$("_n_tg").reconstruct()},onShow:function(){e.$$("_filt").setValue("");var t=e.$$("_n_tg").config.id_spr;Object(s.get_tg)(e,t);var n=e.$$("e_list");n.clearAll(!0),e.$$("t_list").clearAll(),e.$$("t_list").parse(s.tg);var i=s.allTg.data.order;i.forEach(function(e,t,i){n.add(s.allTg.getItem(e))}),i=e.$$("t_list").data.order,i.forEach(function(e,t,i){n.remove(e)}),e.$$("_filt").focus()}},body:{view:"form",localId:"_n_tg",margin:0,id_spr:void 0,th:void 0,callback:void 0,elements:[{rows:[{view:"text",label:"Название",value:"",name:"_filter",placeholder:"Введите название группы",localId:"_filt",on:{onTimedKeyPress:function(e,t){var n=this.getValue().toString().toLowerCase();this.$scope.$$("e_list").filter("c_tgroup",n)}}},{cols:[{rows:[{view:"label",label:"Товарные группы"},{view:"list",localId:"t_list",width:350,height:.7*document.documentElement.clientHeight,template:"#c_tgroup#",select:!0,on:{onItemDblClick:function(e){var t=this.getItem(e);this.remove(e),this.$scope.$$("e_list").add(t),this.$scope.$$("e_list").sort("c_tgroup","asc")}}}]},{width:10},{rows:[{view:"label",label:"Все товарные группы"},{view:"list",localId:"e_list",width:350,template:"#c_tgroup#",select:!0,on:{onItemDblClick:function(e){var t=this.getItem(e);this.remove(e),this.$scope.$$("t_list").add(t),this.$scope.$$("t_list").sort("c_tgroup","asc")}}}]}]},{height:10},{cols:[{view:"button",type:"base",label:"Отменить",width:120,click:function(){e.hide()}},{},{view:"button",type:"base",label:"Применить",width:120,click:function(){e.$$("t_list").selectAll();var t=e.$$("t_list").getSelectedItem(),n="",i=e.$$("_n_tg").config.th,o=e.$$("_n_tg").config.id_spr,r=e.$$("_n_tg").config.callback;if(t){void 0===t||c(t);try{t.forEach(function(e,t,i){n+=e.c_tgroup+"; "})}catch(e){n=t.c_tgroup}}i&&i.$$("_c_tgroup").setValue(n),r&&r(o,n),e.hide()}}]}]}],on:{onBeforeShow:function(){},onShow:function(){}}}}},t.prototype.show=function(e,t,n,i){this.$$("_n_tg").config.id_spr=t,this.$$("_n_tg").config.th=n,this.$$("_n_tg").config.callback=i,this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show()},t.prototype.hide=function(){this.getRoot().hide()},t}(a.c);t.default=l},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=n(0),c=function(e){function t(){return i(this,t),o(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){function e(e){var t=this.$scope.app.config.r_url+"?check"+this.config._params.type,n={};n.check=e,n.user=this.$scope.app.config.user;var i=!1,o=Object(s.request)(t,n,!0).response;return o=Object(s.checkVal)(o,"s"),(o||this.config._params.id)&&(i=!0),i}var t=this,n=$$("main_ui").$scope.app;return{view:"cWindow",modal:!0,on:{onHide:function(){t.$$("new_user").clear(),t.$$("new_user").clearValidation()},onShow:function(){t.$$("_pwrd").define({type:"password"}),t.$$("_eye").define({label:"<span class='webix_icon fa-eye'></span><span style='line-height: 20px;'></span>"}),t.$$("_pwrd").refresh(),t.$$("_eye").refresh()}},body:{view:"form",localId:"new_user",margin:0,_params:{},rules:{c_user:e,c_pwrd:webix.rules.isNotEmpty,id_role:webix.rules.isNotEmpty},elements:[{rows:[{view:"text",labelPosition:"top",label:"Пользователь:",value:"",name:"c_user",required:!0,invalidMessage:"Укажите коректное имя"},{height:10,width:600},{view:"label",label:"Пароль:"},{cols:[{view:"text",label:"",value:"",name:"c_pwrd",type:"password",localId:"_pwrd",required:!0,invalidMessage:"Пароль обязателен"},{view:"button",type:"htmlbutton",localId:"_eye",label:"<span class='webix_icon fa-eye'></span><span style='line-height: 20px;'></span>",width:30,disabled:!0,_vis:!1,on:{onAfterRender:function(){n.config.roles[n.config.role].useradd&&this.enable()}},click:function(){t.$$("_eye").config._vis?(t.$$("_pwrd").define({type:"password"}),t.$$("_eye").define({label:"<span class='webix_icon fa-eye'></span><span style='line-height: 20px;'></span>"}),t.$$("_pwrd").refresh(),t.$$("_eye").refresh(),t.$$("_eye").config._vis=!1):t.$$("_eye").config._vis||(t.$$("_pwrd").define({type:"text"}),t.$$("_eye").define({label:"<span class='webix_icon fa-eye-slash'></span><span style='line-height: 20px;'></span>"}),t.$$("_pwrd").refresh(),t.$$("_eye").refresh(),t.$$("_eye").config._vis=!0)}}]},{view:"text",labelPosition:"top",label:"Группа:",name:"id_group"},{view:"text",labelPosition:"top",label:"Список ИНН:",value:"",name:"c_inn"},{view:"label",label:"Роль пользователя:"},{cols:[{view:"combo",label:"",value:"",name:"id_role",disabled:!1,localId:"_rolesC",required:!0,invalidMessage:"Роль пользователя должна быть указана",options:{body:{template:"#r_name#",yCount:5}},on:{onAfterRender:function(){}}},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-plus'></span><span style='line-height: 20px;'></span>",width:30,disabled:!0,on:{onAfterRender:function(){n.config.roles[n.config.role].useradd&&this.enable()}},click:function(){webix.message({type:"debug",text:"Пока не реализованно"})}}]},{height:10,width:600},{cols:[{view:"button",type:"base",label:"Отменить",width:120,height:32,click:function(){t.hide()}},{},{view:"button",type:"base",label:"Сохранить",width:120,height:32,disabled:!0,on:{onAfterRender:function(){n.config.roles[n.config.role].useradd&&this.enable()}},click:function(){if(t.$$("new_user").validate({hidden:!1,disabled:!1})){var e=t.$$("new_user").getValues();e.user=t.app.user;var n=e.id?t.app.config.r_url+"?updUser":t.app.config.r_url+"?setUser";Object(s.checkVal)(Object(s.request)(n,e,!0).response,"s")&&(n=t.app.config.r_url+"?getUsersAll",Object(s.request)(n,e).then(function(e){if(e=Object(s.checkVal)(e,"a")){$$("users_dc").clearAll(),$$("users_dc").parse(e);var t=$$("__dtu_g");t.clearAll(),t.parse($$("users_dc"))}}),t.hide())}}}]}]}]}}},t.prototype.show=function(e,t){t?(this.$$("new_user").parse(t),this.$$("new_user").config._params.id=t.id):(this.$$("new_user").clear(),this.$$("new_user").config._params={}),this.$$("new_user").config._params.type="User",this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show()},t.prototype.init=function(){var e=this.$$("_rolesC");e.getList().clearAll(),e.getList().parse(s.u_roles)},t.prototype.hide=function(){this.getRoot().hide()},t}(a.c);t.default=c},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=n(4),c=n(3),l=n(16),u=n(9),d=n(0),p=n(17),f=n(18),h=n(19),_=function(e){function t(){return i(this,t),o(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this,t=$$("main_ui").$scope.app;return{rows:[{view:"toolbar",height:40,cols:[{view:"combo",name:"suppliers",id:"_suppl",readonly:!1,disabled:!1,width:300,options:{filter:d.filter_1,body:{css:"big-combo",template:"#c_vnd# - #count#",yCount:10}},on:{onChange:function(){var t=$$("_suppl").getList().getItem($$("_suppl").getValue()).id_vnd;Object(d.get_prcs)(e,t)}}},{},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-refresh'></span><span style='line-height: 20px;'> Обновить с сервера</span>",width:210,click:function(){Object(d.get_suppl)("_suppl",e)}},{view:"button",id:"_skip",type:"htmlbutton",label:"<span class='webix_icon fa-archive'></span><span style='line-height: 20px;'> Пропущенные (Ctrl+S)</span>",width:210,disabled:!0,on:{onAfterRender:function(){t.config.roles[t.config.role].skipped&&this.enable()}},click:function(){e.popskipped.show("Пропущенные товары")}},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-unlink'></span><span style='line-height: 20px;'> Все несвязанные</span>",width:210,click:function(){e.popallunlink.show("Все несвязанные товары")}},{view:"button",id:"_links",type:"htmlbutton",label:"<span class='webix_icon fa-stumbleupon'></span><span style='line-height: 20px;'> Связки (Ctrl+L)</span>",width:210,click:function(){e.poplinks.showWindow("Линки")}}]},{view:"toolbar",id:"_names_bar",css:"header",rows:[{cols:[{view:"label",label:"",name:"_name",fillspace:1}]},{cols:[{view:"label",label:"",css:"header",name:"_vendor"},{},{view:"label",label:"",css:"right",name:"_count",width:320,click:function(){var t=$$("_suppl").getValue();t=$$("_suppl").getList().getItem(t).c_vnd,e.popunlink.show("Осталось связать в этой сессии по поставщику "+t)}},{width:10},{view:"button",type:"htmlbutton",label:"<span class='butt'>Обновить сессию</span>",width:230,height:32,click:function(){var t=$$("_suppl").getList().getItem($$("_suppl").getValue()).id_vnd;Object(d.get_prcs)(e,t)}}]}]},{view:"toolbar",height:40,cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Строка поиска",id:"_spr_search",_keytimed:void 0,tooltip:"поиск от двух символов",on:{onKeyPress:function(e,t){clearTimeout(this.config._keytimed),Object(d.checkKey)(e)&&(this.config._keytimed=setTimeout(function(){var e=this.$scope,t=$$("__dt").config.posPpage;Object(d.get_data)({th:e,view:"__dt",navBar:"__nav",start:1,count:t,searchBar:"_spr_search",method:"getSprSearch"})},this.$scope.app.config.searchDelay))}}},{view:"button",type:"htmlbutton",width:35,label:"<span class='webix_icon fa-history'></span><span style='line-height: 20px;'></span>",click:function(){var t=webix.storage.session.get("__dt");e.pophistory.show(t,$$("_spr_search"))}},{view:"button",type:"htmlbutton",id:"_add",width:140,disabled:!0,label:"Добавить (Ins)",hotkey:"insert",on:{onAfterRender:function(){t.config.roles[t.config.role].spradd&&this.enable()}},click:function(){var t={},n=$$("_names_bar").getValues().p_name;t.t_name="Название товара:   "+n,t.c_tovar=n.toUpperCase(),e.popnew.show("Добавление в справочник",$$("_spr_search"),t)}},{view:"button",type:"htmlbutton",id:"_link",label:"<span class='webix_icon fa-link'></span><span style='line-height: 20px;'>  Связать (Ctrl+Home)</span>",width:200,hotkey:"home+ctrl",disabled:!0,click:function(){var t=d.prcs.getItem(d.prcs.getCursor()).sh_prc,n=$$("__dt").getSelectedItem().id_spr,i={};i.th=e,i.command="?setLnk",i.sh_prc=t,i.id_spr=n,i.type="async",i.callback=d.delPrc,e.popconfirm.show("Связать?",i)}},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-angle-left'></span><span style='line-height: 20px;'>Ctrl+</span><span class='webix_icon fa-arrow-down'></span>",width:90,hotkey:"down+ctrl",click:function(){var t=$$("prcs_dc").getCursor(),n=$$("prcs_dc").data.order,i=void 0;n.forEach(function(e,n,o){e===t&&(i=n)}),i-=1,i<0&&(i=$$("prcs_dc").count()-1),t=$$("prcs_dc").data.order[+i],$$("prcs_dc").setCursor(t),Object(d.parse_unlinked_item)(e)}},{view:"button",type:"htmlbutton",label:"Пропустить (Ctrl+M)",width:160,hotkey:"m+ctrl",disabled:!1,click:function(){var t=d.prcs.getItem(d.prcs.getCursor()).sh_prc,n={};n.th=e,n.command="?skipLnk",n.sh_prc=t,n.type="async",n.callback=d.delPrc,e.popconfirm.show("Пропустить?",n)}},{view:"button",type:"htmlbutton",label:"<span style='line-height: 20px;'>Ctrl+</span><span class='webix_icon fa-arrow-up'></span><span class='webix_icon fa-angle-right'></span>",width:90,hotkey:"up+ctrl",click:function(){var t=$$("prcs_dc").getCursor(),n=$$("prcs_dc").data.order,i=void 0;n.forEach(function(e,n,o){e===t&&(i=n)}),i+=1,i===$$("prcs_dc").count()-1&&(i=0),t=$$("prcs_dc").data.order[+i],$$("prcs_dc").setCursor(t),Object(d.parse_unlinked_item)(e)}}]}]}},t.prototype.init=function(){Object(d.get_suppl)("_suppl",this),this.popconfirm=this.ui(u.default),this.popnew=this.ui(c.default),this.poplinks=this.ui(l.default),this.popunlink=this.ui(p.default),this.popallunlink=this.ui(f.default),this.popskipped=this.ui(h.default),this.pophistory=this.ui(s.default)},t}(a.c);t.default=_},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=n(4),c=n(3),l=n(0),u=n(5),d=function(e){function t(){return i(this,t),o(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this,t=function(){return 1===$$("_spr_ch").getValue()?"__tt":"__ttl"},n=function(){return 1===$$("_spr_ch").getValue()?"__nav_l":"__nav_ll"},i=function(){return 1===$$("_spr_ch").getValue()?"getSprLnks":"getLnkSprs"};return{view:"cWindow",id:"__cw",width:.8*document.documentElement.clientWidth,height:.8*document.documentElement.clientHeight,modal:!0,on:{onHide:function(){$$(t()).unselectAll(),$$("_break").disable(),$$("_spr_search").focus()}},body:{view:"layout",rows:[{cols:[{view:"text",label:"",placeholder:"Строка поиска",id:"_link_search",height:40,fillspace:!0,tooltip:"поиск от двух символов",on:{onKeyPress:function(e,o){clearTimeout(this.config._keytimed),Object(l.checkKey)(e)&&(this.config._keytimed=setTimeout(function(){var e=webix.$$(t());if(e){var o=Object(l.getDtParams)(e);Object(l.get_data)({view:t(),navBar:n(),start:1,count:o[1],searchBar:"_link_search",method:i(),field:o[2],direction:o[3],filter:o[0]})}},this.$scope.app.config.searchDelay))}}},{view:"button",type:"htmlbutton",width:40,label:"<span class='webix_icon fa-history'></span><span style='line-height: 20px;'></span>",click:function(){var n=webix.storage.session.get(t());e.pophistory.show(n,$$("_link_search"))}},{view:"checkbox",labelRight:"Поиск по справочнику",labelWidth:0,value:this.app.config.lch,disabled:!1,width:150,id:"_spr_ch",on:{onChange:function(){$$("_link_search").setValue("");var t=$$("_spr_ch").getValue();0===t?(e.app.config.lch=0,e.getRoot().getHead().getChildViews()[0].setValue("Поиск по связкам")):1===t&&(e.app.config.lch=1,e.getRoot().getHead().getChildViews()[0].setValue("Поиск по эталонам")),e.show(1===e.app.config.lch?"links_form_spr":"links_form_lnk")}}},{view:"button",type:"htmlbutton",disabled:!1,label:"<span style='line-height: 20px;'>Сбросить фильтры</span>",width:220,click:function(){var e=t();$$(e).config.columns.forEach(function(t){if($$(e).isColumnVisible(t.id)&&t.header[1])if("function"==typeof $$(e).getFilter(t.id).setValue)$$(e).getFilter(t.id).setValue("");else{var n=$$(e).getFilter(t.id);n.readOnly||(n.value="")}}),$$("_link_search").callEvent("onKeyPress",[13])}},{view:"button",type:"htmlbutton",id:"_break",disabled:!0,label:"<span class='webix_icon fa-unlink'></span><span style='line-height: 20px;'>  Разорвать (Ctrl+D)</span>",width:220,click:function(){$$(t()).callEvent("onItemDblClick")}}]},{height:10},{$subview:!0}]}}},t.prototype.showWindow=function(e){this.getRoot().getHead().getChildViews()[0].setValue(1===this.app.config.lch?"Поиск по эталонам":"Поиск по связкам"),this.getRoot().show(),this.show(1===this.app.config.lch?"links_form_spr":"links_form_lnk")},t.prototype.hide=function(){this.getRoot().hide()},t.prototype.init=function(){this.popnew=this.ui(c.default),this.popunlink=this.ui(u.default),this.pophistory=this.ui(s.default)},t}(a.c);t.default=d},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=n(0),c=function(e){function t(){return i(this,t),o(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this,t={view:"datatable",id:"__unl",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,old_stri:"",columns:[{id:"id_tovar",width:120,sort:"int",header:[{text:"ID поставщика"}]},{id:"c_tovar",fillspace:1,sort:"text",header:[{text:"Название"}]},{id:"c_zavod",sort:"text",width:300,header:[{text:"Производитель"}]}],on:{onItemDblClick:function(t){$$("prcs_dc").setCursor(t.row),Object(s.parse_unlinked_item)(e),e.getRoot().hide()},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")},onBeforeSelect:function(){}}};return{view:"cWindow",width:.8*document.documentElement.clientWidth,height:.8*document.documentElement.clientHeight,modal:!0,on:{onShow:function(){$$("__unl").clearAll(),$$("__unl").parse($$("prcs_dc"))}},body:t}},t.prototype.show=function(e){this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show()},t.prototype.hide=function(){this.getRoot().hide()},t}(a.c);t.default=c},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=n(0),c=function(e){function t(){return i(this,t),o(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this,t=$$("main_ui").$scope.app,n=function(e){var t=webix.$$(e);if(t){var n=Object(s.getDtParams)(t);Object(s.get_data)({view:e,navBar:"__nav_a",start:1,count:n[1],searchBar:void 0,method:"getPrcsAll",field:n[2],direction:n[3],filter:n[0]})}};webix.ui.datafilter.customFilterUnlnk=Object.create(webix.ui.datafilter.textFilter),webix.ui.datafilter.customFilterUnlnk.on_key_down=function(e,i,o){var r=this._comp_id;9!=(e.which||e.keyCode)&&Object(s.checkKey)(e.keyCode)&&(this._filter_ti&&window.clearTimeout(this._filter_ti),this._filter_ti=window.setTimeout(function(){n(r)},t.config.searchDelay))},webix.ui.datafilter.customFilterUnlnk.refresh=s.fRefresh,webix.ui.datafilter.customFilterUnlnk.render=s.fRender;var i={view:"toolbar",id:"__nav_a",height:36,cols:[{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-angle-double-left'></span>",width:50,click:function(){n("__dt_a")}},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-angle-left'></span>",width:50,click:function(){var e=$$("__dt_a").config.startPos-$$("__dt_a").config.posPpage;e=e<0?1:e;var t=webix.$$("__dt_a");if(t){var n=Object(s.getDtParams)(t);Object(s.get_data)({view:"__dt_a",navBar:"__nav_a",start:e,count:n[1],searchBar:void 0,method:"getPrcsAll",field:n[2],direction:n[3],filter:n[0]})}}},{view:"label",label:"Страница 1 из 1",width:200,id:"__pager_a"},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-angle-right'></span>",width:50,click:function(){var e="__dt_a",t=webix.$$(e);if(t){var n=t.config.startPos+t.config.posPpage;n=n>t.config.totalPos?Object(s.last_page)(e):n;var i=Object(s.getDtParams)(t);Object(s.get_data)({view:e,navBar:"__nav_a",start:n,count:i[1],searchBar:void 0,method:"getPrcsAll",field:i[2],direction:i[3],filter:i[0]})}}},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-angle-double-right'></span>",width:50,click:function(){var e="__dt_a",t=webix.$$(e);if(t){var n=Object(s.last_page)(e),i=Object(s.getDtParams)(t);Object(s.get_data)({view:e,navBar:"__nav_a",start:n,count:i[1],searchBar:void 0,method:"getPrcsAll",field:i[2],direction:i[3],filter:i[0]})}}},{},{view:"label",label:"Всего записей: 0",width:180,id:"__count_a"}]},o={view:"datatable",id:"__dt_a",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,startPos:1,posPpage:20,totalPos:1250,fi:"c_tovar",di:"asc",old_stri:" ",columns:[{id:"id_tovar",width:80,hidden:!0,header:[{text:"ID товара"}]},{id:"c_tovar",fillspace:1,sort:"server",headermenu:!1,header:[{text:"Название"},{content:"customFilterUnlnk"}]},{id:"c_vnd",sort:"server",width:200,header:[{text:"Поставщик"},{content:"customFilterUnlnk"}]},{id:"c_zavod",sort:"server",width:200,header:[{text:"Производитель"},{content:"customFilterUnlnk"}]},{id:"c_user",sort:"server",width:160,header:[{text:"Пользователь"},{content:"customFilterUnlnk"}]},{id:"dt",width:200,sort:"server",format:s.dt_formating_sec,css:"center_p",header:[{text:"Дата добавления"},{content:"dateRangeFilter",compare:s.compareTrue,readonly:!1,disabled:!1,inputConfig:{format:s.dt_formating,width:180},suggest:{view:"daterangesuggest",body:{timepicker:!1,calendarCount:2}}}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onBeforeSort:function(e,t){var i="__dt_a";$$(i).config.fi=e,$$(i).config.di=t,n(i)},onItemDblClick:function(){var n=$$("__dt_a").getSelectedItem();console.log("item",n),t.config.roles[t.config.role].lnkdel||n.c_user===e.app.config.user?(Object(s.parseToLink)(n),e.getRoot().hide()):webix.message({text:"Упс. Нет доступа.",type:"debug"})},onKeyPress:function(e,t){13===e&&this.getSelectedItem()&&this.callEvent("onItemDblClick")},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(){}}};return{view:"cWindow",width:.8*document.documentElement.clientWidth,height:.8*document.documentElement.clientHeight,modal:!0,on:{onShow:function(){n("__dt_a")},onHide:function(){$$("_spr_search").focus()}},body:{view:"layout",rows:[o,i]}}},t.prototype.show=function(e){this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show()},t.prototype.hide=function(){this.getRoot().hide()},t.prototype.init=function(){var e=$$("main_ui").$scope.app;$$("__dt_a").isColumnVisible("c_user")&&($$("__dt_a").getFilter("c_user").value=this.app.config.user,e.config.roles[e.config.role].lnkdel?$$("__dt_a").getFilter("c_user").readOnly=!1:($$("__dt_a").getFilter("c_user").value=this.app.config.user,$$("__dt_a").getFilter("c_user").readOnly=!0)),$$($$("__dt_a").getColumnConfig("dt").header[1].suggest.body.id).getChildViews()[1].getChildViews()[1].setValue("Применить"),$$($$("__dt_a").getColumnConfig("dt").header[1].suggest.body.id).getChildViews()[1].getChildViews()[1].define("click",function(){this._filter_timer&&window.clearTimeout(this._filter_timer),this._filter_timer=window.setTimeout(function(){var e=webix.$$("__dt_a");if(e){var t=Object(s.getDtParams)(e);Object(s.get_data)({view:"__dt_a",navBar:"__nav_a",start:1,count:t[1],searchBar:void 0,method:"getPrcsAll",field:t[2],direction:t[3],filter:t[0]})}},webix.ui.datafilter.textWaitDelay),this.getParentView().getParentView().hide()})},t}(a.c);t.default=c},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=n(0),c=n(9),l=function(e){function t(){return i(this,t),o(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){function e(){var e=$$("__dt_s").getSelectedId();$$("__dt_s").remove(e)}var t=$$("main_ui").$scope.app,n=function(e){var t=webix.$$(e);if(t){var n=Object(s.getDtParams)(t);Object(s.get_data)({view:e,navBar:"__nav_s",start:1,count:n[1],searchBar:void 0,method:"getPrcsSkip",field:n[2],direction:n[3],filter:n[0]})}};webix.ui.datafilter.customFilterSkip=Object.create(webix.ui.datafilter.textFilter),webix.ui.datafilter.customFilterSkip.on_key_down=function(e,i,o){var r=this._comp_id;9!=(e.which||e.keyCode)&&Object(s.checkKey)(e.keyCode)&&(this._filter_timer&&window.clearTimeout(this._filter_timer),this._filter_timer=window.setTimeout(function(){n(r)},t.config.searchDelay))},webix.ui.datafilter.customFilterSkip.refresh=s.fRefresh,webix.ui.datafilter.customFilterSkip.render=s.fRender;var i={view:"toolbar",id:"__nav_s",height:36,cols:[{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-angle-double-left'></span>",width:50,click:function(){var e=webix.$$("__dt_s");if(e){var t=Object(s.getDtParams)(e);Object(s.get_data)({view:"__dt_s",navBar:"__nav_s",start:1,count:t[1],searchBar:void 0,method:"getPrcsSkip",field:t[2],direction:t[3],filter:t[0]})}}},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-angle-left'></span>",width:50,click:function(){var e=$$("__dt_s").config.startPos-$$("__dt_s").config.posPpage;e=e<0?1:e;var t=webix.$$("__dt_s");if(t){var n=Object(s.getDtParams)(t);Object(s.get_data)({view:"__dt_s",navBar:"__nav_s",start:e,count:n[1],searchBar:void 0,method:"getPrcsSkip",field:n[2],direction:n[3],filter:n[0]})}}},{view:"label",label:"Страница 1 из 1",width:200,id:"__pager_s"},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-angle-right'></span>",width:50,click:function(){var e="__dt_s",t=webix.$$(e);if(t){var n=t.config.startPos+t.config.posPpage;n=n>t.config.totalPos?Object(s.last_page)(e):n;var i=Object(s.getDtParams)(t);Object(s.get_data)({view:e,navBar:"__nav_s",start:n,count:i[1],searchBar:void 0,method:"getPrcsSkip",field:i[2],direction:i[3],filter:i[0]})}}},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-angle-double-right'></span>",width:50,click:function(){var e="__dt_s",t=webix.$$(e);if(t){var n=Object(s.last_page)(e),i=Object(s.getDtParams)(t);Object(s.get_data)({view:e,navBar:"__nav_s",start:n,count:i[1],searchBar:void 0,method:"getPrcsSkip",field:i[2],direction:i[3],filter:i[0]})}}},{},{view:"label",label:"Всего записей: 0",width:180,id:"__count_s"}]},o={view:"datatable",id:"__dt_s",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,startPos:1,posPpage:20,totalPos:1250,old_stri:" ",fi:"c_tovar",di:"asc",columns:[{id:"id_tovar",width:80,hidden:!0,header:[{text:"ID товара"}]},{id:"c_tovar",fillspace:1,sort:"server",headermenu:!1,header:[{text:"Название"},{content:"customFilterSkip"}]},{id:"c_vnd",sort:"server",width:200,header:[{text:"Поставщик"},{content:"customFilterSkip"}]},{id:"c_zavod",sort:"text",width:200,header:[{text:"Производитель"},{content:"customFilterSkip"}]},{id:"dt",width:200,sort:"server",format:s.dt_formating_sec,css:"center_p",header:[{text:"Дата изменения"},{content:"dateRangeFilter",compare:s.compareTrue,readonly:!1,disabled:!1,inputConfig:{format:s.dt_formating,width:180},suggest:{view:"daterangesuggest",body:{timepicker:!1,calendarCount:2}}}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onBeforeSort:function(e,t){var i="__dt_s";$$(i).config.fi=e,$$(i).config.di=t,n(i)},onItemDblClick:function(t){this.$scope.app.config.user;if(this.$scope.app.config.role===this.$scope.app.config.admin){var n=this.getSelectedItem().sh_prc,i={};i.command="?returnLnk",i.sh_prc=n,i.type="async",i.callback=e,this.$scope.popconfirm.show("Вернуть на сведение?",i)}},onKeyPress:function(e,t){13===e&&this.getSelectedItem()&&this.callEvent("onItemDblClick")},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(){}}};return{view:"cWindow",width:.8*document.documentElement.clientWidth,height:.8*document.documentElement.clientHeight,modal:!0,on:{onShow:function(){n("__dt_s")},onHide:function(){$$("__dt_s").clearAll(),$$("_spr_search").focus()}},body:{view:"layout",rows:[o,i]}}},t.prototype.show=function(e){this.getRoot().getHead().getChildViews()[0].setValue(e),this.getRoot().show()},t.prototype.hide=function(){this.getRoot().hide()},t.prototype.init=function(){this.popconfirm=this.ui(c.default),$$($$("__dt_s").getColumnConfig("dt").header[1].suggest.body.id).getChildViews()[1].getChildViews()[1].setValue("Применить"),$$($$("__dt_s").getColumnConfig("dt").header[1].suggest.body.id).getChildViews()[1].getChildViews()[1].define("click",function(){this._filter_timer&&window.clearTimeout(this._filter_timer),this._filter_timer=window.setTimeout(function(){var e=webix.$$("__dt_s");if(e){var t=Object(s.getDtParams)(e);Object(s.get_data)({view:"__dt_s",navBar:"__nav_s",start:1,count:t[1],searchBar:void 0,method:"getPrcsSkip",field:t[2],direction:t[3],filter:t[0]})}},webix.ui.datafilter.textWaitDelay),this.getParentView().getParentView().hide()})},t}(a.c);t.default=l},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=n(3),c=n(0),l=function(e){function t(){return i(this,t),o(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){function e(e){return 0!=+e.id_dv?"<div> <span class='green'>есть</span></div>":"<div> <span class='red'>нет</span></div>"}function t(e){return e.c_mandat?"<div><span class='webix_icon fa-check-circle'></span></div>":"<div><span></span></div>"}function n(e){return e.c_prescr?"<div><span class='webix_icon fa-check-circle'></span></div>":"<div><span></span></div>"}var i=this,o={view:"toolbar",id:"__nav",height:36,cols:[{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-angle-double-left'></span>",width:50,click:function(){var e=$$("__dt").config.posPpage,t=$$("__dt").config.fi,n=$$("__dt").config.di;Object(c.get_data)({th:i,view:"__dt",navBar:"__nav",start:1,count:e,searchBar:"_spr_search",method:"getSprSearch",field:t,direction:n})}},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-angle-left'></span>",width:50,click:function(){var e=$$("__dt").config.startPos-$$("__dt").config.posPpage;e=e<0?1:e;var t=$$("__dt").config.posPpage,n=$$("__dt").config.fi,o=$$("__dt").config.di;Object(c.get_data)({th:i,view:"__dt",navBar:"__nav",start:e,count:t,searchBar:"_spr_search",method:"getSprSearch",field:n,direction:o})}},{view:"label",label:"Страница 1 из 1",width:200,id:"__pager"},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-angle-right'></span>",width:50,click:function(){var e=$$("__dt").config.startPos+$$("__dt").config.posPpage;e=e>$$("__dt").config.totalPos?Object(c.last_page)("__dt"):e;var t=$$("__dt").config.posPpage,n=$$("__dt").config.fi,o=$$("__dt").config.di;Object(c.get_data)({th:i,view:"__dt",navBar:"__nav",start:e,count:t,searchBar:"_spr_search",method:"getSprSearch",field:n,direction:o})}},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-angle-double-right'></span>",width:50,click:function(){var e=Object(c.last_page)("__dt"),t=$$("__dt").config.posPpage,n=$$("__dt").config.fi,o=$$("__dt").config.di;Object(c.get_data)({th:i,view:"__dt",navBar:"__nav",start:e,count:t,searchBar:"_spr_search",method:"getSprSearch",field:n,direction:o})}},{},{view:"label",label:"Всего записей: 0",width:180,id:"__count"}]};return{view:"layout",rows:[{view:"datatable",id:"__dt",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,startPos:1,posPpage:20,totalPos:1250,fi:"c_tovar",di:"asc",old_stri:"",css:"dt_css",columns:[{id:"id_mnn",width:75,template:e,header:[{text:"МНН"}]},{id:"id_spr",width:80,sort:"server",header:[{text:"IDSPR"}],headermenu:!1},{id:"c_tovar",fillspace:1,sort:"server",header:[{text:"Название"}],headermenu:!1},{id:"id_zavod",width:300,header:[{text:"Производитель"}]},{id:"id_strana",width:200,header:[{text:"Страна"}]},{id:"c_dv",hidden:!0,width:150,header:[{text:"Д. в-во"}]},{id:"c_group",hidden:!0,width:150,header:[{text:"Группа"}]},{id:"c_nds",hidden:!0,width:150,header:[{text:"НДС"}]},{id:"c_hran",hidden:!0,width:150,header:[{text:"Условия хранения"}]},{id:"c_sezon",hidden:!0,width:150,header:[{text:"Сезонность"}]},{id:"mandat",width:100,template:t,hidden:!0,css:"col_center",header:[{text:"Обязательный"}]},{id:"prescr",width:100,template:n,hidden:!0,css:"col_center",header:[{text:"Рецептурный"}]}],on:{"data->onParse":function(e,t){this.clearAll(),$$("_link").disable()},onBeforeSort:function(e,t){var n=$$("__dt").config.startPos,o=$$("__dt").config.posPpage;$$("__dt").config.fi=e,$$("__dt").config.di=t,Object(c.get_data)({th:i,view:"__dt",navBar:"__nav",start:n,count:o,searchBar:"_spr_search",method:"getSprSearch",field:e,direction:t})},onBeforeRender:function(){webix.extend(this,webix.ProgressBar),this.count||this.showProgress({type:"icon",icon:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>'})},onItemDblClick:function(e){e=this.getSelectedItem(),e=e.id_spr,e=Object(c.get_spr)(this.$scope,e),e.s_name="Страна: "+e.c_strana,e.t_name="Название товара: "+e.c_tovar,e.v_name="Производитель: "+e.c_zavod,e.dv_name="Действующее вещество: "+e.c_dv,this.$scope.popnew.show("Редактирование записи "+e.id_spr,$$("_spr_search"),e)},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(){$$("_link").enable()},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}},o]}},t.prototype.init=function(){this.popnew=this.ui(s.default)},t}(a.c);t.default=l},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=n(0),c=function(e){function t(){return i(this,t),o(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this.app.config.r_url+"?getVersion",t={user:this.app.config.user},n=Object(s.request)(e,t,!0).response;n=Object(s.checkVal)(n,"s");var i=n.info.prod?"Production":"test";return this.app.config.roles=n.cfg,{view:"toolbar",css:"header",cols:[{view:"label",label:"Вы находитесь на сервере:  "+location.hostname+" | fv. "+this.app.config.version+" | bv. "+n.info.version+" | "+i,css:"ms-logo-text",height:36},{},{view:"button",type:"htmlbutton",width:32,label:"<span class='webix_icon fa-info', style='color: #666666;'></span>"}]}},t}(a.c);t.default=c},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=n(0),c=function(e){function t(){return i(this,t),o(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this,t=$$("main_ui").$scope.app;return{view:"toolbar",css:"header",cols:[{view:"label",label:"<a href='http://ms71.org'><span class='ms-logo', style='background-image: url(addons/img/ms_logo.jpg);'></span></a>",width:44,align:"center",height:36},{view:"label",label:"Манускрипт солюшн: Линкер | "+this.app.config.user,css:"ms-logo-text",height:36,width:550},{},{view:"button",id:"_adm",css:"butt",type:"htmlbutton",label:"<span class='webix_icon fa-blind', style='color: #3498db'></span><span class = 'butt'>Админка</span>",width:120,click:function(){t.config.roles[t.config.role].adm?e.app.show("/start/adm/adm-spr"):webix.message({text:"Упс. Нет доступа.",type:"debug"})}},{view:"button",id:"_merge",css:"butt",type:"htmlbutton",label:"<span class='butt'>Линкер</span>",width:80,click:function(){e.app.show("/start/body")}},{view:"button",id:"_exit",css:"butt",type:"htmlbutton",disabled:!1,label:"<span class='butt'>Выйти</span>",width:80,click:function(){Object(s.deleteCookie)("linker_user"),Object(s.deleteCookie)("linker_auth_key"),Object(s.deleteCookie)("linker_role"),e.app.config.user="",e.app.config.role="0",e.app.config.x_api="x_login",e.show("/login")}}]}},t}(a.c);t.default=c},function(e,t){webix.i18n.locales["ru-RU"]={groupDelimiter:" ",groupSize:3,decimalDelimiter:",",decimalSize:2,dateFormat:"%d.%m.%Y",timeFormat:"%H:%i",longDateFormat:"%d %F %Y",fullDateFormat:"%d.%m.%Y %H:%i",price:"{obj} руб.",priceSettings:null,calendar:{monthFull:["Январь","Февраль","Март","Апрель","Maй","Июнь","Июль","Август","Сентябрь","Oктябрь","Ноябрь","Декабрь"],monthShort:["Янв","Фев","Maр","Aпр","Maй","Июн","Июл","Aвг","Сен","Окт","Ноя","Дек"],dayFull:["Воскресенье","Понедельник","Вторник","Среда","Четверг","Пятница","Суббота"],dayShort:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],hours:"Часы",minutes:"Минуты",done:"Гoтовo",clear:"Очистить",today:"Сегодня"},controls:{select:"Выбрать",invalidMessage:"Неправильное значение"},dataExport:{page:"Страница",of:"из"},PDFviewer:{of:"из",automaticZoom:"Автоматический зум",actualSize:"Настоящий размер",pageFit:"Размер страницы",pageWidth:"Ширина страницы",pageHeight:"Высота страницы"},aria:{calendar:"Календарь",increaseValue:"Увеличить значение",decreaseValue:"Уменьшить значение",navMonth:["Предыдущий месяц","Следующий месяц"],navYear:["Предыдущий год","Следующий год"],navDecade:["Предыдущие десять лет","Следующие десять лет"],dateFormat:"%d %F %Y",monthFormat:"%F %Y",yearFormat:"%Y",hourFormat:"Часы: %H",minuteFormat:"Минуты: %i",removeItem:"Удалить элемент",pages:["Первая страница","Предыдущая страница","Следующая страница","Последняя страница"],page:"Страница",headermenu:"Меню шапки таблицы",openGroup:"Развернуть группу столбцов",closeGroup:"Свернуть группу столбцов",closeTab:"Закрыть вкладку",showTabs:"Показать больше вкладок",resetTreeMap:"Вернуться к первоначальному представлению",navTreeMap:"Перейти на уровень выше",nextTab:"Следующая вкладка",prevTab:"Предыдущая вкладка",multitextSection:"Добавить элемент",multitextextraSection:"Удалить элемент",showChart:"Показать чарт",hideChart:"Спрятать чарт",resizeChart:"Изменить размер чарта"},richtext:{underline:"Подчеркивание",bold:"Жирный",italic:"Курсив"}}},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=e.getChildViews(),i=n,r=Array.isArray(i),a=0,i=r?i:i[Symbol.iterator]();;){var s;if(r){if(a>=i.length)break;s=i[a++]}else{if(a=i.next(),a.done)break;s=a.value}var c=s,l=c;if(l.config.localId===t)return l;if(l=o(l,t))return l}return null}n.d(t,"a",function(){return r});var r=function(){function e(){i(this,e),this._id=webix.uid(),this._events=[],this._subs={}}return e.prototype.getRoot=function(){return this._root},e.prototype.destructor=function(){for(var e=this._events,t=e.length-1;t>=0;t--)e[t].obj.detachEvent(e[t].id);for(var n in this._subs){var i=this._subs[n].view;i&&i.destructor()}this._events=this._container=this._app=this._parent=null},e.prototype.render=function(e,t,n){var i=this;this._parent=n,t&&(this._index=t[0].index),e=e||document.body;var o="string"==typeof e?webix.toNode(e):e;return this._container!==o?(this._container=o,this._render(t).then(function(){return i.getRoot()})):this._urlChange(t).then(function(){return i.getRoot()})},e.prototype.getIndex=function(){return this._index},e.prototype.getId=function(){return this._id},e.prototype.getParentView=function(){return this._parent},e.prototype.$$=function(e){var t=webix.$$(e);return t||(t=o(this.getRoot(),e)),t},e.prototype.on=function(e,t,n){var i=e.attachEvent(t,n);return this._events.push({obj:e,id:i}),i},e.prototype.contains=function(e){for(var t in this._subs){var n=this._subs[t].view;if(n===e||n.contains(e))return!0}return!1},e.prototype.getSubView=function(e){var t=this._subs[e||"default"];return t?{subview:t,parent:this}:this._parent?this._parent.getSubView(e):null},e.prototype.getName=function(){return this._name},e}()},function(e,t,n){"use strict";function i(e){"/"===e[0]&&(e=e.substr(1));for(var t=e.split("/"),n=[],i=0;i<t.length;i++){var o=t[i],r={},a=o.indexOf(":");if(-1===a&&(a=o.indexOf("?")),-1!==a)for(var s=o.substr(a+1).split(/[\:\?\&]/g),c=s,l=Array.isArray(c),u=0,c=l?c:c[Symbol.iterator]();;){var d;if(l){if(u>=c.length)break;d=c[u++]}else{if(u=c.next(),u.done)break;d=u.value}var p=d,f=p.split("=");r[f[0]]=f[1]}n[i]={page:a>-1?o.substr(0,a):o,params:r,index:i+1}}return n}function o(e){for(var t=[],n=e,i=Array.isArray(n),o=0,n=i?n:n[Symbol.iterator]();;){var a;if(i){if(o>=n.length)break;a=n[o++]}else{if(o=n.next(),o.done)break;a=o.value}var s=a;t.push("/"+s.page);var c=r(s.params);c&&t.push(":"+c)}return t.join("")}function r(e){var t=[];for(var n in e)t.length&&t.push(":"),t.push(n+"="+e[n]);return t.join("")}t.a=i,t.b=o},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",function(){return a});var o=n(52),r=n.n(o),a=function(){function e(t,n){var o=this;i(this,e),this.config=n||{},this._prefix=this.config.routerPrefix,void 0===this._prefix&&(this._prefix="!");var a=function(e){};r()(this._prefix+"*",function(e){return o._lastUrl="",a(o.get())}),a=t}return e.prototype.set=function(e,t){if(this.config.routes){var n=e.split("?",2);for(var i in this.config.routes)if(this.config.routes[i]===n[0]){e=i+(n.length>1?"?"+n[1]:"");break}}this._lastUrl=e,r.a.navigate(this._prefix+e,t)},e.prototype.get=function(){var e=this._lastUrl||(window.location.hash||"").replace("#"+this._prefix,"");if(this.config.routes){var t=e.split("?",2),n=this.config.routes[t[0]];n&&(e=n+(t.length>1?"?"+t[1]:""))}return e},e}()},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=n(10),c=n(0),l=function(e){function t(){return i(this,t),o(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{view:"layout",css:"margin-zero",rows:[{$subview:s.default,name:"top_menu"},{$subview:!0}]}},t.prototype.ready=function(e){},t.prototype.init=function(){var e=this.app,t=e.config.searchDelay;setTimeout(c.get_refs,0*t,{app:e,type:"async",method:"getRoles",store:"roles_dc"}),setTimeout(c.get_refs,0*t,{app:e,type:"async",method:"getUsersAll",store:"users_dc"})},t}(a.c);t.default=l},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=n(4),c=n(0),l=function(e){function t(){return i(this,t),o(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this;return{view:"layout",rows:[{height:40,cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Начните набирать название товара здесь",id:"__s_b",fillspace:!0,keyPressTimeout:900,tooltip:"поиск по ШК",_keytimed:void 0,on:{onKeyPress:function(e,t){clearTimeout(this.config._keytimed),Object(c.checkKey)(e)&&(this.config._keytimed=setTimeout(function(){var e=this.$scope,t=1===$$("__ssearch").getValue()?"__dtd":"__dtdb",n=1===$$("__ssearch").getValue()?"__nav_b":"__nav_bb",i=1===$$("__ssearch").getValue()?"getSprBars":"getBarsSpr",o=$$(t).config.posPpage,r=$$(t).config.fi,a=$$(t).config.di,s=1===$$("__checkbars").getValue()?"0,100":$$("_bar_num").getValue();Object(c.get_data)({th:e,view:t,navBar:n,start:1,count:o,searchBar:"__s_b",method:i,field:r,direction:a,cbars:s})},this.$scope.app.config.searchDelay))}}},{view:"button",type:"htmlbutton",width:35,label:"<span class='webix_icon fa-history'></span><span style='line-height: 20px;'></span>",click:function(){var t=1===$$("__ssearch").getValue()?"__dtd":"__dtdb",n=webix.storage.session.get(t);e.pophistory.show(n,$$("__s_b"))}},{view:"checkbox",labelRight:"Поиск по справочнику",labelWidth:0,value:1,disabled:!1,width:160,id:"__ssearch",on:{onChange:function(){$$("__s_b").setValue(""),1===$$("__ssearch").getValue()?($$("__s_b").define("placeholder","Начните набирать название товара здесь"),$$("_bar_num").show(),$$("__checkbars").show(),e.show("/start/adm/adm-barcodes/adm-barcodes-s")):0===$$("__ssearch").getValue()&&($$("__s_b").define("placeholder","Начните набирать баркод"),$$("_bar_num").hide(),$$("__checkbars").hide(),e.show("/start/adm/adm-barcodes/adm-barcodes-b")),$$("__s_b").refresh()}}},{view:"rangeslider",label:"Диапазон кол-ва ШК",value:[0,15],width:350,labelWidth:140,disabled:function(){return 1===$$("__checkbars").getValue()},id:"_bar_num",title:function(e){var t=e.value;return t[0]==t[1]?t[0]:t[0]+" - "+t[1]},stringResult:!0,max:15,min:0,on:{onChange:function(){$$("__s_b").focus()}}},{view:"checkbox",labelRight:"Все",labelWidth:0,value:1,disabled:!1,width:60,id:"__checkbars",on:{onChange:function(){$$("__s_b").focus(),1===$$("__checkbars").getValue()?$$("_bar_num").disable():$$("_bar_num").enable()}}}]},{$subview:!0}]}},t.prototype.init=function(){this.pophistory=this.ui(s.default)},t}(a.c);t.default=l},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=n(0),c=n(7),l=function(e){function t(){return i(this,t),o(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){function e(e){var t,n=e.item.$level,i=e.item,o=e.th,r=o.$scope.app.config.user,a=o.$scope.app.config.r_url+"?delBar";if(console.log(i),1===n)t={user:r,barcode:i.c_tovar,id_spr:void 0};else if(2===n){var c=o.getItem(i.$parent).c_tovar;t={user:r,barcode:c,id_spr:i.id_spr}}var l=Object(s.request)(a,t,!0).response;(l=Object(s.checkVal)(l,"s"))&&(1===n?o.remove(i.id):2===n&&(o.remove(i.id),0===o.getItem(i.$parent).$count&&o.remove(i.$parent)))}var t=this;return{view:"layout",rows:[{view:"treetable",id:"__dtdb",startPos:1,posPpage:20,totalPos:1250,select:!0,resizeColumn:!0,borderless:!0,navigation:"row",rowHeight:32,fixedRowHeight:!1,rowLineHeight:32,headermenu:!0,editable:!1,old_stri:" ",fi:"c_tovar",di:"asc",columns:[{id:"c_tovar",header:"Товар",fillspace:!0,sort:"server",headermenu:!1,template:"<span>{common.treetable()} #c_tovar#</span>"},{id:"id_spr",width:150,header:[{text:"IDSPR"}]},{id:"id_state",width:150,header:[{text:"Статус"}]},{id:"dt",header:"Дата",width:160},{id:"owner",header:"Создал",width:120}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onBeforeSort:function(e,n){var i=$$("__dtdb").config.startPos,o=$$("__dtdb").config.posPpage;$$("__dtdb").config.fi=e,$$("__dtdb").config.di=n,Object(s.get_data)({th:t,view:"__dtdb",navBar:"__nav_bb",start:i,count:o,searchBar:"__s_b",method:"getBarsSpr",field:e,direction:n})},onItemDblClick:function(t){if(this.$scope.app.config.role===this.$scope.app.config.admin){t=this.getSelectedItem();var n=t.$level,i={item:t,th:this},o={callback:e,params:i};2===n?this.$scope.popconfirm.show("Удалить товар из ШК?",o):1===n&&this.$scope.popconfirm.show("Удалить ШК со всеми товарами?",o)}else webix.message({type:"error",text:"Доступ запрещен"})},onAfterLoad:function(){},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}},{view:"toolbar",disabled:!0,id:"__nav_bb",height:36,cols:[{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-angle-double-left'></span>",width:50,click:function(){var e=$$("__dtdb").config.posPpage,n=$$("__dtdb").config.fi,i=$$("__dtdb").config.di;Object(s.get_data)({th:t,view:"__dtdb",navBar:"__nav_bb",start:1,count:e,searchBar:"__s_b",method:"getBarsSpr",field:n,direction:i})}},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-angle-left'></span>",width:50,click:function(){var e=$$("__dtdb").config.startPos-$$("__dtdb").config.posPpage;e=e<0?1:e;var n=$$("__dtdb").config.posPpage,i=$$("__dtdb").config.fi,o=$$("__dtdb").config.di;Object(s.get_data)({th:t,view:"__dtdb",navBar:"__nav_bb",start:e,count:n,searchBar:"__s_b",method:"getBarsSpr",field:i,direction:o})}},{view:"label",label:"Страница 1 из 1",width:200},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-angle-right'></span>",width:50,click:function(){var e=$$("__dtdb").config.startPos+$$("__dtdb").config.posPpage;e=e>$$("__dtdb").config.totalPos?Object(s.last_page)("__dtdb"):e;var n=$$("__dtdb").config.posPpage,i=$$("__dtdb").config.fi,o=$$("__dtdb").config.di;Object(s.get_data)({th:t,view:"__dtdb",navBar:"__nav_bb",start:e,count:n,searchBar:"__s_b",method:"getBarsSpr",field:i,direction:o})}},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-angle-double-right'></span>",width:50,click:function(){var e=Object(s.last_page)("__dtdb"),n=$$("__dtdb").config.posPpage,i=$$("__dtdb").config.fi,o=$$("__dtdb").config.di;Object(s.get_data)({th:t,view:"__dtdb",navBar:"__nav_bb",start:e,count:n,searchBar:"__s_b",method:"getBarsSpr",field:i,direction:o})}},{},{view:"label",label:"Всего записей: 0",width:180}]}]}},t.prototype.init=function(){webix.extend($$("__dtdb"),webix.ProgressBar),this.popconfirm=this.ui(c.default)},t}(a.c);t.default=l},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=n(0),c=n(8),l=n(7),u=function(e){function t(){return i(this,t),o(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){function e(e){var t=e.item,n=e.th,i=n.$scope.app.config.user,o=n.$scope.app.config.r_url+"?delBar",r={user:i,id_spr:t.$parent,barcode:t.barcode},a=Object(s.request)(o,r,!0).response;if(a=Object(s.checkVal)(a,"s")){n.remove(t.id);var c=$$("__dtd").getItem(t.$parent);c.count=c.$count>0?c.$count:"",$$("__dtd").refresh(t.$parent)}}function t(e,t){var n=$$("__dtd"),i=n.$scope.app.config.user,o=n.$scope.app.config.r_url+"?setBar",r={user:i,id_spr:e,barcode:t},a=Object(s.request)(o,r,!0).response;if(a=Object(s.checkVal)(a,"s")){var c=n.isBranchOpen(e),l=(t.split(" "),n.data),u=[];l.each(function(t){2===t.$level&&t.$parent===e&&u.push(t.id)}),n.remove(u),o=n.$scope.app.config.r_url+"?getBar";Object(s.checkVal)(Object(s.request)(o,r,!0).response,"s").forEach(function(t,i,o){var r={barcode:t.barcode,id_state:"active",dt:t.dt,owner:"",count:""};n.add(r,0,e)}),c&&n.open(e);var d=$$("__dtd").getItem(e);d.count=d.$count>0?d.$count:"",$$("__dtd").refresh(e)}}var n=this;return{view:"layout",rows:[{view:"treetable",id:"__dtd",startPos:1,posPpage:20,totalPos:1250,select:!0,resizeColumn:!0,borderless:!0,navigation:"row",rowHeight:32,fixedRowHeight:!1,rowLineHeight:32,headermenu:!0,editable:!1,old_stri:" ",fi:"c_tovar",di:"asc",columns:[{id:"barcode",header:"Штрих-код",fillspace:!0,headermenu:!1,template:"<span>{common.treetable()} #barcode#</span><span style='color: red'> #count#</span>"},{id:"dt",header:"Дата изменения",width:200,format:s.dt_formating_sec,css:"center_p"},{id:"owner",header:"Изменил",width:120,hidden:!0}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onBeforeSort:function(e,t){var i=$$("__dtd").config.startPos,o=$$("__dtd").config.posPpage;$$("__dtd").config.fi=e,$$("__dtd").config.di=t;var r=1===$$("__checkbars").getValue()?"0,100":$$("_bar_num").getValue();Object(s.get_data)({th:n,view:"__dtd",navBar:"__nav_b",start:i,count:o,searchBar:"__s_b",method:"getSprBars",field:e,direction:t,cbars:r})},onItemDblClick:function(){var n=this.getSelectedItem();if(this.$scope.app.config.role===this.$scope.app.config.admin){var i=n.$level;if(1===i)this.$scope.popnewbar.show("Редактирование ШК: "+n.barcode,n.id,void 0,t);else if(2===i){var o={item:n,th:this},r={callback:e,params:o};this.$scope.popconfirm.show("Удалить ШК?",r)}}else webix.message({type:"error",text:"Редактирование запрещено"})},onAfterLoad:function(){},onBeforeSelect:function(){},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}},{view:"toolbar",id:"__nav_b",height:36,cols:[{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-angle-double-left'></span>",width:50,click:function(){var e=$$("__dtd").config.posPpage,t=$$("__dtd").config.fi,i=$$("__dtd").config.di,o=1===$$("__checkbars").getValue()?"0,100":$$("_bar_num").getValue();Object(s.get_data)({th:n,view:"__dtd",navBar:"__nav_b",start:1,count:e,searchBar:"__s_b",method:"getSprBars",field:t,direction:i,cbars:o})}},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-angle-left'></span>",width:50,click:function(){var e=$$("__dtd").config.startPos-$$("__dtd").config.posPpage;e=e<0?1:e;var t=$$("__dtd").config.posPpage,i=$$("__dtd").config.fi,o=$$("__dtd").config.di,r=1===$$("__checkbars").getValue()?"0,100":$$("_bar_num").getValue();Object(s.get_data)({th:n,view:"__dtd",navBar:"__nav_b",start:e,count:t,searchBar:"__s_b",method:"getSprBars",field:i,direction:o,cbars:r})}},{view:"label",label:"Страница 1 из 1",width:200},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-angle-right'></span>",width:50,click:function(){var e=$$("__dtd").config.startPos+$$("__dtd").config.posPpage;e=e>$$("__dtd").config.totalPos?Object(s.last_page)("__dtd"):e;var t=$$("__dtd").config.posPpage,i=$$("__dtd").config.fi,o=$$("__dtd").config.di,r=1===$$("__checkbars").getValue()?"0,100":$$("_bar_num").getValue();Object(s.get_data)({th:n,view:"__dtd",navBar:"__nav_b",start:e,count:t,searchBar:"__s_b",method:"getSprBars",field:i,direction:o,cbars:r})}},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-angle-double-right'></span>",width:50,click:function(){var e=Object(s.last_page)("__dtd"),t=$$("__dtd").config.posPpage,i=$$("__dtd").config.fi,o=$$("__dtd").config.di,r=1===$$("__checkbars").getValue()?"0,100":$$("_bar_num").getValue();Object(s.get_data)({th:n,view:"__dtd",navBar:"__nav_b",start:e,count:t,searchBar:"__s_b",method:"getSprBars",field:i,direction:o,cbars:r})}},{},{view:"label",label:"Всего записей: 0",width:180}]}]}},t.prototype.init=function(){webix.extend($$("__dtd"),webix.ProgressBar),this.popnewbar=this.ui(c.default),this.popconfirm=this.ui(l.default)},t.prototype.ready=function(){$$("__s_b").focus()},t}(a.c);t.default=u},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=n(0),c=n(2),l=function(e){function t(){return i(this,t),o(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this,t={view:"datatable",localId:"__dtc",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,startPos:1,posPpage:20,totalPos:1250,old_stri:"",columns:[{id:"id",width:75,header:[{text:"ID"}]},{id:"c_strana",headermenu:!1,fillspace:1,sort:"text",header:[{text:"Страна"}]},{id:"id_state",width:150,header:[{text:"Статус"}]},{id:"dt",width:250,header:[{text:"Дата заведения"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){this.count||this.showProgress({type:"icon",icon:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>'})},onItemDblClick:function(e){e=this.getSelectedItem();var t={text:e.c_strana,id:e.id,type:"Strana",callback:s.updStrana,mode:"upd",source:this};this.$scope.popnew.show("Редактирование страны",t)},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(){e.$$("_del").enable()},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}};return{view:"layout",rows:[{height:40,cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Строка поиска",keyPressTimeout:900,tooltip:"поиск по стране",on:{onTimedKeyPress:function(e,t){var n=this.getValue().toString().toLowerCase();this.$scope.$$("__dtc").filter(function(e){return-1!=e.c_strana.toString().toLowerCase().indexOf(n)})}}},{view:"button",type:"htmlbutton",disabled:!1,label:"<span class='webix_icon fa-plus'></span><span style='line-height: 20px;'> Добавить</span>",width:140,click:function(){var t={type:"Strana",callback:s.addStrana,mode:"new",source:e.$$("__dtc")};e.popnew.show("Добавление страны",t)}},{view:"button",type:"htmlbutton",disabled:!0,localId:"_del",label:"<span style='color: red', class='webix_icon fa-times'></span><span style='line-height: 20px;'> Удалить</span>",width:140,click:function(){var t=e.$$("__dtc").getSelectedItem().id,n={};n.user=e.app.config.user,n.id=t;var i=e.app.config.r_url+"?delStrana",o=Object(s.request)(i,n,!0).response;(o=Object(s.checkVal)(o,"s"))&&Object(s.delStrana)(o.id)}}]},t]}},t.prototype.init=function(){this.popnew=this.ui(c.default),webix.extend(this.$$("__dtc"),webix.ProgressBar),this.$$("__dtc").sync(s.strana.data)},t}(a.c);t.default=l},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=n(0),c=n(11),l=function(e){function t(){return i(this,t),o(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this,t={view:"datatable",localId:"__dtd",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,startPos:1,posPpage:20,totalPos:1250,old_stri:"",columns:[{id:"id",width:75,sort:"text",header:[{text:"ID"},{content:"selectFilter"}]},{id:"act_ingr",fillspace:1,sort:"text",headermenu:!1,header:[{text:"Действующее вещество"},{content:"textFilter"}]},{id:"oa",width:200,sort:"text",header:[{text:"Обязательный ассортимент"},{content:"selectFilter"}]},{id:"id_state",width:150,header:[{text:"Статус"},{content:"selectFilter"}]},{id:"dt",width:250,header:[{text:"Дата заведения"},{content:"selectFilter"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){this.count||this.showProgress({type:"icon",icon:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>'})},onItemDblClick:function(e){e=this.getSelectedItem();var t={text:e.act_ingr,id:e.id,oa:e.oa,type:"Dv",callback:s.updDv,mode:"upd",source:this};console.log(t),this.$scope.popnew.show("Редактирование действующего в-ва",t)},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(){e.$$("_del").enable()},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}};return{view:"layout",rows:[{height:40,cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Строка поиска",keyPressTimeout:900,tooltip:"поиск по действующему веществу",on:{onTimedKeyPress:function(e,t){var n=this.getValue().toString().toLowerCase();this.$scope.$$("__dtd").filter(function(e){return-1!=e.act_ingr.toString().toLowerCase().indexOf(n)})}}},{view:"button",type:"htmlbutton",disabled:!1,label:"<span class='webix_icon fa-plus'></span><span style='line-height: 20px;'> Добавить</span>",width:140,click:function(){var t={type:"Dv",callback:s.addDv,mode:"new",source:e.$$("__dtd")};e.popnew.show("Добавление действующего в-ва",t)}},{view:"button",type:"htmlbutton",disabled:!0,localId:"_del",label:"<span style='color: red', class='webix_icon fa-times'></span><span style='line-height: 20px;'> Удалить</span>",width:140,click:function(){var t=e.$$("__dtd").getSelectedItem().id,n={};n.user=e.app.config.user,n.id=t;var i=e.app.config.r_url+"?delDv",o=Object(s.request)(i,n,!0).response;(o=Object(s.checkVal)(o,"s"))&&Object(s.delDv)(o.id)}}]},t]}},t.prototype.init=function(){this.popnew=this.ui(c.default),webix.extend(this.$$("__dtd"),webix.ProgressBar),this.$$("__dtd").sync(s.dv.data)},t}(a.c);t.default=l},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=n(0),c=n(2),l=function(e){function t(){return i(this,t),o(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this,t={view:"datatable",id:"__dtg",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,startPos:1,posPpage:20,totalPos:1250,old_stri:"",columns:[{id:"id",width:200,header:[{text:"ID"}]},{id:"group",headermenu:!1,fillspace:1,sort:"text",header:[{text:"Группа"}]},{id:"id_state",width:150,header:[{text:"Статус"}]},{id:"dt",width:250,header:[{text:"Дата заведения"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){this.count||this.showProgress({type:"icon",icon:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>'})},onItemDblClick:function(e){e=this.getSelectedItem();var t={text:e.group,id:e.id,type:"Gr",callback:s.updGr,mode:"upd",source:this};this.$scope.popnew.show("Редактирование группы",t)},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(){e.$$("_del").enable()},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}};return{view:"layout",rows:[{height:40,cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Строка поиска",keyPressTimeout:900,tooltip:"поиск по группе",on:{onTimedKeyPress:function(e,t){var n=this.getValue().toString().toLowerCase();this.$scope.$$("__dtg").filter(function(e){return-1!=e.group.toString().toLowerCase().indexOf(n)})}}},{view:"button",type:"htmlbutton",disabled:!1,label:"<span class='webix_icon fa-plus'></span><span style='line-height: 20px;'> Добавить</span>",width:140,click:function(){var t={type:"Gr",callback:s.addGr,mode:"new",source:e.$$("__dtg")};e.popnew.show("Добавление группы",t)}},{view:"button",type:"htmlbutton",disabled:!0,localId:"_del",label:"<span style='color: red', class='webix_icon fa-times'></span><span style='line-height: 20px;'> Удалить</span>",width:140,click:function(){var t=e.$$("__dtg").getSelectedItem().id,n={};n.user=e.app.config.user,n.id=t;var i=e.app.config.r_url+"?delGr",o=Object(s.request)(i,n,!0).response;(o=Object(s.checkVal)(o,"s"))&&Object(s.delGr)(o.id)}}]},t]}},t.prototype.init=function(){this.popnew=this.ui(c.default),webix.extend(this.$$("__dtg"),webix.ProgressBar),this.$$("__dtg").sync(s.group.data)},t}(a.c);t.default=l},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=n(0),c=n(2),l=function(e){function t(){return i(this,t),o(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this,t={view:"datatable",localId:"__dth",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,startPos:1,posPpage:20,totalPos:1250,old_stri:"",columns:[{id:"id",width:200,header:[{text:"ID"}]},{id:"usloviya",headermenu:!1,fillspace:1,sort:"text",header:[{text:"Условия хранения"}]},{id:"id_state",width:150,header:[{text:"Статус"}]},{id:"dt",width:250,header:[{text:"Дата заведения"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){this.count||this.showProgress({type:"icon",icon:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>'})},onItemDblClick:function(e){e=this.getSelectedItem();var t={text:e.usloviya,id:e.id,type:"Hran",callback:s.updHran,mode:"upd",source:this};this.$scope.popnew.show("Редактирование условия хранения",t)},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(){e.$$("_del").enable()},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}};return{view:"layout",rows:[{height:40,cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Строка поиска",keyPressTimeout:900,tooltip:"поиск по условиям хранения",on:{onTimedKeyPress:function(e,t){var n=this.getValue().toString().toLowerCase();this.$scope.$$("__dth").filter(function(e){return-1!=e.usloviya.toString().toLowerCase().indexOf(n)})}}},{view:"button",type:"htmlbutton",disabled:!1,label:"<span class='webix_icon fa-plus'></span><span style='line-height: 20px;'> Добавить</span>",width:140,click:function(){var t={type:"Hran",callback:s.addHran,mode:"new",source:e.$$("__dth")};e.popnew.show("Добавление условия хранения",t)}},{view:"button",type:"htmlbutton",disabled:!0,localId:"_del",label:"<span style='color: red', class='webix_icon fa-times'></span><span style='line-height: 20px;'> Удалить</span>",width:140,click:function(){var t=e.$$("__dth").getSelectedItem().id,n={};n.user=e.app.config.user,n.id=t;var i=e.app.config.r_url+"?delHran",o=Object(s.request)(i,n,!0).response;(o=Object(s.checkVal)(o,"s"))&&Object(s.delHran)(o.id)}}]},t]}},t.prototype.init=function(){this.popnew=this.ui(c.default),webix.extend(this.$$("__dth"),webix.ProgressBar),this.$$("__dth").sync(s.hran.data)},t}(a.c);t.default=l},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=n(0),c=n(2),l=function(e){function t(){return i(this,t),o(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this,t={view:"datatable",localId:"__dts",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,startPos:1,posPpage:20,totalPos:1250,old_stri:"",columns:[{id:"id",width:200,header:[{text:"ID"}]},{id:"nds",headermenu:!1,fillspace:1,sort:"text",header:[{text:"НДС"}]},{id:"id_state",width:150,header:[{text:"Статус"}]},{id:"dt",width:250,header:[{text:"Дата заведения"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){this.count||this.showProgress({type:"icon",icon:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>'})},onItemDblClick:function(e){e=this.getSelectedItem();var t={text:e.nds,id:e.id,type:"Nds",callback:s.updNds,mode:"upd",source:this};this.$scope.popnew.show("Редактирование НДС",t)},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(){e.$$("_del").enable()},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}};return{view:"layout",rows:[{height:40,cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Строка поиска",keyPressTimeout:900,tooltip:"поиск по НДС",on:{onTimedKeyPress:function(e,t){var n=this.getValue().toString().toLowerCase();this.$scope.$$("__dts").filter(function(e){return-1!=e.nds.toString().toLowerCase().indexOf(n)})}}},{view:"button",type:"htmlbutton",disabled:!1,label:"<span class='webix_icon fa-plus'></span><span style='line-height: 20px;'> Добавить</span>",width:140,click:function(){var t={type:"Nds",callback:s.addNds,mode:"new",source:e.$$("__dts")};e.popnew.show("Добавление НДС",t)}},{view:"button",type:"htmlbutton",disabled:!0,localId:"_del",label:"<span style='color: red', class='webix_icon fa-times'></span><span style='line-height: 20px;'> Удалить</span>",width:140,click:function(){var t=e.$$("__dts").getSelectedItem().id,n={};n.user=e.app.config.user,n.id=t;var i=e.app.config.r_url+"?delNds",o=Object(s.request)(i,n,!0).response;(o=Object(s.checkVal)(o,"s"))&&Object(s.delNds)(o.id)}}]},t]}},t.prototype.init=function(){this.popnew=this.ui(c.default),webix.extend(this.$$("__dts"),webix.ProgressBar),this.$$("__dts").sync(s.nds.data)},t}(a.c);t.default=l},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=n(0),c=n(2),l=function(e){function t(){return i(this,t),o(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this,t={view:"datatable",localId:"__dts",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,startPos:1,posPpage:20,totalPos:1250,old_stri:"",columns:[{id:"id",width:200,header:[{text:"ID"}]},{id:"sezon",headermenu:!1,fillspace:1,sort:"text",header:[{text:"Сезон"}]},{id:"id_state",width:150,header:[{text:"Статус"}]},{id:"dt",width:250,header:[{text:"Дата заведения"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){this.count||this.showProgress({type:"icon",icon:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>'})},onItemDblClick:function(e){e=this.getSelectedItem();var t={text:e.sezon,id:e.id,type:"Sez",callback:s.updSez,mode:"upd",source:this};this.$scope.popnew.show("Редактирование сезонности",t)},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(){e.$$("_del").enable()},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}};return{view:"layout",rows:[{height:40,cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Строка поиска",keyPressTimeout:900,tooltip:"поиск по сезону",on:{onTimedKeyPress:function(e,t){var n=this.getValue().toString().toLowerCase();this.$scope.$$("__dts").filter(function(e){return-1!=e.sezon.toString().toLowerCase().indexOf(n)})}}},{view:"button",type:"htmlbutton",disabled:!1,label:"<span class='webix_icon fa-plus'></span><span style='line-height: 20px;'> Добавить</span>",width:140,click:function(){var t={type:"Sez",callback:s.addSez,mode:"new",source:e.$$("__dts")};e.popnew.show("Добавление сезонности",t)}},{view:"button",type:"htmlbutton",disabled:!0,localId:"_del",label:"<span style='color: red', class='webix_icon fa-times'></span><span style='line-height: 20px;'> Удалить</span>",width:140,click:function(){var t=e.$$("__dts").getSelectedItem().id,n={};n.user=e.app.config.user,n.id=t;var i=e.app.config.r_url+"?delSez",o=Object(s.request)(i,n,!0).response;(o=Object(s.checkVal)(o,"s"))&&Object(s.delSez)(o.id)}}]},t]}},t.prototype.init=function(){this.popnew=this.ui(c.default),webix.extend(this.$$("__dts"),webix.ProgressBar),this.$$("__dts").sync(s.sezon.data)},t}(a.c);t.default=l},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=n(3),c=n(4),l=n(0),u=function(e){function t(){return i(this,t),o(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){function e(e){return 0!=+e.id_dv?"<div> <span class='green'>есть</span></div>":"<div> <span class='red'>нет</span></div>"}function t(e){return e.c_mandat?"<div><span class='webix_icon fa-check-circle'></span></div>":"<div><span class='webix_icon fa-times'></span></div>"}function n(e){return e.c_prescr?"<div><span class='webix_icon fa-check-circle'></span></div>":"<div><span class='webix_icon fa-times'></span></div>"}var i=this,o=$$("main_ui").$scope.app,r=function(e){var t=webix.$$(e);if(t){var n=Object(l.getDtParams)(t);Object(l.get_data)({view:e,navBar:"__nav_as",start:1,count:n[1],searchBar:"_spr_search_adm",method:"getSprSearchAdm",field:n[2],direction:n[3],filter:n[0]})}};webix.ui.datafilter.richFilt=Object.create(webix.ui.datafilter.richSelectFilter),webix.ui.datafilter.richFilt.refresh=l.rRefresh,webix.ui.datafilter.richFilt.render=Object(l.rRender)(function(){this._filter_timer&&window.clearTimeout(this._filter_timer),this._filter_timer=window.setTimeout(function(){r("__dt_as")},o.config.searchDelay)}),webix.ui.datafilter.txtFilt=Object.create(webix.ui.datafilter.textFilter),webix.ui.datafilter.txtFilt.on_key_down=function(e,t,n){var i=this._comp_id;9!=(e.which||e.keyCode)&&Object(l.checkKey)(e.keyCode)&&(this._filter_timer&&window.clearTimeout(this._filter_timer),this._filter_timer=window.setTimeout(function(){r(i)},o.config.searchDelay))},webix.ui.datafilter.txtFilt.refresh=l.fRefresh,webix.ui.datafilter.txtFilt.render=l.fRender;var a=$$("sezon_dc").data.getRange($$("sezon_dc").data.getFirstId(),$$("sezon_dc").data.getLastId()),s=[],c=[],u=[],d=[];a.forEach(function(e,t,n){var i={id:e.id,value:e.sezon};s.push(i)}),a=$$("hran_dc").data.getRange($$("hran_dc").data.getFirstId(),$$("hran_dc").data.getLastId()),a.forEach(function(e,t,n){var i={id:e.id,value:e.usloviya};d.push(i)}),a=$$("nds_dc").data.getRange($$("nds_dc").data.getFirstId(),$$("nds_dc").data.getLastId()),a.forEach(function(e,t,n){var i={id:e.id,value:e.nds};u.push(i)}),a=$$("allTg_dc").data.getRange($$("allTg_dc").data.getFirstId(),$$("allTg_dc").data.getLastId()),a.forEach(function(e,t,n){var i={id:e.id,value:e.c_tgroup};c.push(i)});var p={view:"toolbar",id:"__nav_as",height:36,cols:[{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-angle-double-left'></span>",width:50,click:function(){var e=webix.$$("__dt_as");if(e){var t=Object(l.getDtParams)(e);Object(l.get_data)({view:"__dt_as",navBar:"__nav_as",start:1,count:t[1],searchBar:"_spr_search_adm",method:"getSprSearchAdm",field:t[2],direction:t[3],filter:t[0]})}}},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-angle-left'></span>",width:50,click:function(){var e=$$("__dt_as").config.startPos-$$("__dt_as").config.posPpage;e=e<0?1:e;var t=webix.$$("__dt_as");if(t){var n=Object(l.getDtParams)(t);Object(l.get_data)({view:"__dt_as",navBar:"__nav_as",start:e,count:n[1],searchBar:"_spr_search_adm",method:"getSprSearchAdm",field:n[2],direction:n[3],filter:n[0]})}}},{view:"label",label:"Страница 1 из 1",width:200,id:"__pager"},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-angle-right'></span>",width:50,click:function(){var e=$$("__dt_as").config.startPos+$$("__dt_as").config.posPpage;e=e>$$("__dt_as").config.totalPos?Object(l.last_page)("__dt_as"):e;var t=webix.$$("__dt_as");if(t){var n=Object(l.getDtParams)(t);Object(l.get_data)({view:"__dt_as",navBar:"__nav_as",start:e,count:n[1],searchBar:"_spr_search_adm",method:"getSprSearchAdm",field:n[2],direction:n[3],filter:n[0]})}}},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-angle-double-right'></span>",width:50,click:function(){var e=Object(l.last_page)("__dt_as"),t=webix.$$("__dt_as");if(t){var n=Object(l.getDtParams)(t);Object(l.get_data)({view:"__dt_as",navBar:"__nav_as",start:e,count:n[1],searchBar:"_spr_search_adm",method:"getSprSearchAdm",field:n[2],direction:n[3],filter:n[0]})}}},{},{view:"label",label:"Всего записей: 0",width:180,id:"__count"}]},f={view:"datatable",id:"__dt_as",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,startPos:1,posPpage:20,totalPos:1250,fi:"c_tovar",di:"asc",old_stri:"",css:"dt_css",columns:[{id:"id_mnn",width:75,template:e,header:[{text:"МНН"}]},{id:"id_spr",width:80,sort:"server",header:[{text:"IDSPR"},{content:"txtFilt"}],headermenu:!1},{id:"c_tovar",fillspace:1,sort:"server",header:[{text:"Наименование"}],headermenu:!1},{id:"id_zavod",sort:"server",width:300,header:[{text:"Производитель"},{content:"txtFilt"}]},{id:"id_strana",sort:"server",width:200,header:[{text:"Страна"},{content:"txtFilt"}]},{id:"c_dv",hidden:!0,sort:"server",width:150,header:[{text:"Д. в-во"},{content:"txtFilt"}]},{id:"c_group",hidden:!0,width:150,header:[{text:"Группа"},{content:"richFilt",compare:l.compareTrue,inputConfig:{options:c}}]},{id:"c_nds",hidden:!0,width:150,header:[{text:"НДС"},{content:"richFilt",compare:l.compareTrue,inputConfig:{options:u}}]},{id:"c_hran",hidden:!0,width:150,header:[{text:"Условия хранения"},{content:"richFilt",compare:l.compareTrue,inputConfig:{options:d}}]},{id:"c_sezon",hidden:!0,width:180,header:[{text:"Сезонность"},{content:"richFilt",compare:l.compareTrue,inputConfig:{options:s}}]},{id:"mandat",width:100,template:t,hidden:!0,css:"center_p",header:[{text:"Обязательный"},{content:"richFilt",compare:l.compareTrue,inputConfig:{options:[{id:1,value:"Да"},{id:2,value:"Нет"}]}}]},{id:"prescr",width:100,hidden:!0,css:"center_p",template:n,header:[{text:"Рецептурный"},{content:"richFilt",compare:l.compareTrue,inputConfig:{options:[{id:1,value:"Да"},{id:2,value:"Нет"}]}}]},{id:"dt",width:200,sort:"server",format:l.dt_formating_sec,css:"center_p",header:[{text:"Дата изменения"},{content:"dateRangeFilter",compare:l.compareTrue,readonly:!1,disabled:!1,inputConfig:{format:l.dt_formating,width:180},suggest:{view:"daterangesuggest",body:{timepicker:!1,calendarCount:2}}}]}],on:{"data->onParse":function(e,t){this.clearAll(),this.$scope.$$("_del").disable()},onBeforeSort:function(e,t){var n=$$("__dt_as").config.startPos;$$("__dt_as").config.fi=e,$$("__dt_as").config.di=t;var i=webix.$$("__dt_as");if(i){var o=Object(l.getDtParams)(i);Object(l.get_data)({view:"__dt_as",navBar:"__nav_as",start:n,count:o[1],searchBar:"_spr_search_adm",method:"getSprSearchAdm",field:o[2],direction:o[3],filter:o[0]})}},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onItemDblClick:function(e){e=this.getSelectedItem(),e=e.id_spr,e=Object(l.get_spr)(this.$scope,e),e.s_name="Страна: "+e.c_strana,e.t_name="Название товара: "+e.c_tovar,e.v_name="Производитель: "+e.c_zavod,e.dv_name="Действующее вещество: "+e.c_dv,this.$scope.popnew.show("Редактирование записи "+e.id_spr,$$("_spr_search_adm"),e)},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(){i.$$("_del").enable()},onKeyPress:function(e,t){13===e&&this.getSelectedItem()&&this.callEvent("onItemDblClick")}}};return{view:"layout",rows:[{height:40,cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Введите наименование",id:"_spr_search_adm",tooltip:"поиск от двух символов, !слово - исключить из поиска",on:{onKeyPress:function(e,t){clearTimeout(this.config._keytimed),Object(l.checkKey)(e)&&(this.config._keytimed=setTimeout(function(){var e=webix.$$("__dt_as");if(e){var t=Object(l.getDtParams)(e);Object(l.get_data)({view:"__dt_as",navBar:"__nav_as",start:1,count:t[1],searchBar:"_spr_search_adm",method:"getSprSearchAdm",field:t[2],direction:t[3],filter:t[0]})}},this.$scope.app.config.searchDelay))}}},{view:"button",type:"htmlbutton",width:35,label:"<span class='webix_icon fa-history'></span><span style='line-height: 20px;'></span>",click:function(){var e=webix.storage.session.get("__dt_as");i.pophistory.show(e,$$("_spr_search_adm"))}},{view:"button",type:"htmlbutton",disabled:!1,label:"<span style='line-height: 20px;'>Сбросить фильтры</span>",width:160,click:function(){var e="__dt_as";$$(e).config.columns.forEach(function(t){$$(e).isColumnVisible(t.id)&&t.header[1]&&("function"==typeof $$(e).getFilter(t.id).setValue?$$(e).getFilter(t.id).setValue(""):$$(e).getFilter(t.id).value="")}),$$("_spr_search_adm").callEvent("onKeyPress",[13])}},{view:"button",type:"htmlbutton",disabled:!1,label:"<span class='webix_icon fa-plus'></span><span style='line-height: 20px;'> Добавить</span>",width:140,click:function(){i.popnew.show("Новый эталон",$$("_spr_search_adm"))}},{view:"button",type:"htmlbutton",disabled:!0,localId:"_del",label:"<span style='color: red', class='webix_icon fa-times'></span><span style='line-height: 20px;'> Удалить</span>",width:140,click:function(){webix.message({text:"Удаление из SPR. Пока недоступно.",type:"error"})}}]},f,p]}},t.prototype.init=function(){this.popnew=this.ui(s.default),this.pophistory=this.ui(c.default),$$($$("__dt_as").getColumnConfig("dt").header[1].suggest.body.id).getChildViews()[1].getChildViews()[1].setValue("Применить"),$$($$("__dt_as").getColumnConfig("dt").header[1].suggest.body.id).getChildViews()[1].getChildViews()[1].define("click",function(){this._filter_timer&&window.clearTimeout(this._filter_timer),this._filter_timer=window.setTimeout(function(){var e=webix.$$("__dt_as");if(e){var t=Object(l.getDtParams)(e);Object(l.get_data)({view:"__dt_as",navBar:"__nav_as",start:1,count:t[1],searchBar:"_spr_search_adm",method:"getSprSearchAdm",field:t[2],direction:t[3],filter:t[0]})}},webix.ui.datafilter.textWaitDelay),this.getParentView().getParentView().hide()})},t}(a.c);t.default=u},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=n(14),c=n(0),l=function(e){function t(){return i(this,t),o(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this,t=$$("main_ui").$scope.app,n={view:"datatable",localId:"__dtu",id:"__dtu_g",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,startPos:1,posPpage:20,totalPos:1250,old_stri:"",columns:[{id:"id",hidden:!0,width:75,header:[{text:"ID"}]},{id:"c_user",fillspace:1,sort:"text",header:[{text:"Пользователь"}],headermenu:!1},{id:"id_group",width:170,header:[{text:"Группа"}]},{id:"c_role",width:170,sort:"text",header:[{text:"Роль пользователя"}]},{id:"dt",hidden:!0,width:250,header:[{text:"Дата заведения"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onItemDblClick:function(e){e=this.getSelectedItem();var t=this.$scope.app.config.r_url+"?getUser",n={};n.id=e.id,n.user=this.$scope.app.user,e=Object(c.checkVal)(Object(c.request)(t,n,!0).response,"s"),this.$scope.popnewuser.show("Редактирование пользователя",e)},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(){e.$$("_del").enable()},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}};return{view:"layout",rows:[{height:40,cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Строка поиска",keyPressTimeout:900,tooltip:"Поиск по пользователю",on:{onKeyPress:function(e,t){var n=this;clearTimeout(this.config._keytimed),Object(c.checkKey)(e)&&(this.config._keytimed=setTimeout(function(){var e=n.getValue().toString().toLowerCase();n.$scope.$$("__dtu").filter(function(t){return-1!=t.c_user.toString().toLowerCase().indexOf(e)})},this.$scope.app.config.searchDelay))}}},{view:"button",type:"htmlbutton",disabled:!0,label:"<span class='webix_icon fa-user-plus'></span><span style='line-height: 20px;'> Добавить</span>",width:140,on:{onAfterRender:function(){t.config.roles[t.config.role].useradd&&this.enable()}},click:function(){e.popnewuser.show("Добавление пользователя")}},{view:"button",type:"htmlbutton",disabled:!0,localId:"_del",label:"<span class='webix_icon fa-user-times'></span><span style='line-height: 20px;'> Удалить</span>",width:140,on:{onAfterRender:function(){t.config.roles[t.config.role].userdel&&this.enable()}},click:function(){webix.message({text:"Удаление пользователя. Позже.",type:"debug"})}}]},n]}},t.prototype.init=function(){this.popnewuser=this.ui(s.default);var e=this.$$("__dtu");e.clearAll(),e.parse(c.users)},t}(a.c);t.default=l},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=n(0),c=n(2),l=function(e){function t(){return i(this,t),o(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this,t={view:"datatable",localId:"__dtv",navigation:"row",select:!0,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:32,rowHeight:32,editable:!1,headermenu:!0,startPos:1,posPpage:20,totalPos:1250,old_stri:"",columns:[{id:"id",width:75,header:[{text:"ID"}]},{id:"c_zavod",headermenu:!1,fillspace:1,sort:"text",header:[{text:"Производитель"}]},{id:"id_state",width:150,header:[{text:"Статус"}]},{id:"dt",width:250,header:[{text:"Дата заведения"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){this.count||this.showProgress({type:"icon",icon:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>'})},onItemDblClick:function(e){e=this.getSelectedItem();var t={text:e.c_zavod,id:e.id,type:"Vendor",callback:s.updVendor,mode:"upd",source:this};this.$scope.popnew.show("Редактирование поставщика",t)},onAfterLoad:function(){this.hideProgress()},onBeforeSelect:function(){e.$$("_del").enable()},onKeyPress:function(e,t){13===e&&this.callEvent("onItemDblClick")}}};return{view:"layout",rows:[{height:40,cols:[{view:"text",label:"",value:"",labelWidth:1,placeholder:"Строка поиска",keyPressTimeout:900,tooltip:"поиск по поставщику",on:{onTimedKeyPress:function(e,t){var n=this.getValue().toString().toLowerCase();this.$scope.$$("__dtv").filter(function(e){return-1!=e.c_zavod.toString().toLowerCase().indexOf(n)})}}},{view:"button",type:"htmlbutton",disabled:!1,label:"<span class='webix_icon fa-plus'></span><span style='line-height: 20px;'> Добавить</span>",width:140,click:function(){var t={type:"Vendor",callback:s.addVendor,mode:"new",source:e.$$("__dtv")};e.popnew.show("Добавление производителя",t)}},{view:"button",type:"htmlbutton",disabled:!0,localId:"_del",label:"<span style='color: red', class='webix_icon fa-times'></span><span style='line-height: 20px;'> Удалить</span>",width:140,click:function(){var t=e.$$("__dtv").getSelectedItem().id,n={};n.user=e.app.config.user,n.id=t;var i=e.app.config.r_url+"?delVendor",o=Object(s.request)(i,n,!0).response;(o=Object(s.checkVal)(o,"s"))&&Object(s.delVendor)(o.id)}}]},t]}},t.prototype.init=function(){this.popnew=this.ui(c.default),webix.extend(this.$$("__dtv"),webix.ProgressBar),this.$$("__dtv").sync(s.vendor.data)},t}(a.c);t.default=l},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=n(15),c=n(20),l=function(e){function t(){return i(this,t),o(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{view:"layout",css:"margin-zero",rows:[{$subview:s.default,name:"top_menu"},{$subview:c.default,name:"spr_dt"}]}},t.prototype.ready=function(e){},t}(a.c);t.default=l},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=n(3),c=n(0),l=n(5),u=function(e){function t(){return i(this,t),o(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){function e(){var e=$$("__ttl").getSelectedItem().id;$$("__ttl").remove(e)}var t=this,n=$$("main_ui").$scope.app,i=function(e){var t=webix.$$(e);if(t){var n=Object(c.getDtParams)(t);Object(c.get_data)({view:e,navBar:"__nav_ll",start:1,count:n[1],searchBar:"_link_search",method:"getLnkSprs",field:n[2],direction:n[3],filter:n[0]})}};return webix.ui.datafilter.cFilt=Object.create(webix.ui.datafilter.textFilter),webix.ui.datafilter.cFilt.on_key_down=function(e,t,o){var r=this._comp_id;9!=(e.which||e.keyCode)&&Object(c.checkKey)(e.keyCode)&&(this._filter_timer&&window.clearTimeout(this._filter_timer),this._filter_timer=window.setTimeout(function(){i(r)},n.config.searchDelay))},webix.ui.datafilter.cFilt.refresh=c.fRefresh,webix.ui.datafilter.cFilt.render=c.fRender,{view:"layout",rows:[{view:"datatable",id:"__ttl",startPos:1,posPpage:20,totalPos:1250,select:!0,borderless:!0,rowHeight:30,fixedRowHeight:!1,headermenu:!0,resizeColumn:!0,fi:"c_tovar",di:"asc",old_stri:" ",columns:[{id:"id_tovar",width:100,hidden:!0,header:[{text:"Код"},{content:"cFilt"}]},{id:"c_tovar",fillspace:!0,sort:"server",template:"<span>{common.treetable()} #c_tovar#</span>",header:[{text:"Наименование"}],headermenu:!1},{id:"id_spr",width:150,hidden:!0,header:[{text:"id_spr"}]},{id:"spr",width:350,header:[{text:"Эталон"},{content:"cFilt",placeholder:"!слово - исключить из поиска"}]},{id:"c_zavod",width:200,hidden:!0,header:[{text:"Производитель"},{content:"cFilt"}]},{id:"c_vnd",width:160,header:[{text:"Поставщик"},{content:"cFilt"}]},{id:"dt",width:200,sort:"server",format:c.dt_formating_sec,css:"center_p",header:[{text:"Дата изменения"},{content:"dateRangeFilter",compare:c.compareTrue,readonly:!1,disabled:!1,inputConfig:{format:c.dt_formating,width:180},suggest:{view:"daterangesuggest",body:{timepicker:!1,calendarCount:2}}}]},{id:"owner",width:100,sort:"server",header:[{text:"Создал"},{content:"cFilt"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onBeforeSort:function(e,t){var n="__ttl";$$(n).config.fi=e,$$(n).config.di=t,i(n)},onItemDblClick:function(n,i,o){var r=$$("__ttl").getSelectedItem().id,a={};a.command="?delLnk",a.sh_prc=r,a.type="async",a.callback=e,a.parent=t,t.popunlink.show("Причина разрыва связки?",a)},onKeyPress:function(e,t){13===e&&this.getSelectedItem()&&this.callEvent("onItemDblClick")},onBeforeSelect:function(e){},onAfterSelect:function(e){$$("_break").enable()}}},{view:"toolbar",id:"__nav_ll",height:36,cols:[{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-angle-double-left'></span>",width:50,click:function(){i("__ttl")}},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-angle-left'></span>",width:50,click:function(){var e=$$("__ttl").config.startPos-$$("__ttl").config.posPpage;e=e<0?1:e;var t=webix.$$("__ttl");if(t){var n=Object(c.getDtParams)(t);Object(c.get_data)({view:"__ttl",navBar:"__nav_ll",start:e,count:n[1],searchBar:"_link_search",method:"getLnkSprs",field:n[2],direction:n[3],filter:n[0]})}}},{view:"label",label:"Страница 1 из 1",width:200},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-angle-right'></span>",width:50,click:function(){var e=$$("__ttl").config.startPos+$$("__ttl").config.posPpage;e=e>$$("__ttl").config.totalPos?Object(c.last_page)("__ttl"):e;var t=webix.$$("__ttl");if(t){var n=Object(c.getDtParams)(t);Object(c.get_data)({view:"__ttl",navBar:"__nav_ll",start:e,count:n[1],searchBar:"_link_search",method:"getLnkSprs",field:n[2],direction:n[3],filter:n[0]})}}},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-angle-double-right'></span>",width:50,click:function(){var e=Object(c.last_page)("__ttl"),t=webix.$$("__ttl");if(t){var n=Object(c.getDtParams)(t);Object(c.get_data)({view:"__ttl",navBar:"__nav_ll",start:e,count:n[1],searchBar:"_link_search",method:"getLnkSprs",field:n[2],direction:n[3],filter:n[0]})}}},{},{view:"label",label:"Всего записей: 0",width:180}]}]}},t.prototype.init=function(){var e=$$("main_ui").$scope.app;this.popnew=this.ui(s.default),this.popunlink=this.ui(l.default),$$($$("__ttl").getColumnConfig("dt").header[1].suggest.body.id).getChildViews()[1].getChildViews()[1].setValue("Применить"),$$($$("__ttl").getColumnConfig("dt").header[1].suggest.body.id).getChildViews()[1].getChildViews()[1].define("click",function(){this._filter_timer&&window.clearTimeout(this._filter_timer),this._filter_timer=window.setTimeout(function(){var e=webix.$$("__ttl");if(e){var t=Object(c.getDtParams)(e);Object(c.get_data)({view:"__ttl",navBar:"__nav_ll",start:1,count:t[1],searchBar:"_link_search",method:"getLnkSprs",field:t[2],direction:t[3],filter:t[0]})}},webix.ui.datafilter.textWaitDelay),this.getParentView().getParentView().hide()}),$$("__ttl").isColumnVisible("dt")&&$$("__ttl").getFilter("dt").setValue({start:new Date}),$$("__ttl").isColumnVisible("owner")&&(e.config.roles[e.config.role].lnkdel?$$("__ttl").getFilter("owner").readOnly=!1:($$("__ttl").getFilter("owner").value=this.app.config.user,$$("__ttl").getFilter("owner").readOnly=!0))},t}(a.c);t.default=u},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=n(3),c=n(0),l=n(5),u=function(e){function t(){return i(this,t),o(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){function e(){var e=$$("__tt").getSelectedItem().id;$$("__tt").remove(e)}var t=$$("main_ui").$scope.app,n=function(e){var t=webix.$$(e);if(t){var n=Object(c.getDtParams)(t);Object(c.get_data)({view:e,navBar:"__nav_l",start:1,count:n[1],searchBar:"_link_search",method:"getSprLnks",field:n[2],direction:n[3],filter:n[0]})}};return webix.ui.datafilter.customFilterLnkSpr=Object.create(webix.ui.datafilter.textFilter),webix.ui.datafilter.customFilterLnkSpr.on_key_down=function(e,i,o){var r=this._comp_id;9!=(e.which||e.keyCode)&&Object(c.checkKey)(e.keyCode)&&(this._filter_timer&&window.clearTimeout(this._filter_timer),this._filter_timer=window.setTimeout(function(){n(r)},t.config.searchDelay))},webix.ui.datafilter.customFilterLnkSpr.refresh=c.fRefresh,webix.ui.datafilter.customFilterLnkSpr.render=c.fRender,{view:"layout",rows:[{view:"treetable",id:"__tt",startPos:1,posPpage:20,totalPos:1250,select:!0,borderless:!0,rowHeight:30,fixedRowHeight:!1,headermenu:!0,resizeColumn:!0,fi:"c_tovar",di:"asc",old_stri:" ",columns:[{id:"c_tovar",fillspace:!0,template:"<span>{common.treetable()} #c_tovar#</span><span style='color: red'> #count#</span>",header:[{text:"Наименование"}],headermenu:!1},{id:"c_zavod",width:200,header:[{text:"Производитель"},{content:"customFilterLnkSpr"}]},{id:"c_vnd",width:160,header:[{text:"Поставщик"},{content:"customFilterLnkSpr"}]},{id:"id_tovar",width:100,hidden:!0,header:[{text:"Код"},{content:"customFilterLnkSpr"}]},{id:"dt",width:200,format:c.dt_formating_sec,css:"center_p",header:[{text:"Дата изменения"}]},{id:"owner",width:100,header:[{text:"Создал"},{content:"customFilterLnkSpr"}]}],on:{"data->onParse":function(e,t){this.clearAll()},onBeforeRender:function(){webix.extend(this,webix.ProgressBar)},onBeforeSort:function(e,t){var i="__tt";$$(i).config.fi=e,$$(i).config.di=t,n(i)},onItemDblClick:function(n,i,o){var r=this.getSelectedItem().$level;if(1===r)t.config.roles[t.config.role].spredit?(n=n.row,n=Object(c.get_spr)(this.$scope,n),n.s_name="Страна: "+n.c_strana,n.t_name="Название товара: "+n.c_tovar,n.v_name="Производитель: "+n.c_zavod,n.dv_name="Действующее вещество: "+n.c_dv,this.$scope.popnew.show("Редактирование записи "+n.id_spr,$$("_link_search"),n)):webix.message({type:"error",text:"Редактирование запрещено"});else if(2===r){var a=$$("__tt").getSelectedItem().id,s={};s.action="return",s.command="?delLnk",s.sh_prc=a,s.type="async",s.callback=e,s.parent=this.$scope,this.$scope.popunlink.show("Причина разрыва связки?",s)}},onKeyPress:function(e,t){13===e&&this.getSelectedItem()&&this.callEvent("onItemDblClick")},onBeforeSelect:function(e){},onAfterSelect:function(e){var t=this.getSelectedItem().$level;1===t?$$("_break").disable():2===t&&$$("_break").enable()}}},{view:"toolbar",id:"__nav_l",height:36,cols:[{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-angle-double-left'></span>",width:50,click:function(){n("__tt")}},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-angle-left'></span>",width:50,click:function(){var e=$$("__tt").config.startPos-$$("__tt").config.posPpage;e=e<0?1:e;var t=webix.$$("__tt");if(t){var n=Object(c.getDtParams)(t);Object(c.get_data)({view:"__tt",navBar:"__nav_l",start:e,count:n[1],searchBar:"_link_search",method:"getSprLnks",field:n[2],direction:n[3],filter:n[0]})}}},{view:"label",label:"Страница 1 из 1",width:200},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-angle-right'></span>",width:50,click:function(){var e=$$("__tt").config.startPos+$$("__tt").config.posPpage;e=e>$$("__tt").config.totalPos?Object(c.last_page)("__tt"):e;var t=webix.$$("__tt");if(t){var n=Object(c.getDtParams)(t);Object(c.get_data)({view:"__tt",navBar:"__nav_l",start:e,count:n[1],searchBar:"_link_search",method:"getSprLnks",field:n[2],direction:n[3],filter:n[0]})}}},{view:"button",type:"htmlbutton",label:"<span class='webix_icon fa-angle-double-right'></span>",width:50,click:function(){var e=Object(c.last_page)("__tt"),t=webix.$$("__tt");if(t){var n=Object(c.getDtParams)(t);Object(c.get_data)({view:"__tt",navBar:"__nav_l",start:e,count:n[1],searchBar:"_link_search",method:"getSprLnks",field:n[2],direction:n[3],filter:n[0]})}}},{},{view:"label",label:"Всего записей: 0",width:180}]}]}},t.prototype.init=function(){this.popnew=this.ui(s.default),this.popunlink=this.ui(l.default)},t}(a.c);t.default=u},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=n(0),c=function(e){function t(){return i(this,t),o(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){function e(e){var t=$$("auth_box").getValues();t.pass=md5(t.pass);var n=!1,i=e.$scope.app.config.r_url+"?login",o=Object(s.request)(i,t,!0).response;if(o=Object(s.checkVal)(o,"s")){n=!0,e.$scope.app.config.user=t.user,e.$scope.app.config.role=o.role,e.$scope.app.config.x_api=o.key;var r={path:"/"};Object(s.setCookie)("linker_user",t.user,r),Object(s.setCookie)("linker_auth_key",o.key,r),Object(s.setCookie)("linker_role",o.role,r)}return n}return{view:"layout",rows:[{},{cols:[{},{view:"form",id:"auth_box",label:"Аутентификация",elements:[{view:"text",label:"Пользователь",name:"user",labelWidth:120,width:400},{view:"text",type:"password",label:"Пароль",name:"pass",labelWidth:120,width:400},{cols:[{},{},{view:"button",label:"OK",hotkey:"enter",click:function(){e(this)?(this.$scope.show("/start/body"),webix.message("авторизованно")):(webix.message({text:"не авторизованно",type:"debug"}),Object(s.deleteCookie)("linker_user"),Object(s.deleteCookie)("linker_auth_key"),Object(s.deleteCookie)("linker_role"))}}]}]},{}]},{}]}},t.prototype.init=function(){var e=Object(s.getCookie)("linker_user"),t=Object(s.getCookie)("linker_auth_key"),n=Object(s.getCookie)("linker_role");e&&t&&n?(this.app.config.user=e,this.app.config.role=n,this.app.config.x_api=t,this.show("/start/body")):(Object(s.deleteCookie)("linker_user"),Object(s.deleteCookie)("linker_auth_key"),Object(s.deleteCookie)("linker_role"))},t}(a.c);t.default=c},function(e,t,n){var i;"function"==typeof Symbol&&Symbol.iterator;!function(o){"use strict";function r(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function a(e,t){return e<<t|e>>>32-t}function s(e,t,n,i,o,s){return r(a(r(r(t,e),r(i,s)),o),n)}function c(e,t,n,i,o,r,a){return s(t&n|~t&i,e,t,o,r,a)}function l(e,t,n,i,o,r,a){return s(t&i|n&~i,e,t,o,r,a)}function u(e,t,n,i,o,r,a){return s(t^n^i,e,t,o,r,a)}function d(e,t,n,i,o,r,a){return s(n^(t|~i),e,t,o,r,a)}function p(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;var n,i,o,a,s,p=1732584193,f=-271733879,h=-1732584194,_=271733878;for(n=0;n<e.length;n+=16)i=p,o=f,a=h,s=_,p=c(p,f,h,_,e[n],7,-680876936),_=c(_,p,f,h,e[n+1],12,-389564586),h=c(h,_,p,f,e[n+2],17,606105819),f=c(f,h,_,p,e[n+3],22,-1044525330),p=c(p,f,h,_,e[n+4],7,-176418897),_=c(_,p,f,h,e[n+5],12,1200080426),h=c(h,_,p,f,e[n+6],17,-1473231341),f=c(f,h,_,p,e[n+7],22,-45705983),p=c(p,f,h,_,e[n+8],7,1770035416),_=c(_,p,f,h,e[n+9],12,-1958414417),h=c(h,_,p,f,e[n+10],17,-42063),f=c(f,h,_,p,e[n+11],22,-1990404162),p=c(p,f,h,_,e[n+12],7,1804603682),_=c(_,p,f,h,e[n+13],12,-40341101),h=c(h,_,p,f,e[n+14],17,-1502002290),f=c(f,h,_,p,e[n+15],22,1236535329),p=l(p,f,h,_,e[n+1],5,-165796510),_=l(_,p,f,h,e[n+6],9,-1069501632),h=l(h,_,p,f,e[n+11],14,643717713),f=l(f,h,_,p,e[n],20,-373897302),p=l(p,f,h,_,e[n+5],5,-701558691),_=l(_,p,f,h,e[n+10],9,38016083),h=l(h,_,p,f,e[n+15],14,-660478335),f=l(f,h,_,p,e[n+4],20,-405537848),p=l(p,f,h,_,e[n+9],5,568446438),_=l(_,p,f,h,e[n+14],9,-1019803690),h=l(h,_,p,f,e[n+3],14,-187363961),f=l(f,h,_,p,e[n+8],20,1163531501),p=l(p,f,h,_,e[n+13],5,-1444681467),_=l(_,p,f,h,e[n+2],9,-51403784),h=l(h,_,p,f,e[n+7],14,1735328473),f=l(f,h,_,p,e[n+12],20,-1926607734),p=u(p,f,h,_,e[n+5],4,-378558),_=u(_,p,f,h,e[n+8],11,-2022574463),h=u(h,_,p,f,e[n+11],16,1839030562),f=u(f,h,_,p,e[n+14],23,-35309556),p=u(p,f,h,_,e[n+1],4,-1530992060),_=u(_,p,f,h,e[n+4],11,1272893353),h=u(h,_,p,f,e[n+7],16,-155497632),f=u(f,h,_,p,e[n+10],23,-1094730640),p=u(p,f,h,_,e[n+13],4,681279174),_=u(_,p,f,h,e[n],11,-358537222),h=u(h,_,p,f,e[n+3],16,-722521979),f=u(f,h,_,p,e[n+6],23,76029189),p=u(p,f,h,_,e[n+9],4,-640364487),_=u(_,p,f,h,e[n+12],11,-421815835),h=u(h,_,p,f,e[n+15],16,530742520),f=u(f,h,_,p,e[n+2],23,-995338651),p=d(p,f,h,_,e[n],6,-198630844),_=d(_,p,f,h,e[n+7],10,1126891415),h=d(h,_,p,f,e[n+14],15,-1416354905),f=d(f,h,_,p,e[n+5],21,-57434055),p=d(p,f,h,_,e[n+12],6,1700485571),_=d(_,p,f,h,e[n+3],10,-1894986606),h=d(h,_,p,f,e[n+10],15,-1051523),f=d(f,h,_,p,e[n+1],21,-2054922799),p=d(p,f,h,_,e[n+8],6,1873313359),_=d(_,p,f,h,e[n+15],10,-30611744),h=d(h,_,p,f,e[n+6],15,-1560198380),f=d(f,h,_,p,e[n+13],21,1309151649),p=d(p,f,h,_,e[n+4],6,-145523070),_=d(_,p,f,h,e[n+11],10,-1120210379),h=d(h,_,p,f,e[n+2],15,718787259),f=d(f,h,_,p,e[n+9],21,-343485551),p=r(p,i),f=r(f,o),h=r(h,a),_=r(_,s);return[p,f,h,_]}function f(e){var t,n="",i=32*e.length;for(t=0;t<i;t+=8)n+=String.fromCharCode(e[t>>5]>>>t%32&255);return n}function h(e){var t,n=[];for(n[(e.length>>2)-1]=void 0,t=0;t<n.length;t+=1)n[t]=0;var i=8*e.length;for(t=0;t<i;t+=8)n[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return n}function _(e){return f(p(h(e),8*e.length))}function b(e,t){var n,i,o=h(e),r=[],a=[];for(r[15]=a[15]=void 0,o.length>16&&(o=p(o,8*e.length)),n=0;n<16;n+=1)r[n]=909522486^o[n],a[n]=1549556828^o[n];return i=p(r.concat(h(t)),512+8*t.length),f(p(a.concat(i),640))}function g(e){var t,n,i="0123456789abcdef",o="";for(n=0;n<e.length;n+=1)t=e.charCodeAt(n),o+=i.charAt(t>>>4&15)+i.charAt(15&t);return o}function w(e){return unescape(encodeURIComponent(e))}function v(e){return _(w(e))}function y(e){return g(v(e))}function m(e,t){return b(w(e),w(t))}function $(e,t){return g(m(e,t))}function x(e,t,n){return t?n?m(t,e):$(t,e):n?v(e):y(e)}void 0!==(i=function(){return x}.call(t,n,t,e))&&(e.exports=i)}()},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=n(22),c=n(21),l=function(e){function t(){return i(this,t),o(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{type:"line",id:"main_ui",rows:[{$subview:s.default},{$subview:!0},{$subview:c.default}]}},t.prototype.init=function(){},t}(a.c);t.default=l},function(e,t){},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(48),o=(n.n(i),n(1)),r=n(0),a=n(23);n.n(a);webix.ready(function(){webix.i18n.setLocale("ru-RU"),webix.protoUI({name:"activeList"},webix.ui.list,webix.ActiveContent),webix.protoUI({name:"cWindow",defaults:{modal:!1,move:!0,position:"center"},$init:function(e){webix.extend(e,{head:{view:"toolbar",cols:[{view:"label",label:"Название окна"},{view:"button",type:"icon",icon:"times",css:"times",height:26,width:26,click:function(){this.getTopParentView().hide()}}]}})}},webix.ui.window);var e=new o.b({id:"mainApp",name:"linker",version:"18.065.1515",start:"/login",admin:"34",user:"",role:"0",r_url:"localhost"===location.hostname?"http://saas.local/linker_logic":"../linker_logic",router:o.a,x_api:"x_login",debug:!0,searchDelay:1e3,lch:0,roles:{}});webix.attachEvent("onBeforeAjax",function(t,n,i,o,r,a,s){r["x-api-key"]=e.config.x_api}),e.render(),Object(r.init_first)(e)})},function(e,t){},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.d(t,"a",function(){return h});var a=n(24),s=n(6),c=n(50),l=n(51),u=n(26),d=n(25),p=n(53),f=(n.n(p),"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}),h=function(e){function t(n){i(this,t);var r=o(this,e.call(this));return r.webix=n.webix||webix,r.config=r.webix.extend({name:"App",version:"1.0",start:"/home"},n,!0),r._name=r.config.name,r._services={},webix.extend(r,webix.EventSystem),webix.attachEvent("onClick",function(e){return r.clickHandler(e)}),r}return r(t,e),t.prototype.getService=function(e){var t=this._services[e];return"function"==typeof t&&(t=this._services[e]=t(this)),t},t.prototype.setService=function(e,t){this._services[e]=t},t.prototype.copyConfig=function(e,n,i){if(e.$ui?e={$subview:new c.a(this,"",e)}:e instanceof t&&(e={$subview:e}),e.$subview)return this.addSubView(e,n,i);n=n||(e instanceof Array?[]:{});for(var o in e){var r=e[o];"function"==typeof r&&r.prototype&&r.prototype.config&&(r={$subview:r}),!r||"object"!==(void 0===r?"undefined":f(r))||r instanceof webix.DataCollection?n[o]=r:r instanceof Date?n[o]=new Date(r):n[o]=this.copyConfig(r,r instanceof Array?[]:{},i)}return n},t.prototype.getRouter=function(){return this.$router},t.prototype.clickHandler=function(e){if(e){var t=e.target||e.srcElement;if(t&&t.getAttribute){var n=t.getAttribute("trigger");n&&this.trigger(n);var i=t.getAttribute("route");i&&this.show(i)}}},t.prototype.refresh=function(){var e=this._container;this._view.destructor(),this._view=this._container=null,this.render(e,Object(d.a)(this.getRouter().get()),this._parent)},t.prototype.loadView=function(e){var t=this,i=this.config.views,o=null;try{if(i&&"string"==typeof(o="function"==typeof i?i(e):i[e])&&(e=o,o=null),!o){e=e.replace(/\./g,"/");var r=n(54)("./"+e);r.__esModule&&(r=r.default),o=r}}catch(t){o=this._loadError(e,t)}return o.then||(o=Promise.resolve(o)),o=o.catch(function(n){return t._loadError(e,n)})},t.prototype.createFromURL=function(e,n){var i=this,o=e[0],r=o.page;return n&&n.getName()===r?Promise.resolve(n):this.loadView(o.page).then(function(e){if("function"==typeof e){if(e.prototype&&e.prototype.show)return new e(i,r);e=e()}return e instanceof t||e instanceof s.a?e:e.$ui?new c.a(i,r,e):new l.a(i,r,e)})},t.prototype.show=function(e){var t=this;this.$router.get()!==e&&this.canNavigate(e).then(function(e){t.$router.set(e,{silent:!0}),t._render(e)}).catch(function(){return!1})},t.prototype.canNavigate=function(e,t){var n={url:Object(d.a)(e),redirect:e,confirm:Promise.resolve(!0)};return this.callEvent("app:guard",[e,t||this._view,n])?n.confirm.then(function(){return n.redirect}):Promise.reject("")},t.prototype.destructor=function(){this._view.destructor()},t.prototype.trigger=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];this.apply(e,n)},t.prototype.apply=function(e,t){this.callEvent(e,t)},t.prototype.action=function(e){return this.webix.bind(function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];this.apply(e,n)},this)},t.prototype.on=function(e,t){this.attachEvent(e,t)},t.prototype.use=function(e,t){e(this,null,t)},t.prototype.error=function(e,t){this.callEvent(e,t),this.callEvent("app:error",t),this.config.debug&&t[0]&&console.error(t[0])},t.prototype._render=function(e){var t=this;!this.$router&&(e=this._first_start(e));var n="string"==typeof e?e:Object(d.b)(e);return this.canNavigate(n).then(function(e){return t.$router.set(e,{silent:!0}),t._render_stage(e)})},t.prototype._render_stage=function(e){var t=this,n="string"==typeof e?Object(d.a)(e):e;return webix.ui.freeze(function(){return t.createFromURL(n,t._view).then(function(e){var i=t._view;return t._view=e,e.render(t._container,n,t._parent).then(function(o){return i&&i!==t._view&&i.destructor(),t._view.getRoot().getParentView()&&(t._container=o),t._root=o,t.callEvent("app:route",[n]),e})}).catch(function(e){t.error("app:error:render",[e])})})},t.prototype._urlChange=function(e){return alert("Not implemented"),Promise.resolve(!0)},t.prototype._first_start=function(e){var t=this,n=function(e){return setTimeout(function(){t._render(e)},1)};if(this.$router=new(this.config.router||u.a)(n,this.config),this._container===document.body&&!1!==this.config.animation){var i=this._container;webix.html.addCss(i,"webixappstart"),setTimeout(function(){webix.html.removeCss(i,"webixappstart"),webix.html.addCss(i,"webixapp")},10)}return e&&1!==e.length||(e=this.$router.get()||this.config.start,this.$router.set(e,{silent:!0})),e},t.prototype._loadError=function(e,t){return this.error("app:error:resolve",[t,e]),{template:" "}},t.prototype.addSubView=function(e,t,n){var i=!0!==e.$subview?e.$subview:null,o=e.name||(i?this.webix.uid():"default");t.id=e.id||"s"+this.webix.uid();var r=n[o]={id:t.id,url:i};return r.url instanceof s.a&&(r.view=r.url),t},t}(a.a)},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.d(t,"a",function(){return s});var a=n(6),s=function(e){function t(n,r,a){i(this,t);var s=o(this,e.call(this,n,r));return s._ui=a,s._windows=[],s}return r(t,e),t.prototype.getRoot=function(){if(this.app.config.jet1xMode){var e=this.getParentView();if(e)return e.getRoot()}return this._root},t.prototype.config=function(){return this._ui.$ui||this._ui},t.prototype.destructor=function(){var t=this._ui.$ondestroy;t&&t();for(var n=this._windows,i=Array.isArray(n),o=0,n=i?n:n[Symbol.iterator]();;){var r;if(i){if(o>=n.length)break;r=n[o++]}else{if(o=n.next(),o.done)break;r=o.value}r.destructor()}e.prototype.destructor.call(this)},t.prototype.show=function(t,n){if(0===t.indexOf("/")||0===t.indexOf("./"))return e.prototype.show.call(this,t,n);e.prototype.show.call(this,"../"+t,n)},t.prototype.init=function(e,t){this.app.config.legacyEarlyInit&&this._realInitHandler(e,t)},t.prototype.ready=function(e,t){this.app.config.legacyEarlyInit||this._realInitHandler(e,t)},t.prototype._realInitHandler=function(e,n){var i=this._ui.$oninit;if(i){var o=this.getRoot();i(o,o.$scope)}var r=this._ui.$onevent;if(r)for(var a in r)this.on(this.app,a,r[a]);var s=this._ui.$windows;if(s)for(var c=s,l=Array.isArray(c),u=0,c=l?c:c[Symbol.iterator]();;){var d;if(l){if(u>=c.length)break;d=c[u++]}else{if(u=c.next(),u.done)break;d=u.value}var p=d;if(p.$ui){var f=new t(this.app,this.getName(),p);f.render(document.body),this._windows.push(f)}else this.ui(p)}},t.prototype._urlChange=function(t){var n=this;return e.prototype._urlChange.call(this,t).then(function(){var e=n._ui.$onurlchange;if(e){var i=n.getRoot();e(t[0].params,t.slice(1),i.$scope)}})},t}(a.a)},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.d(t,"a",function(){return s});var a=n(6),s=function(e){function t(n,r,a){i(this,t);var s=o(this,e.call(this,n,r));return s._ui=a,s}return r(t,e),t.prototype.config=function(){return this._ui},t}(a.a)},function(e,t,n){var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e,t){var n,o=[],r={},a=e.routie,s=function(e,t){this.name=t,this.path=e,this.keys=[],this.fns=[],this.params={},this.regex=c(this.path,this.keys,!1,!1)};s.prototype.addHandler=function(e){this.fns.push(e)},s.prototype.removeHandler=function(e){for(var t=0,n=this.fns.length;t<n;t++){if(e==this.fns[t])return void this.fns.splice(t,1)}},s.prototype.run=function(e){for(var t=0,n=this.fns.length;t<n;t++)if(!1===this.fns[t].apply(this,e))return!1;return!0},s.prototype.match=function(e,t){var n=this.regex.exec(e);if(!n)return!1;for(var i=1,o=n.length;i<o;++i){var r=this.keys[i-1],a="string"==typeof n[i]?decodeURIComponent(n[i]):n[i];r&&(this.params[r.name]=a),t.push(a)}return!0},s.prototype.toURL=function(e){var t=this.path;for(var n in e)t=t.replace("/:"+n,"/"+e[n]);if(t=t.replace(/\/:.*\?/g,"/").replace(/\?/g,""),-1!=t.indexOf(":"))throw new Error("missing parameters for url: "+t);return t};var c=function(e,t,n,i){return e instanceof RegExp?e:(e instanceof Array&&(e="("+e.join("|")+")"),e=e.concat(i?"":"/?").replace(/\/\(/g,"(?:/").replace(/\+/g,"__plus__").replace(/(\/)?(\.)?:(\w+)(?:(\(.*?\)))?(\?)?/g,function(e,n,i,o,r,a){return t.push({name:o,optional:!!a}),n=n||"",(a?"":n)+"(?:"+(a?n:"")+(i||"")+(r||i&&"([^/.]+?)"||"([^/]+?)")+")"+(a||"")}).replace(/([\/.])/g,"\\$1").replace(/__plus__/g,"(.+)").replace(/\*/g,"(.*)"),new RegExp("^"+e+"$",n?"":"i"))},l=function(e,t){var n=e.split(" "),i=2==n.length?n[0]:null;e=2==n.length?n[1]:n[0],r[e]||(r[e]=new s(e,i),o.push(r[e])),r[e].addHandler(t)},u=function e(t,n){if("function"==typeof n)l(t,n),e.reload();else if("object"==(void 0===t?"undefined":i(t))){for(var o in t)l(o,t[o]);e.reload()}else void 0===n&&e.navigate(t)};u.lookup=function(e,t){for(var n=0,i=o.length;n<i;n++){var r=o[n];if(r.name==e)return r.toURL(t)}},u.remove=function(e,t){var n=r[e];n&&n.removeHandler(t)},u.removeAll=function(){r={},o=[],n=""},u.navigate=function(e,t){t=t||{};var n=t.silent||!1;n&&_(),setTimeout(function(){window.location.hash=e,n&&setTimeout(function(){h()},1)},1)},u.noConflict=function(){return e.routie=a,u};var d=function(){return window.location.hash.substring(1)},p=function(e,t){var n=[];return t.match(e,n)?!1!==t.run(n)?1:0:-1},f=u.reload=function(){for(var e=d(),t=0,i=o.length;t<i;t++){var r=o[t],a=p(e,r);if(1===a){n=e;break}if(0===a){u.navigate(n,{silent:!0});break}}},h=function(){e.addEventListener?e.addEventListener("hashchange",f,!1):e.attachEvent("onhashchange",f)},_=function(){e.removeEventListener?e.removeEventListener("hashchange",f):e.detachEvent("onhashchange",f)};if(h(),n=d(),t)return u;e.routie=u};e.exports=o(window,!0),e.exports.default=e.exports},function(e,t){var n=webix;n.ui.freeze||(n.ui.freeze=function(e){var t=e();return t&&t.then?t.then(function(e){return n.ui.$freeze=!1,n.ui.resize(),e}):(n.ui.$freeze=!1,n.ui.resize()),t})},function(e,t,n){function i(e){return n(o(e))}function o(e){var t=r[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var r={"./adm":27,"./adm-barcodes":28,"./adm-barcodes-b":29,"./adm-barcodes-b.js":29,"./adm-barcodes-s":30,"./adm-barcodes-s.js":30,"./adm-barcodes.js":28,"./adm-country":31,"./adm-country.js":31,"./adm-dv":32,"./adm-dv.js":32,"./adm-groups":33,"./adm-groups.js":33,"./adm-hran":34,"./adm-hran.js":34,"./adm-nds":35,"./adm-nds.js":35,"./adm-seasons":36,"./adm-seasons.js":36,"./adm-spr":37,"./adm-spr.js":37,"./adm-top-menu":10,"./adm-top-menu.js":10,"./adm-users":38,"./adm-users.js":38,"./adm-vendors":39,"./adm-vendors.js":39,"./adm.js":27,"./bar-yes-no":7,"./bar-yes-no.js":7,"./body":40,"./body.js":40,"./footer":21,"./footer.js":21,"./globals":0,"./globals.js":0,"./header":22,"./header.js":22,"./history":4,"./history.js":4,"./links_form":16,"./links_form.js":16,"./links_form_lnk":41,"./links_form_lnk.js":41,"./links_form_spr":42,"./links_form_spr.js":42,"./login":43,"./login.js":43,"./md5":44,"./md5.js":44,"./new_bar":8,"./new_bar.js":8,"./new_dv":11,"./new_dv.js":11,"./new_form":3,"./new_form.js":3,"./new_prop":2,"./new_prop.js":2,"./new_stri":12,"./new_stri.js":12,"./new_tg":13,"./new_tg.js":13,"./new_user":14,"./new_user.js":14,"./skipped":19,"./skipped.js":19,"./spr_dt":20,"./spr_dt.js":20,"./start":45,"./start.js":45,"./top-menu":15,"./top-menu.js":15,"./unlink":5,"./unlink.js":5,"./unlinked":17,"./unlinked.js":17,"./unlinkedall":18,"./unlinkedall.js":18,"./yes-no":9,"./yes-no.js":9};i.keys=function(){return Object.keys(r)},i.resolve=o,e.exports=i,i.id=54},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}!function(){function e(t,n){i(this,e),this.name=n.storeName||n.id+":route",this.cb=t}e.prototype.set=function(e,t){var n=this;webix.storage.session.put(this.name,e),t&&t.silent||setTimeout(function(){return n.cb(e)},1)},e.prototype.get=function(){return webix.storage.session.get(this.name)}}()},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}!function(){function e(t,n){i(this,e),this.cb=t,this.prefix=n.routerPrefix||""}e.prototype.set=function(e,t){var n=this;window.history.pushState(null,null,this.prefix+e),t&&t.silent||setTimeout(function(){return n.cb(e)},1)},e.prototype.get=function(){var e=window.location.pathname.replace(this.prefix,"");return"/"!==e?e:""}}()},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",function(){return o});var o=function(){function e(t,n){i(this,e),this.path="",this.cb=t}return e.prototype.set=function(e,t){var n=this;this.path=e,t&&t.silent||setTimeout(function(){return n.cb(e)},1)},e.prototype.get=function(){return this.path},e}()},function(e,t,n){"use strict";function i(e,t,n){t.on(e,"app:guard",function(e,i,o){if(i===t||i.contains(t)){var r=n();o.confirm=!1===r?Promise.reject(r):o.confirm.then(function(){return r})}})}t.a=i},function(e,t,n){"use strict";function i(e,t,i){i=i||{};var o=i.storage,a=o?o.get("lang"):i.lang||"en",s={_:null,polyglot:null,getLang:function(){return a},setLang:function(t,i){var c=n(61)("./"+t);c.__esModule&&(c=c.default);var l=s.polyglot=new r.a({phrases:c});l.locale(t),s._=webix.bind(l.t,l),a=t,o&&o.put("lang",a),i||e.refresh()}};e.setService("locale",s),s.setLang(a,!0)}t.a=i;var o=n(60),r=n.n(o)},function(e,t,n){var i,o,r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(n,r){i=[],void 0!==(o=function(){return r(n)}.apply(t,i))&&(e.exports=o)}(this,function(e){"use strict";function t(e){e=e||{},this.phrases={},this.extend(e.phrases||{}),this.currentLocale=e.locale||"en",this.allowMissing=!!e.allowMissing,this.warn=e.warn||l}function n(e){var t,n,i,o={};for(t in e)if(e.hasOwnProperty(t)){n=e[t];for(i in n)o[n[i]]=t}return o}function i(e){var t=/^\s+|\s+$/g;return e.replace(t,"")}function o(e,t,n){var o,r,a;return null!=n&&e?(r=e.split(d),a=r[s(t,n)]||r[0],o=i(a)):o=e,o}function a(e){var t=n(f);return t[e]||t.en}function s(e,t){return p[a(e)](t)}function c(e,t){for(var n in t)"_"!==n&&t.hasOwnProperty(n)&&(e=e.replace(new RegExp("%\\{"+n+"\\}","g"),t[n]));return e}function l(t){e.console&&e.console.warn&&e.console.warn("WARNING: "+t)}function u(e){var t={};for(var n in e)t[n]=e[n];return t}t.VERSION="0.4.3",t.prototype.locale=function(e){return e&&(this.currentLocale=e),this.currentLocale},t.prototype.extend=function(e,t){var n;for(var i in e)e.hasOwnProperty(i)&&(n=e[i],t&&(i=t+"."+i),"object"===(void 0===n?"undefined":r(n))?this.extend(n,i):this.phrases[i]=n)},t.prototype.clear=function(){this.phrases={}},t.prototype.replace=function(e){this.clear(),this.extend(e)},t.prototype.t=function(e,t){var n,i;return t=null==t?{}:t,"number"==typeof t&&(t={smart_count:t}),"string"==typeof this.phrases[e]?n=this.phrases[e]:"string"==typeof t._?n=t._:this.allowMissing?n=e:(this.warn('Missing translation for key: "'+e+'"'),i=e),"string"==typeof n&&(t=u(t),i=o(n,this.currentLocale,t.smart_count),i=c(i,t)),i},t.prototype.has=function(e){return e in this.phrases};var d="||||",p={chinese:function(e){return 0},german:function(e){return 1!==e?1:0},french:function(e){return e>1?1:0},russian:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2},czech:function(e){return 1===e?0:e>=2&&e<=4?1:2},polish:function(e){return 1===e?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2},icelandic:function(e){return e%10!=1||e%100==11?1:0}},f={chinese:["fa","id","ja","ko","lo","ms","th","tr","zh"],german:["da","de","en","es","fi","el","he","hu","it","nl","no","pt","sv"],french:["fr","tl","pt-br"],russian:["hr","ru"],czech:["cs"],polish:["pl"],icelandic:["is"]};return t})},function(e,t,n){function i(e){return n(o(e))}function o(e){var t=r[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var r={"./en":46,"./en.js":46,"./ru":23,"./ru.js":23};i.keys=function(){return Object.keys(r)},i.resolve=o,e.exports=i,i.id=61},function(e,t,n){"use strict";function i(e,t,n){t.urls&&(n=t.urls[n]||n),e.show("./"+n)}function o(e,t,n){var o=t.$$(n.id||n),r=!1;o.attachEvent("onchange",function(){r||i(t,n,this.getValue())}),o.attachEvent("onafterselect",function(){if(!r){var e=null;o.setValue?e=this.getValue():o.getSelectedId&&(e=o.getSelectedId()),i(t,n,e)}}),t.on(e,"app:route",function(e){var n=e[t.getIndex()];if(n){r=!0;var i=n.page;o.setValue&&o.getValue()!==i?o.setValue(i):o.select&&o.exists(i)&&o.getSelectedId()!==i&&o.select(i),r=!1}})}t.a=o},function(e,t,n){"use strict";function i(e,t,n){function i(e){var i=t.$$(n.target);i&&(e||(e="<div class='status_"+f+"'><span class='webix_icon fa-"+w[f]+"'></span> "+g[f]+"</div>"),i.setHTML(e))}function a(){h--,d("good")}function s(e){h--,d("error",e)}function c(e){h++,d("saving"),e&&e.then&&e.then(a,s)}function l(){return f}function u(){0==h&&i(" ")}function d(t,n){h<0&&(h=0),"saving"===t?(f="saving",i()):(_="error"===t,0===h&&(f=_?"error":"good",_?e.error("app:error:server",[n.responseText||n]):b&&setTimeout(u,b),i()))}function p(e){var n=webix.dp(e);n&&(t.on(n,"onAfterDataSend",c),t.on(n,"onAfterSaveError",function(e,t,n){return s(n)}),t.on(n,"onAfterSave",a))}var f="good",h=0,_=!1,b=n.expire;b||!1===b||(b=2e3);var g=n.texts||r,w=n.icons||o;"string"==typeof n&&(n={target:n}),e.setService("status",{getStatus:l,setStatus:d,track:p}),n.remote&&t.on(webix,"onRemoteCall",c),n.ajax&&t.on(webix,"onBeforeAjax",function(e,t,n,i,o,r,a){c(a)}),n.data&&p(n.data)}t.a=i;var o={good:"check",error:"warning",saving:"refresh fa-spin"},r={good:"Ok",error:"Error",saving:"Connecting..."}},function(e,t,n){"use strict";function i(e,t,n){n=n||{};var i=n.storage,o=i?i.get("theme"):n.theme||"flat-default",r={getTheme:function(){return o},setTheme:function(t,n){for(var r=t.split("-"),a=document.getElementsByTagName("link"),s=0;s<a.length;s++){var c=a[s].getAttribute("title");c&&(c===t||c===r[0]?(a[s].rel="stylesheet",a[s].disabled=!1):(a[s].rel="alternate stylesheet",a[s].disabled=!0),webix.skin.set(r[0])),webix.html.removeCss(document.body,"theme-"+o),webix.html.addCss(document.body,"theme-"+t)}o=t,i&&i.put("theme",t),n||e.refresh()}};e.setService("theme",r),r.setTheme(o,!0)}t.a=i},function(e,t,n){"use strict";function i(e,t,n){function i(e,t){e===r?(d.logout(),t.redirect=s):e===o||d.getStatus()||(t.redirect=o)}n=n||{};var o=n.login||"/login",r=n.logout||"/logout",a=n.afterLogin||e.config.start,s=n.afterLogout||"/login",c=n.ping||3e5,l=n.model,u=n.user,d={getUser:function(){return u},getStatus:function(e){return e?l.status().catch(function(){return null}).then(function(e){u=e}):null!==u},login:function(t,n){return l.login(t,n).then(function(t){if(u=t,!t)throw"Access denied";e.show(a)})},logout:function(){return u=null,l.logout()}};e.setService("user",d),e.attachEvent("app:guard",function(e,t,n){return void 0===u&&(n.confirm=d.getStatus(!0).then(function(t){return i(e,n)})),i(e,n)}),c&&setInterval(function(){return d.getStatus(!0)},c)}t.a=i}]);